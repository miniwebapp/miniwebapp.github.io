var ti=Object.defineProperty;var ei=(k,e,I)=>e in k?ti(k,e,{enumerable:!0,configurable:!0,writable:!0,value:I}):k[e]=I;var ee=(k,e,I)=>(ei(k,typeof e!="symbol"?e+"":e,I),I),Ne=(k,e,I)=>{if(!e.has(k))throw TypeError("Cannot "+I)};var t=(k,e,I)=>(Ne(k,e,"read from private field"),I?I.call(k):e.get(k)),j=(k,e,I)=>{if(e.has(k))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(k):e.set(k,I)},st=(k,e,I,r)=>(Ne(k,e,"write to private field"),r?r.call(k,I):e.set(k,I),I);var ge=(k,e,I,r)=>({set _(f){st(k,e,f,I)},get _(){return t(k,e,r)}}),q=(k,e,I)=>(Ne(k,e,"access private method"),I);import{r as reactExports,h as generateUtilityClasses,g as generateUtilityClass,s as styled,_ as _extends,k as alpha_1,f as useThemeProps,b as _objectWithoutPropertiesLoose,j as jsxRuntimeExports,d as clsx,a as capitalize,e as composeClasses,D as getAugmentedNamespace,q as getDefaultExportFromCjs}from"./index-459c5962.js";import{t as ButtonGroupContext,v as ButtonGroupButtonContext}from"./appStore-653fb111.js";function _mergeNamespaces(k,e){for(var I=0;I<e.length;I++){const r=e[I];if(typeof r!="string"&&!Array.isArray(r)){for(const f in r)if(f!=="default"&&!(f in k)){const z=Object.getOwnPropertyDescriptor(r,f);z&&Object.defineProperty(k,f,z.get?z:{enumerable:!0,get:()=>r[f]})}}}return Object.freeze(Object.defineProperty(k,Symbol.toStringTag,{value:"Module"}))}function getValidReactChildren(k){return reactExports.Children.toArray(k).filter(e=>reactExports.isValidElement(e))}function getButtonGroupUtilityClass(k){return generateUtilityClass("MuiButtonGroup",k)}const buttonGroupClasses=generateUtilityClasses("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),buttonGroupClasses$1=buttonGroupClasses,_excluded=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],overridesResolver=(k,e)=>{const{ownerState:I}=k;return[{[`& .${buttonGroupClasses$1.grouped}`]:e.grouped},{[`& .${buttonGroupClasses$1.grouped}`]:e[`grouped${capitalize(I.orientation)}`]},{[`& .${buttonGroupClasses$1.grouped}`]:e[`grouped${capitalize(I.variant)}`]},{[`& .${buttonGroupClasses$1.grouped}`]:e[`grouped${capitalize(I.variant)}${capitalize(I.orientation)}`]},{[`& .${buttonGroupClasses$1.grouped}`]:e[`grouped${capitalize(I.variant)}${capitalize(I.color)}`]},{[`& .${buttonGroupClasses$1.firstButton}`]:e.firstButton},{[`& .${buttonGroupClasses$1.lastButton}`]:e.lastButton},{[`& .${buttonGroupClasses$1.middleButton}`]:e.middleButton},e.root,e[I.variant],I.disableElevation===!0&&e.disableElevation,I.fullWidth&&e.fullWidth,I.orientation==="vertical"&&e.vertical]},useUtilityClasses=k=>{const{classes:e,color:I,disabled:r,disableElevation:f,fullWidth:z,orientation:U,variant:ct}=k,D={root:["root",ct,U==="vertical"&&"vertical",z&&"fullWidth",f&&"disableElevation"],grouped:["grouped",`grouped${capitalize(U)}`,`grouped${capitalize(ct)}`,`grouped${capitalize(ct)}${capitalize(U)}`,`grouped${capitalize(ct)}${capitalize(I)}`,r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return composeClasses(D,getButtonGroupUtilityClass,e)},ButtonGroupRoot=styled("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver})(({theme:k,ownerState:e})=>_extends({display:"inline-flex",borderRadius:(k.vars||k).shape.borderRadius},e.variant==="contained"&&{boxShadow:(k.vars||k).shadows[2]},e.disableElevation&&{boxShadow:"none"},e.fullWidth&&{width:"100%"},e.orientation==="vertical"&&{flexDirection:"column"},{[`& .${buttonGroupClasses$1.grouped}`]:_extends({minWidth:40,"&:hover":_extends({},e.variant==="contained"&&{boxShadow:"none"})},e.variant==="contained"&&{boxShadow:"none"}),[`& .${buttonGroupClasses$1.firstButton},& .${buttonGroupClasses$1.middleButton}`]:_extends({},e.orientation==="horizontal"&&{borderTopRightRadius:0,borderBottomRightRadius:0},e.orientation==="vertical"&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},e.variant==="text"&&e.orientation==="horizontal"&&{borderRight:k.vars?`1px solid rgba(${k.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${k.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${buttonGroupClasses$1.disabled}`]:{borderRight:`1px solid ${(k.vars||k).palette.action.disabled}`}},e.variant==="text"&&e.orientation==="vertical"&&{borderBottom:k.vars?`1px solid rgba(${k.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${k.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${buttonGroupClasses$1.disabled}`]:{borderBottom:`1px solid ${(k.vars||k).palette.action.disabled}`}},e.variant==="text"&&e.color!=="inherit"&&{borderColor:k.vars?`rgba(${k.vars.palette[e.color].mainChannel} / 0.5)`:alpha_1(k.palette[e.color].main,.5)},e.variant==="outlined"&&e.orientation==="horizontal"&&{borderRightColor:"transparent"},e.variant==="outlined"&&e.orientation==="vertical"&&{borderBottomColor:"transparent"},e.variant==="contained"&&e.orientation==="horizontal"&&{borderRight:`1px solid ${(k.vars||k).palette.grey[400]}`,[`&.${buttonGroupClasses$1.disabled}`]:{borderRight:`1px solid ${(k.vars||k).palette.action.disabled}`}},e.variant==="contained"&&e.orientation==="vertical"&&{borderBottom:`1px solid ${(k.vars||k).palette.grey[400]}`,[`&.${buttonGroupClasses$1.disabled}`]:{borderBottom:`1px solid ${(k.vars||k).palette.action.disabled}`}},e.variant==="contained"&&e.color!=="inherit"&&{borderColor:(k.vars||k).palette[e.color].dark},{"&:hover":_extends({},e.variant==="outlined"&&e.orientation==="horizontal"&&{borderRightColor:"currentColor"},e.variant==="outlined"&&e.orientation==="vertical"&&{borderBottomColor:"currentColor"})}),[`& .${buttonGroupClasses$1.lastButton},& .${buttonGroupClasses$1.middleButton}`]:_extends({},e.orientation==="horizontal"&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},e.orientation==="vertical"&&{borderTopRightRadius:0,borderTopLeftRadius:0},e.variant==="outlined"&&e.orientation==="horizontal"&&{marginLeft:-1},e.variant==="outlined"&&e.orientation==="vertical"&&{marginTop:-1})})),ButtonGroup=reactExports.forwardRef(function(e,I){const r=useThemeProps({props:e,name:"MuiButtonGroup"}),{children:f,className:z,color:U="primary",component:ct="div",disabled:D=!1,disableElevation:C=!1,disableFocusRipple:g=!1,disableRipple:L=!1,fullWidth:O=!1,orientation:T="horizontal",size:v="medium",variant:A="outlined"}=r,u=_objectWithoutPropertiesLoose(r,_excluded),_=_extends({},r,{color:U,component:ct,disabled:D,disableElevation:C,disableFocusRipple:g,disableRipple:L,fullWidth:O,orientation:T,size:v,variant:A}),x=useUtilityClasses(_),w=reactExports.useMemo(()=>({className:x.grouped,color:U,disabled:D,disableElevation:C,disableFocusRipple:g,disableRipple:L,fullWidth:O,size:v,variant:A}),[U,D,C,g,L,O,v,A,x.grouped]),y=getValidReactChildren(f),o=y.length,h=F=>{const m=F===0,l=F===o-1;return m&&l?"":m?x.firstButton:l?x.lastButton:x.middleButton};return jsxRuntimeExports.jsx(ButtonGroupRoot,_extends({as:ct,role:"group",className:clsx(x.root,z),ref:I,ownerState:_},u,{children:jsxRuntimeExports.jsx(ButtonGroupContext.Provider,{value:w,children:y.map((F,m)=>jsxRuntimeExports.jsx(ButtonGroupButtonContext.Provider,{value:h(m),children:F},m))})}))}),ButtonGroup$1=ButtonGroup;function commonjsRequire(k){throw new Error('Could not dynamically require "'+k+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,I){module.exports=e.pdfjsLib=I()})(globalThis,()=>(()=>{var __webpack_modules__=[,(k,e)=>{var qt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=lt,e.bytesToString=W,e.createValidAbsoluteUrl=Et,e.getModificationDate=Ct,e.getUuid=zt,e.getVerbosityLevel=X,e.info=it,e.isArrayBuffer=ft,e.isArrayEqual=wt,e.isNodeJS=void 0,e.normalizeUnicode=Ht,e.objectFromMap=ht,e.objectSize=at,e.setVerbosityLevel=S,e.shadow=xt,e.string32=J,e.stringToBytes=nt,e.stringToPDFString=mt,e.stringToUTF8String=et,e.unreachable=H,e.utf8StringToString=Z,e.warn=rt;const I=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=I;const r=[1,0,0,1,0,0];e.IDENTITY_MATRIX=r;const f=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=f;const z=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=z;const U=1.35;e.LINE_FACTOR=U;const ct=.35;e.LINE_DESCENT_FACTOR=ct;const D=ct/U;e.BASELINE_FACTOR=D;const C={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=C;const g={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=g;const L="pdfjs_internal_editor_";e.AnnotationEditorPrefix=L;const O={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=O;const T={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=T;const v={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=v;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=A;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=u;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=_;const x={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=x;const w={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=w;const y={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=y;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=o;const h={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=h;const F={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=F;const m={O:"PageOpen",C:"PageClose"};e.PageActionEventType=m;const l={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=l;const R={NONE:0,BINARY:1};e.CMapCompressionType=R;const p={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=p;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=$;let G=l.WARNINGS;function S(ut){Number.isInteger(ut)&&(G=ut)}function X(){return G}function it(ut){G>=l.INFOS&&console.log(`Info: ${ut}`)}function rt(ut){G>=l.WARNINGS&&console.log(`Warning: ${ut}`)}function H(ut){throw new Error(ut)}function lt(ut,tt){ut||H(tt)}function gt(ut){switch(ut==null?void 0:ut.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Et(ut,tt=null,Y=null){if(!ut)return null;try{if(Y&&typeof ut=="string"){if(Y.addDefaultProtocol&&ut.startsWith("www.")){const yt=ut.match(/\./g);(yt==null?void 0:yt.length)>=2&&(ut=`http://${ut}`)}if(Y.tryConvertEncoding)try{ut=et(ut)}catch{}}const _t=tt?new URL(ut,tt):new URL(ut);if(gt(_t))return _t}catch{}return null}function xt(ut,tt,Y,_t=!1){return Object.defineProperty(ut,tt,{value:Y,enumerable:!_t,configurable:!0,writable:!1}),Y}const P=function(){function tt(Y,_t){this.constructor===tt&&H("Cannot initialize BaseException."),this.message=Y,this.name=_t}return tt.prototype=new Error,tt.constructor=tt,tt}();e.BaseException=P;class i extends P{constructor(tt,Y){super(tt,"PasswordException"),this.code=Y}}e.PasswordException=i;class a extends P{constructor(tt,Y){super(tt,"UnknownErrorException"),this.details=Y}}e.UnknownErrorException=a;class s extends P{constructor(tt){super(tt,"InvalidPDFException")}}e.InvalidPDFException=s;class c extends P{constructor(tt){super(tt,"MissingPDFException")}}e.MissingPDFException=c;class d extends P{constructor(tt,Y){super(tt,"UnexpectedResponseException"),this.status=Y}}e.UnexpectedResponseException=d;class E extends P{constructor(tt){super(tt,"FormatError")}}e.FormatError=E;class M extends P{constructor(tt){super(tt,"AbortException")}}e.AbortException=M;function W(ut){(typeof ut!="object"||(ut==null?void 0:ut.length)===void 0)&&H("Invalid argument for bytesToString");const tt=ut.length,Y=8192;if(tt<Y)return String.fromCharCode.apply(null,ut);const _t=[];for(let yt=0;yt<tt;yt+=Y){const te=Math.min(yt+Y,tt),Zt=ut.subarray(yt,te);_t.push(String.fromCharCode.apply(null,Zt))}return _t.join("")}function nt(ut){typeof ut!="string"&&H("Invalid argument for stringToBytes");const tt=ut.length,Y=new Uint8Array(tt);for(let _t=0;_t<tt;++_t)Y[_t]=ut.charCodeAt(_t)&255;return Y}function J(ut){return String.fromCharCode(ut>>24&255,ut>>16&255,ut>>8&255,ut&255)}function at(ut){return Object.keys(ut).length}function ht(ut){const tt=Object.create(null);for(const[Y,_t]of ut)tt[Y]=_t;return tt}function pt(){const ut=new Uint8Array(4);return ut[0]=1,new Uint32Array(ut.buffer,0,1)[0]===1}function dt(){try{return new Function(""),!0}catch{return!1}}class Tt{static get isLittleEndian(){return xt(this,"isLittleEndian",pt())}static get isEvalSupported(){return xt(this,"isEvalSupported",dt())}static get isOffscreenCanvasSupported(){return xt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?xt(this,"platform",{isWin:!1,isMac:!1}):xt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var tt,Y;return xt(this,"isCSSRoundSupported",(Y=(tt=globalThis.CSS)==null?void 0:tt.supports)==null?void 0:Y.call(tt,"width: round(1.5px, 1px)"))}}e.FeatureTest=Tt;const Lt=[...Array(256).keys()].map(ut=>ut.toString(16).padStart(2,"0"));class vt{static makeHexColor(tt,Y,_t){return`#${Lt[tt]}${Lt[Y]}${Lt[_t]}`}static scaleMinMax(tt,Y){let _t;tt[0]?(tt[0]<0&&(_t=Y[0],Y[0]=Y[1],Y[1]=_t),Y[0]*=tt[0],Y[1]*=tt[0],tt[3]<0&&(_t=Y[2],Y[2]=Y[3],Y[3]=_t),Y[2]*=tt[3],Y[3]*=tt[3]):(_t=Y[0],Y[0]=Y[2],Y[2]=_t,_t=Y[1],Y[1]=Y[3],Y[3]=_t,tt[1]<0&&(_t=Y[2],Y[2]=Y[3],Y[3]=_t),Y[2]*=tt[1],Y[3]*=tt[1],tt[2]<0&&(_t=Y[0],Y[0]=Y[1],Y[1]=_t),Y[0]*=tt[2],Y[1]*=tt[2]),Y[0]+=tt[4],Y[1]+=tt[4],Y[2]+=tt[5],Y[3]+=tt[5]}static transform(tt,Y){return[tt[0]*Y[0]+tt[2]*Y[1],tt[1]*Y[0]+tt[3]*Y[1],tt[0]*Y[2]+tt[2]*Y[3],tt[1]*Y[2]+tt[3]*Y[3],tt[0]*Y[4]+tt[2]*Y[5]+tt[4],tt[1]*Y[4]+tt[3]*Y[5]+tt[5]]}static applyTransform(tt,Y){const _t=tt[0]*Y[0]+tt[1]*Y[2]+Y[4],yt=tt[0]*Y[1]+tt[1]*Y[3]+Y[5];return[_t,yt]}static applyInverseTransform(tt,Y){const _t=Y[0]*Y[3]-Y[1]*Y[2],yt=(tt[0]*Y[3]-tt[1]*Y[2]+Y[2]*Y[5]-Y[4]*Y[3])/_t,te=(-tt[0]*Y[1]+tt[1]*Y[0]+Y[4]*Y[1]-Y[5]*Y[0])/_t;return[yt,te]}static getAxialAlignedBoundingBox(tt,Y){const _t=this.applyTransform(tt,Y),yt=this.applyTransform(tt.slice(2,4),Y),te=this.applyTransform([tt[0],tt[3]],Y),Zt=this.applyTransform([tt[2],tt[1]],Y);return[Math.min(_t[0],yt[0],te[0],Zt[0]),Math.min(_t[1],yt[1],te[1],Zt[1]),Math.max(_t[0],yt[0],te[0],Zt[0]),Math.max(_t[1],yt[1],te[1],Zt[1])]}static inverseTransform(tt){const Y=tt[0]*tt[3]-tt[1]*tt[2];return[tt[3]/Y,-tt[1]/Y,-tt[2]/Y,tt[0]/Y,(tt[2]*tt[5]-tt[4]*tt[3])/Y,(tt[4]*tt[1]-tt[5]*tt[0])/Y]}static singularValueDecompose2dScale(tt){const Y=[tt[0],tt[2],tt[1],tt[3]],_t=tt[0]*Y[0]+tt[1]*Y[2],yt=tt[0]*Y[1]+tt[1]*Y[3],te=tt[2]*Y[0]+tt[3]*Y[2],Zt=tt[2]*Y[1]+tt[3]*Y[3],Q=(_t+Zt)/2,St=Math.sqrt((_t+Zt)**2-4*(_t*Zt-te*yt))/2,Ot=Q+St||1,Pt=Q-St||1;return[Math.sqrt(Ot),Math.sqrt(Pt)]}static normalizeRect(tt){const Y=tt.slice(0);return tt[0]>tt[2]&&(Y[0]=tt[2],Y[2]=tt[0]),tt[1]>tt[3]&&(Y[1]=tt[3],Y[3]=tt[1]),Y}static intersect(tt,Y){const _t=Math.max(Math.min(tt[0],tt[2]),Math.min(Y[0],Y[2])),yt=Math.min(Math.max(tt[0],tt[2]),Math.max(Y[0],Y[2]));if(_t>yt)return null;const te=Math.max(Math.min(tt[1],tt[3]),Math.min(Y[1],Y[3])),Zt=Math.min(Math.max(tt[1],tt[3]),Math.max(Y[1],Y[3]));return te>Zt?null:[_t,te,yt,Zt]}static bezierBoundingBox(tt,Y,_t,yt,te,Zt,Q,St){const Ot=[],Pt=[[],[]];let Nt,Bt,Jt,At,Yt,It,N,n;for(let K=0;K<2;++K){if(K===0?(Bt=6*tt-12*_t+6*te,Nt=-3*tt+9*_t-9*te+3*Q,Jt=3*_t-3*tt):(Bt=6*Y-12*yt+6*Zt,Nt=-3*Y+9*yt-9*Zt+3*St,Jt=3*yt-3*Y),Math.abs(Nt)<1e-12){if(Math.abs(Bt)<1e-12)continue;At=-Jt/Bt,0<At&&At<1&&Ot.push(At);continue}N=Bt*Bt-4*Jt*Nt,n=Math.sqrt(N),!(N<0)&&(Yt=(-Bt+n)/(2*Nt),0<Yt&&Yt<1&&Ot.push(Yt),It=(-Bt-n)/(2*Nt),0<It&&It<1&&Ot.push(It))}let b=Ot.length,B;const V=b;for(;b--;)At=Ot[b],B=1-At,Pt[0][b]=B*B*B*tt+3*B*B*At*_t+3*B*At*At*te+At*At*At*Q,Pt[1][b]=B*B*B*Y+3*B*B*At*yt+3*B*At*At*Zt+At*At*At*St;return Pt[0][V]=tt,Pt[1][V]=Y,Pt[0][V+1]=Q,Pt[1][V+1]=St,Pt[0].length=Pt[1].length=V+2,[Math.min(...Pt[0]),Math.min(...Pt[1]),Math.max(...Pt[0]),Math.max(...Pt[1])]}}e.Util=vt;const Dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function mt(ut){if(ut[0]>="ï"){let Y;if(ut[0]==="þ"&&ut[1]==="ÿ"?Y="utf-16be":ut[0]==="ÿ"&&ut[1]==="þ"?Y="utf-16le":ut[0]==="ï"&&ut[1]==="»"&&ut[2]==="¿"&&(Y="utf-8"),Y)try{const _t=new TextDecoder(Y,{fatal:!0}),yt=nt(ut);return _t.decode(yt)}catch(_t){rt(`stringToPDFString: "${_t}".`)}}const tt=[];for(let Y=0,_t=ut.length;Y<_t;Y++){const yt=Dt[ut.charCodeAt(Y)];tt.push(yt?String.fromCharCode(yt):ut.charAt(Y))}return tt.join("")}function et(ut){return decodeURIComponent(escape(ut))}function Z(ut){return unescape(encodeURIComponent(ut))}function ft(ut){return typeof ut=="object"&&(ut==null?void 0:ut.byteLength)!==void 0}function wt(ut,tt){if(ut.length!==tt.length)return!1;for(let Y=0,_t=ut.length;Y<_t;Y++)if(ut[Y]!==tt[Y])return!1;return!0}function Ct(ut=new Date){return[ut.getUTCFullYear().toString(),(ut.getUTCMonth()+1).toString().padStart(2,"0"),ut.getUTCDate().toString().padStart(2,"0"),ut.getUTCHours().toString().padStart(2,"0"),ut.getUTCMinutes().toString().padStart(2,"0"),ut.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){j(this,qt,!1);this.promise=new Promise((tt,Y)=>{this.resolve=_t=>{st(this,qt,!0),tt(_t)},this.reject=_t=>{st(this,qt,!0),Y(_t)}})}get settled(){return t(this,qt)}}qt=new WeakMap,e.PromiseCapability=Ut;let Gt=null,Wt=null;function Ht(ut){return Gt||(Gt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Wt=new Map([["ﬅ","ſt"]])),ut.replaceAll(Gt,(tt,Y,_t)=>Y?Y.normalize("NFKC"):Wt.get(_t))}function zt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ut=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ut);else for(let tt=0;tt<32;tt++)ut[tt]=Math.floor(Math.random()*255);return W(ut)}const jt="pdfjs_internal_id_";e.AnnotationPrefix=jt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var k,I,r,f,he,U,Se,D,C,g,L,O,T,v,A,u,xe,x,w,Be,o,h;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(m){if(typeof m=="string"||m instanceof URL?m={url:m}:(0,_util.isArrayBuffer)(m)&&(m={data:m}),typeof m!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!m.url&&!m.data&&!m.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:R}=l,p=m.url?getUrlProp(m.url):null,$=m.data?getDataProp(m.data):null,G=m.httpHeaders||null,S=m.withCredentials===!0,X=m.password??null,it=m.range instanceof PDFDataRangeTransport?m.range:null,rt=Number.isInteger(m.rangeChunkSize)&&m.rangeChunkSize>0?m.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let H=m.worker instanceof PDFWorker?m.worker:null;const lt=m.verbosity,gt=typeof m.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(m.docBaseUrl)?m.docBaseUrl:null,Et=typeof m.cMapUrl=="string"?m.cMapUrl:null,xt=m.cMapPacked!==!1,P=m.CMapReaderFactory||DefaultCMapReaderFactory,i=typeof m.standardFontDataUrl=="string"?m.standardFontDataUrl:null,a=m.StandardFontDataFactory||DefaultStandardFontDataFactory,s=m.stopAtErrors!==!0,c=Number.isInteger(m.maxImageSize)&&m.maxImageSize>-1?m.maxImageSize:-1,d=m.isEvalSupported!==!1,E=typeof m.isOffscreenCanvasSupported=="boolean"?m.isOffscreenCanvasSupported:!_util.isNodeJS,M=Number.isInteger(m.canvasMaxAreaInBytes)?m.canvasMaxAreaInBytes:-1,W=typeof m.disableFontFace=="boolean"?m.disableFontFace:_util.isNodeJS,nt=m.fontExtraProperties===!0,J=m.enableXfa===!0,at=m.ownerDocument||globalThis.document,ht=m.disableRange===!0,pt=m.disableStream===!0,dt=m.disableAutoFetch===!0,Tt=m.pdfBug===!0,Lt=it?it.length:m.length??NaN,vt=typeof m.useSystemFonts=="boolean"?m.useSystemFonts:!_util.isNodeJS&&!W,Dt=typeof m.useWorkerFetch=="boolean"?m.useWorkerFetch:P===_display_utils.DOMCMapReaderFactory&&a===_display_utils.DOMStandardFontDataFactory&&Et&&i&&(0,_display_utils.isValidFetchUrl)(Et,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI),mt=m.canvasFactory||new DefaultCanvasFactory({ownerDocument:at}),et=m.filterFactory||new DefaultFilterFactory({docId:R,ownerDocument:at}),Z=null;(0,_util.setVerbosityLevel)(lt);const ft={canvasFactory:mt,filterFactory:et};if(Dt||(ft.cMapReaderFactory=new P({baseUrl:Et,isCompressed:xt}),ft.standardFontDataFactory=new a({baseUrl:i})),!H){const Ut={verbosity:lt,port:_worker_options.GlobalWorkerOptions.workerPort};H=Ut.port?PDFWorker.fromPort(Ut):new PDFWorker(Ut),l._worker=H}const wt={docId:R,apiVersion:"3.11.174",data:$,password:X,disableAutoFetch:dt,rangeChunkSize:rt,length:Lt,docBaseUrl:gt,enableXfa:J,evaluatorOptions:{maxImageSize:c,disableFontFace:W,ignoreErrors:s,isEvalSupported:d,isOffscreenCanvasSupported:E,canvasMaxAreaInBytes:M,fontExtraProperties:nt,useSystemFonts:vt,cMapUrl:Dt?Et:null,standardFontDataUrl:Dt?i:null}},Ct={ignoreErrors:s,isEvalSupported:d,disableFontFace:W,fontExtraProperties:nt,enableXfa:J,ownerDocument:at,disableAutoFetch:dt,pdfBug:Tt,styleElement:Z};return H.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const Ut=_fetchDocument(H,wt),Gt=new Promise(function(Wt){let Ht;it?Ht=new _transport_stream.PDFDataTransportStream({length:Lt,initialData:it.initialData,progressiveDone:it.progressiveDone,contentDispositionFilename:it.contentDispositionFilename,disableRange:ht,disableStream:pt},it):$||(Ht=(jt=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(jt):(0,_display_utils.isValidFetchUrl)(jt.url)?new _displayFetch_stream.PDFFetchStream(jt):new _displayNetwork.PDFNetworkStream(jt))({url:p,length:Lt,httpHeaders:G,withCredentials:S,rangeChunkSize:rt,disableRange:ht,disableStream:pt})),Wt(Ht)});return Promise.all([Ut,Gt]).then(function([Wt,Ht]){if(l.destroyed)throw new Error("Loading aborted");const zt=new _message_handler.MessageHandler(R,Wt,H.port),jt=new WorkerTransport(zt,l,Ht,Ct,ft);l._transport=jt,zt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(m,l){if(m.destroyed)throw new Error("Worker was destroyed");const R=await m.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(m.destroyed)throw new Error("Worker was destroyed");return R}function getUrlProp(m){if(m instanceof URL)return m.href;try{return new URL(m,window.location).href}catch{if(_util.isNodeJS&&typeof m=="string")return m}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(m){if(_util.isNodeJS&&typeof Buffer<"u"&&m instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength)return m;if(typeof m=="string")return(0,_util.stringToBytes)(m);if(typeof m=="object"&&!isNaN(m==null?void 0:m.length)||(0,_util.isArrayBuffer)(m))return new Uint8Array(m);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ge(e,k)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,R,p;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((R=this._transport)==null?void 0:R.destroy())}catch($){throw(p=this._worker)!=null&&p.port&&delete this._worker._pendingDestroy,$}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};k=new WeakMap,j(e,k,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,R,p=!1,$=null){this.length=l,this.initialData=R,this.progressiveDone=p,this.contentDispositionFilename=$,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,R){for(const p of this._rangeListeners)p(l,R)}onDataProgress(l,R){this._readyCapability.promise.then(()=>{for(const p of this._progressListeners)p(l,R)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const R of this._progressiveReadListeners)R(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,R){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,R){this._pdfInfo=l,this._transport=R,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(p=>{if(!p)return p;const $=[];for(const G in p)$.push(...p[G]);return $}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,R,p,$=!1){j(this,f);j(this,U);j(this,I,null);j(this,r,!1);this._pageIndex=l,this._pageInfo=R,this._transport=p,this._stats=$?new _display_utils.StatTimer:null,this._pdfBug=$,this.commonObjs=p.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:R=this.rotate,offsetX:p=0,offsetY:$=0,dontFlip:G=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:R,offsetX:p,offsetY:$,dontFlip:G})}getAnnotations({intent:l="display"}={}){const R=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,R.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:R,intent:p="display",annotationMode:$=_util.AnnotationMode.ENABLE,transform:G=null,background:S=null,optionalContentConfigPromise:X=null,annotationCanvasMap:it=null,pageColors:rt=null,printAnnotationStorage:H=null}){var a,s;(a=this._stats)==null||a.time("Overall");const lt=this._transport.getRenderingIntent(p,$,H);st(this,r,!1),q(this,U,Se).call(this),X||(X=this._transport.getOptionalContentConfig());let gt=this._intentStates.get(lt.cacheKey);gt||(gt=Object.create(null),this._intentStates.set(lt.cacheKey,gt)),gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null);const Et=!!(lt.renderingIntent&_util.RenderingIntentFlag.PRINT);gt.displayReadyCapability||(gt.displayReadyCapability=new _util.PromiseCapability,gt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(s=this._stats)==null||s.time("Page Request"),this._pumpOperatorList(lt));const xt=c=>{var d,E;gt.renderTasks.delete(P),(this._maybeCleanupAfterRender||Et)&&st(this,r,!0),q(this,f,he).call(this,!Et),c?(P.capability.reject(c),this._abortOperatorList({intentState:gt,reason:c instanceof Error?c:new Error(c)})):P.capability.resolve(),(d=this._stats)==null||d.timeEnd("Rendering"),(E=this._stats)==null||E.timeEnd("Overall")},P=new InternalRenderTask({callback:xt,params:{canvasContext:l,viewport:R,transform:G,background:S},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:it,operatorList:gt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Et,pdfBug:this._pdfBug,pageColors:rt});(gt.renderTasks||(gt.renderTasks=new Set)).add(P);const i=P.task;return Promise.all([gt.displayReadyCapability.promise,X]).then(([c,d])=>{var E;if(this.destroyed){xt();return}(E=this._stats)==null||E.time("Rendering"),P.initializeGraphics({transparency:c,optionalContentConfig:d}),P.operatorListChanged()}).catch(xt),i}getOperatorList({intent:l="display",annotationMode:R=_util.AnnotationMode.ENABLE,printAnnotationStorage:p=null}={}){var it;function $(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(X))}const G=this._transport.getRenderingIntent(l,R,p,!0);let S=this._intentStates.get(G.cacheKey);S||(S=Object.create(null),this._intentStates.set(G.cacheKey,S));let X;return S.opListReadCapability||(X=Object.create(null),X.operatorListChanged=$,S.opListReadCapability=new _util.PromiseCapability,(S.renderTasks||(S.renderTasks=new Set)).add(X),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(G)),S.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:R=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:R===!0},{highWaterMark:100,size($){return $.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(p=>_xfa_text.XfaText.textContent(p));const R=this.streamTextContent(l);return new Promise(function(p,$){function G(){S.read().then(function({value:it,done:rt}){if(rt){p(X);return}Object.assign(X.styles,it.styles),X.items.push(...it.items),G()},$)}const S=R.getReader(),X={items:[],styles:Object.create(null)};G()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const R of this._intentStates.values())if(this._abortOperatorList({intentState:R,reason:new Error("Page was destroyed."),force:!0}),!R.opListReadCapability)for(const p of R.renderTasks)l.push(p.completed),p.cancel();return this.objs.clear(),st(this,r,!1),q(this,U,Se).call(this),Promise.all(l)}cleanup(l=!1){st(this,r,!0);const R=q(this,f,he).call(this,!1);return l&&R&&this._stats&&(this._stats=new _display_utils.StatTimer),R}_startRenderPage(l,R){var $,G;const p=this._intentStates.get(R);p&&(($=this._stats)==null||$.timeEnd("Page Request"),(G=p.displayReadyCapability)==null||G.resolve(l))}_renderPageChunk(l,R){for(let p=0,$=l.length;p<$;p++)R.operatorList.fnArray.push(l.fnArray[p]),R.operatorList.argsArray.push(l.argsArray[p]);R.operatorList.lastChunk=l.lastChunk,R.operatorList.separateAnnots=l.separateAnnots;for(const p of R.renderTasks)p.operatorListChanged();l.lastChunk&&q(this,f,he).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:R,annotationStorageSerializable:p}){const{map:$,transfers:G}=p,X=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:R,annotationStorage:$},G).getReader(),it=this._intentStates.get(R);it.streamReader=X;const rt=()=>{X.read().then(({value:H,done:lt})=>{if(lt){it.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(H,it),rt())},H=>{if(it.streamReader=null,!this._transport.destroyed){if(it.operatorList){it.operatorList.lastChunk=!0;for(const lt of it.renderTasks)lt.operatorListChanged();q(this,f,he).call(this,!0)}if(it.displayReadyCapability)it.displayReadyCapability.reject(H);else if(it.opListReadCapability)it.opListReadCapability.reject(H);else throw H}})};rt()}_abortOperatorList({intentState:l,reason:R,force:p=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!p){if(l.renderTasks.size>0)return;if(R instanceof _display_utils.RenderingCancelledException){let $=RENDERING_CANCELLED_TIMEOUT;R.extraDelay>0&&R.extraDelay<1e3&&($+=R.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:R,force:!0})},$);return}}if(l.streamReader.cancel(new _util.AbortException(R.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[$,G]of this._intentStates)if(G===l){this._intentStates.delete($);break}this.cleanup()}}}get stats(){return this._stats}}I=new WeakMap,r=new WeakMap,f=new WeakSet,he=function(l=!1){if(q(this,U,Se).call(this),!t(this,r)||this.destroyed)return!1;if(l)return st(this,I,setTimeout(()=>{st(this,I,null),q(this,f,he).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:R,operatorList:p}of this._intentStates.values())if(R.size>0||!p.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),st(this,r,!1),!0},U=new WeakSet,Se=function(){t(this,I)&&(clearTimeout(t(this,I)),st(this,I,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){j(this,D,new Set);j(this,C,Promise.resolve())}postMessage(l,R){const p={data:structuredClone(l,R?{transfer:R}:null)};t(this,C).then(()=>{for(const $ of t(this,D))$.call(this,p)})}addEventListener(l,R){t(this,D).add(R)}removeEventListener(l,R){t(this,D).delete(R)}terminate(){t(this,D).clear()}}D=new WeakMap,C=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const m=(g=document==null?void 0:document.currentScript)==null?void 0:g.src;m&&(PDFWorkerUtil.fallbackWorkerSrc=m.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(m,l){let R;try{if(R=new URL(m),!R.origin||R.origin==="null")return!1}catch{return!1}const p=new URL(l,R);return R.origin===p.origin},PDFWorkerUtil.createCDNWrapper=function(m){const l=`importScripts("${m}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:m=null,port:l=null,verbosity:R=(0,_util.getVerbosityLevel)()}={}){var p;if(this.name=m,this.destroyed=!1,this.verbosity=R,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((p=t(_PDFWorker,L))!=null&&p.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,L)||st(_PDFWorker,L,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(m){this._port=m,this._messageHandler=new _message_handler.MessageHandler("main","worker",m),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:m}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,m)||(m=PDFWorkerUtil.createCDNWrapper(new URL(m,window.location).href));const l=new Worker(m),R=new _message_handler.MessageHandler("main","worker",l),p=()=>{l.removeEventListener("error",$),R.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},$=()=>{this._webWorker||p()};l.addEventListener("error",$),R.on("test",S=>{if(l.removeEventListener("error",$),this.destroyed){p();return}S?(this._messageHandler=R,this._port=l,this._webWorker=l,this._readyCapability.resolve(),R.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),R.destroy(),l.terminate())}),R.on("ready",S=>{if(l.removeEventListener("error",$),this.destroyed){p();return}try{G()}catch{this._setupFakeWorker()}});const G=()=>{const S=new Uint8Array;R.send("test",S,[S.buffer])};G();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(m=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const R=`fake${PDFWorkerUtil.fakeWorkerId++}`,p=new _message_handler.MessageHandler(R+"_worker",R,l);m.setup(p,l);const $=new _message_handler.MessageHandler(R,R+"_worker",l);this._messageHandler=$,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})}).catch(m=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${m.message}".`))})}destroy(){var m;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(m=t(_PDFWorker,L))==null||m.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(m){var R;if(!(m!=null&&m.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(R=t(this,L))==null?void 0:R.get(m.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(m)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var m;try{return((m=globalThis.pdfjsWorker)==null?void 0:m.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};L=new WeakMap,j(_PDFWorker,L,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,R,p,$,G){j(this,u);j(this,O,new Map);j(this,T,new Map);j(this,v,new Map);j(this,A,null);this.messageHandler=l,this.loadingTask=R,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:$.ownerDocument,styleElement:$.styleElement}),this._params=$,this.canvasFactory=G.canvasFactory,this.filterFactory=G.filterFactory,this.cMapReaderFactory=G.cMapReaderFactory,this.standardFontDataFactory=G.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=p,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,R=_util.AnnotationMode.ENABLE,p=null,$=!1){let G=_util.RenderingIntentFlag.DISPLAY,S=_annotation_storage.SerializableEmpty;switch(l){case"any":G=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":G=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(R){case _util.AnnotationMode.DISABLE:G+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:G+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:G+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=(G&_util.RenderingIntentFlag.PRINT&&p instanceof _annotation_storage.PrintAnnotationStorage?p:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${R}`)}return $&&(G+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:G,cacheKey:`${G}_${S.hash}`,annotationStorageSerializable:S}}destroy(){var p;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(p=t(this,A))==null||p.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const $ of t(this,T).values())l.push($._destroy());t(this,T).clear(),t(this,v).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const R=this.messageHandler.sendWithPromise("Terminate",null);return l.push(R),Promise.all(l).then(()=>{var $;this.commonObjs.clear(),this.fontLoader.clear(),t(this,O).clear(),this.filterFactory.destroy(),($=this._networkStream)==null||$.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:R}=this;l.on("GetReader",(p,$)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=G=>{this._lastProgress={loaded:G.loaded,total:G.total}},$.onPull=()=>{this._fullReader.read().then(function({value:G,done:S}){if(S){$.close();return}(0,_util.assert)(G instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(G),1,[G])}).catch(G=>{$.error(G)})},$.onCancel=G=>{this._fullReader.cancel(G),$.ready.catch(S=>{if(!this.destroyed)throw S})}}),l.on("ReaderHeadersReady",p=>{const $=new _util.PromiseCapability,G=this._fullReader;return G.headersReady.then(()=>{var S;(!G.isStreamingSupported||!G.isRangeSupported)&&(this._lastProgress&&((S=R.onProgress)==null||S.call(R,this._lastProgress)),G.onProgress=X=>{var it;(it=R.onProgress)==null||it.call(R,{loaded:X.loaded,total:X.total})}),$.resolve({isStreamingSupported:G.isStreamingSupported,isRangeSupported:G.isRangeSupported,contentLength:G.contentLength})},$.reject),$.promise}),l.on("GetRangeReader",(p,$)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const G=this._networkStream.getRangeReader(p.begin,p.end);if(!G){$.close();return}$.onPull=()=>{G.read().then(function({value:S,done:X}){if(X){$.close();return}(0,_util.assert)(S instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{$.error(S)})},$.onCancel=S=>{G.cancel(S),$.ready.catch(X=>{if(!this.destroyed)throw X})}}),l.on("GetDoc",({pdfInfo:p})=>{this._numPages=p.numPages,this._htmlForXfa=p.htmlForXfa,delete p.htmlForXfa,R._capability.resolve(new PDFDocumentProxy(p,this))}),l.on("DocException",function(p){let $;switch(p.name){case"PasswordException":$=new _util.PasswordException(p.message,p.code);break;case"InvalidPDFException":$=new _util.InvalidPDFException(p.message);break;case"MissingPDFException":$=new _util.MissingPDFException(p.message);break;case"UnexpectedResponseException":$=new _util.UnexpectedResponseException(p.message,p.status);break;case"UnknownErrorException":$=new _util.UnknownErrorException(p.message,p.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}R._capability.reject($)}),l.on("PasswordRequest",p=>{if(st(this,A,new _util.PromiseCapability),R.onPassword){const $=G=>{G instanceof Error?t(this,A).reject(G):t(this,A).resolve({password:G})};try{R.onPassword($,p.code)}catch(G){t(this,A).reject(G)}}else t(this,A).reject(new _util.PasswordException(p.message,p.code));return t(this,A).promise}),l.on("DataLoaded",p=>{var $;($=R.onProgress)==null||$.call(R,{loaded:p.length,total:p.length}),this.downloadInfoCapability.resolve(p)}),l.on("StartRenderPage",p=>{if(this.destroyed)return;t(this,T).get(p.pageIndex)._startRenderPage(p.transparency,p.cacheKey)}),l.on("commonobj",([p,$,G])=>{var S;if(!this.destroyed&&!this.commonObjs.has(p))switch($){case"Font":const X=this._params;if("error"in G){const H=G.error;(0,_util.warn)(`Error during font loading: ${H}`),this.commonObjs.resolve(p,H);break}const it=X.pdfBug&&((S=globalThis.FontInspector)!=null&&S.enabled)?(H,lt)=>globalThis.FontInspector.fontAdded(H,lt):null,rt=new _font_loader.FontFaceObject(G,{isEvalSupported:X.isEvalSupported,disableFontFace:X.disableFontFace,ignoreErrors:X.ignoreErrors,inspectFont:it});this.fontLoader.bind(rt).catch(H=>l.sendWithPromise("FontFallback",{id:p})).finally(()=>{!X.fontExtraProperties&&rt.data&&(rt.data=null),this.commonObjs.resolve(p,rt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(p,G);break;default:throw new Error(`Got unknown common object type ${$}`)}}),l.on("obj",([p,$,G,S])=>{var it;if(this.destroyed)return;const X=t(this,T).get($);if(!X.objs.has(p))switch(G){case"Image":if(X.objs.resolve(p,S),S){let rt;if(S.bitmap){const{width:H,height:lt}=S;rt=H*lt*4}else rt=((it=S.data)==null?void 0:it.length)||0;rt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(X._maybeCleanupAfterRender=!0)}break;case"Pattern":X.objs.resolve(p,S);break;default:throw new Error(`Got unknown object type ${G}`)}}),l.on("DocProgress",p=>{var $;this.destroyed||($=R.onProgress)==null||$.call(R,{loaded:p.loaded,total:p.total})}),l.on("FetchBuiltInCMap",p=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(p):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",p=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(p):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var p;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:R}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:((p=this._fullReader)==null?void 0:p.filename)??null},R).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const R=l-1,p=t(this,v).get(R);if(p)return p;const $=this.messageHandler.sendWithPromise("GetPage",{pageIndex:R}).then(G=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(R,G,this,this._params.pdfBug);return t(this,T).set(R,S),S});return t(this,v).set(R,$),$}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,R){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:R})}getFieldObjects(){return q(this,u,xe).call(this,"GetFieldObjects")}hasJSActions(){return q(this,u,xe).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return q(this,u,xe).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",R=t(this,O).get(l);if(R)return R;const p=this.messageHandler.sendWithPromise(l,null).then($=>{var G,S;return{info:$[0],metadata:$[1]?new _metadata.Metadata($[1]):null,contentDispositionFilename:((G=this._fullReader)==null?void 0:G.filename)??null,contentLength:((S=this._fullReader)==null?void 0:S.contentLength)??null}});return t(this,O).set(l,p),p}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const R of t(this,T).values())if(!R.cleanup())throw new Error(`startCleanup: Page ${R.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,O).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:R}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:R})}}O=new WeakMap,T=new WeakMap,v=new WeakMap,A=new WeakMap,u=new WeakSet,xe=function(l,R=null){const p=t(this,O).get(l);if(p)return p;const $=this.messageHandler.sendWithPromise(l,R);return t(this,O).set(l,$),$};class PDFObjects{constructor(){j(this,w);j(this,x,Object.create(null))}get(l,R=null){if(R){const $=q(this,w,Be).call(this,l);return $.capability.promise.then(()=>R($.data)),null}const p=t(this,x)[l];if(!(p!=null&&p.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return p.data}has(l){const R=t(this,x)[l];return(R==null?void 0:R.capability.settled)||!1}resolve(l,R=null){const p=q(this,w,Be).call(this,l);p.data=R,p.capability.resolve()}clear(){var l;for(const R in t(this,x)){const{data:p}=t(this,x)[R];(l=p==null?void 0:p.bitmap)==null||l.close()}st(this,x,Object.create(null))}}x=new WeakMap,w=new WeakSet,Be=function(l){var R;return(R=t(this,x))[l]||(R[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){j(this,o,null);st(this,o,l),this.onContinue=null}get promise(){return t(this,o).capability.promise}cancel(l=0){t(this,o).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,o).operatorList;if(!l)return!1;const{annotationCanvasMap:R}=t(this,o);return l.form||l.canvas&&(R==null?void 0:R.size)>0}}o=new WeakMap,exports.RenderTask=RenderTask;const F=class F{constructor({callback:l,params:R,objs:p,commonObjs:$,annotationCanvasMap:G,operatorList:S,pageIndex:X,canvasFactory:it,filterFactory:rt,useRequestAnimationFrame:H=!1,pdfBug:lt=!1,pageColors:gt=null}){this.callback=l,this.params=R,this.objs=p,this.commonObjs=$,this.annotationCanvasMap=G,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=X,this.canvasFactory=it,this.filterFactory=rt,this._pdfBug=lt,this.pageColors=gt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=H===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=R.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:R}){var X,it;if(this.cancelled)return;if(this._canvas){if(t(F,h).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(F,h).add(this._canvas)}this._pdfBug&&((X=globalThis.StepperManager)!=null&&X.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:p,viewport:$,transform:G,background:S}=this.params;this.gfx=new _canvas.CanvasGraphics(p,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:R},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:G,viewport:$,transparency:l,background:S}),this.operatorListIdx=0,this.graphicsReady=!0,(it=this.graphicsReadyCallback)==null||it.call(this)}cancel(l=null,R=0){var p;this.running=!1,this.cancelled=!0,(p=this.gfx)==null||p.endDrawing(),t(F,h).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,R))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(F,h).delete(this._canvas),this.callback())))}};h=new WeakMap,j(F,h,new WeakSet);let InternalRenderTask=F;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(k,e,I)=>{var C,g,L,yn,T;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var r=I(1),f=I(4),z=I(8);const U=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=U;class ct{constructor(){j(this,L);j(this,C,!1);j(this,g,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(A,u){const _=t(this,g).get(A);return _===void 0?u:Object.assign(u,_)}getRawValue(A){return t(this,g).get(A)}remove(A){if(t(this,g).delete(A),t(this,g).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const u of t(this,g).values())if(u instanceof f.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(A,u){const _=t(this,g).get(A);let x=!1;if(_!==void 0)for(const[w,y]of Object.entries(u))_[w]!==y&&(x=!0,_[w]=y);else x=!0,t(this,g).set(A,u);x&&q(this,L,yn).call(this),u instanceof f.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(u.constructor._type)}has(A){return t(this,g).has(A)}getAll(){return t(this,g).size>0?(0,r.objectFromMap)(t(this,g)):null}setAll(A){for(const[u,_]of Object.entries(A))this.setValue(u,_)}get size(){return t(this,g).size}resetModified(){t(this,C)&&(st(this,C,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new D(this)}get serializable(){if(t(this,g).size===0)return U;const A=new Map,u=new z.MurmurHash3_64,_=[],x=Object.create(null);let w=!1;for(const[y,o]of t(this,g)){const h=o instanceof f.AnnotationEditor?o.serialize(!1,x):o;h&&(A.set(y,h),u.update(`${y}:${JSON.stringify(h)}`),w||(w=!!h.bitmap))}if(w)for(const y of A.values())y.bitmap&&_.push(y.bitmap);return A.size>0?{map:A,hash:u.hexdigest(),transfers:_}:U}}C=new WeakMap,g=new WeakMap,L=new WeakSet,yn=function(){t(this,C)||(st(this,C,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=ct;class D extends ct{constructor(u){super();j(this,T,void 0);const{map:_,hash:x,transfers:w}=u.serializable,y=structuredClone(_,w?{transfer:w}:null);st(this,T,{map:y,hash:x,transfers:w})}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,T)}}T=new WeakMap,e.PrintAnnotationStorage=D},(k,e,I)=>{var D,C,g,L,O,T,v,A,u,_,x,w,y,o,h,je,m,Ue,R,We,$,$e,S,vn,it,En,H,Sn,gt,He,xt,xn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var r=I(5),f=I(1),z=I(6);const i=class i{constructor(s){j(this,h);j(this,m);j(this,$);j(this,S);j(this,it);j(this,H);j(this,gt);j(this,xt);j(this,D,"");j(this,C,!1);j(this,g,null);j(this,L,null);j(this,O,null);j(this,T,!1);j(this,v,null);j(this,A,this.focusin.bind(this));j(this,u,this.focusout.bind(this));j(this,_,!1);j(this,x,!1);j(this,w,!1);ee(this,"_initialOptions",Object.create(null));ee(this,"_uiManager",null);ee(this,"_focusEventsAllowed",!0);ee(this,"_l10nPromise",null);j(this,y,!1);j(this,o,i._zIndex++);this.constructor===i&&(0,f.unreachable)("Cannot initialize AnnotationEditor."),this.parent=s.parent,this.id=s.id,this.width=this.height=null,this.pageIndex=s.parent.pageIndex,this.name=s.name,this.div=null,this._uiManager=s.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=s.isCentered,this._structTreeParentId=null;const{rotation:c,rawDims:{pageWidth:d,pageHeight:E,pageX:M,pageY:W}}=this.parent.viewport;this.rotation=c,this.pageRotation=(360+c-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[d,E],this.pageTranslation=[M,W];const[nt,J]=this.parentDimensions;this.x=s.x/nt,this.y=s.y/J,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,f.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(s){const c=new ct({id:s.parent.getNextId(),parent:s.parent,uiManager:s._uiManager});c.annotationElementId=s.annotationElementId,c.deleted=!0,c._uiManager.addToAnnotationStorage(c)}static initialize(s,c=null){if(i._l10nPromise||(i._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(E=>[E,s.get(E)]))),c!=null&&c.strings)for(const E of c.strings)i._l10nPromise.set(E,s.get(E));if(i._borderLineWidth!==-1)return;const d=getComputedStyle(document.documentElement);i._borderLineWidth=parseFloat(d.getPropertyValue("--outline-width"))||0}static updateDefaultParams(s,c){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(s){return!1}static paste(s,c){(0,f.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,y)}set _isDraggable(s){var c;st(this,y,s),(c=this.div)==null||c.classList.toggle("draggable",s)}center(){const[s,c]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*c/(s*2),this.y+=this.width*s/(c*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*c/(s*2),this.y-=this.width*s/(c*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(s){this._uiManager.addCommands(s)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,o)}setParent(s){s!==null&&(this.pageIndex=s.pageIndex,this.pageDimensions=s.pageDimensions),this.parent=s}focusin(s){this._focusEventsAllowed&&(t(this,_)?st(this,_,!1):this.parent.setSelected(this))}focusout(s){var d;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const c=s.relatedTarget;c!=null&&c.closest(`#${this.id}`)||(s.preventDefault(),(d=this.parent)!=null&&d.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(s,c,d,E){const[M,W]=this.parentDimensions;[d,E]=this.screenToPageTranslation(d,E),this.x=(s+d)/M,this.y=(c+E)/W,this.fixAndSetPosition()}translate(s,c){q(this,h,je).call(this,this.parentDimensions,s,c)}translateInPage(s,c){q(this,h,je).call(this,this.pageDimensions,s,c),this.div.scrollIntoView({block:"nearest"})}drag(s,c){const[d,E]=this.parentDimensions;if(this.x+=s/d,this.y+=c/E,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:at,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,at,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:M,y:W}=this;const[nt,J]=q(this,m,Ue).call(this);M+=nt,W+=J,this.div.style.left=`${(100*M).toFixed(2)}%`,this.div.style.top=`${(100*W).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[s,c]=this.pageDimensions;let{x:d,y:E,width:M,height:W}=this;switch(M*=s,W*=c,d*=s,E*=c,this.rotation){case 0:d=Math.max(0,Math.min(s-M,d)),E=Math.max(0,Math.min(c-W,E));break;case 90:d=Math.max(0,Math.min(s-W,d)),E=Math.min(c,Math.max(M,E));break;case 180:d=Math.min(s,Math.max(M,d)),E=Math.min(c,Math.max(W,E));break;case 270:d=Math.min(s,Math.max(W,d)),E=Math.max(0,Math.min(c-M,E));break}this.x=d/=s,this.y=E/=c;const[nt,J]=q(this,m,Ue).call(this);d+=nt,E+=J;const{style:at}=this.div;at.left=`${(100*d).toFixed(2)}%`,at.top=`${(100*E).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(s,c){var d;return q(d=i,R,We).call(d,s,c,this.parentRotation)}pageTranslationToScreen(s,c){var d;return q(d=i,R,We).call(d,s,c,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:s,pageDimensions:[c,d]}=this,E=c*s,M=d*s;return f.FeatureTest.isCSSRoundSupported?[Math.round(E),Math.round(M)]:[E,M]}setDims(s,c){var M;const[d,E]=this.parentDimensions;this.div.style.width=`${(100*s/d).toFixed(2)}%`,t(this,T)||(this.div.style.height=`${(100*c/E).toFixed(2)}%`),(M=t(this,g))==null||M.classList.toggle("small",s<i.SMALL_EDITOR_SIZE||c<i.SMALL_EDITOR_SIZE)}fixDims(){const{style:s}=this.div,{height:c,width:d}=s,E=d.endsWith("%"),M=!t(this,T)&&c.endsWith("%");if(E&&M)return;const[W,nt]=this.parentDimensions;E||(s.width=`${(100*parseFloat(d)/W).toFixed(2)}%`),!t(this,T)&&!M&&(s.height=`${(100*parseFloat(c)/nt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,g))return;const s=st(this,g,document.createElement("button"));s.className="altText";const c=await i._l10nPromise.get("editor_alt_text_button_label");s.textContent=c,s.setAttribute("aria-label",c),s.tabIndex="0",s.addEventListener("contextmenu",z.noContextMenu),s.addEventListener("pointerdown",d=>d.stopPropagation()),s.addEventListener("click",d=>{d.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),s.addEventListener("keydown",d=>{d.target===s&&d.key==="Enter"&&(d.preventDefault(),this._uiManager.editAltText(this))}),q(this,gt,He).call(this),this.div.append(s),i.SMALL_EDITOR_SIZE||(i.SMALL_EDITOR_SIZE=Math.min(128,Math.round(s.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,D),decorative:t(this,C)}}set altTextData({altText:s,decorative:c}){t(this,D)===s&&t(this,C)===c||(st(this,D,s),st(this,C,c),q(this,gt,He).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,A)),this.div.addEventListener("focusout",t(this,u));const[s,c]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*c/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/c).toFixed(2)}%`);const[d,E]=this.getInitialTranslation();return this.translate(d,E),(0,r.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(s){const{isMac:c}=f.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&c){s.preventDefault();return}st(this,_,!0),q(this,xt,xn).call(this,s)}moveInDOM(){var s;(s=this.parent)==null||s.moveEditorInDOM(this)}_setParentAndPosition(s,c,d){s.changeParent(this),this.x=c,this.y=d,this.fixAndSetPosition()}getRect(s,c){const d=this.parentScale,[E,M]=this.pageDimensions,[W,nt]=this.pageTranslation,J=s/d,at=c/d,ht=this.x*E,pt=this.y*M,dt=this.width*E,Tt=this.height*M;switch(this.rotation){case 0:return[ht+J+W,M-pt-at-Tt+nt,ht+J+dt+W,M-pt-at+nt];case 90:return[ht+at+W,M-pt+J+nt,ht+at+Tt+W,M-pt+J+dt+nt];case 180:return[ht-J-dt+W,M-pt+at+nt,ht-J+W,M-pt+at+Tt+nt];case 270:return[ht-at-Tt+W,M-pt-J-dt+nt,ht-at+W,M-pt-J+nt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(s,c){const[d,E,M,W]=s,nt=M-d,J=W-E;switch(this.rotation){case 0:return[d,c-W,nt,J];case 90:return[d,c-E,J,nt];case 180:return[M,c-E,nt,J];case 270:return[M,c-W,J,nt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){st(this,w,!0)}disableEditMode(){st(this,w,!1)}isInEditMode(){return t(this,w)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var s,c;(s=this.div)==null||s.addEventListener("focusin",t(this,A)),(c=this.div)==null||c.addEventListener("focusout",t(this,u))}serialize(s=!1,c=null){(0,f.unreachable)("An editor must be serializable")}static deserialize(s,c,d){const E=new this.prototype.constructor({parent:c,id:c.getNextId(),uiManager:d});E.rotation=s.rotation;const[M,W]=E.pageDimensions,[nt,J,at,ht]=E.getRectInCurrentCoords(s.rect,W);return E.x=nt/M,E.y=J/W,E.width=at/M,E.height=ht/W,E}remove(){var s;this.div.removeEventListener("focusin",t(this,A)),this.div.removeEventListener("focusout",t(this,u)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(s=t(this,g))==null||s.remove(),st(this,g,null),st(this,L,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(q(this,S,vn).call(this),t(this,v).classList.remove("hidden"))}select(){var s;this.makeResizable(),(s=this.div)==null||s.classList.add("selectedEditor")}unselect(){var s,c,d;(s=t(this,v))==null||s.classList.add("hidden"),(c=this.div)==null||c.classList.remove("selectedEditor"),(d=this.div)!=null&&d.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(s,c){}disableEditing(){t(this,g)&&(t(this,g).hidden=!0)}enableEditing(){t(this,g)&&(t(this,g).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,x)}set isEditing(s){st(this,x,s),this.parent&&(s?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(s,c){st(this,T,!0);const d=s/c,{style:E}=this.div;E.aspectRatio=d,E.height="auto"}static get MIN_SIZE(){return 16}};D=new WeakMap,C=new WeakMap,g=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakMap,v=new WeakMap,A=new WeakMap,u=new WeakMap,_=new WeakMap,x=new WeakMap,w=new WeakMap,y=new WeakMap,o=new WeakMap,h=new WeakSet,je=function([s,c],d,E){[d,E]=this.screenToPageTranslation(d,E),this.x+=d/s,this.y+=E/c,this.fixAndSetPosition()},m=new WeakSet,Ue=function(){const[s,c]=this.parentDimensions,{_borderLineWidth:d}=i,E=d/s,M=d/c;switch(this.rotation){case 90:return[-E,M];case 180:return[E,M];case 270:return[E,-M];default:return[-E,-M]}},R=new WeakSet,We=function(s,c,d){switch(d){case 90:return[c,-s];case 180:return[-s,-c];case 270:return[-c,s];default:return[s,c]}},$=new WeakSet,$e=function(s){switch(s){case 90:{const[c,d]=this.pageDimensions;return[0,-c/d,d/c,0]}case 180:return[-1,0,0,-1];case 270:{const[c,d]=this.pageDimensions;return[0,c/d,-d/c,0]}default:return[1,0,0,1]}},S=new WeakSet,vn=function(){if(t(this,v))return;st(this,v,document.createElement("div")),t(this,v).classList.add("resizers");const s=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||s.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const c of s){const d=document.createElement("div");t(this,v).append(d),d.classList.add("resizer",c),d.addEventListener("pointerdown",q(this,it,En).bind(this,c)),d.addEventListener("contextmenu",z.noContextMenu)}this.div.prepend(t(this,v))},it=new WeakSet,En=function(s,c){c.preventDefault();const{isMac:d}=f.FeatureTest.platform;if(c.button!==0||c.ctrlKey&&d)return;const E=q(this,H,Sn).bind(this,s),M=this._isDraggable;this._isDraggable=!1;const W={passive:!0,capture:!0};window.addEventListener("pointermove",E,W);const nt=this.x,J=this.y,at=this.width,ht=this.height,pt=this.parent.div.style.cursor,dt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(c.target).cursor;const Tt=()=>{this._isDraggable=M,window.removeEventListener("pointerup",Tt),window.removeEventListener("blur",Tt),window.removeEventListener("pointermove",E,W),this.parent.div.style.cursor=pt,this.div.style.cursor=dt;const Lt=this.x,vt=this.y,Dt=this.width,mt=this.height;Lt===nt&&vt===J&&Dt===at&&mt===ht||this.addCommands({cmd:()=>{this.width=Dt,this.height=mt,this.x=Lt,this.y=vt;const[et,Z]=this.parentDimensions;this.setDims(et*Dt,Z*mt),this.fixAndSetPosition()},undo:()=>{this.width=at,this.height=ht,this.x=nt,this.y=J;const[et,Z]=this.parentDimensions;this.setDims(et*at,Z*ht),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",Tt),window.addEventListener("blur",Tt)},H=new WeakSet,Sn=function(s,c){const[d,E]=this.parentDimensions,M=this.x,W=this.y,nt=this.width,J=this.height,at=i.MIN_SIZE/d,ht=i.MIN_SIZE/E,pt=_t=>Math.round(_t*1e4)/1e4,dt=q(this,$,$e).call(this,this.rotation),Tt=(_t,yt)=>[dt[0]*_t+dt[2]*yt,dt[1]*_t+dt[3]*yt],Lt=q(this,$,$e).call(this,360-this.rotation),vt=(_t,yt)=>[Lt[0]*_t+Lt[2]*yt,Lt[1]*_t+Lt[3]*yt];let Dt,mt,et=!1,Z=!1;switch(s){case"topLeft":et=!0,Dt=(_t,yt)=>[0,0],mt=(_t,yt)=>[_t,yt];break;case"topMiddle":Dt=(_t,yt)=>[_t/2,0],mt=(_t,yt)=>[_t/2,yt];break;case"topRight":et=!0,Dt=(_t,yt)=>[_t,0],mt=(_t,yt)=>[0,yt];break;case"middleRight":Z=!0,Dt=(_t,yt)=>[_t,yt/2],mt=(_t,yt)=>[0,yt/2];break;case"bottomRight":et=!0,Dt=(_t,yt)=>[_t,yt],mt=(_t,yt)=>[0,0];break;case"bottomMiddle":Dt=(_t,yt)=>[_t/2,yt],mt=(_t,yt)=>[_t/2,0];break;case"bottomLeft":et=!0,Dt=(_t,yt)=>[0,yt],mt=(_t,yt)=>[_t,0];break;case"middleLeft":Z=!0,Dt=(_t,yt)=>[0,yt/2],mt=(_t,yt)=>[_t,yt/2];break}const ft=Dt(nt,J),wt=mt(nt,J);let Ct=Tt(...wt);const Ut=pt(M+Ct[0]),Gt=pt(W+Ct[1]);let Wt=1,Ht=1,[zt,jt]=this.screenToPageTranslation(c.movementX,c.movementY);if([zt,jt]=vt(zt/d,jt/E),et){const _t=Math.hypot(nt,J);Wt=Ht=Math.max(Math.min(Math.hypot(wt[0]-ft[0]-zt,wt[1]-ft[1]-jt)/_t,1/nt,1/J),at/nt,ht/J)}else Z?Wt=Math.max(at,Math.min(1,Math.abs(wt[0]-ft[0]-zt)))/nt:Ht=Math.max(ht,Math.min(1,Math.abs(wt[1]-ft[1]-jt)))/J;const qt=pt(nt*Wt),ut=pt(J*Ht);Ct=Tt(...mt(qt,ut));const tt=Ut-Ct[0],Y=Gt-Ct[1];this.width=qt,this.height=ut,this.x=tt,this.y=Y,this.setDims(d*qt,E*ut),this.fixAndSetPosition()},gt=new WeakSet,He=async function(){var d;const s=t(this,g);if(!s)return;if(!t(this,D)&&!t(this,C)){s.classList.remove("done"),(d=t(this,L))==null||d.remove();return}i._l10nPromise.get("editor_alt_text_edit_button_label").then(E=>{s.setAttribute("aria-label",E)});let c=t(this,L);if(!c){st(this,L,c=document.createElement("span")),c.className="tooltip",c.setAttribute("role","tooltip");const E=c.id=`alt-text-tooltip-${this.id}`;s.setAttribute("aria-describedby",E);const M=100;s.addEventListener("mouseenter",()=>{st(this,O,setTimeout(()=>{st(this,O,null),t(this,L).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},M))}),s.addEventListener("mouseleave",()=>{var W;clearTimeout(t(this,O)),st(this,O,null),(W=t(this,L))==null||W.classList.remove("show")})}s.classList.add("done"),c.innerText=t(this,C)?await i._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,D),c.parentNode||s.append(c)},xt=new WeakSet,xn=function(s){if(!this._isDraggable)return;const c=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let d,E;c&&(d={passive:!0,capture:!0},E=W=>{const[nt,J]=this.screenToPageTranslation(W.movementX,W.movementY);this._uiManager.dragSelectedEditors(nt,J)},window.addEventListener("pointermove",E,d));const M=()=>{if(window.removeEventListener("pointerup",M),window.removeEventListener("blur",M),c&&window.removeEventListener("pointermove",E,d),st(this,_,!1),!this._uiManager.endDragSession()){const{isMac:W}=f.FeatureTest.platform;s.ctrlKey&&!W||s.shiftKey||s.metaKey&&W?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",M),window.addEventListener("blur",M)},j(i,R),ee(i,"_borderLineWidth",-1),ee(i,"_colorManager",new r.ColorManager),ee(i,"_zIndex",1),ee(i,"SMALL_EDITOR_SIZE",0);let U=i;e.AnnotationEditor=U;class ct extends U{constructor(s){super(s),this.annotationElementId=s.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(k,e,I)=>{var T,v,A,u,_,Ge,y,o,h,F,m,wn,p,$,G,S,X,it,rt,H,lt,gt,Et,xt,P,i,a,s,c,d,E,M,W,nt,J,at,ht,pt,dt,Tt,Lt,vt,Dt,mt,et,Z,ft,Cn,Ct,ze,Gt,Ve,Ht,we,jt,Xe,ut,qe,Y,re,yt,me,Zt,Tn,St,Pn,Pt,Ye,Bt,be,At,Ke;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=z,e.opacityToHex=U;var r=I(1),f=I(6);function z(N,n,b){for(const B of b)n.addEventListener(B,N[B].bind(N))}function U(N){return Math.round(Math.min(255,Math.max(1,255*N))).toString(16).padStart(2,"0")}class ct{constructor(){j(this,T,0)}getId(){return`${r.AnnotationEditorPrefix}${ge(this,T)._++}`}}T=new WeakMap;const w=class w{constructor(){j(this,_);j(this,v,(0,r.getUuid)());j(this,A,0);j(this,u,null)}static get _isSVGFittingCanvas(){const n='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',B=new OffscreenCanvas(1,3).getContext("2d"),V=new Image;V.src=n;const K=V.decode().then(()=>(B.drawImage(V,0,0,1,1,0,0,1,3),new Uint32Array(B.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,r.shadow)(this,"_isSVGFittingCanvas",K)}async getFromFile(n){const{lastModified:b,name:B,size:V,type:K}=n;return q(this,_,Ge).call(this,`${b}_${B}_${V}_${K}`,n)}async getFromUrl(n){return q(this,_,Ge).call(this,n,n)}async getFromId(n){t(this,u)||st(this,u,new Map);const b=t(this,u).get(n);return b?b.bitmap?(b.refCounter+=1,b):b.file?this.getFromFile(b.file):this.getFromUrl(b.url):null}getSvgUrl(n){const b=t(this,u).get(n);return b!=null&&b.isSvg?b.svgUrl:null}deleteId(n){t(this,u)||st(this,u,new Map);const b=t(this,u).get(n);b&&(b.refCounter-=1,b.refCounter===0&&(b.bitmap=null))}isValidId(n){return n.startsWith(`image_${t(this,v)}_`)}};v=new WeakMap,A=new WeakMap,u=new WeakMap,_=new WeakSet,Ge=async function(n,b){t(this,u)||st(this,u,new Map);let B=t(this,u).get(n);if(B===null)return null;if(B!=null&&B.bitmap)return B.refCounter+=1,B;try{B||(B={bitmap:null,id:`image_${t(this,v)}_${ge(this,A)._++}`,refCounter:0,isSvg:!1});let V;if(typeof b=="string"){B.url=b;const K=await fetch(b);if(!K.ok)throw new Error(K.statusText);V=await K.blob()}else V=B.file=b;if(V.type==="image/svg+xml"){const K=w._isSVGFittingCanvas,ot=new FileReader,bt=new Image,kt=new Promise((Rt,Vt)=>{bt.onload=()=>{B.bitmap=bt,B.isSvg=!0,Rt()},ot.onload=async()=>{const Mt=B.svgUrl=ot.result;bt.src=await K?`${Mt}#svgView(preserveAspectRatio(none))`:Mt},bt.onerror=ot.onerror=Vt});ot.readAsDataURL(V),await kt}else B.bitmap=await createImageBitmap(V);B.refCounter=1}catch(V){console.error(V),B=null}return t(this,u).set(n,B),B&&t(this,u).set(B.id,B),B};let D=w;class C{constructor(n=128){j(this,y,[]);j(this,o,!1);j(this,h,void 0);j(this,F,-1);st(this,h,n)}add({cmd:n,undo:b,mustExec:B,type:V=NaN,overwriteIfSameType:K=!1,keepUndo:ot=!1}){if(B&&n(),t(this,o))return;const bt={cmd:n,undo:b,type:V};if(t(this,F)===-1){t(this,y).length>0&&(t(this,y).length=0),st(this,F,0),t(this,y).push(bt);return}if(K&&t(this,y)[t(this,F)].type===V){ot&&(bt.undo=t(this,y)[t(this,F)].undo),t(this,y)[t(this,F)]=bt;return}const kt=t(this,F)+1;kt===t(this,h)?t(this,y).splice(0,1):(st(this,F,kt),kt<t(this,y).length&&t(this,y).splice(kt)),t(this,y).push(bt)}undo(){t(this,F)!==-1&&(st(this,o,!0),t(this,y)[t(this,F)].undo(),st(this,o,!1),st(this,F,t(this,F)-1))}redo(){t(this,F)<t(this,y).length-1&&(st(this,F,t(this,F)+1),st(this,o,!0),t(this,y)[t(this,F)].cmd(),st(this,o,!1))}hasSomethingToUndo(){return t(this,F)!==-1}hasSomethingToRedo(){return t(this,F)<t(this,y).length-1}destroy(){st(this,y,null)}}y=new WeakMap,o=new WeakMap,h=new WeakMap,F=new WeakMap,e.CommandManager=C;class g{constructor(n){j(this,m);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:b}=r.FeatureTest.platform;for(const[B,V,K={}]of n)for(const ot of B){const bt=ot.startsWith("mac+");b&&bt?(this.callbacks.set(ot.slice(4),{callback:V,options:K}),this.allKeys.add(ot.split("+").at(-1))):!b&&!bt&&(this.callbacks.set(ot,{callback:V,options:K}),this.allKeys.add(ot.split("+").at(-1)))}}exec(n,b){if(!this.allKeys.has(b.key))return;const B=this.callbacks.get(q(this,m,wn).call(this,b));if(!B)return;const{callback:V,options:{bubbles:K=!1,args:ot=[],checker:bt=null}}=B;bt&&!bt(n,b)||(V.bind(n,...ot)(),K||(b.stopPropagation(),b.preventDefault()))}}m=new WeakSet,wn=function(n){n.altKey&&this.buffer.push("alt"),n.ctrlKey&&this.buffer.push("ctrl"),n.metaKey&&this.buffer.push("meta"),n.shiftKey&&this.buffer.push("shift"),this.buffer.push(n.key);const b=this.buffer.join("+");return this.buffer.length=0,b},e.KeyboardManager=g;const R=class R{get _colors(){const n=new Map([["CanvasText",null],["Canvas",null]]);return(0,f.getColorValues)(n),(0,r.shadow)(this,"_colors",n)}convert(n){const b=(0,f.getRGB)(n);if(!window.matchMedia("(forced-colors: active)").matches)return b;for(const[B,V]of this._colors)if(V.every((K,ot)=>K===b[ot]))return R._colorsMapping.get(B);return b}getHexCode(n){const b=this._colors.get(n);return b?r.Util.makeHexColor(...b):n}};ee(R,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=R;e.ColorManager=L;const It=class It{constructor(n,b,B,V,K,ot){j(this,ft);j(this,Ct);j(this,Gt);j(this,Ht);j(this,jt);j(this,ut);j(this,Y);j(this,yt);j(this,Zt);j(this,St);j(this,Pt);j(this,Bt);j(this,At);j(this,p,null);j(this,$,new Map);j(this,G,new Map);j(this,S,null);j(this,X,null);j(this,it,new C);j(this,rt,0);j(this,H,new Set);j(this,lt,null);j(this,gt,null);j(this,Et,new Set);j(this,xt,null);j(this,P,new ct);j(this,i,!1);j(this,a,!1);j(this,s,null);j(this,c,r.AnnotationEditorType.NONE);j(this,d,new Set);j(this,E,null);j(this,M,this.blur.bind(this));j(this,W,this.focus.bind(this));j(this,nt,this.copy.bind(this));j(this,J,this.cut.bind(this));j(this,at,this.paste.bind(this));j(this,ht,this.keydown.bind(this));j(this,pt,this.onEditingAction.bind(this));j(this,dt,this.onPageChanging.bind(this));j(this,Tt,this.onScaleChanging.bind(this));j(this,Lt,this.onRotationChanging.bind(this));j(this,vt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});j(this,Dt,[0,0]);j(this,mt,null);j(this,et,null);j(this,Z,null);st(this,et,n),st(this,Z,b),st(this,S,B),this._eventBus=V,this._eventBus._on("editingaction",t(this,pt)),this._eventBus._on("pagechanging",t(this,dt)),this._eventBus._on("scalechanging",t(this,Tt)),this._eventBus._on("rotationchanging",t(this,Lt)),st(this,X,K.annotationStorage),st(this,xt,K.filterFactory),st(this,E,ot),this.viewParameters={realScale:f.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const n=It.prototype,b=K=>{const{activeElement:ot}=document;return ot&&t(K,et).contains(ot)&&K.hasSomethingToControl()},B=this.TRANSLATE_SMALL,V=this.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new g([[["ctrl+a","mac+meta+a"],n.selectAll],[["ctrl+z","mac+meta+z"],n.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],n.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],n.delete],[["Escape","mac+Escape"],n.unselectAll],[["ArrowLeft","mac+ArrowLeft"],n.translateSelectedEditors,{args:[-B,0],checker:b}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],n.translateSelectedEditors,{args:[-V,0],checker:b}],[["ArrowRight","mac+ArrowRight"],n.translateSelectedEditors,{args:[B,0],checker:b}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],n.translateSelectedEditors,{args:[V,0],checker:b}],[["ArrowUp","mac+ArrowUp"],n.translateSelectedEditors,{args:[0,-B],checker:b}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],n.translateSelectedEditors,{args:[0,-V],checker:b}],[["ArrowDown","mac+ArrowDown"],n.translateSelectedEditors,{args:[0,B],checker:b}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],n.translateSelectedEditors,{args:[0,V],checker:b}]]))}destroy(){q(this,Ht,we).call(this),q(this,Ct,ze).call(this),this._eventBus._off("editingaction",t(this,pt)),this._eventBus._off("pagechanging",t(this,dt)),this._eventBus._off("scalechanging",t(this,Tt)),this._eventBus._off("rotationchanging",t(this,Lt));for(const n of t(this,G).values())n.destroy();t(this,G).clear(),t(this,$).clear(),t(this,Et).clear(),st(this,p,null),t(this,d).clear(),t(this,it).destroy(),t(this,S).destroy()}get hcmFilter(){return(0,r.shadow)(this,"hcmFilter",t(this,E)?t(this,xt).addHCMFilter(t(this,E).foreground,t(this,E).background):"none")}get direction(){return(0,r.shadow)(this,"direction",getComputedStyle(t(this,et)).direction)}editAltText(n){var b;(b=t(this,S))==null||b.editAltText(this,n)}onPageChanging({pageNumber:n}){st(this,rt,n-1)}focusMainContainer(){t(this,et).focus()}findParent(n,b){for(const B of t(this,G).values()){const{x:V,y:K,width:ot,height:bt}=B.div.getBoundingClientRect();if(n>=V&&n<=V+ot&&b>=K&&b<=K+bt)return B}return null}disableUserSelect(n=!1){t(this,Z).classList.toggle("noUserSelect",n)}addShouldRescale(n){t(this,Et).add(n)}removeShouldRescale(n){t(this,Et).delete(n)}onScaleChanging({scale:n}){this.commitOrRemove(),this.viewParameters.realScale=n*f.PixelsPerInch.PDF_TO_CSS_UNITS;for(const b of t(this,Et))b.onScaleChanging()}onRotationChanging({pagesRotation:n}){this.commitOrRemove(),this.viewParameters.rotation=n}addToAnnotationStorage(n){!n.isEmpty()&&t(this,X)&&!t(this,X).has(n.id)&&t(this,X).setValue(n.id,n)}blur(){if(!this.hasSelection)return;const{activeElement:n}=document;for(const b of t(this,d))if(b.div.contains(n)){st(this,s,[b,n]),b._focusEventsAllowed=!1;break}}focus(){if(!t(this,s))return;const[n,b]=t(this,s);st(this,s,null),b.addEventListener("focusin",()=>{n._focusEventsAllowed=!0},{once:!0}),b.focus()}addEditListeners(){q(this,Gt,Ve).call(this),q(this,jt,Xe).call(this)}removeEditListeners(){q(this,Ht,we).call(this),q(this,ut,qe).call(this)}copy(n){var B;if(n.preventDefault(),(B=t(this,p))==null||B.commitOrRemove(),!this.hasSelection)return;const b=[];for(const V of t(this,d)){const K=V.serialize(!0);K&&b.push(K)}b.length!==0&&n.clipboardData.setData("application/pdfjs",JSON.stringify(b))}cut(n){this.copy(n),this.delete()}paste(n){n.preventDefault();const{clipboardData:b}=n;for(const K of b.items)for(const ot of t(this,gt))if(ot.isHandlingMimeForPasting(K.type)){ot.paste(K,this.currentLayer);return}let B=b.getData("application/pdfjs");if(!B)return;try{B=JSON.parse(B)}catch(K){(0,r.warn)(`paste: "${K.message}".`);return}if(!Array.isArray(B))return;this.unselectAll();const V=this.currentLayer;try{const K=[];for(const kt of B){const Rt=V.deserialize(kt);if(!Rt)return;K.push(Rt)}const ot=()=>{for(const kt of K)q(this,Pt,Ye).call(this,kt);q(this,At,Ke).call(this,K)},bt=()=>{for(const kt of K)kt.remove()};this.addCommands({cmd:ot,undo:bt,mustExec:!0})}catch(K){(0,r.warn)(`paste: "${K.message}".`)}}keydown(n){var b;(b=this.getActive())!=null&&b.shouldGetKeyboardEvents()||It._keyboardManager.exec(this,n)}onEditingAction(n){["undo","redo","delete","selectAll"].includes(n.name)&&this[n.name]()}setEditingState(n){n?(q(this,ft,Cn).call(this),q(this,Gt,Ve).call(this),q(this,jt,Xe).call(this),q(this,Y,re).call(this,{isEditing:t(this,c)!==r.AnnotationEditorType.NONE,isEmpty:q(this,Bt,be).call(this),hasSomethingToUndo:t(this,it).hasSomethingToUndo(),hasSomethingToRedo:t(this,it).hasSomethingToRedo(),hasSelectedEditor:!1})):(q(this,Ct,ze).call(this),q(this,Ht,we).call(this),q(this,ut,qe).call(this),q(this,Y,re).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(n){if(!t(this,gt)){st(this,gt,n);for(const b of t(this,gt))q(this,yt,me).call(this,b.defaultPropertiesToUpdate)}}getId(){return t(this,P).getId()}get currentLayer(){return t(this,G).get(t(this,rt))}getLayer(n){return t(this,G).get(n)}get currentPageIndex(){return t(this,rt)}addLayer(n){t(this,G).set(n.pageIndex,n),t(this,i)?n.enable():n.disable()}removeLayer(n){t(this,G).delete(n.pageIndex)}updateMode(n,b=null){if(t(this,c)!==n){if(st(this,c,n),n===r.AnnotationEditorType.NONE){this.setEditingState(!1),q(this,St,Pn).call(this);return}this.setEditingState(!0),q(this,Zt,Tn).call(this),this.unselectAll();for(const B of t(this,G).values())B.updateMode(n);if(b){for(const B of t(this,$).values())if(B.annotationElementId===b){this.setSelected(B),B.enterInEditMode();break}}}}updateToolbar(n){n!==t(this,c)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:n})}updateParams(n,b){if(t(this,gt)){if(n===r.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(n);return}for(const B of t(this,d))B.updateParams(n,b);for(const B of t(this,gt))B.updateDefaultParams(n,b)}}enableWaiting(n=!1){if(t(this,a)!==n){st(this,a,n);for(const b of t(this,G).values())n?b.disableClick():b.enableClick(),b.div.classList.toggle("waiting",n)}}getEditors(n){const b=[];for(const B of t(this,$).values())B.pageIndex===n&&b.push(B);return b}getEditor(n){return t(this,$).get(n)}addEditor(n){t(this,$).set(n.id,n)}removeEditor(n){var b;t(this,$).delete(n.id),this.unselect(n),(!n.annotationElementId||!t(this,H).has(n.annotationElementId))&&((b=t(this,X))==null||b.remove(n.id))}addDeletedAnnotationElement(n){t(this,H).add(n.annotationElementId),n.deleted=!0}isDeletedAnnotationElement(n){return t(this,H).has(n)}removeDeletedAnnotationElement(n){t(this,H).delete(n.annotationElementId),n.deleted=!1}setActiveEditor(n){t(this,p)!==n&&(st(this,p,n),n&&q(this,yt,me).call(this,n.propertiesToUpdate))}toggleSelected(n){if(t(this,d).has(n)){t(this,d).delete(n),n.unselect(),q(this,Y,re).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,d).add(n),n.select(),q(this,yt,me).call(this,n.propertiesToUpdate),q(this,Y,re).call(this,{hasSelectedEditor:!0})}setSelected(n){for(const b of t(this,d))b!==n&&b.unselect();t(this,d).clear(),t(this,d).add(n),n.select(),q(this,yt,me).call(this,n.propertiesToUpdate),q(this,Y,re).call(this,{hasSelectedEditor:!0})}isSelected(n){return t(this,d).has(n)}unselect(n){n.unselect(),t(this,d).delete(n),q(this,Y,re).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,d).size!==0}undo(){t(this,it).undo(),q(this,Y,re).call(this,{hasSomethingToUndo:t(this,it).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:q(this,Bt,be).call(this)})}redo(){t(this,it).redo(),q(this,Y,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,it).hasSomethingToRedo(),isEmpty:q(this,Bt,be).call(this)})}addCommands(n){t(this,it).add(n),q(this,Y,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:q(this,Bt,be).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const n=[...t(this,d)],b=()=>{for(const V of n)V.remove()},B=()=>{for(const V of n)q(this,Pt,Ye).call(this,V)};this.addCommands({cmd:b,undo:B,mustExec:!0})}commitOrRemove(){var n;(n=t(this,p))==null||n.commitOrRemove()}hasSomethingToControl(){return t(this,p)||this.hasSelection}selectAll(){for(const n of t(this,d))n.commit();q(this,At,Ke).call(this,t(this,$).values())}unselectAll(){if(t(this,p)){t(this,p).commitOrRemove();return}if(this.hasSelection){for(const n of t(this,d))n.unselect();t(this,d).clear(),q(this,Y,re).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(n,b,B=!1){if(B||this.commitOrRemove(),!this.hasSelection)return;t(this,Dt)[0]+=n,t(this,Dt)[1]+=b;const[V,K]=t(this,Dt),ot=[...t(this,d)],bt=1e3;t(this,mt)&&clearTimeout(t(this,mt)),st(this,mt,setTimeout(()=>{st(this,mt,null),t(this,Dt)[0]=t(this,Dt)[1]=0,this.addCommands({cmd:()=>{for(const kt of ot)t(this,$).has(kt.id)&&kt.translateInPage(V,K)},undo:()=>{for(const kt of ot)t(this,$).has(kt.id)&&kt.translateInPage(-V,-K)},mustExec:!1})},bt));for(const kt of ot)kt.translateInPage(n,b)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),st(this,lt,new Map);for(const n of t(this,d))t(this,lt).set(n,{savedX:n.x,savedY:n.y,savedPageIndex:n.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,lt))return!1;this.disableUserSelect(!1);const n=t(this,lt);st(this,lt,null);let b=!1;for(const[{x:V,y:K,pageIndex:ot},bt]of n)bt.newX=V,bt.newY=K,bt.newPageIndex=ot,b||(b=V!==bt.savedX||K!==bt.savedY||ot!==bt.savedPageIndex);if(!b)return!1;const B=(V,K,ot,bt)=>{if(t(this,$).has(V.id)){const kt=t(this,G).get(bt);kt?V._setParentAndPosition(kt,K,ot):(V.pageIndex=bt,V.x=K,V.y=ot)}};return this.addCommands({cmd:()=>{for(const[V,{newX:K,newY:ot,newPageIndex:bt}]of n)B(V,K,ot,bt)},undo:()=>{for(const[V,{savedX:K,savedY:ot,savedPageIndex:bt}]of n)B(V,K,ot,bt)},mustExec:!0}),!0}dragSelectedEditors(n,b){if(t(this,lt))for(const B of t(this,lt).keys())B.drag(n,b)}rebuild(n){if(n.parent===null){const b=this.getLayer(n.pageIndex);b?(b.changeParent(n),b.addOrRebuild(n)):(this.addEditor(n),this.addToAnnotationStorage(n),n.rebuild())}else n.parent.addOrRebuild(n)}isActive(n){return t(this,p)===n}getActive(){return t(this,p)}getMode(){return t(this,c)}get imageManager(){return(0,r.shadow)(this,"imageManager",new D)}};p=new WeakMap,$=new WeakMap,G=new WeakMap,S=new WeakMap,X=new WeakMap,it=new WeakMap,rt=new WeakMap,H=new WeakMap,lt=new WeakMap,gt=new WeakMap,Et=new WeakMap,xt=new WeakMap,P=new WeakMap,i=new WeakMap,a=new WeakMap,s=new WeakMap,c=new WeakMap,d=new WeakMap,E=new WeakMap,M=new WeakMap,W=new WeakMap,nt=new WeakMap,J=new WeakMap,at=new WeakMap,ht=new WeakMap,pt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,vt=new WeakMap,Dt=new WeakMap,mt=new WeakMap,et=new WeakMap,Z=new WeakMap,ft=new WeakSet,Cn=function(){window.addEventListener("focus",t(this,W)),window.addEventListener("blur",t(this,M))},Ct=new WeakSet,ze=function(){window.removeEventListener("focus",t(this,W)),window.removeEventListener("blur",t(this,M))},Gt=new WeakSet,Ve=function(){window.addEventListener("keydown",t(this,ht),{capture:!0})},Ht=new WeakSet,we=function(){window.removeEventListener("keydown",t(this,ht),{capture:!0})},jt=new WeakSet,Xe=function(){document.addEventListener("copy",t(this,nt)),document.addEventListener("cut",t(this,J)),document.addEventListener("paste",t(this,at))},ut=new WeakSet,qe=function(){document.removeEventListener("copy",t(this,nt)),document.removeEventListener("cut",t(this,J)),document.removeEventListener("paste",t(this,at))},Y=new WeakSet,re=function(n){Object.entries(n).some(([B,V])=>t(this,vt)[B]!==V)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,vt),n)})},yt=new WeakSet,me=function(n){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:n})},Zt=new WeakSet,Tn=function(){if(!t(this,i)){st(this,i,!0);for(const n of t(this,G).values())n.enable()}},St=new WeakSet,Pn=function(){if(this.unselectAll(),t(this,i)){st(this,i,!1);for(const n of t(this,G).values())n.disable()}},Pt=new WeakSet,Ye=function(n){const b=t(this,G).get(n.pageIndex);b?b.addOrRebuild(n):this.addEditor(n)},Bt=new WeakSet,be=function(){if(t(this,$).size===0)return!0;if(t(this,$).size===1)for(const n of t(this,$).values())return n.isEmpty();return!1},At=new WeakSet,Ke=function(n){t(this,d).clear();for(const b of n)b.isEmpty()||(t(this,d).add(b),b.select());q(this,Y,re).call(this,{hasSelectedEditor:!0})},ee(It,"TRANSLATE_SMALL",1),ee(It,"TRANSLATE_BIG",10);let O=It;e.AnnotationEditorUIManager=O},(k,e,I)=>{var rt,H,lt,gt,Et,xt,P,i,a,s,c,d,de,M,ue,nt,Je,at,Ce,pt,Te,Tt,_e,vt,Ae;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=F,e.getColorValues=$,e.getCurrentTransform=G,e.getCurrentTransformInverse=S,e.getFilenameFromUrl=_,e.getPdfFilenameFromUrl=x,e.getRGB=p,e.getXfaPageViewport=R,e.isDataScheme=A,e.isPdfFile=u,e.isValidFetchUrl=y,e.loadScript=h,e.noContextMenu=o,e.setLayerDimensions=X;var r=I(7),f=I(1);const z="http://www.w3.org/2000/svg",it=class it{};ee(it,"CSS",96),ee(it,"PDF",72),ee(it,"PDF_TO_CSS_UNITS",it.CSS/it.PDF);let U=it;e.PixelsPerInch=U;class ct extends r.BaseFilterFactory{constructor({docId:Z,ownerDocument:ft=globalThis.document}={}){super();j(this,d);j(this,M);j(this,nt);j(this,at);j(this,pt);j(this,Tt);j(this,vt);j(this,rt,void 0);j(this,H,void 0);j(this,lt,void 0);j(this,gt,void 0);j(this,Et,void 0);j(this,xt,void 0);j(this,P,void 0);j(this,i,void 0);j(this,a,void 0);j(this,s,void 0);j(this,c,0);st(this,lt,Z),st(this,gt,ft)}addFilter(Z){if(!Z)return"none";let ft=t(this,d,de).get(Z);if(ft)return ft;let wt,Ct,Ut,Gt;if(Z.length===1){const jt=Z[0],qt=new Array(256);for(let ut=0;ut<256;ut++)qt[ut]=jt[ut]/255;Gt=wt=Ct=Ut=qt.join(",")}else{const[jt,qt,ut]=Z,tt=new Array(256),Y=new Array(256),_t=new Array(256);for(let yt=0;yt<256;yt++)tt[yt]=jt[yt]/255,Y[yt]=qt[yt]/255,_t[yt]=ut[yt]/255;wt=tt.join(","),Ct=Y.join(","),Ut=_t.join(","),Gt=`${wt}${Ct}${Ut}`}if(ft=t(this,d,de).get(Gt),ft)return t(this,d,de).set(Z,ft),ft;const Wt=`g_${t(this,lt)}_transfer_map_${ge(this,c)._++}`,Ht=`url(#${Wt})`;t(this,d,de).set(Z,Ht),t(this,d,de).set(Gt,Ht);const zt=q(this,at,Ce).call(this,Wt);return q(this,Tt,_e).call(this,wt,Ct,Ut,zt),Ht}addHCMFilter(Z,ft){var qt;const wt=`${Z}-${ft}`;if(t(this,xt)===wt)return t(this,P);if(st(this,xt,wt),st(this,P,"none"),(qt=t(this,Et))==null||qt.remove(),!Z||!ft)return t(this,P);const Ct=q(this,vt,Ae).call(this,Z);Z=f.Util.makeHexColor(...Ct);const Ut=q(this,vt,Ae).call(this,ft);if(ft=f.Util.makeHexColor(...Ut),t(this,M,ue).style.color="",Z==="#000000"&&ft==="#ffffff"||Z===ft)return t(this,P);const Gt=new Array(256);for(let ut=0;ut<=255;ut++){const tt=ut/255;Gt[ut]=tt<=.03928?tt/12.92:((tt+.055)/1.055)**2.4}const Wt=Gt.join(","),Ht=`g_${t(this,lt)}_hcm_filter`,zt=st(this,i,q(this,at,Ce).call(this,Ht));q(this,Tt,_e).call(this,Wt,Wt,Wt,zt),q(this,nt,Je).call(this,zt);const jt=(ut,tt)=>{const Y=Ct[ut]/255,_t=Ut[ut]/255,yt=new Array(tt+1);for(let te=0;te<=tt;te++)yt[te]=Y+te/tt*(_t-Y);return yt.join(",")};return q(this,Tt,_e).call(this,jt(0,5),jt(1,5),jt(2,5),zt),st(this,P,`url(#${Ht})`),t(this,P)}addHighlightHCMFilter(Z,ft,wt,Ct){var _t;const Ut=`${Z}-${ft}-${wt}-${Ct}`;if(t(this,a)===Ut)return t(this,s);if(st(this,a,Ut),st(this,s,"none"),(_t=t(this,i))==null||_t.remove(),!Z||!ft)return t(this,s);const[Gt,Wt]=[Z,ft].map(q(this,vt,Ae).bind(this));let Ht=Math.round(.2126*Gt[0]+.7152*Gt[1]+.0722*Gt[2]),zt=Math.round(.2126*Wt[0]+.7152*Wt[1]+.0722*Wt[2]),[jt,qt]=[wt,Ct].map(q(this,vt,Ae).bind(this));zt<Ht&&([Ht,zt,jt,qt]=[zt,Ht,qt,jt]),t(this,M,ue).style.color="";const ut=(yt,te,Zt)=>{const Q=new Array(256),St=(zt-Ht)/Zt,Ot=yt/255,Pt=(te-yt)/(255*Zt);let Nt=0;for(let Bt=0;Bt<=Zt;Bt++){const Jt=Math.round(Ht+Bt*St),At=Ot+Bt*Pt;for(let Yt=Nt;Yt<=Jt;Yt++)Q[Yt]=At;Nt=Jt+1}for(let Bt=Nt;Bt<256;Bt++)Q[Bt]=Q[Nt-1];return Q.join(",")},tt=`g_${t(this,lt)}_hcm_highlight_filter`,Y=st(this,i,q(this,at,Ce).call(this,tt));return q(this,nt,Je).call(this,Y),q(this,Tt,_e).call(this,ut(jt[0],qt[0],5),ut(jt[1],qt[1],5),ut(jt[2],qt[2],5),Y),st(this,s,`url(#${tt})`),t(this,s)}destroy(Z=!1){Z&&(t(this,P)||t(this,s))||(t(this,H)&&(t(this,H).parentNode.parentNode.remove(),st(this,H,null)),t(this,rt)&&(t(this,rt).clear(),st(this,rt,null)),st(this,c,0))}}rt=new WeakMap,H=new WeakMap,lt=new WeakMap,gt=new WeakMap,Et=new WeakMap,xt=new WeakMap,P=new WeakMap,i=new WeakMap,a=new WeakMap,s=new WeakMap,c=new WeakMap,d=new WeakSet,de=function(){return t(this,rt)||st(this,rt,new Map)},M=new WeakSet,ue=function(){if(!t(this,H)){const Z=t(this,gt).createElement("div"),{style:ft}=Z;ft.visibility="hidden",ft.contain="strict",ft.width=ft.height=0,ft.position="absolute",ft.top=ft.left=0,ft.zIndex=-1;const wt=t(this,gt).createElementNS(z,"svg");wt.setAttribute("width",0),wt.setAttribute("height",0),st(this,H,t(this,gt).createElementNS(z,"defs")),Z.append(wt),wt.append(t(this,H)),t(this,gt).body.append(Z)}return t(this,H)},nt=new WeakSet,Je=function(Z){const ft=t(this,gt).createElementNS(z,"feColorMatrix");ft.setAttribute("type","matrix"),ft.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Z.append(ft)},at=new WeakSet,Ce=function(Z){const ft=t(this,gt).createElementNS(z,"filter");return ft.setAttribute("color-interpolation-filters","sRGB"),ft.setAttribute("id",Z),t(this,M,ue).append(ft),ft},pt=new WeakSet,Te=function(Z,ft,wt){const Ct=t(this,gt).createElementNS(z,ft);Ct.setAttribute("type","discrete"),Ct.setAttribute("tableValues",wt),Z.append(Ct)},Tt=new WeakSet,_e=function(Z,ft,wt,Ct){const Ut=t(this,gt).createElementNS(z,"feComponentTransfer");Ct.append(Ut),q(this,pt,Te).call(this,Ut,"feFuncR",Z),q(this,pt,Te).call(this,Ut,"feFuncG",ft),q(this,pt,Te).call(this,Ut,"feFuncB",wt)},vt=new WeakSet,Ae=function(Z){return t(this,M,ue).style.color=Z,p(getComputedStyle(t(this,M,ue)).getPropertyValue("color"))},e.DOMFilterFactory=ct;class D extends r.BaseCanvasFactory{constructor({ownerDocument:et=globalThis.document}={}){super(),this._document=et}_createCanvas(et,Z){const ft=this._document.createElement("canvas");return ft.width=et,ft.height=Z,ft}}e.DOMCanvasFactory=D;async function C(mt,et=!1){if(y(mt,document.baseURI)){const Z=await fetch(mt);if(!Z.ok)throw new Error(Z.statusText);return et?new Uint8Array(await Z.arrayBuffer()):(0,f.stringToBytes)(await Z.text())}return new Promise((Z,ft)=>{const wt=new XMLHttpRequest;wt.open("GET",mt,!0),et&&(wt.responseType="arraybuffer"),wt.onreadystatechange=()=>{if(wt.readyState===XMLHttpRequest.DONE){if(wt.status===200||wt.status===0){let Ct;if(et&&wt.response?Ct=new Uint8Array(wt.response):!et&&wt.responseText&&(Ct=(0,f.stringToBytes)(wt.responseText)),Ct){Z(Ct);return}}ft(new Error(wt.statusText))}},wt.send(null)})}class g extends r.BaseCMapReaderFactory{_fetchData(et,Z){return C(et,this.isCompressed).then(ft=>({cMapData:ft,compressionType:Z}))}}e.DOMCMapReaderFactory=g;class L extends r.BaseStandardFontDataFactory{_fetchData(et){return C(et,!0)}}e.DOMStandardFontDataFactory=L;class O extends r.BaseSVGFactory{_createSVG(et){return document.createElementNS(z,et)}}e.DOMSVGFactory=O;class T{constructor({viewBox:et,scale:Z,rotation:ft,offsetX:wt=0,offsetY:Ct=0,dontFlip:Ut=!1}){this.viewBox=et,this.scale=Z,this.rotation=ft,this.offsetX=wt,this.offsetY=Ct;const Gt=(et[2]+et[0])/2,Wt=(et[3]+et[1])/2;let Ht,zt,jt,qt;switch(ft%=360,ft<0&&(ft+=360),ft){case 180:Ht=-1,zt=0,jt=0,qt=1;break;case 90:Ht=0,zt=1,jt=1,qt=0;break;case 270:Ht=0,zt=-1,jt=-1,qt=0;break;case 0:Ht=1,zt=0,jt=0,qt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ut&&(jt=-jt,qt=-qt);let ut,tt,Y,_t;Ht===0?(ut=Math.abs(Wt-et[1])*Z+wt,tt=Math.abs(Gt-et[0])*Z+Ct,Y=(et[3]-et[1])*Z,_t=(et[2]-et[0])*Z):(ut=Math.abs(Gt-et[0])*Z+wt,tt=Math.abs(Wt-et[1])*Z+Ct,Y=(et[2]-et[0])*Z,_t=(et[3]-et[1])*Z),this.transform=[Ht*Z,zt*Z,jt*Z,qt*Z,ut-Ht*Z*Gt-jt*Z*Wt,tt-zt*Z*Gt-qt*Z*Wt],this.width=Y,this.height=_t}get rawDims(){const{viewBox:et}=this;return(0,f.shadow)(this,"rawDims",{pageWidth:et[2]-et[0],pageHeight:et[3]-et[1],pageX:et[0],pageY:et[1]})}clone({scale:et=this.scale,rotation:Z=this.rotation,offsetX:ft=this.offsetX,offsetY:wt=this.offsetY,dontFlip:Ct=!1}={}){return new T({viewBox:this.viewBox.slice(),scale:et,rotation:Z,offsetX:ft,offsetY:wt,dontFlip:Ct})}convertToViewportPoint(et,Z){return f.Util.applyTransform([et,Z],this.transform)}convertToViewportRectangle(et){const Z=f.Util.applyTransform([et[0],et[1]],this.transform),ft=f.Util.applyTransform([et[2],et[3]],this.transform);return[Z[0],Z[1],ft[0],ft[1]]}convertToPdfPoint(et,Z){return f.Util.applyInverseTransform([et,Z],this.transform)}}e.PageViewport=T;class v extends f.BaseException{constructor(et,Z=0){super(et,"RenderingCancelledException"),this.extraDelay=Z}}e.RenderingCancelledException=v;function A(mt){const et=mt.length;let Z=0;for(;Z<et&&mt[Z].trim()==="";)Z++;return mt.substring(Z,Z+5).toLowerCase()==="data:"}function u(mt){return typeof mt=="string"&&/\.pdf$/i.test(mt)}function _(mt,et=!1){return et||([mt]=mt.split(/[#?]/,1)),mt.substring(mt.lastIndexOf("/")+1)}function x(mt,et="document.pdf"){if(typeof mt!="string")return et;if(A(mt))return(0,f.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),et;const Z=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ft=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,wt=Z.exec(mt);let Ct=ft.exec(wt[1])||ft.exec(wt[2])||ft.exec(wt[3]);if(Ct&&(Ct=Ct[0],Ct.includes("%")))try{Ct=ft.exec(decodeURIComponent(Ct))[0]}catch{}return Ct||et}class w{constructor(){ee(this,"started",Object.create(null));ee(this,"times",[])}time(et){et in this.started&&(0,f.warn)(`Timer is already running for ${et}`),this.started[et]=Date.now()}timeEnd(et){et in this.started||(0,f.warn)(`Timer has not been started for ${et}`),this.times.push({name:et,start:this.started[et],end:Date.now()}),delete this.started[et]}toString(){const et=[];let Z=0;for(const{name:ft}of this.times)Z=Math.max(ft.length,Z);for(const{name:ft,start:wt,end:Ct}of this.times)et.push(`${ft.padEnd(Z)} ${Ct-wt}ms
`);return et.join("")}}e.StatTimer=w;function y(mt,et){try{const{protocol:Z}=et?new URL(mt,et):new URL(mt);return Z==="http:"||Z==="https:"}catch{return!1}}function o(mt){mt.preventDefault()}function h(mt,et=!1){return new Promise((Z,ft)=>{const wt=document.createElement("script");wt.src=mt,wt.onload=function(Ct){et&&wt.remove(),Z(Ct)},wt.onerror=function(){ft(new Error(`Cannot load script at: ${wt.src}`))},(document.head||document.documentElement).append(wt)})}function F(mt){console.log("Deprecated API usage: "+mt)}let m;class l{static toDateObject(et){if(!et||typeof et!="string")return null;m||(m=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Z=m.exec(et);if(!Z)return null;const ft=parseInt(Z[1],10);let wt=parseInt(Z[2],10);wt=wt>=1&&wt<=12?wt-1:0;let Ct=parseInt(Z[3],10);Ct=Ct>=1&&Ct<=31?Ct:1;let Ut=parseInt(Z[4],10);Ut=Ut>=0&&Ut<=23?Ut:0;let Gt=parseInt(Z[5],10);Gt=Gt>=0&&Gt<=59?Gt:0;let Wt=parseInt(Z[6],10);Wt=Wt>=0&&Wt<=59?Wt:0;const Ht=Z[7]||"Z";let zt=parseInt(Z[8],10);zt=zt>=0&&zt<=23?zt:0;let jt=parseInt(Z[9],10)||0;return jt=jt>=0&&jt<=59?jt:0,Ht==="-"?(Ut+=zt,Gt+=jt):Ht==="+"&&(Ut-=zt,Gt-=jt),new Date(Date.UTC(ft,wt,Ct,Ut,Gt,Wt))}}e.PDFDateString=l;function R(mt,{scale:et=1,rotation:Z=0}){const{width:ft,height:wt}=mt.attributes.style,Ct=[0,0,parseInt(ft),parseInt(wt)];return new T({viewBox:Ct,scale:et,rotation:Z})}function p(mt){if(mt.startsWith("#")){const et=parseInt(mt.slice(1),16);return[(et&16711680)>>16,(et&65280)>>8,et&255]}return mt.startsWith("rgb(")?mt.slice(4,-1).split(",").map(et=>parseInt(et)):mt.startsWith("rgba(")?mt.slice(5,-1).split(",").map(et=>parseInt(et)).slice(0,3):((0,f.warn)(`Not a valid color format: "${mt}"`),[0,0,0])}function $(mt){const et=document.createElement("span");et.style.visibility="hidden",document.body.append(et);for(const Z of mt.keys()){et.style.color=Z;const ft=window.getComputedStyle(et).color;mt.set(Z,p(ft))}et.remove()}function G(mt){const{a:et,b:Z,c:ft,d:wt,e:Ct,f:Ut}=mt.getTransform();return[et,Z,ft,wt,Ct,Ut]}function S(mt){const{a:et,b:Z,c:ft,d:wt,e:Ct,f:Ut}=mt.getTransform().invertSelf();return[et,Z,ft,wt,Ct,Ut]}function X(mt,et,Z=!1,ft=!0){if(et instanceof T){const{pageWidth:wt,pageHeight:Ct}=et.rawDims,{style:Ut}=mt,Gt=f.FeatureTest.isCSSRoundSupported,Wt=`var(--scale-factor) * ${wt}px`,Ht=`var(--scale-factor) * ${Ct}px`,zt=Gt?`round(${Wt}, 1px)`:`calc(${Wt})`,jt=Gt?`round(${Ht}, 1px)`:`calc(${Ht})`;!Z||et.rotation%180===0?(Ut.width=zt,Ut.height=jt):(Ut.width=jt,Ut.height=zt)}ft&&mt.setAttribute("data-main-rotation",et.rotation)}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var r=I(1);class f{constructor(){this.constructor===f&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(g){return"none"}addHCMFilter(g,L){return"none"}addHighlightHCMFilter(g,L,O,T){return"none"}destroy(g=!1){}}e.BaseFilterFactory=f;class z{constructor(){this.constructor===z&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(g,L){if(g<=0||L<=0)throw new Error("Invalid canvas size");const O=this._createCanvas(g,L);return{canvas:O,context:O.getContext("2d")}}reset(g,L,O){if(!g.canvas)throw new Error("Canvas is not specified");if(L<=0||O<=0)throw new Error("Invalid canvas size");g.canvas.width=L,g.canvas.height=O}destroy(g){if(!g.canvas)throw new Error("Canvas is not specified");g.canvas.width=0,g.canvas.height=0,g.canvas=null,g.context=null}_createCanvas(g,L){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=z;class U{constructor({baseUrl:g=null,isCompressed:L=!0}){this.constructor===U&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=g,this.isCompressed=L}async fetch({name:g}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!g)throw new Error("CMap name must be specified.");const L=this.baseUrl+g+(this.isCompressed?".bcmap":""),O=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(L,O).catch(T=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${L}`)})}_fetchData(g,L){(0,r.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=U;class ct{constructor({baseUrl:g=null}){this.constructor===ct&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=g}async fetch({filename:g}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!g)throw new Error("Font filename must be specified.");const L=`${this.baseUrl}${g}`;return this._fetchData(L).catch(O=>{throw new Error(`Unable to load font data at: ${L}`)})}_fetchData(g){(0,r.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=ct;class D{constructor(){this.constructor===D&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(g,L,O=!1){if(g<=0||L<=0)throw new Error("Invalid SVG dimensions");const T=this._createSVG("svg:svg");return T.setAttribute("version","1.1"),O||(T.setAttribute("width",`${g}px`),T.setAttribute("height",`${L}px`)),T.setAttribute("preserveAspectRatio","none"),T.setAttribute("viewBox",`0 0 ${g} ${L}`),T}createElement(g){if(typeof g!="string")throw new Error("Invalid SVG element type");return this._createSVG(g)}_createSVG(g){(0,r.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=D},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var r=I(1);const f=3285377520,z=4294901760,U=65535;class ct{constructor(C){this.h1=C?C&4294967295:f,this.h2=C?C&4294967295:f}update(C){let g,L;if(typeof C=="string"){g=new Uint8Array(C.length*2),L=0;for(let F=0,m=C.length;F<m;F++){const l=C.charCodeAt(F);l<=255?g[L++]=l:(g[L++]=l>>>8,g[L++]=l&255)}}else if((0,r.isArrayBuffer)(C))g=C.slice(),L=g.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const O=L>>2,T=L-O*4,v=new Uint32Array(g.buffer,0,O);let A=0,u=0,_=this.h1,x=this.h2;const w=3432918353,y=461845907,o=w&U,h=y&U;for(let F=0;F<O;F++)F&1?(A=v[F],A=A*w&z|A*o&U,A=A<<15|A>>>17,A=A*y&z|A*h&U,_^=A,_=_<<13|_>>>19,_=_*5+3864292196):(u=v[F],u=u*w&z|u*o&U,u=u<<15|u>>>17,u=u*y&z|u*h&U,x^=u,x=x<<13|x>>>19,x=x*5+3864292196);switch(A=0,T){case 3:A^=g[O*4+2]<<16;case 2:A^=g[O*4+1]<<8;case 1:A^=g[O*4],A=A*w&z|A*o&U,A=A<<15|A>>>17,A=A*y&z|A*h&U,O&1?_^=A:x^=A}this.h1=_,this.h2=x}hexdigest(){let C=this.h1,g=this.h2;return C^=g>>>1,C=C*3981806797&z|C*36045&U,g=g*4283543511&z|((g<<16|C>>>16)*2950163797&z)>>>16,C^=g>>>1,C=C*444984403&z|C*60499&U,g=g*3301882366&z|((g<<16|C>>>16)*3120437893&z)>>>16,C^=g>>>1,(C>>>0).toString(16).padStart(8,"0")+(g>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=ct},(k,e,I)=>{var U;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var r=I(1);class f{constructor({ownerDocument:D=globalThis.document,styleElement:C=null}){j(this,U,new Set);this._document=D,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(D){this.nativeFontFaces.add(D),this._document.fonts.add(D)}removeNativeFontFace(D){this.nativeFontFaces.delete(D),this._document.fonts.delete(D)}insertRule(D){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const C=this.styleElement.sheet;C.insertRule(D,C.cssRules.length)}clear(){for(const D of this.nativeFontFaces)this._document.fonts.delete(D);this.nativeFontFaces.clear(),t(this,U).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(D){if(!(!D||t(this,U).has(D.loadedName))){if((0,r.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:C,src:g,style:L}=D,O=new FontFace(C,g,L);this.addNativeFontFace(O);try{await O.load(),t(this,U).add(C)}catch{(0,r.warn)(`Cannot load system font: ${D.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(O)}return}(0,r.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(D){if(D.attached||D.missingFile&&!D.systemFontInfo)return;if(D.attached=!0,D.systemFontInfo){await this.loadSystemFont(D.systemFontInfo);return}if(this.isFontLoadingAPISupported){const g=D.createNativeFontFace();if(g){this.addNativeFontFace(g);try{await g.loaded}catch(L){throw(0,r.warn)(`Failed to load font '${g.family}': '${L}'.`),D.disableFontFace=!0,L}}return}const C=D.createFontFaceRule();if(C){if(this.insertRule(C),this.isSyncFontLoadingSupported)return;await new Promise(g=>{const L=this._queueLoadingCallback(g);this._prepareFontLoadEvent(D,L)})}}get isFontLoadingAPISupported(){var C;const D=!!((C=this._document)!=null&&C.fonts);return(0,r.shadow)(this,"isFontLoadingAPISupported",D)}get isSyncFontLoadingSupported(){let D=!1;return(r.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(D=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",D)}_queueLoadingCallback(D){function C(){for((0,r.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;g.length>0&&g[0].done;){const O=g.shift();setTimeout(O.callback,0)}}const{loadingRequests:g}=this,L={done:!1,complete:C,callback:D};return g.push(L),L}get _loadTestFont(){const D=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",D)}_prepareFontLoadEvent(D,C){function g(p,$){return p.charCodeAt($)<<24|p.charCodeAt($+1)<<16|p.charCodeAt($+2)<<8|p.charCodeAt($+3)&255}function L(p,$,G,S){const X=p.substring(0,$),it=p.substring($+G);return X+S+it}let O,T;const v=this._document.createElement("canvas");v.width=1,v.height=1;const A=v.getContext("2d");let u=0;function _(p,$){if(++u>30){(0,r.warn)("Load test font never loaded."),$();return}if(A.font="30px "+p,A.fillText(".",0,20),A.getImageData(0,0,1,1).data[3]>0){$();return}setTimeout(_.bind(null,p,$))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=L(w,976,x.length,x);const o=16,h=1482184792;let F=g(w,o);for(O=0,T=x.length-3;O<T;O+=4)F=F-h+g(x,O)|0;O<x.length&&(F=F-h+g(x+"XXX",O)|0),w=L(w,o,4,(0,r.string32)(F));const m=`url(data:font/opentype;base64,${btoa(w)});`,l=`@font-face {font-family:"${x}";src:${m}}`;this.insertRule(l);const R=this._document.createElement("div");R.style.visibility="hidden",R.style.width=R.style.height="10px",R.style.position="absolute",R.style.top=R.style.left="0px";for(const p of[D.loadedName,x]){const $=this._document.createElement("span");$.textContent="Hi",$.style.fontFamily=p,R.append($)}this._document.body.append(R),_(x,()=>{R.remove(),C.complete()})}}U=new WeakMap,e.FontLoader=f;class z{constructor(D,{isEvalSupported:C=!0,disableFontFace:g=!1,ignoreErrors:L=!1,inspectFont:O=null}){this.compiledGlyphs=Object.create(null);for(const T in D)this[T]=D[T];this.isEvalSupported=C!==!1,this.disableFontFace=g===!0,this.ignoreErrors=L===!0,this._inspectFont=O}createNativeFontFace(){var C;if(!this.data||this.disableFontFace)return null;let D;if(!this.cssFontInfo)D=new FontFace(this.loadedName,this.data,{});else{const g={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(g.style=`oblique ${this.cssFontInfo.italicAngle}deg`),D=new FontFace(this.cssFontInfo.fontFamily,this.data,g)}return(C=this._inspectFont)==null||C.call(this,this),D}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const D=(0,r.bytesToString)(this.data),C=`url(data:${this.mimetype};base64,${btoa(D)});`;let g;if(!this.cssFontInfo)g=`@font-face {font-family:"${this.loadedName}";src:${C}}`;else{let O=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(O+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),g=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${O}src:${C}}`}return(L=this._inspectFont)==null||L.call(this,this,C),g}getPathGenerator(D,C){if(this.compiledGlyphs[C]!==void 0)return this.compiledGlyphs[C];let g;try{g=D.get(this.loadedName+"_path_"+C)}catch(L){if(!this.ignoreErrors)throw L;return(0,r.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[C]=function(O,T){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){const L=[];for(const O of g){const T=O.args!==void 0?O.args.join(","):"";L.push("c.",O.cmd,"(",T,`);
`)}return this.compiledGlyphs[C]=new Function("c","size",L.join(""))}return this.compiledGlyphs[C]=function(L,O){for(const T of g)T.cmd==="scale"&&(T.args=[O,-O]),L[T.cmd].apply(L,T.args)}}}e.FontFaceObject=z},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var r=I(7);I(1);const f=function(C){return new Promise((g,L)=>{require$$5.readFile(C,(T,v)=>{if(T||!v){L(new Error(T));return}g(new Uint8Array(v))})})};class z extends r.BaseFilterFactory{}e.NodeFilterFactory=z;class U extends r.BaseCanvasFactory{_createCanvas(g,L){return require$$5.createCanvas(g,L)}}e.NodeCanvasFactory=U;class ct extends r.BaseCMapReaderFactory{_fetchData(g,L){return f(g).then(O=>({cMapData:O,compressionType:L}))}}e.NodeCMapReaderFactory=ct;class D extends r.BaseStandardFontDataFactory{_fetchData(g){return f(g)}}e.NodeStandardFontDataFactory=D},(k,e,I)=>{var H,Qe,gt,Ze;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var r=I(1),f=I(6),z=I(12),U=I(13);const ct=16,D=100,C=4096,g=15,L=10,O=1e3,T=16;function v(P,i){if(P._removeMirroring)throw new Error("Context is already forwarding operations.");P.__originalSave=P.save,P.__originalRestore=P.restore,P.__originalRotate=P.rotate,P.__originalScale=P.scale,P.__originalTranslate=P.translate,P.__originalTransform=P.transform,P.__originalSetTransform=P.setTransform,P.__originalResetTransform=P.resetTransform,P.__originalClip=P.clip,P.__originalMoveTo=P.moveTo,P.__originalLineTo=P.lineTo,P.__originalBezierCurveTo=P.bezierCurveTo,P.__originalRect=P.rect,P.__originalClosePath=P.closePath,P.__originalBeginPath=P.beginPath,P._removeMirroring=()=>{P.save=P.__originalSave,P.restore=P.__originalRestore,P.rotate=P.__originalRotate,P.scale=P.__originalScale,P.translate=P.__originalTranslate,P.transform=P.__originalTransform,P.setTransform=P.__originalSetTransform,P.resetTransform=P.__originalResetTransform,P.clip=P.__originalClip,P.moveTo=P.__originalMoveTo,P.lineTo=P.__originalLineTo,P.bezierCurveTo=P.__originalBezierCurveTo,P.rect=P.__originalRect,P.closePath=P.__originalClosePath,P.beginPath=P.__originalBeginPath,delete P._removeMirroring},P.save=function(){i.save(),this.__originalSave()},P.restore=function(){i.restore(),this.__originalRestore()},P.translate=function(s,c){i.translate(s,c),this.__originalTranslate(s,c)},P.scale=function(s,c){i.scale(s,c),this.__originalScale(s,c)},P.transform=function(s,c,d,E,M,W){i.transform(s,c,d,E,M,W),this.__originalTransform(s,c,d,E,M,W)},P.setTransform=function(s,c,d,E,M,W){i.setTransform(s,c,d,E,M,W),this.__originalSetTransform(s,c,d,E,M,W)},P.resetTransform=function(){i.resetTransform(),this.__originalResetTransform()},P.rotate=function(s){i.rotate(s),this.__originalRotate(s)},P.clip=function(s){i.clip(s),this.__originalClip(s)},P.moveTo=function(a,s){i.moveTo(a,s),this.__originalMoveTo(a,s)},P.lineTo=function(a,s){i.lineTo(a,s),this.__originalLineTo(a,s)},P.bezierCurveTo=function(a,s,c,d,E,M){i.bezierCurveTo(a,s,c,d,E,M),this.__originalBezierCurveTo(a,s,c,d,E,M)},P.rect=function(a,s,c,d){i.rect(a,s,c,d),this.__originalRect(a,s,c,d)},P.closePath=function(){i.closePath(),this.__originalClosePath()},P.beginPath=function(){i.beginPath(),this.__originalBeginPath()}}class A{constructor(i){this.canvasFactory=i,this.cache=Object.create(null)}getCanvas(i,a,s){let c;return this.cache[i]!==void 0?(c=this.cache[i],this.canvasFactory.reset(c,a,s)):(c=this.canvasFactory.create(a,s),this.cache[i]=c),c}delete(i){delete this.cache[i]}clear(){for(const i in this.cache){const a=this.cache[i];this.canvasFactory.destroy(a),delete this.cache[i]}}}function u(P,i,a,s,c,d,E,M,W,nt){const[J,at,ht,pt,dt,Tt]=(0,f.getCurrentTransform)(P);if(at===0&&ht===0){const Dt=E*J+dt,mt=Math.round(Dt),et=M*pt+Tt,Z=Math.round(et),ft=(E+W)*J+dt,wt=Math.abs(Math.round(ft)-mt)||1,Ct=(M+nt)*pt+Tt,Ut=Math.abs(Math.round(Ct)-Z)||1;return P.setTransform(Math.sign(J),0,0,Math.sign(pt),mt,Z),P.drawImage(i,a,s,c,d,0,0,wt,Ut),P.setTransform(J,at,ht,pt,dt,Tt),[wt,Ut]}if(J===0&&pt===0){const Dt=M*ht+dt,mt=Math.round(Dt),et=E*at+Tt,Z=Math.round(et),ft=(M+nt)*ht+dt,wt=Math.abs(Math.round(ft)-mt)||1,Ct=(E+W)*at+Tt,Ut=Math.abs(Math.round(Ct)-Z)||1;return P.setTransform(0,Math.sign(at),Math.sign(ht),0,mt,Z),P.drawImage(i,a,s,c,d,0,0,Ut,wt),P.setTransform(J,at,ht,pt,dt,Tt),[Ut,wt]}P.drawImage(i,a,s,c,d,E,M,W,nt);const Lt=Math.hypot(J,at),vt=Math.hypot(ht,pt);return[Lt*W,vt*nt]}function _(P){const{width:i,height:a}=P;if(i>O||a>O)return null;const s=1e3,c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),d=i+1;let E=new Uint8Array(d*(a+1)),M,W,nt;const J=i+7&-8;let at=new Uint8Array(J*a),ht=0;for(const vt of P.data){let Dt=128;for(;Dt>0;)at[ht++]=vt&Dt?0:255,Dt>>=1}let pt=0;for(ht=0,at[ht]!==0&&(E[0]=1,++pt),W=1;W<i;W++)at[ht]!==at[ht+1]&&(E[W]=at[ht]?2:1,++pt),ht++;for(at[ht]!==0&&(E[W]=2,++pt),M=1;M<a;M++){ht=M*J,nt=M*d,at[ht-J]!==at[ht]&&(E[nt]=at[ht]?1:8,++pt);let vt=(at[ht]?4:0)+(at[ht-J]?8:0);for(W=1;W<i;W++)vt=(vt>>2)+(at[ht+1]?4:0)+(at[ht-J+1]?8:0),c[vt]&&(E[nt+W]=c[vt],++pt),ht++;if(at[ht-J]!==at[ht]&&(E[nt+W]=at[ht]?2:4,++pt),pt>s)return null}for(ht=J*(a-1),nt=M*d,at[ht]!==0&&(E[nt]=8,++pt),W=1;W<i;W++)at[ht]!==at[ht+1]&&(E[nt+W]=at[ht]?4:8,++pt),ht++;if(at[ht]!==0&&(E[nt+W]=4,++pt),pt>s)return null;const dt=new Int32Array([0,d,-1,0,-d,0,0,0,1]),Tt=new Path2D;for(M=0;pt&&M<=a;M++){let vt=M*d;const Dt=vt+i;for(;vt<Dt&&!E[vt];)vt++;if(vt===Dt)continue;Tt.moveTo(vt%d,M);const mt=vt;let et=E[vt];do{const Z=dt[et];do vt+=Z;while(!E[vt]);const ft=E[vt];ft!==5&&ft!==10?(et=ft,E[vt]=0):(et=ft&51*et>>4,E[vt]&=et>>2|et<<2),Tt.lineTo(vt%d,vt/d|0),E[vt]||--pt}while(mt!==vt);--M}return at=null,E=null,function(vt){vt.save(),vt.scale(1/i,-1/a),vt.translate(0,-a),vt.fill(Tt),vt.beginPath(),vt.restore()}}class x{constructor(i,a){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,i,a])}clone(){const i=Object.create(this);return i.clipBox=this.clipBox.slice(),i}setCurrentPoint(i,a){this.x=i,this.y=a}updatePathMinMax(i,a,s){[a,s]=r.Util.applyTransform([a,s],i),this.minX=Math.min(this.minX,a),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,a),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(i,a){const s=r.Util.applyTransform(a,i),c=r.Util.applyTransform(a.slice(2),i);this.minX=Math.min(this.minX,s[0],c[0]),this.minY=Math.min(this.minY,s[1],c[1]),this.maxX=Math.max(this.maxX,s[0],c[0]),this.maxY=Math.max(this.maxY,s[1],c[1])}updateScalingPathMinMax(i,a){r.Util.scaleMinMax(i,a),this.minX=Math.min(this.minX,a[0]),this.maxX=Math.max(this.maxX,a[1]),this.minY=Math.min(this.minY,a[2]),this.maxY=Math.max(this.maxY,a[3])}updateCurvePathMinMax(i,a,s,c,d,E,M,W,nt,J){const at=r.Util.bezierBoundingBox(a,s,c,d,E,M,W,nt);if(J){J[0]=Math.min(J[0],at[0],at[2]),J[1]=Math.max(J[1],at[0],at[2]),J[2]=Math.min(J[2],at[1],at[3]),J[3]=Math.max(J[3],at[1],at[3]);return}this.updateRectMinMax(i,at)}getPathBoundingBox(i=z.PathType.FILL,a=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(i===z.PathType.STROKE){a||(0,r.unreachable)("Stroke bounding box must include transform.");const c=r.Util.singularValueDecompose2dScale(a),d=c[0]*this.lineWidth/2,E=c[1]*this.lineWidth/2;s[0]-=d,s[1]-=E,s[2]+=d,s[3]+=E}return s}updateClipFromPath(){const i=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(i||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(i){this.clipBox=i,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(i=z.PathType.FILL,a=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(i,a))}}function w(P,i){if(typeof ImageData<"u"&&i instanceof ImageData){P.putImageData(i,0,0);return}const a=i.height,s=i.width,c=a%T,d=(a-c)/T,E=c===0?d:d+1,M=P.createImageData(s,T);let W=0,nt;const J=i.data,at=M.data;let ht,pt,dt,Tt;if(i.kind===r.ImageKind.GRAYSCALE_1BPP){const Lt=J.byteLength,vt=new Uint32Array(at.buffer,0,at.byteLength>>2),Dt=vt.length,mt=s+7>>3,et=4294967295,Z=r.FeatureTest.isLittleEndian?4278190080:255;for(ht=0;ht<E;ht++){for(dt=ht<d?T:c,nt=0,pt=0;pt<dt;pt++){const ft=Lt-W;let wt=0;const Ct=ft>mt?s:ft*8-7,Ut=Ct&-8;let Gt=0,Wt=0;for(;wt<Ut;wt+=8)Wt=J[W++],vt[nt++]=Wt&128?et:Z,vt[nt++]=Wt&64?et:Z,vt[nt++]=Wt&32?et:Z,vt[nt++]=Wt&16?et:Z,vt[nt++]=Wt&8?et:Z,vt[nt++]=Wt&4?et:Z,vt[nt++]=Wt&2?et:Z,vt[nt++]=Wt&1?et:Z;for(;wt<Ct;wt++)Gt===0&&(Wt=J[W++],Gt=128),vt[nt++]=Wt&Gt?et:Z,Gt>>=1}for(;nt<Dt;)vt[nt++]=0;P.putImageData(M,0,ht*T)}}else if(i.kind===r.ImageKind.RGBA_32BPP){for(pt=0,Tt=s*T*4,ht=0;ht<d;ht++)at.set(J.subarray(W,W+Tt)),W+=Tt,P.putImageData(M,0,pt),pt+=T;ht<E&&(Tt=s*c*4,at.set(J.subarray(W,W+Tt)),P.putImageData(M,0,pt))}else if(i.kind===r.ImageKind.RGB_24BPP)for(dt=T,Tt=s*dt,ht=0;ht<E;ht++){for(ht>=d&&(dt=c,Tt=s*dt),nt=0,pt=Tt;pt--;)at[nt++]=J[W++],at[nt++]=J[W++],at[nt++]=J[W++],at[nt++]=255;P.putImageData(M,0,ht*T)}else throw new Error(`bad image kind: ${i.kind}`)}function y(P,i){if(i.bitmap){P.drawImage(i.bitmap,0,0);return}const a=i.height,s=i.width,c=a%T,d=(a-c)/T,E=c===0?d:d+1,M=P.createImageData(s,T);let W=0;const nt=i.data,J=M.data;for(let at=0;at<E;at++){const ht=at<d?T:c;({srcPos:W}=(0,U.convertBlackAndWhiteToRGBA)({src:nt,srcPos:W,dest:J,width:s,height:ht,nonBlackColor:0})),P.putImageData(M,0,at*T)}}function o(P,i){const a=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of a)P[s]!==void 0&&(i[s]=P[s]);P.setLineDash!==void 0&&(i.setLineDash(P.getLineDash()),i.lineDashOffset=P.lineDashOffset)}function h(P){if(P.strokeStyle=P.fillStyle="#000000",P.fillRule="nonzero",P.globalAlpha=1,P.lineWidth=1,P.lineCap="butt",P.lineJoin="miter",P.miterLimit=10,P.globalCompositeOperation="source-over",P.font="10px sans-serif",P.setLineDash!==void 0&&(P.setLineDash([]),P.lineDashOffset=0),!r.isNodeJS){const{filter:i}=P;i!=="none"&&i!==""&&(P.filter="none")}}function F(P,i,a,s){const c=P.length;for(let d=3;d<c;d+=4){const E=P[d];if(E===0)P[d-3]=i,P[d-2]=a,P[d-1]=s;else if(E<255){const M=255-E;P[d-3]=P[d-3]*E+i*M>>8,P[d-2]=P[d-2]*E+a*M>>8,P[d-1]=P[d-1]*E+s*M>>8}}}function m(P,i,a){const s=P.length,c=1/255;for(let d=3;d<s;d+=4){const E=a?a[P[d]]:P[d];i[d]=i[d]*E*c|0}}function l(P,i,a){const s=P.length;for(let c=3;c<s;c+=4){const d=P[c-3]*77+P[c-2]*152+P[c-1]*28;i[c]=a?i[c]*a[d>>8]>>8:i[c]*d>>16}}function R(P,i,a,s,c,d,E,M,W,nt,J){const at=!!d,ht=at?d[0]:0,pt=at?d[1]:0,dt=at?d[2]:0,Tt=c==="Luminosity"?l:m,vt=Math.min(s,Math.ceil(1048576/a));for(let Dt=0;Dt<s;Dt+=vt){const mt=Math.min(vt,s-Dt),et=P.getImageData(M-nt,Dt+(W-J),a,mt),Z=i.getImageData(M,Dt+W,a,mt);at&&F(et.data,ht,pt,dt),Tt(et.data,Z.data,E),i.putImageData(Z,M,Dt+W)}}function p(P,i,a,s){const c=s[0],d=s[1],E=s[2]-c,M=s[3]-d;E===0||M===0||(R(i.context,a,E,M,i.subtype,i.backdrop,i.transferMap,c,d,i.offsetX,i.offsetY),P.save(),P.globalAlpha=1,P.globalCompositeOperation="source-over",P.setTransform(1,0,0,1,0,0),P.drawImage(a.canvas,0,0),P.restore())}function $(P,i){const a=r.Util.singularValueDecompose2dScale(P);a[0]=Math.fround(a[0]),a[1]=Math.fround(a[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*f.PixelsPerInch.PDF_TO_CSS_UNITS);return i!==void 0?i:a[0]<=s||a[1]<=s}const G=["butt","round","square"],S=["miter","round","bevel"],X={},it={},xt=class xt{constructor(i,a,s,c,d,{optionalContentConfig:E,markedContentStack:M=null},W,nt){j(this,H);j(this,gt);this.ctx=i,this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=a,this.objs=s,this.canvasFactory=c,this.filterFactory=d,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=M||[],this.optionalContentConfig=E,this.cachedCanvases=new A(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=W,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=nt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(i,a=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):a}beginDrawing({transform:i,viewport:a,transparency:s=!1,background:c=null}){const d=this.ctx.canvas.width,E=this.ctx.canvas.height,M=this.ctx.fillStyle;if(this.ctx.fillStyle=c||"#ffffff",this.ctx.fillRect(0,0,d,E),this.ctx.fillStyle=M,s){const W=this.cachedCanvases.getCanvas("transparent",d,E);this.compositeCtx=this.ctx,this.transparentCanvas=W.canvas,this.ctx=W.context,this.ctx.save(),this.ctx.transform(...(0,f.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),h(this.ctx),i&&(this.ctx.transform(...i),this.outputScaleX=i[0],this.outputScaleY=i[0]),this.ctx.transform(...a.transform),this.viewportScale=a.scale,this.baseTransform=(0,f.getCurrentTransform)(this.ctx)}executeOperatorList(i,a,s,c){const d=i.argsArray,E=i.fnArray;let M=a||0;const W=d.length;if(W===M)return M;const nt=W-M>L&&typeof s=="function",J=nt?Date.now()+g:0;let at=0;const ht=this.commonObjs,pt=this.objs;let dt;for(;;){if(c!==void 0&&M===c.nextBreakPoint)return c.breakIt(M,s),M;if(dt=E[M],dt!==r.OPS.dependency)this[dt].apply(this,d[M]);else for(const Tt of d[M]){const Lt=Tt.startsWith("g_")?ht:pt;if(!Lt.has(Tt))return Lt.get(Tt,s),M}if(M++,M===W)return M;if(nt&&++at>L){if(Date.now()>J)return s(),M;at=0}}}endDrawing(){q(this,H,Qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const i of this._cachedBitmapsMap.values()){for(const a of i.values())typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement&&(a.width=a.height=0);i.clear()}this._cachedBitmapsMap.clear(),q(this,gt,Ze).call(this)}_scaleImage(i,a){const s=i.width,c=i.height;let d=Math.max(Math.hypot(a[0],a[1]),1),E=Math.max(Math.hypot(a[2],a[3]),1),M=s,W=c,nt="prescale1",J,at;for(;d>2&&M>1||E>2&&W>1;){let ht=M,pt=W;d>2&&M>1&&(ht=M>=16384?Math.floor(M/2)-1||1:Math.ceil(M/2),d/=M/ht),E>2&&W>1&&(pt=W>=16384?Math.floor(W/2)-1||1:Math.ceil(W)/2,E/=W/pt),J=this.cachedCanvases.getCanvas(nt,ht,pt),at=J.context,at.clearRect(0,0,ht,pt),at.drawImage(i,0,0,M,W,0,0,ht,pt),i=J.canvas,M=ht,W=pt,nt=nt==="prescale1"?"prescale2":"prescale1"}return{img:i,paintWidth:M,paintHeight:W}}_createMaskCanvas(i){const a=this.ctx,{width:s,height:c}=i,d=this.current.fillColor,E=this.current.patternFill,M=(0,f.getCurrentTransform)(a);let W,nt,J,at;if((i.bitmap||i.data)&&i.count>1){const wt=i.bitmap||i.data.buffer;nt=JSON.stringify(E?M:[M.slice(0,4),d]),W=this._cachedBitmapsMap.get(wt),W||(W=new Map,this._cachedBitmapsMap.set(wt,W));const Ct=W.get(nt);if(Ct&&!E){const Ut=Math.round(Math.min(M[0],M[2])+M[4]),Gt=Math.round(Math.min(M[1],M[3])+M[5]);return{canvas:Ct,offsetX:Ut,offsetY:Gt}}J=Ct}J||(at=this.cachedCanvases.getCanvas("maskCanvas",s,c),y(at.context,i));let ht=r.Util.transform(M,[1/s,0,0,-1/c,0,0]);ht=r.Util.transform(ht,[1,0,0,1,0,-c]);const pt=r.Util.applyTransform([0,0],ht),dt=r.Util.applyTransform([s,c],ht),Tt=r.Util.normalizeRect([pt[0],pt[1],dt[0],dt[1]]),Lt=Math.round(Tt[2]-Tt[0])||1,vt=Math.round(Tt[3]-Tt[1])||1,Dt=this.cachedCanvases.getCanvas("fillCanvas",Lt,vt),mt=Dt.context,et=Math.min(pt[0],dt[0]),Z=Math.min(pt[1],dt[1]);mt.translate(-et,-Z),mt.transform(...ht),J||(J=this._scaleImage(at.canvas,(0,f.getCurrentTransformInverse)(mt)),J=J.img,W&&E&&W.set(nt,J)),mt.imageSmoothingEnabled=$((0,f.getCurrentTransform)(mt),i.interpolate),u(mt,J,0,0,J.width,J.height,0,0,s,c),mt.globalCompositeOperation="source-in";const ft=r.Util.transform((0,f.getCurrentTransformInverse)(mt),[1,0,0,1,-et,-Z]);return mt.fillStyle=E?d.getPattern(a,this,ft,z.PathType.FILL):d,mt.fillRect(0,0,s,c),W&&!E&&(this.cachedCanvases.delete("fillCanvas"),W.set(nt,Dt.canvas)),{canvas:Dt.canvas,offsetX:Math.round(et),offsetY:Math.round(Z)}}setLineWidth(i){i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(i){this.ctx.lineCap=G[i]}setLineJoin(i){this.ctx.lineJoin=S[i]}setMiterLimit(i){this.ctx.miterLimit=i}setDash(i,a){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(i),s.lineDashOffset=a)}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[a,s]of i)switch(a){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const i=this.inSMaskMode;this.current.activeSMask&&!i?this.beginSMaskMode():!this.current.activeSMask&&i&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,a=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,c=this.cachedCanvases.getCanvas(s,i,a);this.suspendedCtx=this.ctx,this.ctx=c.context;const d=this.ctx;d.setTransform(...(0,f.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,d),v(d,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(i){if(!this.current.activeSMask)return;i?(i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i[2]=Math.ceil(i[2]),i[3]=Math.ceil(i[3])):i=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const a=this.current.activeSMask,s=this.suspendedCtx;p(s,a,this.ctx,i),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(i,a,s,c,d,E){this.ctx.transform(i,a,s,c,d,E),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(i,a,s){const c=this.ctx,d=this.current;let E=d.x,M=d.y,W,nt;const J=(0,f.getCurrentTransform)(c),at=J[0]===0&&J[3]===0||J[1]===0&&J[2]===0,ht=at?s.slice(0):null;for(let pt=0,dt=0,Tt=i.length;pt<Tt;pt++)switch(i[pt]|0){case r.OPS.rectangle:E=a[dt++],M=a[dt++];const Lt=a[dt++],vt=a[dt++],Dt=E+Lt,mt=M+vt;c.moveTo(E,M),Lt===0||vt===0?c.lineTo(Dt,mt):(c.lineTo(Dt,M),c.lineTo(Dt,mt),c.lineTo(E,mt)),at||d.updateRectMinMax(J,[E,M,Dt,mt]),c.closePath();break;case r.OPS.moveTo:E=a[dt++],M=a[dt++],c.moveTo(E,M),at||d.updatePathMinMax(J,E,M);break;case r.OPS.lineTo:E=a[dt++],M=a[dt++],c.lineTo(E,M),at||d.updatePathMinMax(J,E,M);break;case r.OPS.curveTo:W=E,nt=M,E=a[dt+4],M=a[dt+5],c.bezierCurveTo(a[dt],a[dt+1],a[dt+2],a[dt+3],E,M),d.updateCurvePathMinMax(J,W,nt,a[dt],a[dt+1],a[dt+2],a[dt+3],E,M,ht),dt+=6;break;case r.OPS.curveTo2:W=E,nt=M,c.bezierCurveTo(E,M,a[dt],a[dt+1],a[dt+2],a[dt+3]),d.updateCurvePathMinMax(J,W,nt,E,M,a[dt],a[dt+1],a[dt+2],a[dt+3],ht),E=a[dt+2],M=a[dt+3],dt+=4;break;case r.OPS.curveTo3:W=E,nt=M,E=a[dt+2],M=a[dt+3],c.bezierCurveTo(a[dt],a[dt+1],E,M,E,M),d.updateCurvePathMinMax(J,W,nt,a[dt],a[dt+1],E,M,E,M,ht),dt+=4;break;case r.OPS.closePath:c.closePath();break}at&&d.updateScalingPathMinMax(J,ht),d.setCurrentPoint(E,M)}closePath(){this.ctx.closePath()}stroke(i=!0){const a=this.ctx,s=this.current.strokeColor;a.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(a.save(),a.strokeStyle=s.getPattern(a,this,(0,f.getCurrentTransformInverse)(a),z.PathType.STROKE),this.rescaleAndStroke(!1),a.restore()):this.rescaleAndStroke(!0)),i&&this.consumePath(this.current.getClippedPathBoundingBox()),a.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(i=!0){const a=this.ctx,s=this.current.fillColor,c=this.current.patternFill;let d=!1;c&&(a.save(),a.fillStyle=s.getPattern(a,this,(0,f.getCurrentTransformInverse)(a),z.PathType.FILL),d=!0);const E=this.current.getClippedPathBoundingBox();this.contentVisible&&E!==null&&(this.pendingEOFill?(a.fill("evenodd"),this.pendingEOFill=!1):a.fill()),d&&a.restore(),i&&this.consumePath(E)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=X}eoClip(){this.pendingClip=it}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const i=this.pendingTextPaths,a=this.ctx;if(i===void 0){a.beginPath();return}a.save(),a.beginPath();for(const s of i)a.setTransform(...s.transform),a.translate(s.x,s.y),s.addToPath(a,s.fontSize);a.restore(),a.clip(),a.beginPath(),delete this.pendingTextPaths}setCharSpacing(i){this.current.charSpacing=i}setWordSpacing(i){this.current.wordSpacing=i}setHScale(i){this.current.textHScale=i/100}setLeading(i){this.current.leading=-i}setFont(i,a){var J;const s=this.commonObjs.get(i),c=this.current;if(!s)throw new Error(`Can't find font for ${i}`);if(c.fontMatrix=s.fontMatrix||r.FONT_IDENTITY_MATRIX,(c.fontMatrix[0]===0||c.fontMatrix[3]===0)&&(0,r.warn)("Invalid font matrix for font "+i),a<0?(a=-a,c.fontDirection=-1):c.fontDirection=1,this.current.font=s,this.current.fontSize=a,s.isType3Font)return;const d=s.loadedName||"sans-serif",E=((J=s.systemFontInfo)==null?void 0:J.css)||`"${d}", ${s.fallbackName}`;let M="normal";s.black?M="900":s.bold&&(M="bold");const W=s.italic?"italic":"normal";let nt=a;a<ct?nt=ct:a>D&&(nt=D),this.current.fontSizeScale=a/nt,this.ctx.font=`${W} ${M} ${nt}px ${E}`}setTextRenderingMode(i){this.current.textRenderingMode=i}setTextRise(i){this.current.textRise=i}moveText(i,a){this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=a}setLeadingMoveText(i,a){this.setLeading(-a),this.moveText(i,a)}setTextMatrix(i,a,s,c,d,E){this.current.textMatrix=[i,a,s,c,d,E],this.current.textMatrixScale=Math.hypot(i,a),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(i,a,s,c){const d=this.ctx,E=this.current,M=E.font,W=E.textRenderingMode,nt=E.fontSize/E.fontSizeScale,J=W&r.TextRenderingMode.FILL_STROKE_MASK,at=!!(W&r.TextRenderingMode.ADD_TO_PATH_FLAG),ht=E.patternFill&&!M.missingFile;let pt;(M.disableFontFace||at||ht)&&(pt=M.getPathGenerator(this.commonObjs,i)),M.disableFontFace||ht?(d.save(),d.translate(a,s),d.beginPath(),pt(d,nt),c&&d.setTransform(...c),(J===r.TextRenderingMode.FILL||J===r.TextRenderingMode.FILL_STROKE)&&d.fill(),(J===r.TextRenderingMode.STROKE||J===r.TextRenderingMode.FILL_STROKE)&&d.stroke(),d.restore()):((J===r.TextRenderingMode.FILL||J===r.TextRenderingMode.FILL_STROKE)&&d.fillText(i,a,s),(J===r.TextRenderingMode.STROKE||J===r.TextRenderingMode.FILL_STROKE)&&d.strokeText(i,a,s)),at&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,f.getCurrentTransform)(d),x:a,y:s,fontSize:nt,addToPath:pt})}get isFontSubpixelAAEnabled(){const{context:i}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);i.scale(1.5,1),i.fillText("I",0,10);const a=i.getImageData(0,0,10,10).data;let s=!1;for(let c=3;c<a.length;c+=4)if(a[c]>0&&a[c]<255){s=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(i){const a=this.current,s=a.font;if(s.isType3Font)return this.showType3Text(i);const c=a.fontSize;if(c===0)return;const d=this.ctx,E=a.fontSizeScale,M=a.charSpacing,W=a.wordSpacing,nt=a.fontDirection,J=a.textHScale*nt,at=i.length,ht=s.vertical,pt=ht?1:-1,dt=s.defaultVMetrics,Tt=c*a.fontMatrix[0],Lt=a.textRenderingMode===r.TextRenderingMode.FILL&&!s.disableFontFace&&!a.patternFill;d.save(),d.transform(...a.textMatrix),d.translate(a.x,a.y+a.textRise),nt>0?d.scale(J,-1):d.scale(J,1);let vt;if(a.patternFill){d.save();const ft=a.fillColor.getPattern(d,this,(0,f.getCurrentTransformInverse)(d),z.PathType.FILL);vt=(0,f.getCurrentTransform)(d),d.restore(),d.fillStyle=ft}let Dt=a.lineWidth;const mt=a.textMatrixScale;if(mt===0||Dt===0){const ft=a.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;(ft===r.TextRenderingMode.STROKE||ft===r.TextRenderingMode.FILL_STROKE)&&(Dt=this.getSinglePixelWidth())}else Dt/=mt;if(E!==1&&(d.scale(E,E),Dt/=E),d.lineWidth=Dt,s.isInvalidPDFjsFont){const ft=[];let wt=0;for(const Ct of i)ft.push(Ct.unicode),wt+=Ct.width;d.fillText(ft.join(""),0,0),a.x+=wt*Tt*J,d.restore(),this.compose();return}let et=0,Z;for(Z=0;Z<at;++Z){const ft=i[Z];if(typeof ft=="number"){et+=pt*ft*c/1e3;continue}let wt=!1;const Ct=(ft.isSpace?W:0)+M,Ut=ft.fontChar,Gt=ft.accent;let Wt,Ht,zt=ft.width;if(ht){const qt=ft.vmetric||dt,ut=-(ft.vmetric?qt[1]:zt*.5)*Tt,tt=qt[2]*Tt;zt=qt?-qt[0]:zt,Wt=ut/E,Ht=(et+tt)/E}else Wt=et/E,Ht=0;if(s.remeasure&&zt>0){const qt=d.measureText(Ut).width*1e3/c*E;if(zt<qt&&this.isFontSubpixelAAEnabled){const ut=zt/qt;wt=!0,d.save(),d.scale(ut,1),Wt/=ut}else zt!==qt&&(Wt+=(zt-qt)/2e3*c/E)}if(this.contentVisible&&(ft.isInFont||s.missingFile)){if(Lt&&!Gt)d.fillText(Ut,Wt,Ht);else if(this.paintChar(Ut,Wt,Ht,vt),Gt){const qt=Wt+c*Gt.offset.x/E,ut=Ht-c*Gt.offset.y/E;this.paintChar(Gt.fontChar,qt,ut,vt)}}const jt=ht?zt*Tt-Ct*nt:zt*Tt+Ct*nt;et+=jt,wt&&d.restore()}ht?a.y-=et:a.x+=et*J,d.restore(),this.compose()}showType3Text(i){const a=this.ctx,s=this.current,c=s.font,d=s.fontSize,E=s.fontDirection,M=c.vertical?1:-1,W=s.charSpacing,nt=s.wordSpacing,J=s.textHScale*E,at=s.fontMatrix||r.FONT_IDENTITY_MATRIX,ht=i.length,pt=s.textRenderingMode===r.TextRenderingMode.INVISIBLE;let dt,Tt,Lt,vt;if(!(pt||d===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,a.save(),a.transform(...s.textMatrix),a.translate(s.x,s.y),a.scale(J,E),dt=0;dt<ht;++dt){if(Tt=i[dt],typeof Tt=="number"){vt=M*Tt*d/1e3,this.ctx.translate(vt,0),s.x+=vt*J;continue}const Dt=(Tt.isSpace?nt:0)+W,mt=c.charProcOperatorList[Tt.operatorListId];if(!mt){(0,r.warn)(`Type3 character "${Tt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Tt,this.save(),a.scale(d,d),a.transform(...at),this.executeOperatorList(mt),this.restore()),Lt=r.Util.applyTransform([Tt.width,0],at)[0]*d+Dt,a.translate(Lt,0),s.x+=Lt*J}a.restore(),this.processingType3=null}}setCharWidth(i,a){}setCharWidthAndBounds(i,a,s,c,d,E){this.ctx.rect(s,c,d-s,E-c),this.ctx.clip(),this.endPath()}getColorN_Pattern(i){let a;if(i[0]==="TilingPattern"){const s=i[1],c=this.baseTransform||(0,f.getCurrentTransform)(this.ctx),d={createCanvasGraphics:E=>new xt(E,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};a=new z.TilingPattern(i,s,this.ctx,d,c)}else a=this._getPattern(i[1],i[2]);return a}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(i,a,s){const c=r.Util.makeHexColor(i,a,s);this.ctx.strokeStyle=c,this.current.strokeColor=c}setFillRGBColor(i,a,s){const c=r.Util.makeHexColor(i,a,s);this.ctx.fillStyle=c,this.current.fillColor=c,this.current.patternFill=!1}_getPattern(i,a=null){let s;return this.cachedPatterns.has(i)?s=this.cachedPatterns.get(i):(s=(0,z.getShadingPattern)(this.getObject(i)),this.cachedPatterns.set(i,s)),a&&(s.matrix=a),s}shadingFill(i){if(!this.contentVisible)return;const a=this.ctx;this.save();const s=this._getPattern(i);a.fillStyle=s.getPattern(a,this,(0,f.getCurrentTransformInverse)(a),z.PathType.SHADING);const c=(0,f.getCurrentTransformInverse)(a);if(c){const{width:d,height:E}=a.canvas,[M,W,nt,J]=r.Util.getAxialAlignedBoundingBox([0,0,d,E],c);this.ctx.fillRect(M,W,nt-M,J-W)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(i,a){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(i)&&i.length===6&&this.transform(...i),this.baseTransform=(0,f.getCurrentTransform)(this.ctx),a)){const s=a[2]-a[0],c=a[3]-a[1];this.ctx.rect(a[0],a[1],s,c),this.current.updateRectMinMax((0,f.getCurrentTransform)(this.ctx),a),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(i){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const a=this.ctx;i.isolated||(0,r.info)("TODO: Support non-isolated groups."),i.knockout&&(0,r.warn)("Knockout groups not supported.");const s=(0,f.getCurrentTransform)(a);if(i.matrix&&a.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let c=r.Util.getAxialAlignedBoundingBox(i.bbox,(0,f.getCurrentTransform)(a));const d=[0,0,a.canvas.width,a.canvas.height];c=r.Util.intersect(c,d)||[0,0,0,0];const E=Math.floor(c[0]),M=Math.floor(c[1]);let W=Math.max(Math.ceil(c[2])-E,1),nt=Math.max(Math.ceil(c[3])-M,1),J=1,at=1;W>C&&(J=W/C,W=C),nt>C&&(at=nt/C,nt=C),this.current.startNewPathAndClipBox([0,0,W,nt]);let ht="groupAt"+this.groupLevel;i.smask&&(ht+="_smask_"+this.smaskCounter++%2);const pt=this.cachedCanvases.getCanvas(ht,W,nt),dt=pt.context;dt.scale(1/J,1/at),dt.translate(-E,-M),dt.transform(...s),i.smask?this.smaskStack.push({canvas:pt.canvas,context:dt,offsetX:E,offsetY:M,scaleX:J,scaleY:at,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}):(a.setTransform(1,0,0,1,0,0),a.translate(E,M),a.scale(J,at),a.save()),o(a,dt),this.ctx=dt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}endGroup(i){if(!this.contentVisible)return;this.groupLevel--;const a=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,i.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const c=(0,f.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...c);const d=r.Util.getAxialAlignedBoundingBox([0,0,a.canvas.width,a.canvas.height],c);this.ctx.drawImage(a.canvas,0,0),this.ctx.restore(),this.compose(d)}}beginAnnotation(i,a,s,c,d){if(q(this,H,Qe).call(this),h(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(a)&&a.length===4){const E=a[2]-a[0],M=a[3]-a[1];if(d&&this.annotationCanvasMap){s=s.slice(),s[4]-=a[0],s[5]-=a[1],a=a.slice(),a[0]=a[1]=0,a[2]=E,a[3]=M;const[W,nt]=r.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(this.ctx)),{viewportScale:J}=this,at=Math.ceil(E*this.outputScaleX*J),ht=Math.ceil(M*this.outputScaleY*J);this.annotationCanvas=this.canvasFactory.create(at,ht);const{canvas:pt,context:dt}=this.annotationCanvas;this.annotationCanvasMap.set(i,pt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=dt,this.ctx.save(),this.ctx.setTransform(W,0,0,-nt,0,M*nt),h(this.ctx)}else h(this.ctx),this.ctx.rect(a[0],a[1],E,M),this.ctx.clip(),this.endPath()}this.current=new x(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...c)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),q(this,gt,Ze).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(i){if(!this.contentVisible)return;const a=i.count;i=this.getObject(i.data,i),i.count=a;const s=this.ctx,c=this.processingType3;if(c&&(c.compiled===void 0&&(c.compiled=_(i)),c.compiled)){c.compiled(s);return}const d=this._createMaskCanvas(i),E=d.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(E,d.offsetX,d.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(i,a,s=0,c=0,d,E){if(!this.contentVisible)return;i=this.getObject(i.data,i);const M=this.ctx;M.save();const W=(0,f.getCurrentTransform)(M);M.transform(a,s,c,d,0,0);const nt=this._createMaskCanvas(i);M.setTransform(1,0,0,1,nt.offsetX-W[4],nt.offsetY-W[5]);for(let J=0,at=E.length;J<at;J+=2){const ht=r.Util.transform(W,[a,s,c,d,E[J],E[J+1]]),[pt,dt]=r.Util.applyTransform([0,0],ht);M.drawImage(nt.canvas,pt,dt)}M.restore(),this.compose()}paintImageMaskXObjectGroup(i){if(!this.contentVisible)return;const a=this.ctx,s=this.current.fillColor,c=this.current.patternFill;for(const d of i){const{data:E,width:M,height:W,transform:nt}=d,J=this.cachedCanvases.getCanvas("maskCanvas",M,W),at=J.context;at.save();const ht=this.getObject(E,d);y(at,ht),at.globalCompositeOperation="source-in",at.fillStyle=c?s.getPattern(at,this,(0,f.getCurrentTransformInverse)(a),z.PathType.FILL):s,at.fillRect(0,0,M,W),at.restore(),a.save(),a.transform(...nt),a.scale(1,-1),u(a,J.canvas,0,0,M,W,0,-1,1,1),a.restore()}this.compose()}paintImageXObject(i){if(!this.contentVisible)return;const a=this.getObject(i);if(!a){(0,r.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(a)}paintImageXObjectRepeat(i,a,s,c){if(!this.contentVisible)return;const d=this.getObject(i);if(!d){(0,r.warn)("Dependent image isn't ready yet");return}const E=d.width,M=d.height,W=[];for(let nt=0,J=c.length;nt<J;nt+=2)W.push({transform:[a,0,0,s,c[nt],c[nt+1]],x:0,y:0,w:E,h:M});this.paintInlineImageXObjectGroup(d,W)}applyTransferMapsToCanvas(i){return this.current.transferMaps!=="none"&&(i.filter=this.current.transferMaps,i.drawImage(i.canvas,0,0),i.filter="none"),i.canvas}applyTransferMapsToBitmap(i){if(this.current.transferMaps==="none")return i.bitmap;const{bitmap:a,width:s,height:c}=i,d=this.cachedCanvases.getCanvas("inlineImage",s,c),E=d.context;return E.filter=this.current.transferMaps,E.drawImage(a,0,0),E.filter="none",d.canvas}paintInlineImageXObject(i){if(!this.contentVisible)return;const a=i.width,s=i.height,c=this.ctx;if(this.save(),!r.isNodeJS){const{filter:M}=c;M!=="none"&&M!==""&&(c.filter="none")}c.scale(1/a,-1/s);let d;if(i.bitmap)d=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)d=i;else{const W=this.cachedCanvases.getCanvas("inlineImage",a,s).context;w(W,i),d=this.applyTransferMapsToCanvas(W)}const E=this._scaleImage(d,(0,f.getCurrentTransformInverse)(c));c.imageSmoothingEnabled=$((0,f.getCurrentTransform)(c),i.interpolate),u(c,E.img,0,0,E.paintWidth,E.paintHeight,0,-s,a,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(i,a){if(!this.contentVisible)return;const s=this.ctx;let c;if(i.bitmap)c=i.bitmap;else{const d=i.width,E=i.height,W=this.cachedCanvases.getCanvas("inlineImage",d,E).context;w(W,i),c=this.applyTransferMapsToCanvas(W)}for(const d of a)s.save(),s.transform(...d.transform),s.scale(1,-1),u(s,c,d.x,d.y,d.w,d.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(i){}markPointProps(i,a){}beginMarkedContent(i){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(i,a){i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(a)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(i){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const s=this.ctx;this.pendingClip&&(a||(this.pendingClip===it?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const i=(0,f.getCurrentTransform)(this.ctx);if(i[1]===0&&i[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(i[0]),Math.abs(i[3]));else{const a=Math.abs(i[0]*i[3]-i[2]*i[1]),s=Math.hypot(i[0],i[2]),c=Math.hypot(i[1],i[3]);this._cachedGetSinglePixelWidth=Math.max(s,c)/a}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:i}=this.current,{a,b:s,c,d}=this.ctx.getTransform();let E,M;if(s===0&&c===0){const W=Math.abs(a),nt=Math.abs(d);if(W===nt)if(i===0)E=M=1/W;else{const J=W*i;E=M=J<1?1/J:1}else if(i===0)E=1/W,M=1/nt;else{const J=W*i,at=nt*i;E=J<1?1/J:1,M=at<1?1/at:1}}else{const W=Math.abs(a*d-s*c),nt=Math.hypot(a,s),J=Math.hypot(c,d);if(i===0)E=J/W,M=nt/W;else{const at=i*W;E=J>at?J/at:1,M=nt>at?nt/at:1}}this._cachedScaleForStroking[0]=E,this._cachedScaleForStroking[1]=M}return this._cachedScaleForStroking}rescaleAndStroke(i){const{ctx:a}=this,{lineWidth:s}=this.current,[c,d]=this.getScaleForStroking();if(a.lineWidth=s||1,c===1&&d===1){a.stroke();return}const E=a.getLineDash();if(i&&a.save(),a.scale(c,d),E.length>0){const M=Math.max(c,d);a.setLineDash(E.map(W=>W/M)),a.lineDashOffset/=M}a.stroke(),i&&a.restore()}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}};H=new WeakSet,Qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},gt=new WeakSet,Ze=function(){if(this.pageColors){const i=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(i!=="none"){const a=this.ctx.filter;this.ctx.filter=i,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=a}}};let rt=xt;e.CanvasGraphics=rt;for(const P in r.OPS)rt.prototype[P]!==void 0&&(rt.prototype[r.OPS[P]]=rt.prototype[P])},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=T;var r=I(1),f=I(6);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=z;function U(_,x){if(!x)return;const w=x[2]-x[0],y=x[3]-x[1],o=new Path2D;o.rect(x[0],x[1],w,y),_.clip(o)}class ct{constructor(){this.constructor===ct&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class D extends ct{constructor(x){super(),this._type=x[1],this._bbox=x[2],this._colorStops=x[3],this._p0=x[4],this._p1=x[5],this._r0=x[6],this._r1=x[7],this.matrix=null}_createGradient(x){let w;this._type==="axial"?w=x.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=x.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const y of this._colorStops)w.addColorStop(y[0],y[1]);return w}getPattern(x,w,y,o){let h;if(o===z.STROKE||o===z.FILL){const F=w.current.getClippedPathBoundingBox(o,(0,f.getCurrentTransform)(x))||[0,0,0,0],m=Math.ceil(F[2]-F[0])||1,l=Math.ceil(F[3]-F[1])||1,R=w.cachedCanvases.getCanvas("pattern",m,l,!0),p=R.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-F[0],-F[1]),y=r.Util.transform(y,[1,0,0,1,F[0],F[1]]),p.transform(...w.baseTransform),this.matrix&&p.transform(...this.matrix),U(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),h=x.createPattern(R.canvas,"no-repeat");const $=new DOMMatrix(y);h.setTransform($)}else U(x,this._bbox),h=this._createGradient(x);return h}}function C(_,x,w,y,o,h,F,m){const l=x.coords,R=x.colors,p=_.data,$=_.width*4;let G;l[w+1]>l[y+1]&&(G=w,w=y,y=G,G=h,h=F,F=G),l[y+1]>l[o+1]&&(G=y,y=o,o=G,G=F,F=m,m=G),l[w+1]>l[y+1]&&(G=w,w=y,y=G,G=h,h=F,F=G);const S=(l[w]+x.offsetX)*x.scaleX,X=(l[w+1]+x.offsetY)*x.scaleY,it=(l[y]+x.offsetX)*x.scaleX,rt=(l[y+1]+x.offsetY)*x.scaleY,H=(l[o]+x.offsetX)*x.scaleX,lt=(l[o+1]+x.offsetY)*x.scaleY;if(X>=lt)return;const gt=R[h],Et=R[h+1],xt=R[h+2],P=R[F],i=R[F+1],a=R[F+2],s=R[m],c=R[m+1],d=R[m+2],E=Math.round(X),M=Math.round(lt);let W,nt,J,at,ht,pt,dt,Tt;for(let Lt=E;Lt<=M;Lt++){if(Lt<rt){const Z=Lt<X?0:(X-Lt)/(X-rt);W=S-(S-it)*Z,nt=gt-(gt-P)*Z,J=Et-(Et-i)*Z,at=xt-(xt-a)*Z}else{let Z;Lt>lt?Z=1:rt===lt?Z=0:Z=(rt-Lt)/(rt-lt),W=it-(it-H)*Z,nt=P-(P-s)*Z,J=i-(i-c)*Z,at=a-(a-d)*Z}let vt;Lt<X?vt=0:Lt>lt?vt=1:vt=(X-Lt)/(X-lt),ht=S-(S-H)*vt,pt=gt-(gt-s)*vt,dt=Et-(Et-c)*vt,Tt=xt-(xt-d)*vt;const Dt=Math.round(Math.min(W,ht)),mt=Math.round(Math.max(W,ht));let et=$*Lt+Dt*4;for(let Z=Dt;Z<=mt;Z++)vt=(W-Z)/(W-ht),vt<0?vt=0:vt>1&&(vt=1),p[et++]=nt-(nt-pt)*vt|0,p[et++]=J-(J-dt)*vt|0,p[et++]=at-(at-Tt)*vt|0,p[et++]=255}}function g(_,x,w){const y=x.coords,o=x.colors;let h,F;switch(x.type){case"lattice":const m=x.verticesPerRow,l=Math.floor(y.length/m)-1,R=m-1;for(h=0;h<l;h++){let p=h*m;for(let $=0;$<R;$++,p++)C(_,w,y[p],y[p+1],y[p+m],o[p],o[p+1],o[p+m]),C(_,w,y[p+m+1],y[p+1],y[p+m],o[p+m+1],o[p+1],o[p+m])}break;case"triangles":for(h=0,F=y.length;h<F;h+=3)C(_,w,y[h],y[h+1],y[h+2],o[h],o[h+1],o[h+2]);break;default:throw new Error("illegal figure")}}class L extends ct{constructor(x){super(),this._coords=x[2],this._colors=x[3],this._figures=x[4],this._bounds=x[5],this._bbox=x[7],this._background=x[8],this.matrix=null}_createMeshCanvas(x,w,y){const m=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),R=Math.ceil(this._bounds[2])-m,p=Math.ceil(this._bounds[3])-l,$=Math.min(Math.ceil(Math.abs(R*x[0]*1.1)),3e3),G=Math.min(Math.ceil(Math.abs(p*x[1]*1.1)),3e3),S=R/$,X=p/G,it={coords:this._coords,colors:this._colors,offsetX:-m,offsetY:-l,scaleX:1/S,scaleY:1/X},rt=$+2*2,H=G+2*2,lt=y.getCanvas("mesh",rt,H,!1),gt=lt.context,Et=gt.createImageData($,G);if(w){const P=Et.data;for(let i=0,a=P.length;i<a;i+=4)P[i]=w[0],P[i+1]=w[1],P[i+2]=w[2],P[i+3]=255}for(const P of this._figures)g(Et,P,it);return gt.putImageData(Et,2,2),{canvas:lt.canvas,offsetX:m-2*S,offsetY:l-2*X,scaleX:S,scaleY:X}}getPattern(x,w,y,o){U(x,this._bbox);let h;if(o===z.SHADING)h=r.Util.singularValueDecompose2dScale((0,f.getCurrentTransform)(x));else if(h=r.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const m=r.Util.singularValueDecompose2dScale(this.matrix);h=[h[0]*m[0],h[1]*m[1]]}const F=this._createMeshCanvas(h,o===z.SHADING?null:this._background,w.cachedCanvases);return o!==z.SHADING&&(x.setTransform(...w.baseTransform),this.matrix&&x.transform(...this.matrix)),x.translate(F.offsetX,F.offsetY),x.scale(F.scaleX,F.scaleY),x.createPattern(F.canvas,"no-repeat")}}class O extends ct{getPattern(){return"hotpink"}}function T(_){switch(_[0]){case"RadialAxial":return new D(_);case"Mesh":return new L(_);case"Dummy":return new O}throw new Error(`Unknown IR type: ${_[0]}`)}const v={COLORED:1,UNCOLORED:2},u=class u{constructor(x,w,y,o,h){this.operatorList=x[2],this.matrix=x[3]||[1,0,0,1,0,0],this.bbox=x[4],this.xstep=x[5],this.ystep=x[6],this.paintType=x[7],this.tilingType=x[8],this.color=w,this.ctx=y,this.canvasGraphicsFactory=o,this.baseTransform=h}createPatternCanvas(x){const w=this.operatorList,y=this.bbox,o=this.xstep,h=this.ystep,F=this.paintType,m=this.tilingType,l=this.color,R=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+m);const p=y[0],$=y[1],G=y[2],S=y[3],X=r.Util.singularValueDecompose2dScale(this.matrix),it=r.Util.singularValueDecompose2dScale(this.baseTransform),rt=[X[0]*it[0],X[1]*it[1]],H=this.getSizeAndScale(o,this.ctx.canvas.width,rt[0]),lt=this.getSizeAndScale(h,this.ctx.canvas.height,rt[1]),gt=x.cachedCanvases.getCanvas("pattern",H.size,lt.size,!0),Et=gt.context,xt=R.createCanvasGraphics(Et);xt.groupLevel=x.groupLevel,this.setFillAndStrokeStyleToContext(xt,F,l);let P=p,i=$,a=G,s=S;return p<0&&(P=0,a+=Math.abs(p)),$<0&&(i=0,s+=Math.abs($)),Et.translate(-(H.scale*P),-(lt.scale*i)),xt.transform(H.scale,0,0,lt.scale,0,0),Et.save(),this.clipBbox(xt,P,i,a,s),xt.baseTransform=(0,f.getCurrentTransform)(xt.ctx),xt.executeOperatorList(w),xt.endDrawing(),{canvas:gt.canvas,scaleX:H.scale,scaleY:lt.scale,offsetX:P,offsetY:i}}getSizeAndScale(x,w,y){x=Math.abs(x);const o=Math.max(u.MAX_PATTERN_SIZE,w);let h=Math.ceil(x*y);return h>=o?h=o:y=h/x,{scale:y,size:h}}clipBbox(x,w,y,o,h){const F=o-w,m=h-y;x.ctx.rect(w,y,F,m),x.current.updateRectMinMax((0,f.getCurrentTransform)(x.ctx),[w,y,o,h]),x.clip(),x.endPath()}setFillAndStrokeStyleToContext(x,w,y){const o=x.ctx,h=x.current;switch(w){case v.COLORED:const F=this.ctx;o.fillStyle=F.fillStyle,o.strokeStyle=F.strokeStyle,h.fillColor=F.fillStyle,h.strokeColor=F.strokeStyle;break;case v.UNCOLORED:const m=r.Util.makeHexColor(y[0],y[1],y[2]);o.fillStyle=m,o.strokeStyle=m,h.fillColor=m,h.strokeColor=m;break;default:throw new r.FormatError(`Unsupported paint type: ${w}`)}}getPattern(x,w,y,o){let h=y;o!==z.SHADING&&(h=r.Util.transform(h,w.baseTransform),this.matrix&&(h=r.Util.transform(h,this.matrix)));const F=this.createPatternCanvas(w);let m=new DOMMatrix(h);m=m.translate(F.offsetX,F.offsetY),m=m.scale(1/F.scaleX,1/F.scaleY);const l=x.createPattern(F.canvas,"repeat");return l.setTransform(m),l}};ee(u,"MAX_PATTERN_SIZE",3e3);let A=u;e.TilingPattern=A},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=z,e.convertToRGBA=f,e.grayToRGBA=ct;var r=I(1);function f(D){switch(D.kind){case r.ImageKind.GRAYSCALE_1BPP:return z(D);case r.ImageKind.RGB_24BPP:return U(D)}return null}function z({src:D,srcPos:C=0,dest:g,width:L,height:O,nonBlackColor:T=4294967295,inverseDecode:v=!1}){const A=r.FeatureTest.isLittleEndian?4278190080:255,[u,_]=v?[T,A]:[A,T],x=L>>3,w=L&7,y=D.length;g=new Uint32Array(g.buffer);let o=0;for(let h=0;h<O;h++){for(const m=C+x;C<m;C++){const l=C<y?D[C]:255;g[o++]=l&128?_:u,g[o++]=l&64?_:u,g[o++]=l&32?_:u,g[o++]=l&16?_:u,g[o++]=l&8?_:u,g[o++]=l&4?_:u,g[o++]=l&2?_:u,g[o++]=l&1?_:u}if(w===0)continue;const F=C<y?D[C++]:255;for(let m=0;m<w;m++)g[o++]=F&1<<7-m?_:u}return{srcPos:C,destPos:o}}function U({src:D,srcPos:C=0,dest:g,destPos:L=0,width:O,height:T}){let v=0;const A=D.length>>2,u=new Uint32Array(D.buffer,C,A);if(r.FeatureTest.isLittleEndian){for(;v<A-2;v+=3,L+=4){const _=u[v],x=u[v+1],w=u[v+2];g[L]=_|4278190080,g[L+1]=_>>>24|x<<8|4278190080,g[L+2]=x>>>16|w<<16|4278190080,g[L+3]=w>>>8|4278190080}for(let _=v*4,x=D.length;_<x;_+=3)g[L++]=D[_]|D[_+1]<<8|D[_+2]<<16|4278190080}else{for(;v<A-2;v+=3,L+=4){const _=u[v],x=u[v+1],w=u[v+2];g[L]=_|255,g[L+1]=_<<24|x>>>8|255,g[L+2]=x<<16|w>>>16|255,g[L+3]=w<<8|255}for(let _=v*4,x=D.length;_<x;_+=3)g[L++]=D[_]<<24|D[_+1]<<16|D[_+2]<<8|255}return{srcPos:C,destPos:L}}function ct(D,C){if(r.FeatureTest.isLittleEndian)for(let g=0,L=D.length;g<L;g++)C[g]=D[g]*65793|4278190080;else for(let g=0,L=D.length;g<L;g++)C[g]=D[g]*16843008|255}},(k,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const I=Object.create(null);e.GlobalWorkerOptions=I,I.workerPort=null,I.workerSrc=""},(k,e,I)=>{var D,Rn,g,kn,O,Pe;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var r=I(1);const f={UNKNOWN:0,DATA:1,ERROR:2},z={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function U(v){switch(v instanceof Error||typeof v=="object"&&v!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),v.name){case"AbortException":return new r.AbortException(v.message);case"MissingPDFException":return new r.MissingPDFException(v.message);case"PasswordException":return new r.PasswordException(v.message,v.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(v.message,v.status);case"UnknownErrorException":return new r.UnknownErrorException(v.message,v.details);default:return new r.UnknownErrorException(v.message,v.toString())}}class ct{constructor(A,u,_){j(this,D);j(this,g);j(this,O);this.sourceName=A,this.targetName=u,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=x=>{const w=x.data;if(w.targetName!==this.sourceName)return;if(w.stream){q(this,g,kn).call(this,w);return}if(w.callback){const o=w.callbackId,h=this.callbackCapabilities[o];if(!h)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],w.callback===f.DATA)h.resolve(w.data);else if(w.callback===f.ERROR)h.reject(U(w.reason));else throw new Error("Unexpected callback case");return}const y=this.actionHandler[w.action];if(!y)throw new Error(`Unknown action from worker: ${w.action}`);if(w.callbackId){const o=this.sourceName,h=w.sourceName;new Promise(function(F){F(y(w.data))}).then(function(F){_.postMessage({sourceName:o,targetName:h,callback:f.DATA,callbackId:w.callbackId,data:F})},function(F){_.postMessage({sourceName:o,targetName:h,callback:f.ERROR,callbackId:w.callbackId,reason:U(F)})});return}if(w.streamId){q(this,D,Rn).call(this,w);return}y(w.data)},_.addEventListener("message",this._onComObjOnMessage)}on(A,u){const _=this.actionHandler;if(_[A])throw new Error(`There is already an actionName called "${A}"`);_[A]=u}send(A,u,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,data:u},_)}sendWithPromise(A,u,_){const x=this.callbackId++,w=new r.PromiseCapability;this.callbackCapabilities[x]=w;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:A,callbackId:x,data:u},_)}catch(y){w.reject(y)}return w.promise}sendWithStream(A,u,_,x){const w=this.streamId++,y=this.sourceName,o=this.targetName,h=this.comObj;return new ReadableStream({start:F=>{const m=new r.PromiseCapability;return this.streamControllers[w]={controller:F,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:y,targetName:o,action:A,streamId:w,data:u,desiredSize:F.desiredSize},x),m.promise},pull:F=>{const m=new r.PromiseCapability;return this.streamControllers[w].pullCall=m,h.postMessage({sourceName:y,targetName:o,stream:z.PULL,streamId:w,desiredSize:F.desiredSize}),m.promise},cancel:F=>{(0,r.assert)(F instanceof Error,"cancel must have a valid reason");const m=new r.PromiseCapability;return this.streamControllers[w].cancelCall=m,this.streamControllers[w].isClosed=!0,h.postMessage({sourceName:y,targetName:o,stream:z.CANCEL,streamId:w,reason:U(F)}),m.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}D=new WeakSet,Rn=function(A){const u=A.streamId,_=this.sourceName,x=A.sourceName,w=this.comObj,y=this,o=this.actionHandler[A.action],h={enqueue(F,m=1,l){if(this.isCancelled)return;const R=this.desiredSize;this.desiredSize-=m,R>0&&this.desiredSize<=0&&(this.sinkCapability=new r.PromiseCapability,this.ready=this.sinkCapability.promise),w.postMessage({sourceName:_,targetName:x,stream:z.ENQUEUE,streamId:u,chunk:F},l)},close(){this.isCancelled||(this.isCancelled=!0,w.postMessage({sourceName:_,targetName:x,stream:z.CLOSE,streamId:u}),delete y.streamSinks[u])},error(F){(0,r.assert)(F instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,w.postMessage({sourceName:_,targetName:x,stream:z.ERROR,streamId:u,reason:U(F)}))},sinkCapability:new r.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:A.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[u]=h,new Promise(function(F){F(o(A.data,h))}).then(function(){w.postMessage({sourceName:_,targetName:x,stream:z.START_COMPLETE,streamId:u,success:!0})},function(F){w.postMessage({sourceName:_,targetName:x,stream:z.START_COMPLETE,streamId:u,reason:U(F)})})},g=new WeakSet,kn=function(A){const u=A.streamId,_=this.sourceName,x=A.sourceName,w=this.comObj,y=this.streamControllers[u],o=this.streamSinks[u];switch(A.stream){case z.START_COMPLETE:A.success?y.startCall.resolve():y.startCall.reject(U(A.reason));break;case z.PULL_COMPLETE:A.success?y.pullCall.resolve():y.pullCall.reject(U(A.reason));break;case z.PULL:if(!o){w.postMessage({sourceName:_,targetName:x,stream:z.PULL_COMPLETE,streamId:u,success:!0});break}o.desiredSize<=0&&A.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=A.desiredSize,new Promise(function(h){var F;h((F=o.onPull)==null?void 0:F.call(o))}).then(function(){w.postMessage({sourceName:_,targetName:x,stream:z.PULL_COMPLETE,streamId:u,success:!0})},function(h){w.postMessage({sourceName:_,targetName:x,stream:z.PULL_COMPLETE,streamId:u,reason:U(h)})});break;case z.ENQUEUE:if((0,r.assert)(y,"enqueue should have stream controller"),y.isClosed)break;y.controller.enqueue(A.chunk);break;case z.CLOSE:if((0,r.assert)(y,"close should have stream controller"),y.isClosed)break;y.isClosed=!0,y.controller.close(),q(this,O,Pe).call(this,y,u);break;case z.ERROR:(0,r.assert)(y,"error should have stream controller"),y.controller.error(U(A.reason)),q(this,O,Pe).call(this,y,u);break;case z.CANCEL_COMPLETE:A.success?y.cancelCall.resolve():y.cancelCall.reject(U(A.reason)),q(this,O,Pe).call(this,y,u);break;case z.CANCEL:if(!o)break;new Promise(function(h){var F;h((F=o.onCancel)==null?void 0:F.call(o,U(A.reason)))}).then(function(){w.postMessage({sourceName:_,targetName:x,stream:z.CANCEL_COMPLETE,streamId:u,success:!0})},function(h){w.postMessage({sourceName:_,targetName:x,stream:z.CANCEL_COMPLETE,streamId:u,reason:U(h)})}),o.sinkCapability.reject(U(A.reason)),o.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}},O=new WeakSet,Pe=async function(A,u){var _,x,w;await Promise.allSettled([(_=A.startCall)==null?void 0:_.promise,(x=A.pullCall)==null?void 0:x.promise,(w=A.cancelCall)==null?void 0:w.promise]),delete this.streamControllers[u]},e.MessageHandler=ct},(k,e,I)=>{var z,U;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var r=I(1);class f{constructor({parsedData:D,rawData:C}){j(this,z,void 0);j(this,U,void 0);st(this,z,D),st(this,U,C)}getRaw(){return t(this,U)}get(D){return t(this,z).get(D)??null}getAll(){return(0,r.objectFromMap)(t(this,z))}has(D){return t(this,z).has(D)}}z=new WeakMap,U=new WeakMap,e.Metadata=f},(k,e,I)=>{var D,C,g,L,O,T,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var r=I(1),f=I(8);const z=Symbol("INTERNAL");class U{constructor(u,_){j(this,D,!0);this.name=u,this.intent=_}get visible(){return t(this,D)}_setVisible(u,_){u!==z&&(0,r.unreachable)("Internal method `_setVisible` called."),st(this,D,_)}}D=new WeakMap;class ct{constructor(u){j(this,T);j(this,C,null);j(this,g,new Map);j(this,L,null);j(this,O,null);if(this.name=null,this.creator=null,u!==null){this.name=u.name,this.creator=u.creator,st(this,O,u.order);for(const _ of u.groups)t(this,g).set(_.id,new U(_.name,_.intent));if(u.baseState==="OFF")for(const _ of t(this,g).values())_._setVisible(z,!1);for(const _ of u.on)t(this,g).get(_)._setVisible(z,!0);for(const _ of u.off)t(this,g).get(_)._setVisible(z,!1);st(this,L,this.getHash())}}isVisible(u){if(t(this,g).size===0)return!0;if(!u)return(0,r.warn)("Optional content group not defined."),!0;if(u.type==="OCG")return t(this,g).has(u.id)?t(this,g).get(u.id).visible:((0,r.warn)(`Optional content group not found: ${u.id}`),!0);if(u.type==="OCMD"){if(u.expression)return q(this,T,tn).call(this,u.expression);if(!u.policy||u.policy==="AnyOn"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,r.warn)(`Optional content group not found: ${_}`),!0;if(t(this,g).get(_).visible)return!0}return!1}else if(u.policy==="AllOn"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,r.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,g).get(_).visible)return!1}return!0}else if(u.policy==="AnyOff"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,r.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,g).get(_).visible)return!0}return!1}else if(u.policy==="AllOff"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,r.warn)(`Optional content group not found: ${_}`),!0;if(t(this,g).get(_).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${u.policy}.`),!0}return(0,r.warn)(`Unknown group type ${u.type}.`),!0}setVisibility(u,_=!0){if(!t(this,g).has(u)){(0,r.warn)(`Optional content group not found: ${u}`);return}t(this,g).get(u)._setVisible(z,!!_),st(this,C,null)}get hasInitialVisibility(){return t(this,L)===null||this.getHash()===t(this,L)}getOrder(){return t(this,g).size?t(this,O)?t(this,O).slice():[...t(this,g).keys()]:null}getGroups(){return t(this,g).size>0?(0,r.objectFromMap)(t(this,g)):null}getGroup(u){return t(this,g).get(u)||null}getHash(){if(t(this,C)!==null)return t(this,C);const u=new f.MurmurHash3_64;for(const[_,x]of t(this,g))u.update(`${_}:${x.visible}`);return st(this,C,u.hexdigest())}}C=new WeakMap,g=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakSet,tn=function(u){const _=u.length;if(_<2)return!0;const x=u[0];for(let w=1;w<_;w++){const y=u[w];let o;if(Array.isArray(y))o=q(this,T,tn).call(this,y);else if(t(this,g).has(y))o=t(this,g).get(y).visible;else return(0,r.warn)(`Optional content group not found: ${y}`),!0;switch(x){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return x==="And"},e.OptionalContentConfig=ct},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var r=I(1),f=I(6);class z{constructor({length:C,initialData:g,progressiveDone:L=!1,contentDispositionFilename:O=null,disableRange:T=!1,disableStream:v=!1},A){if((0,r.assert)(A,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=O,(g==null?void 0:g.length)>0){const u=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=A,this._isStreamingSupported=!v,this._isRangeSupported=!T,this._contentLength=C,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,_)=>{this._onReceiveData({begin:u,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((u,_)=>{this._onProgress({loaded:u,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:C,chunk:g}){const L=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;if(C===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const O=this._rangeReaders.some(function(T){return T._begin!==C?!1:(T._enqueue(L),!0)});(0,r.assert)(O,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}_onProgress(C){var g,L,O,T;C.total===void 0?(L=(g=this._rangeReaders[0])==null?void 0:g.onProgress)==null||L.call(g,{loaded:C.loaded}):(T=(O=this._fullRequestReader)==null?void 0:O.onProgress)==null||T.call(O,{loaded:C.loaded,total:C.total})}_onProgressiveDone(){var C;(C=this._fullRequestReader)==null||C.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(C){const g=this._rangeReaders.indexOf(C);g>=0&&this._rangeReaders.splice(g,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const C=this._queuedChunks;return this._queuedChunks=null,new U(this,C,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(C,g){if(g<=this._progressiveDataLength)return null;const L=new ct(this,C,g);return this._pdfDataRangeTransport.requestDataRange(C,g),this._rangeReaders.push(L),L}cancelAllRequests(C){var g;(g=this._fullRequestReader)==null||g.cancel(C);for(const L of this._rangeReaders.slice(0))L.cancel(C);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=z;class U{constructor(C,g,L=!1,O=null){this._stream=C,this._done=L||!1,this._filename=(0,f.isPdfFile)(O)?O:null,this._queuedChunks=g||[],this._loaded=0;for(const T of this._queuedChunks)this._loaded+=T.byteLength;this._requests=[],this._headersReady=Promise.resolve(),C._fullRequestReader=this,this.onProgress=null}_enqueue(C){this._done||(this._requests.length>0?this._requests.shift().resolve({value:C,done:!1}):this._queuedChunks.push(C),this._loaded+=C.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=new r.PromiseCapability;return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ct{constructor(C,g,L){this._stream=C,this._begin=g,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(C){if(!this._done){if(this._requests.length===0)this._queuedChunk=C;else{this._requests.shift().resolve({value:C,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const C=new r.PromiseCapability;return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var r=I(1),f=I(20);function z(L,O,T){return{method:"GET",headers:L,signal:T.signal,mode:"cors",credentials:O?"include":"same-origin",redirect:"follow"}}function U(L){const O=new Headers;for(const T in L){const v=L[T];v!==void 0&&O.append(T,v)}return O}function ct(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,r.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class D{constructor(O){this.source=O,this.isHttp=/^https?:/i.test(O.url),this.httpHeaders=this.isHttp&&O.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new C(this),this._fullRequestReader}getRangeReader(O,T){if(T<=this._progressiveDataLength)return null;const v=new g(this,O,T);return this._rangeRequestReaders.push(v),v}cancelAllRequests(O){var T;(T=this._fullRequestReader)==null||T.cancel(O);for(const v of this._rangeRequestReaders.slice(0))v.cancel(O)}}e.PDFFetchStream=D;class C{constructor(O){this._stream=O,this._reader=null,this._loaded=0,this._filename=null;const T=O.source;this._withCredentials=T.withCredentials||!1,this._contentLength=T.length,this._headersCapability=new r.PromiseCapability,this._disableRange=T.disableRange||!1,this._rangeChunkSize=T.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._headers=U(this._stream.httpHeaders);const v=T.url;fetch(v,z(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,f.validateResponseStatus)(A.status))throw(0,f.createResponseStatusError)(A.status,v);this._reader=A.body.getReader(),this._headersCapability.resolve();const u=w=>A.headers.get(w),{allowRangeRequests:_,suggestedLength:x}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=x||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var v;await this._headersCapability.promise;const{value:O,done:T}=await this._reader.read();return T?{value:O,done:T}:(this._loaded+=O.byteLength,(v=this.onProgress)==null||v.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ct(O),done:!1})}cancel(O){var T;(T=this._reader)==null||T.cancel(O),this._abortController.abort()}}class g{constructor(O,T,v){this._stream=O,this._reader=null,this._loaded=0;const A=O.source;this._withCredentials=A.withCredentials||!1,this._readCapability=new r.PromiseCapability,this._isStreamingSupported=!A.disableStream,this._abortController=new AbortController,this._headers=U(this._stream.httpHeaders),this._headers.append("Range",`bytes=${T}-${v-1}`);const u=A.url;fetch(u,z(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,f.validateResponseStatus)(_.status))throw(0,f.createResponseStatusError)(_.status,u);this._readCapability.resolve(),this._reader=_.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var v;await this._readCapability.promise;const{value:O,done:T}=await this._reader.read();return T?{value:O,done:T}:(this._loaded+=O.byteLength,(v=this.onProgress)==null||v.call(this,{loaded:this._loaded}),{value:ct(O),done:!1})}cancel(O){var T;(T=this._reader)==null||T.cancel(O),this._abortController.abort()}}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=D,e.extractFilenameFromHeader=ct,e.validateRangeRequestCapabilities=U,e.validateResponseStatus=C;var r=I(1),f=I(21),z=I(6);function U({getResponseHeader:g,isHttp:L,rangeChunkSize:O,disableRange:T}){const v={allowRangeRequests:!1,suggestedLength:void 0},A=parseInt(g("Content-Length"),10);return!Number.isInteger(A)||(v.suggestedLength=A,A<=2*O)||T||!L||g("Accept-Ranges")!=="bytes"||(g("Content-Encoding")||"identity")!=="identity"||(v.allowRangeRequests=!0),v}function ct(g){const L=g("Content-Disposition");if(L){let O=(0,f.getFilenameFromContentDispositionHeader)(L);if(O.includes("%"))try{O=decodeURIComponent(O)}catch{}if((0,z.isPdfFile)(O))return O}return null}function D(g,L){return g===404||g===0&&L.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+L+'".'):new r.UnexpectedResponseException(`Unexpected server response (${g}) while retrieving PDF "${L}".`,g)}function C(g){return g===200||g===206}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=f;var r=I(1);function f(z){let U=!0,ct=D("filename\\*","i").exec(z);if(ct){ct=ct[1];let A=O(ct);return A=unescape(A),A=T(A),A=v(A),g(A)}if(ct=L(z),ct){const A=v(ct);return g(A)}if(ct=D("filename","i").exec(z),ct){ct=ct[1];let A=O(ct);return A=v(A),g(A)}function D(A,u){return new RegExp("(?:^|;)\\s*"+A+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function C(A,u){if(A){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const _=new TextDecoder(A,{fatal:!0}),x=(0,r.stringToBytes)(u);u=_.decode(x),U=!1}catch{}}return u}function g(A){return U&&/[\x80-\xff]/.test(A)&&(A=C("utf-8",A),U&&(A=C("iso-8859-1",A))),A}function L(A){const u=[];let _;const x=D("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=x.exec(A))!==null;){let[,y,o,h]=_;if(y=parseInt(y,10),y in u){if(y===0)break;continue}u[y]=[o,h]}const w=[];for(let y=0;y<u.length&&y in u;++y){let[o,h]=u[y];h=O(h),o&&(h=unescape(h),y===0&&(h=T(h))),w.push(h)}return w.join("")}function O(A){if(A.startsWith('"')){const u=A.slice(1).split('\\"');for(let _=0;_<u.length;++_){const x=u[_].indexOf('"');x!==-1&&(u[_]=u[_].slice(0,x),u.length=_+1),u[_]=u[_].replaceAll(/\\(.)/g,"$1")}A=u.join('"')}return A}function T(A){const u=A.indexOf("'");if(u===-1)return A;const _=A.slice(0,u),w=A.slice(u+1).replace(/^[^']*'/,"");return C(_,w)}function v(A){return!A.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(A)?A:A.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,_,x,w){if(x==="q"||x==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,o){return String.fromCharCode(parseInt(o,16))}),C(_,w);try{w=atob(w)}catch{}return C(_,w)})}return""}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var r=I(1),f=I(20);const z=200,U=206;function ct(O){const T=O.response;return typeof T!="string"?T:(0,r.stringToBytes)(T).buffer}class D{constructor(T,v={}){this.url=T,this.isHttp=/^https?:/i.test(T),this.httpHeaders=this.isHttp&&v.httpHeaders||Object.create(null),this.withCredentials=v.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(T,v,A){const u={begin:T,end:v};for(const _ in A)u[_]=A[_];return this.request(u)}requestFull(T){return this.request(T)}request(T){const v=new XMLHttpRequest,A=this.currXhrId++,u=this.pendingRequests[A]={xhr:v};v.open("GET",this.url),v.withCredentials=this.withCredentials;for(const _ in this.httpHeaders){const x=this.httpHeaders[_];x!==void 0&&v.setRequestHeader(_,x)}return this.isHttp&&"begin"in T&&"end"in T?(v.setRequestHeader("Range",`bytes=${T.begin}-${T.end-1}`),u.expectedStatus=U):u.expectedStatus=z,v.responseType="arraybuffer",T.onError&&(v.onerror=function(_){T.onError(v.status)}),v.onreadystatechange=this.onStateChange.bind(this,A),v.onprogress=this.onProgress.bind(this,A),u.onHeadersReceived=T.onHeadersReceived,u.onDone=T.onDone,u.onError=T.onError,u.onProgress=T.onProgress,v.send(null),A}onProgress(T,v){var u;const A=this.pendingRequests[T];A&&((u=A.onProgress)==null||u.call(A,v))}onStateChange(T,v){var y,o,h;const A=this.pendingRequests[T];if(!A)return;const u=A.xhr;if(u.readyState>=2&&A.onHeadersReceived&&(A.onHeadersReceived(),delete A.onHeadersReceived),u.readyState!==4||!(T in this.pendingRequests))return;if(delete this.pendingRequests[T],u.status===0&&this.isHttp){(y=A.onError)==null||y.call(A,u.status);return}const _=u.status||z;if(!(_===z&&A.expectedStatus===U)&&_!==A.expectedStatus){(o=A.onError)==null||o.call(A,u.status);return}const w=ct(u);if(_===U){const F=u.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(F);A.onDone({begin:parseInt(m[1],10),chunk:w})}else w?A.onDone({begin:0,chunk:w}):(h=A.onError)==null||h.call(A,u.status)}getRequestXhr(T){return this.pendingRequests[T].xhr}isPendingRequest(T){return T in this.pendingRequests}abortRequest(T){const v=this.pendingRequests[T].xhr;delete this.pendingRequests[T],v.abort()}}class C{constructor(T){this._source=T,this._manager=new D(T.url,{httpHeaders:T.httpHeaders,withCredentials:T.withCredentials}),this._rangeChunkSize=T.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(T){const v=this._rangeRequestReaders.indexOf(T);v>=0&&this._rangeRequestReaders.splice(v,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader}getRangeReader(T,v){const A=new L(this._manager,T,v);return A.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(A),A}cancelAllRequests(T){var v;(v=this._fullRequestReader)==null||v.cancel(T);for(const A of this._rangeRequestReaders.slice(0))A.cancel(T)}}e.PDFNetworkStream=C;class g{constructor(T,v){this._manager=T;const A={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._fullRequestId=T.requestFull(A),this._headersReceivedCapability=new r.PromiseCapability,this._disableRange=v.disableRange||!1,this._contentLength=v.length,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const T=this._fullRequestId,v=this._manager.getRequestXhr(T),A=x=>v.getResponseHeader(x),{allowRangeRequests:u,suggestedLength:_}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});u&&(this._isRangeSupported=!0),this._contentLength=_||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(A),this._isRangeSupported&&this._manager.abortRequest(T),this._headersReceivedCapability.resolve()}_onDone(T){if(T&&(this._requests.length>0?this._requests.shift().resolve({value:T.chunk,done:!1}):this._cachedChunks.push(T.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(T){this._storedError=(0,f.createResponseStatusError)(T,this._url),this._headersReceivedCapability.reject(this._storedError);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(T){var v;(v=this.onProgress)==null||v.call(this,{loaded:T.loaded,total:T.lengthComputable?T.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=new r.PromiseCapability;return this._requests.push(T),T.promise}cancel(T){this._done=!0,this._headersReceivedCapability.reject(T);for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(T,v,A){this._manager=T;const u={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=T.url,this._requestId=T.requestRange(v,A,u),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var T;(T=this.onClosed)==null||T.call(this,this)}_onDone(T){const v=T.chunk;this._requests.length>0?this._requests.shift().resolve({value:v,done:!1}):this._queuedChunk=v,this._done=!0;for(const A of this._requests)A.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(T){this._storedError=(0,f.createResponseStatusError)(T,this._url);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(T){var v;this.isStreamingSupported||(v=this.onProgress)==null||v.call(this,{loaded:T.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const T=new r.PromiseCapability;return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var r=I(1),f=I(20);const z=/^file:\/\/\/[a-zA-Z]:\//;function U(A){const u=require$$5,_=u.parse(A);return _.protocol==="file:"||_.host?_:/^[a-z]:[/\\]/i.test(A)?u.parse(`file:///${A}`):(_.host||(_.protocol="file:"),_)}class ct{constructor(u){this.source=u,this.url=U(u.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var u;return((u=this._fullRequestReader)==null?void 0:u._loaded)??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new T(this):new L(this),this._fullRequestReader}getRangeReader(u,_){if(_<=this._progressiveDataLength)return null;const x=this.isFsUrl?new v(this,u,_):new O(this,u,_);return this._rangeRequestReaders.push(x),x}cancelAllRequests(u){var _;(_=this._fullRequestReader)==null||_.cancel(u);for(const x of this._rangeRequestReaders.slice(0))x.cancel(u)}}e.PDFNodeStream=ct;class D{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null;const _=u.source;this._contentLength=_.length,this._loaded=0,this._filename=null,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._readableStream=null,this._readCapability=new r.PromiseCapability,this._headersCapability=new r.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=u.length,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",_=>{this._error(_)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class C{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new r.PromiseCapability;const _=u.source;this._isStreamingSupported=!_.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var x;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=u.length,(x=this.onProgress)==null||x.call(this,{loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",_=>{this._error(_)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function g(A,u){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:u}}class L extends D{constructor(u){super(u);const _=x=>{if(x.statusCode===404){const h=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h,this._headersCapability.reject(h);return}this._headersCapability.resolve(),this._setReadableStream(x);const w=h=>this._readableStream.headers[h.toLowerCase()],{allowRangeRequests:y,suggestedLength:o}=(0,f.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:u.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=o||this._contentLength,this._filename=(0,f.extractFilenameFromHeader)(w)};if(this._request=null,this._url.protocol==="http:"){const x=require$$5;this._request=x.request(g(this._url,u.httpHeaders),_)}else{const x=require$$5;this._request=x.request(g(this._url,u.httpHeaders),_)}this._request.on("error",x=>{this._storedError=x,this._headersCapability.reject(x)}),this._request.end()}}class O extends C{constructor(u,_,x){super(u),this._httpHeaders={};for(const y in u.httpHeaders){const o=u.httpHeaders[y];o!==void 0&&(this._httpHeaders[y]=o)}this._httpHeaders.Range=`bytes=${_}-${x-1}`;const w=y=>{if(y.statusCode===404){const o=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(y)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(g(this._url,this._httpHeaders),w)}else{const y=require$$5;this._request=y.request(g(this._url,this._httpHeaders),w)}this._request.on("error",y=>{this._storedError=y}),this._request.end()}}class T extends D{constructor(u){super(u);let _=decodeURIComponent(this._url.path);z.test(this._url.href)&&(_=_.replace(/^\//,""));const x=require$$5;x.lstat(_,(w,y)=>{if(w){w.code==="ENOENT"&&(w=new r.MissingPDFException(`Missing PDF "${_}".`)),this._storedError=w,this._headersCapability.reject(w);return}this._contentLength=y.size,this._setReadableStream(x.createReadStream(_)),this._headersCapability.resolve()})}}class v extends C{constructor(u,_,x){super(u);let w=decodeURIComponent(this._url.path);z.test(this._url.href)&&(w=w.replace(/^\//,""));const y=require$$5;this._setReadableStream(y.createReadStream(w,{start:_,end:x-1}))}}},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var r=I(6),f=I(1);const z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},U="http://www.w3.org/XML/1998/namespace",ct="http://www.w3.org/1999/xlink",D=["butt","round","square"],C=["miter","round","bevel"],g=function(y,o="",h=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!h)return URL.createObjectURL(new Blob([y],{type:o}));const F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let m=`data:${o};base64,`;for(let l=0,R=y.length;l<R;l+=3){const p=y[l]&255,$=y[l+1]&255,G=y[l+2]&255,S=p>>2,X=(p&3)<<4|$>>4,it=l+1<R?($&15)<<2|G>>6:64,rt=l+2<R?G&63:64;m+=F[S]+F[X]+F[it]+F[rt]}return m},L=function(){const y=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,h=new Int32Array(256);for(let G=0;G<256;G++){let S=G;for(let X=0;X<8;X++)S=S&1?3988292384^S>>1&2147483647:S>>1&2147483647;h[G]=S}function F(G,S,X){let it=-1;for(let rt=S;rt<X;rt++){const H=(it^G[rt])&255,lt=h[H];it=it>>>8^lt}return it^-1}function m(G,S,X,it){let rt=it;const H=S.length;X[rt]=H>>24&255,X[rt+1]=H>>16&255,X[rt+2]=H>>8&255,X[rt+3]=H&255,rt+=4,X[rt]=G.charCodeAt(0)&255,X[rt+1]=G.charCodeAt(1)&255,X[rt+2]=G.charCodeAt(2)&255,X[rt+3]=G.charCodeAt(3)&255,rt+=4,X.set(S,rt),rt+=S.length;const lt=F(X,it+4,rt);X[rt]=lt>>24&255,X[rt+1]=lt>>16&255,X[rt+2]=lt>>8&255,X[rt+3]=lt&255}function l(G,S,X){let it=1,rt=0;for(let H=S;H<X;++H)it=(it+(G[H]&255))%65521,rt=(rt+it)%65521;return rt<<16|it}function R(G){if(!f.isNodeJS)return p(G);try{const S=parseInt(process.versions.node)>=8?G:Buffer.from(G),X=require$$5.deflateSync(S,{level:9});return X instanceof Uint8Array?X:new Uint8Array(X)}catch(S){(0,f.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+S)}return p(G)}function p(G){let S=G.length;const X=65535,it=Math.ceil(S/X),rt=new Uint8Array(2+S+it*5+4);let H=0;rt[H++]=120,rt[H++]=156;let lt=0;for(;S>X;)rt[H++]=0,rt[H++]=255,rt[H++]=255,rt[H++]=0,rt[H++]=0,rt.set(G.subarray(lt,lt+X),H),H+=X,lt+=X,S-=X;rt[H++]=1,rt[H++]=S&255,rt[H++]=S>>8&255,rt[H++]=~S&65535&255,rt[H++]=(~S&65535)>>8&255,rt.set(G.subarray(lt),H),H+=G.length-lt;const gt=l(G,0,G.length);return rt[H++]=gt>>24&255,rt[H++]=gt>>16&255,rt[H++]=gt>>8&255,rt[H++]=gt&255,rt}function $(G,S,X,it){const rt=G.width,H=G.height;let lt,gt,Et;const xt=G.data;switch(S){case f.ImageKind.GRAYSCALE_1BPP:gt=0,lt=1,Et=rt+7>>3;break;case f.ImageKind.RGB_24BPP:gt=2,lt=8,Et=rt*3;break;case f.ImageKind.RGBA_32BPP:gt=6,lt=8,Et=rt*4;break;default:throw new Error("invalid format")}const P=new Uint8Array((1+Et)*H);let i=0,a=0;for(let W=0;W<H;++W)P[i++]=0,P.set(xt.subarray(a,a+Et),i),a+=Et,i+=Et;if(S===f.ImageKind.GRAYSCALE_1BPP&&it){i=0;for(let W=0;W<H;W++){i++;for(let nt=0;nt<Et;nt++)P[i++]^=255}}const s=new Uint8Array([rt>>24&255,rt>>16&255,rt>>8&255,rt&255,H>>24&255,H>>16&255,H>>8&255,H&255,lt,gt,0,0,0]),c=R(P),d=y.length+o*3+s.length+c.length,E=new Uint8Array(d);let M=0;return E.set(y,M),M+=y.length,m("IHDR",s,E,M),M+=o+s.length,m("IDATA",c,E,M),M+=o+c.length,m("IEND",new Uint8Array(0),E,M),g(E,"image/png",X)}return function(S,X,it){const rt=S.kind===void 0?f.ImageKind.GRAYSCALE_1BPP:S.kind;return $(S,rt,X,it)}}();class O{constructor(){this.fontSizeScale=1,this.fontWeight=z.fontWeight,this.fontSize=0,this.textMatrix=f.IDENTITY_MATRIX,this.fontMatrix=f.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=f.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,h){this.x=o,this.y=h}}function T(y){let o=[];const h=[];for(const F of y){if(F.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),h.push(o),o=o.at(-1).items;continue}F.fn==="restore"?o=h.pop():o.push(F)}return o}function v(y){if(Number.isInteger(y))return y.toString();const o=y.toFixed(10);let h=o.length-1;if(o[h]!=="0")return o;do h--;while(o[h]==="0");return o.substring(0,o[h]==="."?h:h+1)}function A(y){if(y[4]===0&&y[5]===0){if(y[1]===0&&y[2]===0)return y[0]===1&&y[3]===1?"":`scale(${v(y[0])} ${v(y[3])})`;if(y[0]===y[3]&&y[1]===-y[2]){const o=Math.acos(y[0])*180/Math.PI;return`rotate(${v(o)})`}}else if(y[0]===1&&y[1]===0&&y[2]===0&&y[3]===1)return`translate(${v(y[4])} ${v(y[5])})`;return`matrix(${v(y[0])} ${v(y[1])} ${v(y[2])} ${v(y[3])} ${v(y[4])} ${v(y[5])})`}let u=0,_=0,x=0;class w{constructor(o,h,F=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new O,this.transformMatrix=f.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=o,this.objs=h,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!F,this._operatorIdMapping=[];for(const m in f.OPS)this._operatorIdMapping[f.OPS[m]]=m}getObject(o,h=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):h}save(){this.transformStack.push(this.transformMatrix);const o=this.current;this.extraStack.push(o),this.current=o.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(o){this.save(),this.executeOpTree(o),this.restore()}loadDependencies(o){const h=o.fnArray,F=o.argsArray;for(let m=0,l=h.length;m<l;m++)if(h[m]===f.OPS.dependency)for(const R of F[m]){const p=R.startsWith("g_")?this.commonObjs:this.objs,$=new Promise(G=>{p.get(R,G)});this.current.dependencies.push($)}return Promise.all(this.current.dependencies)}transform(o,h,F,m,l,R){const p=[o,h,F,m,l,R];this.transformMatrix=f.Util.transform(this.transformMatrix,p),this.tgrp=null}getSVG(o,h){this.viewport=h;const F=this._initialize(h);return this.loadDependencies(o).then(()=>(this.transformMatrix=f.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(o)),F))}convertOpList(o){const h=this._operatorIdMapping,F=o.argsArray,m=o.fnArray,l=[];for(let R=0,p=m.length;R<p;R++){const $=m[R];l.push({fnId:$,fn:h[$],args:F[R]})}return T(l)}executeOpTree(o){for(const h of o){const F=h.fn,m=h.fnId,l=h.args;switch(m|0){case f.OPS.beginText:this.beginText();break;case f.OPS.dependency:break;case f.OPS.setLeading:this.setLeading(l);break;case f.OPS.setLeadingMoveText:this.setLeadingMoveText(l[0],l[1]);break;case f.OPS.setFont:this.setFont(l);break;case f.OPS.showText:this.showText(l[0]);break;case f.OPS.showSpacedText:this.showText(l[0]);break;case f.OPS.endText:this.endText();break;case f.OPS.moveText:this.moveText(l[0],l[1]);break;case f.OPS.setCharSpacing:this.setCharSpacing(l[0]);break;case f.OPS.setWordSpacing:this.setWordSpacing(l[0]);break;case f.OPS.setHScale:this.setHScale(l[0]);break;case f.OPS.setTextMatrix:this.setTextMatrix(l[0],l[1],l[2],l[3],l[4],l[5]);break;case f.OPS.setTextRise:this.setTextRise(l[0]);break;case f.OPS.setTextRenderingMode:this.setTextRenderingMode(l[0]);break;case f.OPS.setLineWidth:this.setLineWidth(l[0]);break;case f.OPS.setLineJoin:this.setLineJoin(l[0]);break;case f.OPS.setLineCap:this.setLineCap(l[0]);break;case f.OPS.setMiterLimit:this.setMiterLimit(l[0]);break;case f.OPS.setFillRGBColor:this.setFillRGBColor(l[0],l[1],l[2]);break;case f.OPS.setStrokeRGBColor:this.setStrokeRGBColor(l[0],l[1],l[2]);break;case f.OPS.setStrokeColorN:this.setStrokeColorN(l);break;case f.OPS.setFillColorN:this.setFillColorN(l);break;case f.OPS.shadingFill:this.shadingFill(l[0]);break;case f.OPS.setDash:this.setDash(l[0],l[1]);break;case f.OPS.setRenderingIntent:this.setRenderingIntent(l[0]);break;case f.OPS.setFlatness:this.setFlatness(l[0]);break;case f.OPS.setGState:this.setGState(l[0]);break;case f.OPS.fill:this.fill();break;case f.OPS.eoFill:this.eoFill();break;case f.OPS.stroke:this.stroke();break;case f.OPS.fillStroke:this.fillStroke();break;case f.OPS.eoFillStroke:this.eoFillStroke();break;case f.OPS.clip:this.clip("nonzero");break;case f.OPS.eoClip:this.clip("evenodd");break;case f.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case f.OPS.paintImageXObject:this.paintImageXObject(l[0]);break;case f.OPS.paintInlineImageXObject:this.paintInlineImageXObject(l[0]);break;case f.OPS.paintImageMaskXObject:this.paintImageMaskXObject(l[0]);break;case f.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(l[0],l[1]);break;case f.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case f.OPS.closePath:this.closePath();break;case f.OPS.closeStroke:this.closeStroke();break;case f.OPS.closeFillStroke:this.closeFillStroke();break;case f.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case f.OPS.nextLine:this.nextLine();break;case f.OPS.transform:this.transform(l[0],l[1],l[2],l[3],l[4],l[5]);break;case f.OPS.constructPath:this.constructPath(l[0],l[1]);break;case f.OPS.endPath:this.endPath();break;case 92:this.group(h.items);break;default:(0,f.warn)(`Unimplemented operator ${F}`);break}}}setWordSpacing(o){this.current.wordSpacing=o}setCharSpacing(o){this.current.charSpacing=o}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(o,h,F,m,l,R){const p=this.current;p.textMatrix=p.lineMatrix=[o,h,F,m,l,R],p.textMatrixScale=Math.hypot(o,h),p.x=p.lineX=0,p.y=p.lineY=0,p.xcoords=[],p.ycoords=[],p.tspan=this.svgFactory.createElement("svg:tspan"),p.tspan.setAttributeNS(null,"font-family",p.fontFamily),p.tspan.setAttributeNS(null,"font-size",`${v(p.fontSize)}px`),p.tspan.setAttributeNS(null,"y",v(-p.y)),p.txtElement=this.svgFactory.createElement("svg:text"),p.txtElement.append(p.tspan)}beginText(){const o=this.current;o.x=o.lineX=0,o.y=o.lineY=0,o.textMatrix=f.IDENTITY_MATRIX,o.lineMatrix=f.IDENTITY_MATRIX,o.textMatrixScale=1,o.tspan=this.svgFactory.createElement("svg:tspan"),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtgrp=this.svgFactory.createElement("svg:g"),o.xcoords=[],o.ycoords=[]}moveText(o,h){const F=this.current;F.x=F.lineX+=o,F.y=F.lineY+=h,F.xcoords=[],F.ycoords=[],F.tspan=this.svgFactory.createElement("svg:tspan"),F.tspan.setAttributeNS(null,"font-family",F.fontFamily),F.tspan.setAttributeNS(null,"font-size",`${v(F.fontSize)}px`),F.tspan.setAttributeNS(null,"y",v(-F.y))}showText(o){const h=this.current,F=h.font,m=h.fontSize;if(m===0)return;const l=h.fontSizeScale,R=h.charSpacing,p=h.wordSpacing,$=h.fontDirection,G=h.textHScale*$,S=F.vertical,X=S?1:-1,it=F.defaultVMetrics,rt=m*h.fontMatrix[0];let H=0;for(const Et of o){if(Et===null){H+=$*p;continue}else if(typeof Et=="number"){H+=X*Et*m/1e3;continue}const xt=(Et.isSpace?p:0)+R,P=Et.fontChar;let i,a,s=Et.width;if(S){let d;const E=Et.vmetric||it;d=Et.vmetric?E[1]:s*.5,d=-d*rt;const M=E[2]*rt;s=E?-E[0]:s,i=d/l,a=(H+M)/l}else i=H/l,a=0;(Et.isInFont||F.missingFile)&&(h.xcoords.push(h.x+i),S&&h.ycoords.push(-h.y+a),h.tspan.textContent+=P);const c=S?s*rt-xt*$:s*rt+xt*$;H+=c}h.tspan.setAttributeNS(null,"x",h.xcoords.map(v).join(" ")),S?h.tspan.setAttributeNS(null,"y",h.ycoords.map(v).join(" ")):h.tspan.setAttributeNS(null,"y",v(-h.y)),S?h.y-=H:h.x+=H*G,h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${v(h.fontSize)}px`),h.fontStyle!==z.fontStyle&&h.tspan.setAttributeNS(null,"font-style",h.fontStyle),h.fontWeight!==z.fontWeight&&h.tspan.setAttributeNS(null,"font-weight",h.fontWeight);const lt=h.textRenderingMode&f.TextRenderingMode.FILL_STROKE_MASK;if(lt===f.TextRenderingMode.FILL||lt===f.TextRenderingMode.FILL_STROKE?(h.fillColor!==z.fillColor&&h.tspan.setAttributeNS(null,"fill",h.fillColor),h.fillAlpha<1&&h.tspan.setAttributeNS(null,"fill-opacity",h.fillAlpha)):h.textRenderingMode===f.TextRenderingMode.ADD_TO_PATH?h.tspan.setAttributeNS(null,"fill","transparent"):h.tspan.setAttributeNS(null,"fill","none"),lt===f.TextRenderingMode.STROKE||lt===f.TextRenderingMode.FILL_STROKE){const Et=1/(h.textMatrixScale||1);this._setStrokeAttributes(h.tspan,Et)}let gt=h.textMatrix;h.textRise!==0&&(gt=gt.slice(),gt[5]+=h.textRise),h.txtElement.setAttributeNS(null,"transform",`${A(gt)} scale(${v(G)}, -1)`),h.txtElement.setAttributeNS(U,"xml:space","preserve"),h.txtElement.append(h.tspan),h.txtgrp.append(h.txtElement),this._ensureTransformGroup().append(h.txtElement)}setLeadingMoveText(o,h){this.setLeading(-h),this.moveText(o,h)}addFontStyle(o){if(!o.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const h=g(o.data,o.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${o.loadedName}"; src: url(${h}); }
`}setFont(o){const h=this.current,F=this.commonObjs.get(o[0]);let m=o[1];h.font=F,this.embedFonts&&!F.missingFile&&!this.embeddedFonts[F.loadedName]&&(this.addFontStyle(F),this.embeddedFonts[F.loadedName]=F),h.fontMatrix=F.fontMatrix||f.FONT_IDENTITY_MATRIX;let l="normal";F.black?l="900":F.bold&&(l="bold");const R=F.italic?"italic":"normal";m<0?(m=-m,h.fontDirection=-1):h.fontDirection=1,h.fontSize=m,h.fontFamily=F.loadedName,h.fontWeight=l,h.fontStyle=R,h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"y",v(-h.y)),h.xcoords=[],h.ycoords=[]}endText(){var h;const o=this.current;o.textRenderingMode&f.TextRenderingMode.ADD_TO_PATH_FLAG&&((h=o.txtElement)!=null&&h.hasChildNodes())&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(o){o>0&&(this.current.lineWidth=o)}setLineCap(o){this.current.lineCap=D[o]}setLineJoin(o){this.current.lineJoin=C[o]}setMiterLimit(o){this.current.miterLimit=o}setStrokeAlpha(o){this.current.strokeAlpha=o}setStrokeRGBColor(o,h,F){this.current.strokeColor=f.Util.makeHexColor(o,h,F)}setFillAlpha(o){this.current.fillAlpha=o}setFillRGBColor(o,h,F){this.current.fillColor=f.Util.makeHexColor(o,h,F),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(o){this.current.strokeColor=this._makeColorN_Pattern(o)}setFillColorN(o){this.current.fillColor=this._makeColorN_Pattern(o)}shadingFill(o){const{width:h,height:F}=this.viewport,m=f.Util.inverseTransform(this.transformMatrix),[l,R,p,$]=f.Util.getAxialAlignedBoundingBox([0,0,h,F],m),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x",l),G.setAttributeNS(null,"y",R),G.setAttributeNS(null,"width",p-l),G.setAttributeNS(null,"height",$-R),G.setAttributeNS(null,"fill",this._makeShadingPattern(o)),this.current.fillAlpha<1&&G.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(G)}_makeColorN_Pattern(o){return o[0]==="TilingPattern"?this._makeTilingPattern(o):this._makeShadingPattern(o)}_makeTilingPattern(o){const h=o[1],F=o[2],m=o[3]||f.IDENTITY_MATRIX,[l,R,p,$]=o[4],G=o[5],S=o[6],X=o[7],it=`shading${x++}`,[rt,H,lt,gt]=f.Util.normalizeRect([...f.Util.applyTransform([l,R],m),...f.Util.applyTransform([p,$],m)]),[Et,xt]=f.Util.singularValueDecompose2dScale(m),P=G*Et,i=S*xt,a=this.svgFactory.createElement("svg:pattern");a.setAttributeNS(null,"id",it),a.setAttributeNS(null,"patternUnits","userSpaceOnUse"),a.setAttributeNS(null,"width",P),a.setAttributeNS(null,"height",i),a.setAttributeNS(null,"x",`${rt}`),a.setAttributeNS(null,"y",`${H}`);const s=this.svg,c=this.transformMatrix,d=this.current.fillColor,E=this.current.strokeColor,M=this.svgFactory.create(lt-rt,gt-H);if(this.svg=M,this.transformMatrix=m,X===2){const W=f.Util.makeHexColor(...h);this.current.fillColor=W,this.current.strokeColor=W}return this.executeOpTree(this.convertOpList(F)),this.svg=s,this.transformMatrix=c,this.current.fillColor=d,this.current.strokeColor=E,a.append(M.childNodes[0]),this.defs.append(a),`url(#${it})`}_makeShadingPattern(o){switch(typeof o=="string"&&(o=this.objs.get(o)),o[0]){case"RadialAxial":const h=`shading${x++}`,F=o[3];let m;switch(o[1]){case"axial":const l=o[4],R=o[5];m=this.svgFactory.createElement("svg:linearGradient"),m.setAttributeNS(null,"id",h),m.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),m.setAttributeNS(null,"x1",l[0]),m.setAttributeNS(null,"y1",l[1]),m.setAttributeNS(null,"x2",R[0]),m.setAttributeNS(null,"y2",R[1]);break;case"radial":const p=o[4],$=o[5],G=o[6],S=o[7];m=this.svgFactory.createElement("svg:radialGradient"),m.setAttributeNS(null,"id",h),m.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),m.setAttributeNS(null,"cx",$[0]),m.setAttributeNS(null,"cy",$[1]),m.setAttributeNS(null,"r",S),m.setAttributeNS(null,"fx",p[0]),m.setAttributeNS(null,"fy",p[1]),m.setAttributeNS(null,"fr",G);break;default:throw new Error(`Unknown RadialAxial type: ${o[1]}`)}for(const l of F){const R=this.svgFactory.createElement("svg:stop");R.setAttributeNS(null,"offset",l[0]),R.setAttributeNS(null,"stop-color",l[1]),m.append(R)}return this.defs.append(m),`url(#${h})`;case"Mesh":return(0,f.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${o[0]}`)}}setDash(o,h){this.current.dashArray=o,this.current.dashPhase=h}constructPath(o,h){const F=this.current;let m=F.x,l=F.y,R=[],p=0;for(const $ of o)switch($|0){case f.OPS.rectangle:m=h[p++],l=h[p++];const G=h[p++],S=h[p++],X=m+G,it=l+S;R.push("M",v(m),v(l),"L",v(X),v(l),"L",v(X),v(it),"L",v(m),v(it),"Z");break;case f.OPS.moveTo:m=h[p++],l=h[p++],R.push("M",v(m),v(l));break;case f.OPS.lineTo:m=h[p++],l=h[p++],R.push("L",v(m),v(l));break;case f.OPS.curveTo:m=h[p+4],l=h[p+5],R.push("C",v(h[p]),v(h[p+1]),v(h[p+2]),v(h[p+3]),v(m),v(l)),p+=6;break;case f.OPS.curveTo2:R.push("C",v(m),v(l),v(h[p]),v(h[p+1]),v(h[p+2]),v(h[p+3])),m=h[p+2],l=h[p+3],p+=4;break;case f.OPS.curveTo3:m=h[p+2],l=h[p+3],R.push("C",v(h[p]),v(h[p+1]),v(m),v(l),v(m),v(l)),p+=4;break;case f.OPS.closePath:R.push("Z");break}R=R.join(" "),F.path&&o.length>0&&o[0]!==f.OPS.rectangle&&o[0]!==f.OPS.moveTo?R=F.path.getAttributeNS(null,"d")+R:(F.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(F.path)),F.path.setAttributeNS(null,"d",R),F.path.setAttributeNS(null,"fill","none"),F.element=F.path,F.setCurrentPoint(m,l)}endPath(){const o=this.current;if(o.path=null,!this.pendingClip)return;if(!o.element){this.pendingClip=null;return}const h=`clippath${u++}`,F=this.svgFactory.createElement("svg:clipPath");F.setAttributeNS(null,"id",h),F.setAttributeNS(null,"transform",A(this.transformMatrix));const m=o.element.cloneNode(!0);if(this.pendingClip==="evenodd"?m.setAttributeNS(null,"clip-rule","evenodd"):m.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,F.append(m),this.defs.append(F),o.activeClipUrl){o.clipGroup=null;for(const l of this.extraStack)l.clipGroup=null;F.setAttributeNS(null,"clip-path",o.activeClipUrl)}o.activeClipUrl=`url(#${h})`,this.tgrp=null}clip(o){this.pendingClip=o}closePath(){const o=this.current;if(o.path){const h=`${o.path.getAttributeNS(null,"d")}Z`;o.path.setAttributeNS(null,"d",h)}}setLeading(o){this.current.leading=-o}setTextRise(o){this.current.textRise=o}setTextRenderingMode(o){this.current.textRenderingMode=o}setHScale(o){this.current.textHScale=o/100}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[h,F]of o)switch(h){case"LW":this.setLineWidth(F);break;case"LC":this.setLineCap(F);break;case"LJ":this.setLineJoin(F);break;case"ML":this.setMiterLimit(F);break;case"D":this.setDash(F[0],F[1]);break;case"RI":this.setRenderingIntent(F);break;case"FL":this.setFlatness(F);break;case"Font":this.setFont(F);break;case"CA":this.setStrokeAlpha(F);break;case"ca":this.setFillAlpha(F);break;default:(0,f.warn)(`Unimplemented graphic state operator ${h}`);break}}fill(){const o=this.current;o.element&&(o.element.setAttributeNS(null,"fill",o.fillColor),o.element.setAttributeNS(null,"fill-opacity",o.fillAlpha),this.endPath())}stroke(){const o=this.current;o.element&&(this._setStrokeAttributes(o.element),o.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(o,h=1){const F=this.current;let m=F.dashArray;h!==1&&m.length>0&&(m=m.map(function(l){return h*l})),o.setAttributeNS(null,"stroke",F.strokeColor),o.setAttributeNS(null,"stroke-opacity",F.strokeAlpha),o.setAttributeNS(null,"stroke-miterlimit",v(F.miterLimit)),o.setAttributeNS(null,"stroke-linecap",F.lineCap),o.setAttributeNS(null,"stroke-linejoin",F.lineJoin),o.setAttributeNS(null,"stroke-width",v(h*F.lineWidth)+"px"),o.setAttributeNS(null,"stroke-dasharray",m.map(v).join(" ")),o.setAttributeNS(null,"stroke-dashoffset",v(h*F.dashPhase)+"px")}eoFill(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width","1px"),o.setAttributeNS(null,"height","1px"),o.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(o)}paintImageXObject(o){const h=this.getObject(o);if(!h){(0,f.warn)(`Dependent image with object ID ${o} is not ready yet`);return}this.paintInlineImageXObject(h)}paintInlineImageXObject(o,h){const F=o.width,m=o.height,l=L(o,this.forceDataSchema,!!h),R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y","0"),R.setAttributeNS(null,"width",v(F)),R.setAttributeNS(null,"height",v(m)),this.current.element=R,this.clip("nonzero");const p=this.svgFactory.createElement("svg:image");p.setAttributeNS(ct,"xlink:href",l),p.setAttributeNS(null,"x","0"),p.setAttributeNS(null,"y",v(-m)),p.setAttributeNS(null,"width",v(F)+"px"),p.setAttributeNS(null,"height",v(m)+"px"),p.setAttributeNS(null,"transform",`scale(${v(1/F)} ${v(-1/m)})`),h?h.append(p):this._ensureTransformGroup().append(p)}paintImageMaskXObject(o){const h=this.getObject(o.data,o);if(h.bitmap){(0,f.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const F=this.current,m=h.width,l=h.height,R=F.fillColor;F.maskId=`mask${_++}`;const p=this.svgFactory.createElement("svg:mask");p.setAttributeNS(null,"id",F.maskId);const $=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x","0"),$.setAttributeNS(null,"y","0"),$.setAttributeNS(null,"width",v(m)),$.setAttributeNS(null,"height",v(l)),$.setAttributeNS(null,"fill",R),$.setAttributeNS(null,"mask",`url(#${F.maskId})`),this.defs.append(p),this._ensureTransformGroup().append($),this.paintInlineImageXObject(h,p)}paintFormXObjectBegin(o,h){if(Array.isArray(o)&&o.length===6&&this.transform(o[0],o[1],o[2],o[3],o[4],o[5]),h){const F=h[2]-h[0],m=h[3]-h[1],l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x",h[0]),l.setAttributeNS(null,"y",h[1]),l.setAttributeNS(null,"width",v(F)),l.setAttributeNS(null,"height",v(m)),this.current.element=l,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(o){const h=this.svgFactory.create(o.width,o.height),F=this.svgFactory.createElement("svg:defs");h.append(F),this.defs=F;const m=this.svgFactory.createElement("svg:g");return m.setAttributeNS(null,"transform",A(o.transform)),h.append(m),this.svg=m,h}_ensureClipGroup(){if(!this.current.clipGroup){const o=this.svgFactory.createElement("svg:g");o.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(o),this.current.clipGroup=o}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=w},(k,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class I{static textContent(f){const z=[],U={items:z,styles:Object.create(null)};function ct(D){var L;if(!D)return;let C=null;const g=D.name;if(g==="#text")C=D.value;else if(I.shouldBuildText(g))(L=D==null?void 0:D.attributes)!=null&&L.textContent?C=D.attributes.textContent:D.value&&(C=D.value);else return;if(C!==null&&z.push({str:C}),!!D.children)for(const O of D.children)ct(O)}return ct(f),U}static shouldBuildText(f){return!(f==="textarea"||f==="input"||f==="option"||f==="select")}}e.XfaText=I},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=A,e.updateTextLayer=u;var r=I(1),f=I(6);const z=1e5,U=30,ct=.8,D=new Map;function C(_,x){let w;if(x&&r.FeatureTest.isOffscreenCanvasSupported)w=new OffscreenCanvas(_,_).getContext("2d",{alpha:!1});else{const y=document.createElement("canvas");y.width=y.height=_,w=y.getContext("2d",{alpha:!1})}return w}function g(_,x){const w=D.get(_);if(w)return w;const y=C(U,x);y.font=`${U}px ${_}`;const o=y.measureText("");let h=o.fontBoundingBoxAscent,F=Math.abs(o.fontBoundingBoxDescent);if(h){const l=h/(h+F);return D.set(_,l),y.canvas.width=y.canvas.height=0,l}y.strokeStyle="red",y.clearRect(0,0,U,U),y.strokeText("g",0,0);let m=y.getImageData(0,0,U,U).data;F=0;for(let l=m.length-1-3;l>=0;l-=4)if(m[l]>0){F=Math.ceil(l/4/U);break}y.clearRect(0,0,U,U),y.strokeText("A",0,U),m=y.getImageData(0,0,U,U).data,h=0;for(let l=0,R=m.length;l<R;l+=4)if(m[l]>0){h=U-Math.floor(l/4/U);break}if(y.canvas.width=y.canvas.height=0,h){const l=h/(h+F);return D.set(_,l),l}return D.set(_,ct),ct}function L(_,x,w){const y=document.createElement("span"),o={angle:0,canvasWidth:0,hasText:x.str!=="",hasEOL:x.hasEOL,fontSize:0};_._textDivs.push(y);const h=r.Util.transform(_._transform,x.transform);let F=Math.atan2(h[1],h[0]);const m=w[x.fontName];m.vertical&&(F+=Math.PI/2);const l=Math.hypot(h[2],h[3]),R=l*g(m.fontFamily,_._isOffscreenCanvasSupported);let p,$;F===0?(p=h[4],$=h[5]-R):(p=h[4]+R*Math.sin(F),$=h[5]-R*Math.cos(F));const G="calc(var(--scale-factor)*",S=y.style;_._container===_._rootContainer?(S.left=`${(100*p/_._pageWidth).toFixed(2)}%`,S.top=`${(100*$/_._pageHeight).toFixed(2)}%`):(S.left=`${G}${p.toFixed(2)}px)`,S.top=`${G}${$.toFixed(2)}px)`),S.fontSize=`${G}${l.toFixed(2)}px)`,S.fontFamily=m.fontFamily,o.fontSize=l,y.setAttribute("role","presentation"),y.textContent=x.str,y.dir=x.dir,_._fontInspectorEnabled&&(y.dataset.fontName=x.fontName),F!==0&&(o.angle=F*(180/Math.PI));let X=!1;if(x.str.length>1)X=!0;else if(x.str!==" "&&x.transform[0]!==x.transform[3]){const it=Math.abs(x.transform[0]),rt=Math.abs(x.transform[3]);it!==rt&&Math.max(it,rt)/Math.min(it,rt)>1.5&&(X=!0)}X&&(o.canvasWidth=m.vertical?x.height:x.width),_._textDivProperties.set(y,o),_._isReadableStream&&_._layoutText(y)}function O(_){const{div:x,scale:w,properties:y,ctx:o,prevFontSize:h,prevFontFamily:F}=_,{style:m}=x;let l="";if(y.canvasWidth!==0&&y.hasText){const{fontFamily:R}=m,{canvasWidth:p,fontSize:$}=y;(h!==$||F!==R)&&(o.font=`${$*w}px ${R}`,_.prevFontSize=$,_.prevFontFamily=R);const{width:G}=o.measureText(x.textContent);G>0&&(l=`scaleX(${p*w/G})`)}y.angle!==0&&(l=`rotate(${y.angle}deg) ${l}`),l.length>0&&(m.transform=l)}function T(_){if(_._canceled)return;const x=_._textDivs,w=_._capability;if(x.length>z){w.resolve();return}if(!_._isReadableStream)for(const o of x)_._layoutText(o);w.resolve()}class v{constructor({textContentSource:x,container:w,viewport:y,textDivs:o,textDivProperties:h,textContentItemsStr:F,isOffscreenCanvasSupported:m}){var G;this._textContentSource=x,this._isReadableStream=x instanceof ReadableStream,this._container=this._rootContainer=w,this._textDivs=o||[],this._textContentItemsStr=F||[],this._isOffscreenCanvasSupported=m,this._fontInspectorEnabled=!!((G=globalThis.FontInspector)!=null&&G.enabled),this._reader=null,this._textDivProperties=h||new WeakMap,this._canceled=!1,this._capability=new r.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:C(0,m)};const{pageWidth:l,pageHeight:R,pageX:p,pageY:$}=y.rawDims;this._transform=[1,0,0,-1,-p,$+R],this._pageWidth=l,this._pageHeight=R,(0,f.setLayerDimensions)(w,y),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(x,w){for(const y of x){if(y.str===void 0){if(y.type==="beginMarkedContentProps"||y.type==="beginMarkedContent"){const o=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),y.id!==null&&this._container.setAttribute("id",`${y.id}`),o.append(this._container)}else y.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(y.str),L(this,y,w)}}_layoutText(x){const w=this._layoutTextParams.properties=this._textDivProperties.get(x);if(this._layoutTextParams.div=x,O(this._layoutTextParams),w.hasText&&this._container.append(x),w.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(){const x=new r.PromiseCapability;let w=Object.create(null);if(this._isReadableStream){const y=()=>{this._reader.read().then(({value:o,done:h})=>{if(h){x.resolve();return}Object.assign(w,o.styles),this._processItems(o.items,w),y()},x.reject)};this._reader=this._textContentSource.getReader(),y()}else if(this._textContentSource){const{items:y,styles:o}=this._textContentSource;this._processItems(y,o),x.resolve()}else throw new Error('No "textContentSource" parameter specified.');x.promise.then(()=>{w=null,T(this)},this._capability.reject)}}e.TextLayerRenderTask=v;function A(_){!_.textContentSource&&(_.textContent||_.textContentStream)&&((0,f.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),_.textContentSource=_.textContent||_.textContentStream);const{container:x,viewport:w}=_,y=getComputedStyle(x),o=y.getPropertyValue("visibility"),h=parseFloat(y.getPropertyValue("--scale-factor"));o==="visible"&&(!h||Math.abs(h-w.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const F=new v(_);return F._render(),F}function u({container:_,viewport:x,textDivs:w,textDivProperties:y,isOffscreenCanvasSupported:o,mustRotate:h=!0,mustRescale:F=!0}){if(h&&(0,f.setLayerDimensions)(_,{rotation:x.rotation}),F){const m=C(0,o),R={prevFontSize:null,prevFontFamily:null,div:null,scale:x.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:m};for(const p of w)R.properties=y.get(p),R.div=p,O(R)}}},(k,e,I)=>{var g,L,O,T,v,A,u,_,x,w,y,en,h,Re,m,nn,R,sn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var r=I(1),f=I(4),z=I(28),U=I(33),ct=I(6),D=I(34);const $=class ${constructor({uiManager:S,pageIndex:X,div:it,accessibilityManager:rt,annotationLayer:H,viewport:lt,l10n:gt}){j(this,y);j(this,h);j(this,m);j(this,R);j(this,g,void 0);j(this,L,!1);j(this,O,null);j(this,T,this.pointerup.bind(this));j(this,v,this.pointerdown.bind(this));j(this,A,new Map);j(this,u,!1);j(this,_,!1);j(this,x,!1);j(this,w,void 0);const Et=[z.FreeTextEditor,U.InkEditor,D.StampEditor];if(!$._initialized){$._initialized=!0;for(const xt of Et)xt.initialize(gt)}S.registerEditorTypes(Et),st(this,w,S),this.pageIndex=X,this.div=it,st(this,g,rt),st(this,O,H),this.viewport=lt,t(this,w).addLayer(this)}get isEmpty(){return t(this,A).size===0}updateToolbar(S){t(this,w).updateToolbar(S)}updateMode(S=t(this,w).getMode()){q(this,R,sn).call(this),S===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),S!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",S===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",S===r.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",S===r.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(S){if(!S&&t(this,w).getMode()!==r.AnnotationEditorType.INK)return;if(!S){for(const it of t(this,A).values())if(it.isEmpty()){it.setInBackground();return}}q(this,h,Re).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(S){t(this,w).setEditingState(S)}addCommands(S){t(this,w).addCommands(S)}enable(){this.div.style.pointerEvents="auto";const S=new Set;for(const it of t(this,A).values())it.enableEditing(),it.annotationElementId&&S.add(it.annotationElementId);if(!t(this,O))return;const X=t(this,O).getEditableAnnotations();for(const it of X){if(it.hide(),t(this,w).isDeletedAnnotationElement(it.data.id)||S.has(it.data.id))continue;const rt=this.deserialize(it);rt&&(this.addOrRebuild(rt),rt.enableEditing())}}disable(){var X;st(this,x,!0),this.div.style.pointerEvents="none";const S=new Set;for(const it of t(this,A).values()){if(it.disableEditing(),!it.annotationElementId||it.serialize()!==null){S.add(it.annotationElementId);continue}(X=this.getEditableAnnotation(it.annotationElementId))==null||X.show(),it.remove()}if(t(this,O)){const it=t(this,O).getEditableAnnotations();for(const rt of it){const{id:H}=rt.data;S.has(H)||t(this,w).isDeletedAnnotationElement(H)||rt.show()}}q(this,R,sn).call(this),this.isEmpty&&(this.div.hidden=!0),st(this,x,!1)}getEditableAnnotation(S){var X;return((X=t(this,O))==null?void 0:X.getEditableAnnotation(S))||null}setActiveEditor(S){t(this,w).getActive()!==S&&t(this,w).setActiveEditor(S)}enableClick(){this.div.addEventListener("pointerdown",t(this,v)),this.div.addEventListener("pointerup",t(this,T))}disableClick(){this.div.removeEventListener("pointerdown",t(this,v)),this.div.removeEventListener("pointerup",t(this,T))}attach(S){t(this,A).set(S.id,S);const{annotationElementId:X}=S;X&&t(this,w).isDeletedAnnotationElement(X)&&t(this,w).removeDeletedAnnotationElement(S)}detach(S){var X;t(this,A).delete(S.id),(X=t(this,g))==null||X.removePointerInTextLayer(S.contentDiv),!t(this,x)&&S.annotationElementId&&t(this,w).addDeletedAnnotationElement(S)}remove(S){this.detach(S),t(this,w).removeEditor(S),S.div.contains(document.activeElement)&&setTimeout(()=>{t(this,w).focusMainContainer()},0),S.div.remove(),S.isAttachedToDOM=!1,t(this,_)||this.addInkEditorIfNeeded(!1)}changeParent(S){var X;S.parent!==this&&(S.annotationElementId&&(t(this,w).addDeletedAnnotationElement(S.annotationElementId),f.AnnotationEditor.deleteAnnotationElement(S),S.annotationElementId=null),this.attach(S),(X=S.parent)==null||X.detach(S),S.setParent(this),S.div&&S.isAttachedToDOM&&(S.div.remove(),this.div.append(S.div)))}add(S){if(this.changeParent(S),t(this,w).addEditor(S),this.attach(S),!S.isAttachedToDOM){const X=S.render();this.div.append(X),S.isAttachedToDOM=!0}S.fixAndSetPosition(),S.onceAdded(),t(this,w).addToAnnotationStorage(S)}moveEditorInDOM(S){var it;if(!S.isAttachedToDOM)return;const{activeElement:X}=document;S.div.contains(X)&&(S._focusEventsAllowed=!1,setTimeout(()=>{S.div.contains(document.activeElement)?S._focusEventsAllowed=!0:(S.div.addEventListener("focusin",()=>{S._focusEventsAllowed=!0},{once:!0}),X.focus())},0)),S._structTreeParentId=(it=t(this,g))==null?void 0:it.moveElementInDOM(this.div,S.div,S.contentDiv,!0)}addOrRebuild(S){S.needsToBeRebuilt()?S.rebuild():this.add(S)}addUndoableEditor(S){const X=()=>S._uiManager.rebuild(S),it=()=>{S.remove()};this.addCommands({cmd:X,undo:it,mustExec:!1})}getNextId(){return t(this,w).getId()}pasteEditor(S,X){t(this,w).updateToolbar(S),t(this,w).updateMode(S);const{offsetX:it,offsetY:rt}=q(this,m,nn).call(this),H=this.getNextId(),lt=q(this,y,en).call(this,{parent:this,id:H,x:it,y:rt,uiManager:t(this,w),isCentered:!0,...X});lt&&this.add(lt)}deserialize(S){switch(S.annotationType??S.annotationEditorType){case r.AnnotationEditorType.FREETEXT:return z.FreeTextEditor.deserialize(S,this,t(this,w));case r.AnnotationEditorType.INK:return U.InkEditor.deserialize(S,this,t(this,w));case r.AnnotationEditorType.STAMP:return D.StampEditor.deserialize(S,this,t(this,w))}return null}addNewEditor(){q(this,h,Re).call(this,q(this,m,nn).call(this),!0)}setSelected(S){t(this,w).setSelected(S)}toggleSelected(S){t(this,w).toggleSelected(S)}isSelected(S){return t(this,w).isSelected(S)}unselect(S){t(this,w).unselect(S)}pointerup(S){const{isMac:X}=r.FeatureTest.platform;if(!(S.button!==0||S.ctrlKey&&X)&&S.target===this.div&&t(this,u)){if(st(this,u,!1),!t(this,L)){st(this,L,!0);return}if(t(this,w).getMode()===r.AnnotationEditorType.STAMP){t(this,w).unselectAll();return}q(this,h,Re).call(this,S,!1)}}pointerdown(S){if(t(this,u)){st(this,u,!1);return}const{isMac:X}=r.FeatureTest.platform;if(S.button!==0||S.ctrlKey&&X||S.target!==this.div)return;st(this,u,!0);const it=t(this,w).getActive();st(this,L,!it||it.isEmpty())}findNewParent(S,X,it){const rt=t(this,w).findParent(X,it);return rt===null||rt===this?!1:(rt.changeParent(S),!0)}destroy(){var S,X;((S=t(this,w).getActive())==null?void 0:S.parent)===this&&(t(this,w).commitOrRemove(),t(this,w).setActiveEditor(null));for(const it of t(this,A).values())(X=t(this,g))==null||X.removePointerInTextLayer(it.contentDiv),it.setParent(null),it.isAttachedToDOM=!1,it.div.remove();this.div=null,t(this,A).clear(),t(this,w).removeLayer(this)}render({viewport:S}){this.viewport=S,(0,ct.setLayerDimensions)(this.div,S);for(const X of t(this,w).getEditors(this.pageIndex))this.add(X);this.updateMode()}update({viewport:S}){t(this,w).commitOrRemove(),this.viewport=S,(0,ct.setLayerDimensions)(this.div,{rotation:S.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:S,pageHeight:X}=this.viewport.rawDims;return[S,X]}};g=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakMap,v=new WeakMap,A=new WeakMap,u=new WeakMap,_=new WeakMap,x=new WeakMap,w=new WeakMap,y=new WeakSet,en=function(S){switch(t(this,w).getMode()){case r.AnnotationEditorType.FREETEXT:return new z.FreeTextEditor(S);case r.AnnotationEditorType.INK:return new U.InkEditor(S);case r.AnnotationEditorType.STAMP:return new D.StampEditor(S)}return null},h=new WeakSet,Re=function(S,X){const it=this.getNextId(),rt=q(this,y,en).call(this,{parent:this,id:it,x:S.offsetX,y:S.offsetY,uiManager:t(this,w),isCentered:X});return rt&&this.add(rt),rt},m=new WeakSet,nn=function(){const{x:S,y:X,width:it,height:rt}=this.div.getBoundingClientRect(),H=Math.max(0,S),lt=Math.max(0,X),gt=Math.min(window.innerWidth,S+it),Et=Math.min(window.innerHeight,X+rt),xt=(H+gt)/2-S,P=(lt+Et)/2-X,[i,a]=this.viewport.rotation%180===0?[xt,P]:[P,xt];return{offsetX:i,offsetY:a}},R=new WeakSet,sn=function(){st(this,_,!0);for(const S of t(this,A).values())S.isEmpty()&&S.remove();st(this,_,!1)},ee($,"_initialized",!1);let C=$;e.AnnotationEditorLayer=C},(k,e,I)=>{var D,C,g,L,O,T,v,A,u,_,Mn,w,Fn,o,Dn,F,ye,l,rn,p,Ln,G,an;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var r=I(1),f=I(5),z=I(4),U=I(29);const X=class X extends z.AnnotationEditor{constructor(H){super({...H,name:"freeTextEditor"});j(this,_);j(this,w);j(this,o);j(this,F);j(this,l);j(this,p);j(this,G);j(this,D,this.editorDivBlur.bind(this));j(this,C,this.editorDivFocus.bind(this));j(this,g,this.editorDivInput.bind(this));j(this,L,this.editorDivKeydown.bind(this));j(this,O,void 0);j(this,T,"");j(this,v,`${this.id}-editor`);j(this,A,void 0);j(this,u,null);st(this,O,H.color||X._defaultColor||z.AnnotationEditor._defaultLineColor),st(this,A,H.fontSize||X._defaultFontSize)}static get _keyboardManager(){const H=X.prototype,lt=xt=>xt.isEmpty(),gt=f.AnnotationEditorUIManager.TRANSLATE_SMALL,Et=f.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new f.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],H.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],H.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],H._translateEmpty,{args:[-gt,0],checker:lt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],H._translateEmpty,{args:[-Et,0],checker:lt}],[["ArrowRight","mac+ArrowRight"],H._translateEmpty,{args:[gt,0],checker:lt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],H._translateEmpty,{args:[Et,0],checker:lt}],[["ArrowUp","mac+ArrowUp"],H._translateEmpty,{args:[0,-gt],checker:lt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],H._translateEmpty,{args:[0,-Et],checker:lt}],[["ArrowDown","mac+ArrowDown"],H._translateEmpty,{args:[0,gt],checker:lt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],H._translateEmpty,{args:[0,Et],checker:lt}]]))}static initialize(H){z.AnnotationEditor.initialize(H,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const lt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(lt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(H,lt){switch(H){case r.AnnotationEditorParamsType.FREETEXT_SIZE:X._defaultFontSize=lt;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:X._defaultColor=lt;break}}updateParams(H,lt){switch(H){case r.AnnotationEditorParamsType.FREETEXT_SIZE:q(this,_,Mn).call(this,lt);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:q(this,w,Fn).call(this,lt);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,X._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,X._defaultColor||z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,A)],[r.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,O)]]}_translateEmpty(H,lt){this._uiManager.translateSelectedEditors(H,lt,!0)}getInitialTranslation(){const H=this.parentScale;return[-X._internalPadding*H,-(X._internalPadding+t(this,A))*H]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,C)),this.editorDiv.addEventListener("blur",t(this,D)),this.editorDiv.addEventListener("input",t(this,g)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,v)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,C)),this.editorDiv.removeEventListener("blur",t(this,D)),this.editorDiv.removeEventListener("input",t(this,g)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(H){this._focusEventsAllowed&&(super.focusin(H),H.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var H;if(this.width){q(this,G,an).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(H=this._initialOptions)!=null&&H.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const H=t(this,T),lt=st(this,T,q(this,o,Dn).call(this).trimEnd());if(H===lt)return;const gt=Et=>{if(st(this,T,Et),!Et){this.remove();return}q(this,l,rn).call(this),this._uiManager.rebuild(this),q(this,F,ye).call(this)};this.addCommands({cmd:()=>{gt(lt)},undo:()=>{gt(H)},mustExec:!1}),q(this,F,ye).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(H){this.enterInEditMode()}keydown(H){H.target===this.div&&H.key==="Enter"&&(this.enterInEditMode(),H.preventDefault())}editorDivKeydown(H){X._keyboardManager.exec(this,H)}editorDivFocus(H){this.isEditing=!0}editorDivBlur(H){this.isEditing=!1}editorDivInput(H){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let H,lt;this.width&&(H=this.x,lt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,v)),this.enableEditing(),z.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Et=>{var xt;return(xt=this.editorDiv)==null?void 0:xt.setAttribute("aria-label",Et)}),z.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Et=>{var xt;return(xt=this.editorDiv)==null?void 0:xt.setAttribute("default-content",Et)}),this.editorDiv.contentEditable=!0;const{style:gt}=this.editorDiv;if(gt.fontSize=`calc(${t(this,A)}px * var(--scale-factor))`,gt.color=t(this,O),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,f.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Et,xt]=this.parentDimensions;if(this.annotationElementId){const{position:P}=t(this,u);let[i,a]=this.getInitialTranslation();[i,a]=this.pageTranslationToScreen(i,a);const[s,c]=this.pageDimensions,[d,E]=this.pageTranslation;let M,W;switch(this.rotation){case 0:M=H+(P[0]-d)/s,W=lt+this.height-(P[1]-E)/c;break;case 90:M=H+(P[0]-d)/s,W=lt-(P[1]-E)/c,[i,a]=[a,-i];break;case 180:M=H-this.width+(P[0]-d)/s,W=lt-(P[1]-E)/c,[i,a]=[-i,-a];break;case 270:M=H+(P[0]-d-this.height*c)/s,W=lt+(P[1]-E-this.width*s)/c,[i,a]=[-a,i];break}this.setAt(M*Et,W*xt,i,a)}else this.setAt(H*Et,lt*xt,this.width*Et,this.height*xt);q(this,l,rn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(H,lt,gt){let Et=null;if(H instanceof U.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:P,fontColor:i},rect:a,rotation:s,id:c},textContent:d,textPosition:E,parent:{page:{pageNumber:M}}}=H;if(!d||d.length===0)return null;Et=H={annotationType:r.AnnotationEditorType.FREETEXT,color:Array.from(i),fontSize:P,value:d.join(`
`),position:E,pageIndex:M-1,rect:a,rotation:s,id:c,deleted:!1}}const xt=super.deserialize(H,lt,gt);return st(xt,A,H.fontSize),st(xt,O,r.Util.makeHexColor(...H.color)),st(xt,T,H.value),xt.annotationElementId=H.id||null,st(xt,u,Et),xt}serialize(H=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const lt=X._internalPadding*this.parentScale,gt=this.getRect(lt,lt),Et=z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,O)),xt={annotationType:r.AnnotationEditorType.FREETEXT,color:Et,fontSize:t(this,A),value:t(this,T),pageIndex:this.pageIndex,rect:gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return H?xt:this.annotationElementId&&!q(this,p,Ln).call(this,xt)?null:(xt.id=this.annotationElementId,xt)}};D=new WeakMap,C=new WeakMap,g=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakMap,v=new WeakMap,A=new WeakMap,u=new WeakMap,_=new WeakSet,Mn=function(H){const lt=Et=>{this.editorDiv.style.fontSize=`calc(${Et}px * var(--scale-factor))`,this.translate(0,-(Et-t(this,A))*this.parentScale),st(this,A,Et),q(this,F,ye).call(this)},gt=t(this,A);this.addCommands({cmd:()=>{lt(H)},undo:()=>{lt(gt)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},w=new WeakSet,Fn=function(H){const lt=t(this,O);this.addCommands({cmd:()=>{st(this,O,this.editorDiv.style.color=H)},undo:()=>{st(this,O,this.editorDiv.style.color=lt)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,Dn=function(){const H=this.editorDiv.getElementsByTagName("div");if(H.length===0)return this.editorDiv.innerText;const lt=[];for(const gt of H)lt.push(gt.innerText.replace(/\r\n?|\n/,""));return lt.join(`
`)},F=new WeakSet,ye=function(){const[H,lt]=this.parentDimensions;let gt;if(this.isAttachedToDOM)gt=this.div.getBoundingClientRect();else{const{currentLayer:Et,div:xt}=this,P=xt.style.display;xt.style.display="hidden",Et.div.append(this.div),gt=xt.getBoundingClientRect(),xt.remove(),xt.style.display=P}this.rotation%180===this.parentRotation%180?(this.width=gt.width/H,this.height=gt.height/lt):(this.width=gt.height/H,this.height=gt.width/lt),this.fixAndSetPosition()},l=new WeakSet,rn=function(){if(this.editorDiv.replaceChildren(),!!t(this,T))for(const H of t(this,T).split(`
`)){const lt=document.createElement("div");lt.append(H?document.createTextNode(H):document.createElement("br")),this.editorDiv.append(lt)}},p=new WeakSet,Ln=function(H){const{value:lt,fontSize:gt,color:Et,rect:xt,pageIndex:P}=t(this,u);return H.value!==lt||H.fontSize!==gt||H.rect.some((i,a)=>Math.abs(i-xt[a])>=1)||H.color.some((i,a)=>i!==Et[a])||H.pageIndex!==P},G=new WeakSet,an=function(H=!1){if(!this.annotationElementId)return;if(q(this,F,ye).call(this),!H&&(this.width===0||this.height===0)){setTimeout(()=>q(this,G,an).call(this,!0),0);return}const lt=X._internalPadding*this.parentScale;t(this,u).rect=this.getRect(lt,lt)},ee(X,"_freeTextDefaultContent",""),ee(X,"_internalPadding",0),ee(X,"_defaultColor",null),ee(X,"_defaultFontSize",10),ee(X,"_type","freetext");let ct=X;e.FreeTextEditor=ct},(k,e,I)=>{var a,c,ce,E,In,W,nt,J,at,ht,pt,dt,Tt,Lt,vt,Dt,mt,et,Z,ft,wt,Ct,Ut,On,Wt,ke,zt,on,qt,ln,tt,Y,_t,yt,te,Zt,Q,cn,Ot,Pt,Nt,Bt,Nn,At,hn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var r=I(1),f=I(6),z=I(3),U=I(30),ct=I(31),D=I(32);const C=1e3,g=9,L=new WeakSet;function O(It){return{width:It[2]-It[0],height:It[3]-It[1]}}class T{static create(N){switch(N.data.annotationType){case r.AnnotationType.LINK:return new A(N);case r.AnnotationType.TEXT:return new u(N);case r.AnnotationType.WIDGET:switch(N.data.fieldType){case"Tx":return new x(N);case"Btn":return N.data.radioButton?new o(N):N.data.checkBox?new y(N):new h(N);case"Ch":return new F(N);case"Sig":return new w(N)}return new _(N);case r.AnnotationType.POPUP:return new m(N);case r.AnnotationType.FREETEXT:return new R(N);case r.AnnotationType.LINE:return new p(N);case r.AnnotationType.SQUARE:return new $(N);case r.AnnotationType.CIRCLE:return new G(N);case r.AnnotationType.POLYLINE:return new S(N);case r.AnnotationType.CARET:return new it(N);case r.AnnotationType.INK:return new rt(N);case r.AnnotationType.POLYGON:return new X(N);case r.AnnotationType.HIGHLIGHT:return new H(N);case r.AnnotationType.UNDERLINE:return new lt(N);case r.AnnotationType.SQUIGGLY:return new gt(N);case r.AnnotationType.STRIKEOUT:return new Et(N);case r.AnnotationType.STAMP:return new xt(N);case r.AnnotationType.FILEATTACHMENT:return new P(N);default:return new v(N)}}}const s=class s{constructor(N,{isRenderable:n=!1,ignoreBorder:b=!1,createQuadrilaterals:B=!1}={}){j(this,a,!1);this.isRenderable=n,this.data=N.data,this.layer=N.layer,this.linkService=N.linkService,this.downloadManager=N.downloadManager,this.imageResourcesPath=N.imageResourcesPath,this.renderForms=N.renderForms,this.svgFactory=N.svgFactory,this.annotationStorage=N.annotationStorage,this.enableScripting=N.enableScripting,this.hasJSActions=N.hasJSActions,this._fieldObjects=N.fieldObjects,this.parent=N.parent,n&&(this.container=this._createContainer(b)),B&&this._createQuadrilaterals()}static _hasPopupData({titleObj:N,contentsObj:n,richText:b}){return!!(N!=null&&N.str||n!=null&&n.str||b!=null&&b.str)}get hasPopupData(){return s._hasPopupData(this.data)}_createContainer(N){const{data:n,parent:{page:b,viewport:B}}=this,V=document.createElement("section");V.setAttribute("data-annotation-id",n.id),this instanceof _||(V.tabIndex=C),V.style.zIndex=this.parent.zIndex++,this.data.popupRef&&V.setAttribute("aria-haspopup","dialog"),n.noRotate&&V.classList.add("norotate");const{pageWidth:K,pageHeight:ot,pageX:bt,pageY:kt}=B.rawDims;if(!n.rect||this instanceof m){const{rotation:$t}=n;return!n.hasOwnCanvas&&$t!==0&&this.setRotation($t,V),V}const{width:Rt,height:Vt}=O(n.rect),Mt=r.Util.normalizeRect([n.rect[0],b.view[3]-n.rect[1]+b.view[1],n.rect[2],b.view[3]-n.rect[3]+b.view[1]]);if(!N&&n.borderStyle.width>0){V.style.borderWidth=`${n.borderStyle.width}px`;const $t=n.borderStyle.horizontalCornerRadius,Xt=n.borderStyle.verticalCornerRadius;if($t>0||Xt>0){const Qt=`calc(${$t}px * var(--scale-factor)) / calc(${Xt}px * var(--scale-factor))`;V.style.borderRadius=Qt}else if(this instanceof o){const Qt=`calc(${Rt}px * var(--scale-factor)) / calc(${Vt}px * var(--scale-factor))`;V.style.borderRadius=Qt}switch(n.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:V.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:V.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:V.style.borderBottomStyle="solid";break}const Kt=n.borderColor||null;Kt?(st(this,a,!0),V.style.borderColor=r.Util.makeHexColor(Kt[0]|0,Kt[1]|0,Kt[2]|0)):V.style.borderWidth=0}V.style.left=`${100*(Mt[0]-bt)/K}%`,V.style.top=`${100*(Mt[1]-kt)/ot}%`;const{rotation:Ft}=n;return n.hasOwnCanvas||Ft===0?(V.style.width=`${100*Rt/K}%`,V.style.height=`${100*Vt/ot}%`):this.setRotation(Ft,V),V}setRotation(N,n=this.container){if(!this.data.rect)return;const{pageWidth:b,pageHeight:B}=this.parent.viewport.rawDims,{width:V,height:K}=O(this.data.rect);let ot,bt;N%180===0?(ot=100*V/b,bt=100*K/B):(ot=100*K/b,bt=100*V/B),n.style.width=`${ot}%`,n.style.height=`${bt}%`,n.setAttribute("data-main-rotation",(360-N)%360)}get _commonActions(){const N=(n,b,B)=>{const V=B.detail[n],K=V[0],ot=V.slice(1);B.target.style[b]=U.ColorConverters[`${K}_HTML`](ot),this.annotationStorage.setValue(this.data.id,{[b]:U.ColorConverters[`${K}_rgb`](ot)})};return(0,r.shadow)(this,"_commonActions",{display:n=>{const{display:b}=n.detail,B=b%2===1;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:B,noPrint:b===1||b===2})},print:n=>{this.annotationStorage.setValue(this.data.id,{noPrint:!n.detail.print})},hidden:n=>{const{hidden:b}=n.detail;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:b,noView:b})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.target.disabled=n.detail.readonly},required:n=>{this._setRequired(n.target,n.detail.required)},bgColor:n=>{N("bgColor","backgroundColor",n)},fillColor:n=>{N("fillColor","backgroundColor",n)},fgColor:n=>{N("fgColor","color",n)},textColor:n=>{N("textColor","color",n)},borderColor:n=>{N("borderColor","borderColor",n)},strokeColor:n=>{N("strokeColor","borderColor",n)},rotation:n=>{const b=n.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(N,n){const b=this._commonActions;for(const B of Object.keys(n.detail)){const V=N[B]||b[B];V==null||V(n)}}_setDefaultPropertiesFromJS(N){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const b=this._commonActions;for(const[B,V]of Object.entries(n)){const K=b[B];if(K){const ot={detail:{[B]:V},target:N};K(ot),delete n[B]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:N}=this.data;if(!N)return;const[n,b,B,V]=this.data.rect;if(N.length===1){const[,{x:Xt,y:Kt},{x:Qt,y:ie}]=N[0];if(B===Xt&&V===Kt&&n===Qt&&b===ie)return}const{style:K}=this.container;let ot;if(t(this,a)){const{borderColor:Xt,borderWidth:Kt}=K;K.borderWidth=0,ot=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Xt}" stroke-width="${Kt}">`],this.container.classList.add("hasBorder")}const bt=B-n,kt=V-b,{svgFactory:Rt}=this,Vt=Rt.createElement("svg");Vt.classList.add("quadrilateralsContainer"),Vt.setAttribute("width",0),Vt.setAttribute("height",0);const Mt=Rt.createElement("defs");Vt.append(Mt);const Ft=Rt.createElement("clipPath"),$t=`clippath_${this.data.id}`;Ft.setAttribute("id",$t),Ft.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Ft);for(const[,{x:Xt,y:Kt},{x:Qt,y:ie}]of N){const ne=Rt.createElement("rect"),se=(Qt-n)/bt,oe=(V-Kt)/kt,le=(Xt-Qt)/bt,An=(Kt-ie)/kt;ne.setAttribute("x",se),ne.setAttribute("y",oe),ne.setAttribute("width",le),ne.setAttribute("height",An),Ft.append(ne),ot==null||ot.push(`<rect vector-effect="non-scaling-stroke" x="${se}" y="${oe}" width="${le}" height="${An}"/>`)}t(this,a)&&(ot.push("</g></svg>')"),K.backgroundImage=ot.join("")),this.container.append(Vt),this.container.style.clipPath=`url(#${$t})`}_createPopup(){const{container:N,data:n}=this;N.setAttribute("aria-haspopup","dialog");const b=new m({data:{color:n.color,titleObj:n.titleObj,modificationDate:n.modificationDate,contentsObj:n.contentsObj,richText:n.richText,parentRect:n.rect,borderStyle:0,id:`popup_${n.id}`,rotation:n.rotation},parent:this.parent,elements:[this]});this.parent.div.append(b.render())}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(N,n=null){const b=[];if(this._fieldObjects){const B=this._fieldObjects[N];if(B)for(const{page:V,id:K,exportValues:ot}of B){if(V===-1||K===n)continue;const bt=typeof ot=="string"?ot:null,kt=document.querySelector(`[data-element-id="${K}"]`);if(kt&&!L.has(kt)){(0,r.warn)(`_getElementsByName - element not allowed: ${K}`);continue}b.push({id:K,exportValue:bt,domElement:kt})}return b}for(const B of document.getElementsByName(N)){const{exportValue:V}=B,K=B.getAttribute("data-element-id");K!==n&&L.has(B)&&b.push({id:K,exportValue:V,domElement:B})}return b}show(){var N;this.container&&(this.container.hidden=!1),(N=this.popup)==null||N.maybeShow()}hide(){var N;this.container&&(this.container.hidden=!0),(N=this.popup)==null||N.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const N=this.getElementsToTriggerPopup();if(Array.isArray(N))for(const n of N)n.classList.add("highlightArea");else N.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:N,data:{id:n}}=this;this.container.addEventListener("dblclick",()=>{var b;(b=this.linkService.eventBus)==null||b.dispatch("switchannotationeditormode",{source:this,mode:N,editId:n})})}};a=new WeakMap;let v=s;class A extends v{constructor(n,b=null){super(n,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});j(this,c);j(this,E);this.isTooltipOnly=n.data.isTooltipOnly}render(){const{data:n,linkService:b}=this,B=document.createElement("a");B.setAttribute("data-element-id",n.id);let V=!1;return n.url?(b.addLinkAttributes(B,n.url,n.newWindow),V=!0):n.action?(this._bindNamedAction(B,n.action),V=!0):n.attachment?(this._bindAttachment(B,n.attachment),V=!0):n.setOCGState?(q(this,E,In).call(this,B,n.setOCGState),V=!0):n.dest?(this._bindLink(B,n.dest),V=!0):(n.actions&&(n.actions.Action||n.actions["Mouse Up"]||n.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(B,n),V=!0),n.resetForm?(this._bindResetFormAction(B,n.resetForm),V=!0):this.isTooltipOnly&&!V&&(this._bindLink(B,""),V=!0)),this.container.classList.add("linkAnnotation"),V&&this.container.append(B),this.container}_bindLink(n,b){n.href=this.linkService.getDestinationHash(b),n.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&q(this,c,ce).call(this)}_bindNamedAction(n,b){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeNamedAction(b),!1),q(this,c,ce).call(this)}_bindAttachment(n,b){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>{var B;return(B=this.downloadManager)==null||B.openOrDownloadData(this.container,b.content,b.filename),!1},q(this,c,ce).call(this)}_bindJSAction(n,b){n.href=this.linkService.getAnchorUrl("");const B=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const V of Object.keys(b.actions)){const K=B.get(V);K&&(n[K]=()=>{var ot;return(ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:V}}),!1})}n.onclick||(n.onclick=()=>!1),q(this,c,ce).call(this)}_bindResetFormAction(n,b){const B=n.onclick;if(B||(n.href=this.linkService.getAnchorUrl("")),q(this,c,ce).call(this),!this._fieldObjects){(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),B||(n.onclick=()=>!1);return}n.onclick=()=>{var Vt;B==null||B();const{fields:V,refs:K,include:ot}=b,bt=[];if(V.length!==0||K.length!==0){const Mt=new Set(K);for(const Ft of V){const $t=this._fieldObjects[Ft]||[];for(const{id:Xt}of $t)Mt.add(Xt)}for(const Ft of Object.values(this._fieldObjects))for(const $t of Ft)Mt.has($t.id)===ot&&bt.push($t)}else for(const Mt of Object.values(this._fieldObjects))bt.push(...Mt);const kt=this.annotationStorage,Rt=[];for(const Mt of bt){const{id:Ft}=Mt;switch(Rt.push(Ft),Mt.type){case"text":{const Xt=Mt.defaultValue||"";kt.setValue(Ft,{value:Xt});break}case"checkbox":case"radiobutton":{const Xt=Mt.defaultValue===Mt.exportValues;kt.setValue(Ft,{value:Xt});break}case"combobox":case"listbox":{const Xt=Mt.defaultValue||"";kt.setValue(Ft,{value:Xt});break}default:continue}const $t=document.querySelector(`[data-element-id="${Ft}"]`);if($t){if(!L.has($t)){(0,r.warn)(`_bindResetFormAction - element not allowed: ${Ft}`);continue}}else continue;$t.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Vt=this.linkService.eventBus)==null||Vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Rt,name:"ResetForm"}})),!1}}}c=new WeakSet,ce=function(){this.container.setAttribute("data-internal-link","")},E=new WeakSet,In=function(n,b){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeSetOCGState(b),!1),q(this,c,ce).call(this)};class u extends v{constructor(N){super(N,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const N=document.createElement("img");return N.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",N.alt="[{{type}} Annotation]",N.dataset.l10nId="text_annotation_type",N.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(N),this.container}}class _ extends v{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(N){var n;this.data.hasOwnCanvas&&(((n=N.previousSibling)==null?void 0:n.nodeName)==="CANVAS"&&(N.previousSibling.hidden=!0),N.hidden=!1)}_getKeyModifier(N){const{isWin:n,isMac:b}=r.FeatureTest.platform;return n&&N.ctrlKey||b&&N.metaKey}_setEventListener(N,n,b,B,V){b.includes("mouse")?N.addEventListener(b,K=>{var ot;(ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:V(K),shift:K.shiftKey,modifier:this._getKeyModifier(K)}})}):N.addEventListener(b,K=>{var ot;if(b==="blur"){if(!n.focused||!K.relatedTarget)return;n.focused=!1}else if(b==="focus"){if(n.focused)return;n.focused=!0}V&&((ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:B,value:V(K)}}))})}_setEventListeners(N,n,b,B){var V,K,ot;for(const[bt,kt]of b)(kt==="Action"||(V=this.data.actions)!=null&&V[kt])&&((kt==="Focus"||kt==="Blur")&&(n||(n={focused:!1})),this._setEventListener(N,n,bt,kt,B),kt==="Focus"&&!((K=this.data.actions)!=null&&K.Blur)?this._setEventListener(N,n,"blur","Blur",null):kt==="Blur"&&!((ot=this.data.actions)!=null&&ot.Focus)&&this._setEventListener(N,n,"focus","Focus",null))}_setBackgroundColor(N){const n=this.data.backgroundColor||null;N.style.backgroundColor=n===null?"transparent":r.Util.makeHexColor(n[0],n[1],n[2])}_setTextStyle(N){const n=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,B=this.data.defaultAppearanceData.fontSize||g,V=N.style;let K;const ot=2,bt=kt=>Math.round(10*kt)/10;if(this.data.multiLine){const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-ot),Rt=Math.round(kt/(r.LINE_FACTOR*B))||1,Vt=kt/Rt;K=Math.min(B,bt(Vt/r.LINE_FACTOR))}else{const kt=Math.abs(this.data.rect[3]-this.data.rect[1]-ot);K=Math.min(B,bt(kt/r.LINE_FACTOR))}V.fontSize=`calc(${K}px * var(--scale-factor))`,V.color=r.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(V.textAlign=n[this.data.textAlignment])}_setRequired(N,n){n?N.setAttribute("required",!0):N.removeAttribute("required"),N.setAttribute("aria-required",n)}}class x extends _{constructor(N){const n=N.renderForms||!N.data.hasAppearance&&!!N.data.fieldValue;super(N,{isRenderable:n})}setPropertyOnSiblings(N,n,b,B){const V=this.annotationStorage;for(const K of this._getElementsByName(N.name,N.id))K.domElement&&(K.domElement[n]=b),V.setValue(K.id,{[B]:b})}render(){var B,V;const N=this.annotationStorage,n=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const K=N.getValue(n,{value:this.data.fieldValue});let ot=K.value||"";const bt=N.getValue(n,{charLimit:this.data.maxLen}).charLimit;bt&&ot.length>bt&&(ot=ot.slice(0,bt));let kt=K.formattedValue||((B=this.data.textContent)==null?void 0:B.join(`
`))||null;kt&&this.data.comb&&(kt=kt.replaceAll(/\s+/g,""));const Rt={userValue:ot,formattedValue:kt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=kt??ot,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",kt??ot),this.data.doNotScroll&&(b.style.overflowX="hidden")),this.data.hasOwnCanvas&&(b.hidden=!0),L.add(b),b.setAttribute("data-element-id",n),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=C,this._setRequired(b,this.data.required),bt&&(b.maxLength=bt),b.addEventListener("input",Mt=>{N.setValue(n,{value:Mt.target.value}),this.setPropertyOnSiblings(b,"value",Mt.target.value,"value"),Rt.formattedValue=null}),b.addEventListener("resetform",Mt=>{const Ft=this.data.defaultFieldValue??"";b.value=Rt.userValue=Ft,Rt.formattedValue=null});let Vt=Mt=>{const{formattedValue:Ft}=Rt;Ft!=null&&(Mt.target.value=Ft),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",Ft=>{if(Rt.focused)return;const{target:$t}=Ft;Rt.userValue&&($t.value=Rt.userValue),Rt.lastCommittedValue=$t.value,Rt.commitKey=1,Rt.focused=!0}),b.addEventListener("updatefromsandbox",Ft=>{this.showElementAndHideCanvas(Ft.target);const $t={value(Xt){Rt.userValue=Xt.detail.value??"",N.setValue(n,{value:Rt.userValue.toString()}),Xt.target.value=Rt.userValue},formattedValue(Xt){const{formattedValue:Kt}=Xt.detail;Rt.formattedValue=Kt,Kt!=null&&Xt.target!==document.activeElement&&(Xt.target.value=Kt),N.setValue(n,{formattedValue:Kt})},selRange(Xt){Xt.target.setSelectionRange(...Xt.detail.selRange)},charLimit:Xt=>{var ne;const{charLimit:Kt}=Xt.detail,{target:Qt}=Xt;if(Kt===0){Qt.removeAttribute("maxLength");return}Qt.setAttribute("maxLength",Kt);let ie=Rt.userValue;!ie||ie.length<=Kt||(ie=ie.slice(0,Kt),Qt.value=Rt.userValue=ie,N.setValue(n,{value:ie}),(ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:ie,willCommit:!0,commitKey:1,selStart:Qt.selectionStart,selEnd:Qt.selectionEnd}}))}};this._dispatchEventFromSandbox($t,Ft)}),b.addEventListener("keydown",Ft=>{var Kt;Rt.commitKey=1;let $t=-1;if(Ft.key==="Escape"?$t=0:Ft.key==="Enter"&&!this.data.multiLine?$t=2:Ft.key==="Tab"&&(Rt.commitKey=3),$t===-1)return;const{value:Xt}=Ft.target;Rt.lastCommittedValue!==Xt&&(Rt.lastCommittedValue=Xt,Rt.userValue=Xt,(Kt=this.linkService.eventBus)==null||Kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:Xt,willCommit:!0,commitKey:$t,selStart:Ft.target.selectionStart,selEnd:Ft.target.selectionEnd}}))});const Mt=Vt;Vt=null,b.addEventListener("blur",Ft=>{var Xt;if(!Rt.focused||!Ft.relatedTarget)return;Rt.focused=!1;const{value:$t}=Ft.target;Rt.userValue=$t,Rt.lastCommittedValue!==$t&&((Xt=this.linkService.eventBus)==null||Xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:$t,willCommit:!0,commitKey:Rt.commitKey,selStart:Ft.target.selectionStart,selEnd:Ft.target.selectionEnd}})),Mt(Ft)}),(V=this.data.actions)!=null&&V.Keystroke&&b.addEventListener("beforeinput",Ft=>{var oe;Rt.lastCommittedValue=null;const{data:$t,target:Xt}=Ft,{value:Kt,selectionStart:Qt,selectionEnd:ie}=Xt;let ne=Qt,se=ie;switch(Ft.inputType){case"deleteWordBackward":{const le=Kt.substring(0,Qt).match(/\w*[^\w]*$/);le&&(ne-=le[0].length);break}case"deleteWordForward":{const le=Kt.substring(Qt).match(/^[^\w]*\w*/);le&&(se+=le[0].length);break}case"deleteContentBackward":Qt===ie&&(ne-=1);break;case"deleteContentForward":Qt===ie&&(se+=1);break}Ft.preventDefault(),(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:Kt,change:$t||"",willCommit:!1,selStart:ne,selEnd:se}})}),this._setEventListeners(b,Rt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ft=>Ft.target.value)}if(Vt&&b.addEventListener("blur",Vt),this.data.comb){const Ft=(this.data.rect[2]-this.data.rect[0])/bt;b.classList.add("comb"),b.style.letterSpacing=`calc(${Ft}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class w extends _{constructor(N){super(N,{isRenderable:!!N.data.hasOwnCanvas})}}class y extends _{constructor(N){super(N,{isRenderable:N.renderForms})}render(){const N=this.annotationStorage,n=this.data,b=n.id;let B=N.getValue(b,{value:n.exportValue===n.fieldValue}).value;typeof B=="string"&&(B=B!=="Off",N.setValue(b,{value:B})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const V=document.createElement("input");return L.add(V),V.setAttribute("data-element-id",b),V.disabled=n.readOnly,this._setRequired(V,this.data.required),V.type="checkbox",V.name=n.fieldName,B&&V.setAttribute("checked",!0),V.setAttribute("exportValue",n.exportValue),V.tabIndex=C,V.addEventListener("change",K=>{const{name:ot,checked:bt}=K.target;for(const kt of this._getElementsByName(ot,b)){const Rt=bt&&kt.exportValue===n.exportValue;kt.domElement&&(kt.domElement.checked=Rt),N.setValue(kt.id,{value:Rt})}N.setValue(b,{value:bt})}),V.addEventListener("resetform",K=>{const ot=n.defaultFieldValue||"Off";K.target.checked=ot===n.exportValue}),this.enableScripting&&this.hasJSActions&&(V.addEventListener("updatefromsandbox",K=>{const ot={value(bt){bt.target.checked=bt.detail.value!=="Off",N.setValue(b,{value:bt.target.checked})}};this._dispatchEventFromSandbox(ot,K)}),this._setEventListeners(V,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.checked)),this._setBackgroundColor(V),this._setDefaultPropertiesFromJS(V),this.container.append(V),this.container}}class o extends _{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const N=this.annotationStorage,n=this.data,b=n.id;let B=N.getValue(b,{value:n.fieldValue===n.buttonValue}).value;typeof B=="string"&&(B=B!==n.buttonValue,N.setValue(b,{value:B}));const V=document.createElement("input");if(L.add(V),V.setAttribute("data-element-id",b),V.disabled=n.readOnly,this._setRequired(V,this.data.required),V.type="radio",V.name=n.fieldName,B&&V.setAttribute("checked",!0),V.tabIndex=C,V.addEventListener("change",K=>{const{name:ot,checked:bt}=K.target;for(const kt of this._getElementsByName(ot,b))N.setValue(kt.id,{value:!1});N.setValue(b,{value:bt})}),V.addEventListener("resetform",K=>{const ot=n.defaultFieldValue;K.target.checked=ot!=null&&ot===n.buttonValue}),this.enableScripting&&this.hasJSActions){const K=n.buttonValue;V.addEventListener("updatefromsandbox",ot=>{const bt={value:kt=>{const Rt=K===kt.detail.value;for(const Vt of this._getElementsByName(kt.target.name)){const Mt=Rt&&Vt.id===b;Vt.domElement&&(Vt.domElement.checked=Mt),N.setValue(Vt.id,{value:Mt})}}};this._dispatchEventFromSandbox(bt,ot)}),this._setEventListeners(V,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ot=>ot.target.checked)}return this._setBackgroundColor(V),this._setDefaultPropertiesFromJS(V),this.container.append(V),this.container}}class h extends A{constructor(N){super(N,{ignoreBorder:N.data.hasAppearance})}render(){const N=super.render();N.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(N.title=this.data.alternativeText);const n=N.lastChild;return this.enableScripting&&this.hasJSActions&&n&&(this._setDefaultPropertiesFromJS(n),n.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),N}}class F extends _{constructor(N){super(N,{isRenderable:N.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const N=this.annotationStorage,n=this.data.id,b=N.getValue(n,{value:this.data.fieldValue}),B=document.createElement("select");L.add(B),B.setAttribute("data-element-id",n),B.disabled=this.data.readOnly,this._setRequired(B,this.data.required),B.name=this.data.fieldName,B.tabIndex=C;let V=this.data.combo&&this.data.options.length>0;this.data.combo||(B.size=this.data.options.length,this.data.multiSelect&&(B.multiple=!0)),B.addEventListener("resetform",Rt=>{const Vt=this.data.defaultFieldValue;for(const Mt of B.options)Mt.selected=Mt.value===Vt});for(const Rt of this.data.options){const Vt=document.createElement("option");Vt.textContent=Rt.displayValue,Vt.value=Rt.exportValue,b.value.includes(Rt.exportValue)&&(Vt.setAttribute("selected",!0),V=!1),B.append(Vt)}let K=null;if(V){const Rt=document.createElement("option");Rt.value=" ",Rt.setAttribute("hidden",!0),Rt.setAttribute("selected",!0),B.prepend(Rt),K=()=>{Rt.remove(),B.removeEventListener("input",K),K=null},B.addEventListener("input",K)}const ot=Rt=>{const Vt=Rt?"value":"textContent",{options:Mt,multiple:Ft}=B;return Ft?Array.prototype.filter.call(Mt,$t=>$t.selected).map($t=>$t[Vt]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][Vt]};let bt=ot(!1);const kt=Rt=>{const Vt=Rt.target.options;return Array.prototype.map.call(Vt,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(B.addEventListener("updatefromsandbox",Rt=>{const Vt={value(Mt){K==null||K();const Ft=Mt.detail.value,$t=new Set(Array.isArray(Ft)?Ft:[Ft]);for(const Xt of B.options)Xt.selected=$t.has(Xt.value);N.setValue(n,{value:ot(!0)}),bt=ot(!1)},multipleSelection(Mt){B.multiple=!0},remove(Mt){const Ft=B.options,$t=Mt.detail.remove;Ft[$t].selected=!1,B.remove($t),Ft.length>0&&Array.prototype.findIndex.call(Ft,Kt=>Kt.selected)===-1&&(Ft[0].selected=!0),N.setValue(n,{value:ot(!0),items:kt(Mt)}),bt=ot(!1)},clear(Mt){for(;B.length!==0;)B.remove(0);N.setValue(n,{value:null,items:[]}),bt=ot(!1)},insert(Mt){const{index:Ft,displayValue:$t,exportValue:Xt}=Mt.detail.insert,Kt=B.children[Ft],Qt=document.createElement("option");Qt.textContent=$t,Qt.value=Xt,Kt?Kt.before(Qt):B.append(Qt),N.setValue(n,{value:ot(!0),items:kt(Mt)}),bt=ot(!1)},items(Mt){const{items:Ft}=Mt.detail;for(;B.length!==0;)B.remove(0);for(const $t of Ft){const{displayValue:Xt,exportValue:Kt}=$t,Qt=document.createElement("option");Qt.textContent=Xt,Qt.value=Kt,B.append(Qt)}B.options.length>0&&(B.options[0].selected=!0),N.setValue(n,{value:ot(!0),items:kt(Mt)}),bt=ot(!1)},indices(Mt){const Ft=new Set(Mt.detail.indices);for(const $t of Mt.target.options)$t.selected=Ft.has($t.index);N.setValue(n,{value:ot(!0)}),bt=ot(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(Vt,Rt)}),B.addEventListener("input",Rt=>{var Mt;const Vt=ot(!0);N.setValue(n,{value:Vt}),Rt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:bt,changeEx:Vt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(B,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Rt=>Rt.target.value)):B.addEventListener("input",function(Rt){N.setValue(n,{value:ot(!0)})}),this.data.combo&&this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class m extends v{constructor(N){const{data:n,elements:b}=N;super(N,{isRenderable:v._hasPopupData(n)}),this.elements=b}render(){this.container.classList.add("popupAnnotation");const N=new l({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const b of this.elements)b.popup=N,n.push(b.data.id),b.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(b=>`${r.AnnotationPrefix}${b}`).join(",")),this.container}}class l{constructor({container:N,color:n,elements:b,titleObj:B,modificationDate:V,contentsObj:K,richText:ot,parent:bt,rect:kt,parentRect:Rt,open:Vt}){j(this,Ut);j(this,Wt);j(this,zt);j(this,qt);j(this,W,null);j(this,nt,q(this,Ut,On).bind(this));j(this,J,q(this,qt,ln).bind(this));j(this,at,q(this,zt,on).bind(this));j(this,ht,q(this,Wt,ke).bind(this));j(this,pt,null);j(this,dt,null);j(this,Tt,null);j(this,Lt,null);j(this,vt,null);j(this,Dt,null);j(this,mt,!1);j(this,et,null);j(this,Z,null);j(this,ft,null);j(this,wt,null);j(this,Ct,!1);var Ft;st(this,dt,N),st(this,wt,B),st(this,Tt,K),st(this,ft,ot),st(this,vt,bt),st(this,pt,n),st(this,Z,kt),st(this,Dt,Rt),st(this,Lt,b);const Mt=f.PDFDateString.toDateObject(V);Mt&&st(this,W,bt.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=b.flatMap($t=>$t.getElementsToTriggerPopup());for(const $t of this.trigger)$t.addEventListener("click",t(this,ht)),$t.addEventListener("mouseenter",t(this,at)),$t.addEventListener("mouseleave",t(this,J)),$t.classList.add("popupTriggerArea");for(const $t of b)(Ft=$t.container)==null||Ft.addEventListener("keydown",t(this,nt));t(this,dt).hidden=!0,Vt&&q(this,Wt,ke).call(this)}render(){if(t(this,et))return;const{page:{view:N},viewport:{rawDims:{pageWidth:n,pageHeight:b,pageX:B,pageY:V}}}=t(this,vt),K=st(this,et,document.createElement("div"));if(K.className="popup",t(this,pt)){const ne=K.style.outlineColor=r.Util.makeHexColor(...t(this,pt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?K.style.backgroundColor=`color-mix(in srgb, ${ne} 30%, white)`:K.style.backgroundColor=r.Util.makeHexColor(...t(this,pt).map(oe=>Math.floor(.7*(255-oe)+oe)))}const ot=document.createElement("span");ot.className="header";const bt=document.createElement("h1");if(ot.append(bt),{dir:bt.dir,str:bt.textContent}=t(this,wt),K.append(ot),t(this,W)){const ne=document.createElement("span");ne.classList.add("popupDate"),t(this,W).then(se=>{ne.textContent=se}),ot.append(ne)}const kt=t(this,Tt),Rt=t(this,ft);if(Rt!=null&&Rt.str&&(!(kt!=null&&kt.str)||kt.str===Rt.str))D.XfaLayer.render({xfaHtml:Rt.html,intent:"richText",div:K}),K.lastChild.classList.add("richText","popupContent");else{const ne=this._formatContents(kt);K.append(ne)}let Vt=!!t(this,Dt),Mt=Vt?t(this,Dt):t(this,Z);for(const ne of t(this,Lt))if(!Mt||r.Util.intersect(ne.data.rect,Mt)!==null){Mt=ne.data.rect,Vt=!0;break}const Ft=r.Util.normalizeRect([Mt[0],N[3]-Mt[1]+N[1],Mt[2],N[3]-Mt[3]+N[1]]),$t=5,Xt=Vt?Mt[2]-Mt[0]+$t:0,Kt=Ft[0]+Xt,Qt=Ft[1],{style:ie}=t(this,dt);ie.left=`${100*(Kt-B)/n}%`,ie.top=`${100*(Qt-V)/b}%`,t(this,dt).append(K)}_formatContents({str:N,dir:n}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=n;const B=N.split(/(?:\r\n?|\n)/);for(let V=0,K=B.length;V<K;++V){const ot=B[V];b.append(document.createTextNode(ot)),V<K-1&&b.append(document.createElement("br"))}return b}forceHide(){st(this,Ct,this.isVisible),t(this,Ct)&&(t(this,dt).hidden=!0)}maybeShow(){t(this,Ct)&&(st(this,Ct,!1),t(this,dt).hidden=!1)}get isVisible(){return t(this,dt).hidden===!1}}W=new WeakMap,nt=new WeakMap,J=new WeakMap,at=new WeakMap,ht=new WeakMap,pt=new WeakMap,dt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,vt=new WeakMap,Dt=new WeakMap,mt=new WeakMap,et=new WeakMap,Z=new WeakMap,ft=new WeakMap,wt=new WeakMap,Ct=new WeakMap,Ut=new WeakSet,On=function(N){N.altKey||N.shiftKey||N.ctrlKey||N.metaKey||(N.key==="Enter"||N.key==="Escape"&&t(this,mt))&&q(this,Wt,ke).call(this)},Wt=new WeakSet,ke=function(){st(this,mt,!t(this,mt)),t(this,mt)?(q(this,zt,on).call(this),t(this,dt).addEventListener("click",t(this,ht)),t(this,dt).addEventListener("keydown",t(this,nt))):(q(this,qt,ln).call(this),t(this,dt).removeEventListener("click",t(this,ht)),t(this,dt).removeEventListener("keydown",t(this,nt)))},zt=new WeakSet,on=function(){t(this,et)||this.render(),this.isVisible?t(this,mt)&&t(this,dt).classList.add("focused"):(t(this,dt).hidden=!1,t(this,dt).style.zIndex=parseInt(t(this,dt).style.zIndex)+1e3)},qt=new WeakSet,ln=function(){t(this,dt).classList.remove("focused"),!(t(this,mt)||!this.isVisible)&&(t(this,dt).hidden=!0,t(this,dt).style.zIndex=parseInt(t(this,dt).style.zIndex)-1e3)};class R extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0}),this.textContent=N.data.textContent,this.textPosition=N.data.textPosition,this.annotationEditorType=r.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const N=document.createElement("div");N.classList.add("annotationTextContent"),N.setAttribute("role","comment");for(const n of this.textContent){const b=document.createElement("span");b.textContent=n,N.append(b)}this.container.append(N)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=R;class p extends v{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});j(this,tt,null)}render(){this.container.classList.add("lineAnnotation");const n=this.data,{width:b,height:B}=O(n.rect),V=this.svgFactory.create(b,B,!0),K=st(this,tt,this.svgFactory.createElement("svg:line"));return K.setAttribute("x1",n.rect[2]-n.lineCoordinates[0]),K.setAttribute("y1",n.rect[3]-n.lineCoordinates[1]),K.setAttribute("x2",n.rect[2]-n.lineCoordinates[2]),K.setAttribute("y2",n.rect[3]-n.lineCoordinates[3]),K.setAttribute("stroke-width",n.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),V.append(K),this.container.append(V),!n.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,tt)}addHighlightArea(){this.container.classList.add("highlightArea")}}tt=new WeakMap;class $ extends v{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});j(this,Y,null)}render(){this.container.classList.add("squareAnnotation");const n=this.data,{width:b,height:B}=O(n.rect),V=this.svgFactory.create(b,B,!0),K=n.borderStyle.width,ot=st(this,Y,this.svgFactory.createElement("svg:rect"));return ot.setAttribute("x",K/2),ot.setAttribute("y",K/2),ot.setAttribute("width",b-K),ot.setAttribute("height",B-K),ot.setAttribute("stroke-width",K||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),V.append(ot),this.container.append(V),!n.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Y)}addHighlightArea(){this.container.classList.add("highlightArea")}}Y=new WeakMap;class G extends v{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});j(this,_t,null)}render(){this.container.classList.add("circleAnnotation");const n=this.data,{width:b,height:B}=O(n.rect),V=this.svgFactory.create(b,B,!0),K=n.borderStyle.width,ot=st(this,_t,this.svgFactory.createElement("svg:ellipse"));return ot.setAttribute("cx",b/2),ot.setAttribute("cy",B/2),ot.setAttribute("rx",b/2-K/2),ot.setAttribute("ry",B/2-K/2),ot.setAttribute("stroke-width",K||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),V.append(ot),this.container.append(V),!n.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,_t)}addHighlightArea(){this.container.classList.add("highlightArea")}}_t=new WeakMap;class S extends v{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});j(this,yt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const n=this.data,{width:b,height:B}=O(n.rect),V=this.svgFactory.create(b,B,!0);let K=[];for(const bt of n.vertices){const kt=bt.x-n.rect[0],Rt=n.rect[3]-bt.y;K.push(kt+","+Rt)}K=K.join(" ");const ot=st(this,yt,this.svgFactory.createElement(this.svgElementName));return ot.setAttribute("points",K),ot.setAttribute("stroke-width",n.borderStyle.width||1),ot.setAttribute("stroke","transparent"),ot.setAttribute("fill","transparent"),V.append(ot),this.container.append(V),!n.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,yt)}addHighlightArea(){this.container.classList.add("highlightArea")}}yt=new WeakMap;class X extends S{constructor(N){super(N),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class it extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class rt extends v{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});j(this,te,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=r.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const n=this.data,{width:b,height:B}=O(n.rect),V=this.svgFactory.create(b,B,!0);for(const K of n.inkLists){let ot=[];for(const kt of K){const Rt=kt.x-n.rect[0],Vt=n.rect[3]-kt.y;ot.push(`${Rt},${Vt}`)}ot=ot.join(" ");const bt=this.svgFactory.createElement(this.svgElementName);t(this,te).push(bt),bt.setAttribute("points",ot),bt.setAttribute("stroke-width",n.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),!n.popupRef&&this.hasPopupData&&this._createPopup(),V.append(bt)}return this.container.append(V),this.container}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,e.InkAnnotationElement=rt;class H extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class lt extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gt extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Et extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class xt extends v{constructor(N){super(N,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=xt;class P extends v{constructor(n){var V;super(n,{isRenderable:!0});j(this,Q);j(this,Zt,null);const{filename:b,content:B}=this.data.file;this.filename=(0,f.getFilenameFromUrl)(b,!0),this.content=B,(V=this.linkService.eventBus)==null||V.dispatch("fileattachmentannotation",{source:this,filename:b,content:B})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:n,data:b}=this;let B;b.hasAppearance||b.fillAlpha===0?B=document.createElement("div"):(B=document.createElement("img"),B.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(b.name)?"paperclip":"pushpin"}.svg`,b.fillAlpha&&b.fillAlpha<1&&(B.style=`filter: opacity(${Math.round(b.fillAlpha*100)}%);`)),B.addEventListener("dblclick",q(this,Q,cn).bind(this)),st(this,Zt,B);const{isMac:V}=r.FeatureTest.platform;return n.addEventListener("keydown",K=>{K.key==="Enter"&&(V?K.metaKey:K.ctrlKey)&&q(this,Q,cn).call(this)}),!b.popupRef&&this.hasPopupData?this._createPopup():B.classList.add("popupTriggerArea"),n.append(B),n}getElementsToTriggerPopup(){return t(this,Zt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zt=new WeakMap,Q=new WeakSet,cn=function(){var n;(n=this.downloadManager)==null||n.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:N,accessibilityManager:n,annotationCanvasMap:b,l10n:B,page:V,viewport:K}){j(this,Bt);j(this,At);j(this,Ot,null);j(this,Pt,null);j(this,Nt,new Map);this.div=N,st(this,Ot,n),st(this,Pt,b),this.l10n=B,this.page=V,this.viewport=K,this.zIndex=0,this.l10n||(this.l10n=ct.NullL10n)}async render(N){const{annotations:n}=N,b=this.div;(0,f.setLayerDimensions)(b,this.viewport);const B=new Map,V={data:null,layer:b,linkService:N.linkService,downloadManager:N.downloadManager,imageResourcesPath:N.imageResourcesPath||"",renderForms:N.renderForms!==!1,svgFactory:new f.DOMSVGFactory,annotationStorage:N.annotationStorage||new z.AnnotationStorage,enableScripting:N.enableScripting===!0,hasJSActions:N.hasJSActions,fieldObjects:N.fieldObjects,parent:this,elements:null};for(const K of n){if(K.noHTML)continue;const ot=K.annotationType===r.AnnotationType.POPUP;if(ot){const Rt=B.get(K.id);if(!Rt)continue;V.elements=Rt}else{const{width:Rt,height:Vt}=O(K.rect);if(Rt<=0||Vt<=0)continue}V.data=K;const bt=T.create(V);if(!bt.isRenderable)continue;if(!ot&&K.popupRef){const Rt=B.get(K.popupRef);Rt?Rt.push(bt):B.set(K.popupRef,[bt])}bt.annotationEditorType>0&&t(this,Nt).set(bt.data.id,bt);const kt=bt.render();K.hidden&&(kt.style.visibility="hidden"),q(this,Bt,Nn).call(this,kt,K.id)}q(this,At,hn).call(this),await this.l10n.translate(b)}update({viewport:N}){const n=this.div;this.viewport=N,(0,f.setLayerDimensions)(n,{rotation:N.rotation}),q(this,At,hn).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Nt).values())}getEditableAnnotation(N){return t(this,Nt).get(N)}}Ot=new WeakMap,Pt=new WeakMap,Nt=new WeakMap,Bt=new WeakSet,Nn=function(N,n){var B;const b=N.firstChild||N;b.id=`${r.AnnotationPrefix}${n}`,this.div.append(N),(B=t(this,Ot))==null||B.moveElementInDOM(this.div,N,b,!1)},At=new WeakSet,hn=function(){if(!t(this,Pt))return;const N=this.div;for(const[n,b]of t(this,Pt)){const B=N.querySelector(`[data-annotation-id="${n}"]`);if(!B)continue;const{firstChild:V}=B;V?V.nodeName==="CANVAS"?V.replaceWith(b):V.before(b):B.append(b)}t(this,Pt).clear()},e.AnnotationLayer=i},(k,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function I(z){return Math.floor(Math.max(0,Math.min(1,z))*255).toString(16).padStart(2,"0")}function r(z){return Math.max(0,Math.min(255,255*z))}class f{static CMYK_G([U,ct,D,C]){return["G",1-Math.min(1,.3*U+.59*D+.11*ct+C)]}static G_CMYK([U]){return["CMYK",0,0,0,1-U]}static G_RGB([U]){return["RGB",U,U,U]}static G_rgb([U]){return U=r(U),[U,U,U]}static G_HTML([U]){const ct=I(U);return`#${ct}${ct}${ct}`}static RGB_G([U,ct,D]){return["G",.3*U+.59*ct+.11*D]}static RGB_rgb(U){return U.map(r)}static RGB_HTML(U){return`#${U.map(I).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([U,ct,D,C]){return["RGB",1-Math.min(1,U+C),1-Math.min(1,D+C),1-Math.min(1,ct+C)]}static CMYK_rgb([U,ct,D,C]){return[r(1-Math.min(1,U+C)),r(1-Math.min(1,D+C)),r(1-Math.min(1,ct+C))]}static CMYK_HTML(U){const ct=this.CMYK_RGB(U).slice(1);return this.RGB_HTML(ct)}static RGB_CMYK([U,ct,D]){const C=1-U,g=1-ct,L=1-D,O=Math.min(C,g,L);return["CMYK",C,g,L,O]}}e.ColorConverters=f},(k,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=r;const I={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};I.print_progress_percent="{{progress}}%";function r(U,ct){switch(U){case"find_match_count":U=`find_match_count[${ct.total===1?"one":"other"}]`;break;case"find_match_count_limit":U=`find_match_count_limit[${ct.limit===1?"one":"other"}]`;break}return I[U]||""}function f(U,ct){return ct?U.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(D,C)=>C in ct?ct[C]:"{{"+C+"}}"):U}const z={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(U,ct=null,D=r(U,ct)){return f(D,ct)},async translate(U){}};e.NullL10n=z},(k,e,I)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var r=I(25);class f{static setupStorage(U,ct,D,C,g){const L=C.getValue(ct,{value:null});switch(D.name){case"textarea":if(L.value!==null&&(U.textContent=L.value),g==="print")break;U.addEventListener("input",O=>{C.setValue(ct,{value:O.target.value})});break;case"input":if(D.attributes.type==="radio"||D.attributes.type==="checkbox"){if(L.value===D.attributes.xfaOn?U.setAttribute("checked",!0):L.value===D.attributes.xfaOff&&U.removeAttribute("checked"),g==="print")break;U.addEventListener("change",O=>{C.setValue(ct,{value:O.target.checked?O.target.getAttribute("xfaOn"):O.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&U.setAttribute("value",L.value),g==="print")break;U.addEventListener("input",O=>{C.setValue(ct,{value:O.target.value})})}break;case"select":if(L.value!==null){U.setAttribute("value",L.value);for(const O of D.children)O.attributes.value===L.value?O.attributes.selected=!0:O.attributes.hasOwnProperty("selected")&&delete O.attributes.selected}U.addEventListener("input",O=>{const T=O.target.options,v=T.selectedIndex===-1?"":T[T.selectedIndex].value;C.setValue(ct,{value:v})});break}}static setAttributes({html:U,element:ct,storage:D=null,intent:C,linkService:g}){const{attributes:L}=ct,O=U instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${C}`);for(const[T,v]of Object.entries(L))if(v!=null)switch(T){case"class":v.length&&U.setAttribute(T,v.join(" "));break;case"dataId":break;case"id":U.setAttribute("data-element-id",v);break;case"style":Object.assign(U.style,v);break;case"textContent":U.textContent=v;break;default:(!O||T!=="href"&&T!=="newWindow")&&U.setAttribute(T,v)}O&&g.addLinkAttributes(U,L.href,L.newWindow),D&&L.dataId&&this.setupStorage(U,L.dataId,ct,D)}static render(U){var A;const ct=U.annotationStorage,D=U.linkService,C=U.xfaHtml,g=U.intent||"display",L=document.createElement(C.name);C.attributes&&this.setAttributes({html:L,element:C,intent:g,linkService:D});const O=[[C,-1,L]],T=U.div;if(T.append(L),U.viewport){const u=`matrix(${U.viewport.transform.join(",")})`;T.style.transform=u}g!=="richText"&&T.setAttribute("class","xfaLayer xfaFont");const v=[];for(;O.length>0;){const[u,_,x]=O.at(-1);if(_+1===u.children.length){O.pop();continue}const w=u.children[++O.at(-1)[1]];if(w===null)continue;const{name:y}=w;if(y==="#text"){const h=document.createTextNode(w.value);v.push(h),x.append(h);continue}const o=(A=w==null?void 0:w.attributes)!=null&&A.xmlns?document.createElementNS(w.attributes.xmlns,y):document.createElement(y);if(x.append(o),w.attributes&&this.setAttributes({html:o,element:w,storage:ct,intent:g,linkService:D}),w.children&&w.children.length>0)O.push([w,-1,o]);else if(w.value){const h=document.createTextNode(w.value);r.XfaText.shouldBuildText(y)&&v.push(h),o.append(h)}}for(const u of T.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:v}}static update(U){const ct=`matrix(${U.viewport.transform.join(",")})`;U.div.style.transform=ct,U.div.hidden=!1}}e.XfaLayer=f},(k,e,I)=>{var C,g,L,O,T,v,A,u,_,x,w,y,o,h,F,Bn,l,jn,p,Un,G,Wn,X,dn,rt,$n,lt,un,Et,Hn,P,Gn,a,zn,c,Vn,E,Xn,W,ae,J,fn,ht,Me,dt,Fe,Lt,fe,Dt,pn,et,De,ft,qn,Ct,gn,Gt,Yn,Ht,Kn,jt,mn,ut,Le,Y,pe;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var r=I(1),f=I(4),z=I(29),U=I(6),ct=I(5);const yt=class yt extends f.AnnotationEditor{constructor(Q){super({...Q,name:"inkEditor"});j(this,F);j(this,l);j(this,p);j(this,G);j(this,X);j(this,rt);j(this,lt);j(this,Et);j(this,P);j(this,a);j(this,c);j(this,E);j(this,W);j(this,J);j(this,ht);j(this,dt);j(this,Lt);j(this,Dt);j(this,et);j(this,Ht);j(this,jt);j(this,ut);j(this,Y);j(this,C,0);j(this,g,0);j(this,L,this.canvasPointermove.bind(this));j(this,O,this.canvasPointerleave.bind(this));j(this,T,this.canvasPointerup.bind(this));j(this,v,this.canvasPointerdown.bind(this));j(this,A,new Path2D);j(this,u,!1);j(this,_,!1);j(this,x,!1);j(this,w,null);j(this,y,0);j(this,o,0);j(this,h,null);this.color=Q.color||null,this.thickness=Q.thickness||null,this.opacity=Q.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Q){f.AnnotationEditor.initialize(Q,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Q,St){switch(Q){case r.AnnotationEditorParamsType.INK_THICKNESS:yt._defaultThickness=St;break;case r.AnnotationEditorParamsType.INK_COLOR:yt._defaultColor=St;break;case r.AnnotationEditorParamsType.INK_OPACITY:yt._defaultOpacity=St/100;break}}updateParams(Q,St){switch(Q){case r.AnnotationEditorParamsType.INK_THICKNESS:q(this,F,Bn).call(this,St);break;case r.AnnotationEditorParamsType.INK_COLOR:q(this,l,jn).call(this,St);break;case r.AnnotationEditorParamsType.INK_OPACITY:q(this,p,Un).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,yt._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,yt._defaultColor||f.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(yt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||yt._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||yt._defaultColor||f.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??yt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(q(this,ht,Me).call(this),q(this,dt,Fe).call(this)),this.isAttachedToDOM||(this.parent.add(this),q(this,Lt,fe).call(this)),q(this,Y,pe).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,w).disconnect(),st(this,w,null),super.remove())}setParent(Q){!this.parent&&Q?this._uiManager.removeShouldRescale(this):this.parent&&Q===null&&this._uiManager.addShouldRescale(this),super.setParent(Q)}onScaleChanging(){const[Q,St]=this.parentDimensions,Ot=this.width*Q,Pt=this.height*St;this.setDimensions(Ot,Pt)}enableEditMode(){t(this,u)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,v)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,v)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,u)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),st(this,u,!0),this.div.classList.add("disabled"),q(this,Y,pe).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Q){this._focusEventsAllowed&&(super.focusin(Q),this.enableEditMode())}canvasPointerdown(Q){Q.button!==0||!this.isInEditMode()||t(this,u)||(this.setInForeground(),Q.preventDefault(),Q.type!=="mouse"&&this.div.focus(),q(this,rt,$n).call(this,Q.offsetX,Q.offsetY))}canvasPointermove(Q){Q.preventDefault(),q(this,lt,un).call(this,Q.offsetX,Q.offsetY)}canvasPointerup(Q){Q.preventDefault(),q(this,J,fn).call(this,Q)}canvasPointerleave(Q){q(this,J,fn).call(this,Q)}get isResizable(){return!this.isEmpty()&&t(this,u)}render(){if(this.div)return this.div;let Q,St;this.width&&(Q=this.x,St=this.y),super.render(),f.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Jt=>{var At;return(At=this.div)==null?void 0:At.setAttribute("aria-label",Jt)});const[Ot,Pt,Nt,Bt]=q(this,G,Wn).call(this);if(this.setAt(Ot,Pt,0,0),this.setDims(Nt,Bt),q(this,ht,Me).call(this),this.width){const[Jt,At]=this.parentDimensions;this.setAspectRatio(this.width*Jt,this.height*At),this.setAt(Q*Jt,St*At,this.width*Jt,this.height*At),st(this,x,!0),q(this,Lt,fe).call(this),this.setDims(this.width*Jt,this.height*At),q(this,W,ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return q(this,dt,Fe).call(this),this.div}setDimensions(Q,St){const Ot=Math.round(Q),Pt=Math.round(St);if(t(this,y)===Ot&&t(this,o)===Pt)return;st(this,y,Ot),st(this,o,Pt),this.canvas.style.visibility="hidden";const[Nt,Bt]=this.parentDimensions;this.width=Q/Nt,this.height=St/Bt,this.fixAndSetPosition(),t(this,u)&&q(this,Dt,pn).call(this,Q,St),q(this,Lt,fe).call(this),q(this,W,ae).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Q,St,Ot){var V,K,ot;if(Q instanceof z.InkAnnotationElement)return null;const Pt=super.deserialize(Q,St,Ot);Pt.thickness=Q.thickness,Pt.color=r.Util.makeHexColor(...Q.color),Pt.opacity=Q.opacity;const[Nt,Bt]=Pt.pageDimensions,Jt=Pt.width*Nt,At=Pt.height*Bt,Yt=Pt.parentScale,It=Q.thickness/2;st(Pt,u,!0),st(Pt,y,Math.round(Jt)),st(Pt,o,Math.round(At));const{paths:N,rect:n,rotation:b}=Q;for(let{bezier:bt}of N){bt=q(V=yt,Gt,Yn).call(V,bt,n,b);const kt=[];Pt.paths.push(kt);let Rt=Yt*(bt[0]-It),Vt=Yt*(bt[1]-It);for(let Ft=2,$t=bt.length;Ft<$t;Ft+=6){const Xt=Yt*(bt[Ft]-It),Kt=Yt*(bt[Ft+1]-It),Qt=Yt*(bt[Ft+2]-It),ie=Yt*(bt[Ft+3]-It),ne=Yt*(bt[Ft+4]-It),se=Yt*(bt[Ft+5]-It);kt.push([[Rt,Vt],[Xt,Kt],[Qt,ie],[ne,se]]),Rt=ne,Vt=se}const Mt=q(this,ft,qn).call(this,kt);Pt.bezierPath2D.push(Mt)}const B=q(K=Pt,jt,mn).call(K);return st(Pt,g,Math.max(f.AnnotationEditor.MIN_SIZE,B[2]-B[0])),st(Pt,C,Math.max(f.AnnotationEditor.MIN_SIZE,B[3]-B[1])),q(ot=Pt,Dt,pn).call(ot,Jt,At),Pt}serialize(){if(this.isEmpty())return null;const Q=this.getRect(0,0),St=f.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:q(this,Ht,Kn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Q),pageIndex:this.pageIndex,rect:Q,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};C=new WeakMap,g=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakMap,v=new WeakMap,A=new WeakMap,u=new WeakMap,_=new WeakMap,x=new WeakMap,w=new WeakMap,y=new WeakMap,o=new WeakMap,h=new WeakMap,F=new WeakSet,Bn=function(Q){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=Q,q(this,Y,pe).call(this)},undo:()=>{this.thickness=St,q(this,Y,pe).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,jn=function(Q){const St=this.color;this.addCommands({cmd:()=>{this.color=Q,q(this,W,ae).call(this)},undo:()=>{this.color=St,q(this,W,ae).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},p=new WeakSet,Un=function(Q){Q/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=Q,q(this,W,ae).call(this)},undo:()=>{this.opacity=St,q(this,W,ae).call(this)},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},G=new WeakSet,Wn=function(){const{parentRotation:Q,parentDimensions:[St,Ot]}=this;switch(Q){case 90:return[0,Ot,Ot,St];case 180:return[St,Ot,St,Ot];case 270:return[St,0,Ot,St];default:return[0,0,St,Ot]}},X=new WeakSet,dn=function(){const{ctx:Q,color:St,opacity:Ot,thickness:Pt,parentScale:Nt,scaleFactor:Bt}=this;Q.lineWidth=Pt*Nt/Bt,Q.lineCap="round",Q.lineJoin="round",Q.miterLimit=10,Q.strokeStyle=`${St}${(0,ct.opacityToHex)(Ot)}`},rt=new WeakSet,$n=function(Q,St){this.canvas.addEventListener("contextmenu",U.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,O)),this.canvas.addEventListener("pointermove",t(this,L)),this.canvas.addEventListener("pointerup",t(this,T)),this.canvas.removeEventListener("pointerdown",t(this,v)),this.isEditing=!0,t(this,x)||(st(this,x,!0),q(this,Lt,fe).call(this),this.thickness||(this.thickness=yt._defaultThickness),this.color||(this.color=yt._defaultColor||f.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=yt._defaultOpacity)),this.currentPath.push([Q,St]),st(this,_,!1),q(this,X,dn).call(this),st(this,h,()=>{q(this,a,zn).call(this),t(this,h)&&window.requestAnimationFrame(t(this,h))}),window.requestAnimationFrame(t(this,h))},lt=new WeakSet,un=function(Q,St){const[Ot,Pt]=this.currentPath.at(-1);if(this.currentPath.length>1&&Q===Ot&&St===Pt)return;const Nt=this.currentPath;let Bt=t(this,A);if(Nt.push([Q,St]),st(this,_,!0),Nt.length<=2){Bt.moveTo(...Nt[0]),Bt.lineTo(Q,St);return}Nt.length===3&&(st(this,A,Bt=new Path2D),Bt.moveTo(...Nt[0])),q(this,c,Vn).call(this,Bt,...Nt.at(-3),...Nt.at(-2),Q,St)},Et=new WeakSet,Hn=function(){if(this.currentPath.length===0)return;const Q=this.currentPath.at(-1);t(this,A).lineTo(...Q)},P=new WeakSet,Gn=function(Q,St){st(this,h,null),Q=Math.min(Math.max(Q,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),q(this,lt,un).call(this,Q,St),q(this,Et,Hn).call(this);let Ot;if(this.currentPath.length!==1)Ot=q(this,E,Xn).call(this);else{const At=[Q,St];Ot=[[At,At.slice(),At.slice(),At]]}const Pt=t(this,A),Nt=this.currentPath;this.currentPath=[],st(this,A,new Path2D);const Bt=()=>{this.allRawPaths.push(Nt),this.paths.push(Ot),this.bezierPath2D.push(Pt),this.rebuild()},Jt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(q(this,ht,Me).call(this),q(this,dt,Fe).call(this)),q(this,Y,pe).call(this))};this.addCommands({cmd:Bt,undo:Jt,mustExec:!0})},a=new WeakSet,zn=function(){if(!t(this,_))return;st(this,_,!1);const Q=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),Ot=St.map(Bt=>Bt[0]),Pt=St.map(Bt=>Bt[1]);Math.min(...Ot)-Q,Math.max(...Ot)+Q,Math.min(...Pt)-Q,Math.max(...Pt)+Q;const{ctx:Nt}=this;Nt.save(),Nt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Bt of this.bezierPath2D)Nt.stroke(Bt);Nt.stroke(t(this,A)),Nt.restore()},c=new WeakSet,Vn=function(Q,St,Ot,Pt,Nt,Bt,Jt){const At=(St+Pt)/2,Yt=(Ot+Nt)/2,It=(Pt+Bt)/2,N=(Nt+Jt)/2;Q.bezierCurveTo(At+2*(Pt-At)/3,Yt+2*(Nt-Yt)/3,It+2*(Pt-It)/3,N+2*(Nt-N)/3,It,N)},E=new WeakSet,Xn=function(){const Q=this.currentPath;if(Q.length<=2)return[[Q[0],Q[0],Q.at(-1),Q.at(-1)]];const St=[];let Ot,[Pt,Nt]=Q[0];for(Ot=1;Ot<Q.length-2;Ot++){const[n,b]=Q[Ot],[B,V]=Q[Ot+1],K=(n+B)/2,ot=(b+V)/2,bt=[Pt+2*(n-Pt)/3,Nt+2*(b-Nt)/3],kt=[K+2*(n-K)/3,ot+2*(b-ot)/3];St.push([[Pt,Nt],bt,kt,[K,ot]]),[Pt,Nt]=[K,ot]}const[Bt,Jt]=Q[Ot],[At,Yt]=Q[Ot+1],It=[Pt+2*(Bt-Pt)/3,Nt+2*(Jt-Nt)/3],N=[At+2*(Bt-At)/3,Yt+2*(Jt-Yt)/3];return St.push([[Pt,Nt],It,N,[At,Yt]]),St},W=new WeakSet,ae=function(){if(this.isEmpty()){q(this,et,De).call(this);return}q(this,X,dn).call(this);const{canvas:Q,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,Q.width,Q.height),q(this,et,De).call(this);for(const Ot of this.bezierPath2D)St.stroke(Ot)},J=new WeakSet,fn=function(Q){this.canvas.removeEventListener("pointerleave",t(this,O)),this.canvas.removeEventListener("pointermove",t(this,L)),this.canvas.removeEventListener("pointerup",t(this,T)),this.canvas.addEventListener("pointerdown",t(this,v)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",U.noContextMenu)},10),q(this,P,Gn).call(this,Q.offsetX,Q.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ht=new WeakSet,Me=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",f.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Q=>{var St;return(St=this.canvas)==null?void 0:St.setAttribute("aria-label",Q)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},dt=new WeakSet,Fe=function(){st(this,w,new ResizeObserver(Q=>{const St=Q[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),t(this,w).observe(this.div)},Lt=new WeakSet,fe=function(){if(!t(this,x))return;const[Q,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Q),this.canvas.height=Math.ceil(this.height*St),q(this,et,De).call(this)},Dt=new WeakSet,pn=function(Q,St){const Ot=q(this,ut,Le).call(this),Pt=(Q-Ot)/t(this,g),Nt=(St-Ot)/t(this,C);this.scaleFactor=Math.min(Pt,Nt)},et=new WeakSet,De=function(){const Q=q(this,ut,Le).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Q,this.translationY*this.scaleFactor+Q)},ft=new WeakSet,qn=function(Q){const St=new Path2D;for(let Ot=0,Pt=Q.length;Ot<Pt;Ot++){const[Nt,Bt,Jt,At]=Q[Ot];Ot===0&&St.moveTo(...Nt),St.bezierCurveTo(Bt[0],Bt[1],Jt[0],Jt[1],At[0],At[1])}return St},Ct=new WeakSet,gn=function(Q,St,Ot){const[Pt,Nt,Bt,Jt]=St;switch(Ot){case 0:for(let At=0,Yt=Q.length;At<Yt;At+=2)Q[At]+=Pt,Q[At+1]=Jt-Q[At+1];break;case 90:for(let At=0,Yt=Q.length;At<Yt;At+=2){const It=Q[At];Q[At]=Q[At+1]+Pt,Q[At+1]=It+Nt}break;case 180:for(let At=0,Yt=Q.length;At<Yt;At+=2)Q[At]=Bt-Q[At],Q[At+1]+=Nt;break;case 270:for(let At=0,Yt=Q.length;At<Yt;At+=2){const It=Q[At];Q[At]=Bt-Q[At+1],Q[At+1]=Jt-It}break;default:throw new Error("Invalid rotation")}return Q},Gt=new WeakSet,Yn=function(Q,St,Ot){const[Pt,Nt,Bt,Jt]=St;switch(Ot){case 0:for(let At=0,Yt=Q.length;At<Yt;At+=2)Q[At]-=Pt,Q[At+1]=Jt-Q[At+1];break;case 90:for(let At=0,Yt=Q.length;At<Yt;At+=2){const It=Q[At];Q[At]=Q[At+1]-Nt,Q[At+1]=It-Pt}break;case 180:for(let At=0,Yt=Q.length;At<Yt;At+=2)Q[At]=Bt-Q[At],Q[At+1]-=Nt;break;case 270:for(let At=0,Yt=Q.length;At<Yt;At+=2){const It=Q[At];Q[At]=Jt-Q[At+1],Q[At+1]=Bt-It}break;default:throw new Error("Invalid rotation")}return Q},Ht=new WeakSet,Kn=function(Q,St,Ot,Pt){var Yt,It;const Nt=[],Bt=this.thickness/2,Jt=Q*St+Bt,At=Q*Ot+Bt;for(const N of this.paths){const n=[],b=[];for(let B=0,V=N.length;B<V;B++){const[K,ot,bt,kt]=N[B],Rt=Q*K[0]+Jt,Vt=Q*K[1]+At,Mt=Q*ot[0]+Jt,Ft=Q*ot[1]+At,$t=Q*bt[0]+Jt,Xt=Q*bt[1]+At,Kt=Q*kt[0]+Jt,Qt=Q*kt[1]+At;B===0&&(n.push(Rt,Vt),b.push(Rt,Vt)),n.push(Mt,Ft,$t,Xt,Kt,Qt),b.push(Mt,Ft),B===V-1&&b.push(Kt,Qt)}Nt.push({bezier:q(Yt=yt,Ct,gn).call(Yt,n,Pt,this.rotation),points:q(It=yt,Ct,gn).call(It,b,Pt,this.rotation)})}return Nt},jt=new WeakSet,mn=function(){let Q=1/0,St=-1/0,Ot=1/0,Pt=-1/0;for(const Nt of this.paths)for(const[Bt,Jt,At,Yt]of Nt){const It=r.Util.bezierBoundingBox(...Bt,...Jt,...At,...Yt);Q=Math.min(Q,It[0]),Ot=Math.min(Ot,It[1]),St=Math.max(St,It[2]),Pt=Math.max(Pt,It[3])}return[Q,Ot,St,Pt]},ut=new WeakSet,Le=function(){return t(this,u)?Math.ceil(this.thickness*this.parentScale):0},Y=new WeakSet,pe=function(Q=!1){if(this.isEmpty())return;if(!t(this,u)){q(this,W,ae).call(this);return}const St=q(this,jt,mn).call(this),Ot=q(this,ut,Le).call(this);st(this,g,Math.max(f.AnnotationEditor.MIN_SIZE,St[2]-St[0])),st(this,C,Math.max(f.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const Pt=Math.ceil(Ot+t(this,g)*this.scaleFactor),Nt=Math.ceil(Ot+t(this,C)*this.scaleFactor),[Bt,Jt]=this.parentDimensions;this.width=Pt/Bt,this.height=Nt/Jt,this.setAspectRatio(Pt,Nt);const At=this.translationX,Yt=this.translationY;this.translationX=-St[0],this.translationY=-St[1],q(this,Lt,fe).call(this),q(this,W,ae).call(this),st(this,y,Pt),st(this,o,Nt),this.setDims(Pt,Nt);const It=Q?Ot/this.scaleFactor/2:0;this.translate(At-this.translationX-It,Yt-this.translationY-It)},j(yt,ft),j(yt,Ct),j(yt,Gt),ee(yt,"_defaultColor",null),ee(yt,"_defaultOpacity",1),ee(yt,"_defaultThickness",1),ee(yt,"_type","ink");let D=yt;e.InkEditor=D},(k,e,I)=>{var D,C,g,L,O,T,v,A,u,_,x,ve,y,Ee,h,Ie,m,bn,R,Jn,$,Qn,S,_n,it,Oe,H,Zn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var r=I(1),f=I(4),z=I(6),U=I(29);const gt=class gt extends f.AnnotationEditor{constructor(P){super({...P,name:"stampEditor"});j(this,x);j(this,y);j(this,h);j(this,m);j(this,R);j(this,$);j(this,S);j(this,it);j(this,H);j(this,D,null);j(this,C,null);j(this,g,null);j(this,L,null);j(this,O,null);j(this,T,null);j(this,v,null);j(this,A,null);j(this,u,!1);j(this,_,!1);st(this,L,P.bitmapUrl),st(this,O,P.bitmapFile)}static initialize(P){f.AnnotationEditor.initialize(P)}static get supportedTypes(){const P=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,r.shadow)(this,"supportedTypes",P.map(i=>`image/${i}`))}static get supportedTypesStr(){return(0,r.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(P){return this.supportedTypes.includes(P)}static paste(P,i){i.pasteEditor(r.AnnotationEditorType.STAMP,{bitmapFile:P.getAsFile()})}remove(){var P,i;t(this,C)&&(st(this,D,null),this._uiManager.imageManager.deleteId(t(this,C)),(P=t(this,T))==null||P.remove(),st(this,T,null),(i=t(this,v))==null||i.disconnect(),st(this,v,null)),super.remove()}rebuild(){if(!this.parent){t(this,C)&&q(this,h,Ie).call(this);return}super.rebuild(),this.div!==null&&(t(this,C)&&q(this,h,Ie).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,g)||t(this,D)||t(this,L)||t(this,O))}get isResizable(){return!0}render(){if(this.div)return this.div;let P,i;if(this.width&&(P=this.x,i=this.y),super.render(),this.div.hidden=!0,t(this,D)?q(this,m,bn).call(this):q(this,h,Ie).call(this),this.width){const[a,s]=this.parentDimensions;this.setAt(P*a,i*s,this.width*a,this.height*s)}return this.div}static deserialize(P,i,a){if(P instanceof U.StampAnnotationElement)return null;const s=super.deserialize(P,i,a),{rect:c,bitmapUrl:d,bitmapId:E,isSvg:M,accessibilityData:W}=P;E&&a.imageManager.isValidId(E)?st(s,C,E):st(s,L,d),st(s,u,M);const[nt,J]=s.pageDimensions;return s.width=(c[2]-c[0])/nt,s.height=(c[3]-c[1])/J,W&&(s.altTextData=W),s}serialize(P=!1,i=null){if(this.isEmpty())return null;const a={annotationType:r.AnnotationEditorType.STAMP,bitmapId:t(this,C),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,u),structTreeParentId:this._structTreeParentId};if(P)return a.bitmapUrl=q(this,it,Oe).call(this,!0),a.accessibilityData=this.altTextData,a;const{decorative:s,altText:c}=this.altTextData;if(!s&&c&&(a.accessibilityData={type:"Figure",alt:c}),i===null)return a;i.stamps||(i.stamps=new Map);const d=t(this,u)?(a.rect[2]-a.rect[0])*(a.rect[3]-a.rect[1]):null;if(!i.stamps.has(t(this,C)))i.stamps.set(t(this,C),{area:d,serialized:a}),a.bitmap=q(this,it,Oe).call(this,!1);else if(t(this,u)){const E=i.stamps.get(t(this,C));d>E.area&&(E.area=d,E.serialized.bitmap.close(),E.serialized.bitmap=q(this,it,Oe).call(this,!1))}return a}};D=new WeakMap,C=new WeakMap,g=new WeakMap,L=new WeakMap,O=new WeakMap,T=new WeakMap,v=new WeakMap,A=new WeakMap,u=new WeakMap,_=new WeakMap,x=new WeakSet,ve=function(P,i=!1){if(!P){this.remove();return}st(this,D,P.bitmap),i||(st(this,C,P.id),st(this,u,P.isSvg)),q(this,m,bn).call(this)},y=new WeakSet,Ee=function(){st(this,g,null),this._uiManager.enableWaiting(!1),t(this,T)&&this.div.focus()},h=new WeakSet,Ie=function(){if(t(this,C)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,C)).then(i=>q(this,x,ve).call(this,i,!0)).finally(()=>q(this,y,Ee).call(this));return}if(t(this,L)){const i=t(this,L);st(this,L,null),this._uiManager.enableWaiting(!0),st(this,g,this._uiManager.imageManager.getFromUrl(i).then(a=>q(this,x,ve).call(this,a)).finally(()=>q(this,y,Ee).call(this)));return}if(t(this,O)){const i=t(this,O);st(this,O,null),this._uiManager.enableWaiting(!0),st(this,g,this._uiManager.imageManager.getFromFile(i).then(a=>q(this,x,ve).call(this,a)).finally(()=>q(this,y,Ee).call(this)));return}const P=document.createElement("input");P.type="file",P.accept=gt.supportedTypesStr,st(this,g,new Promise(i=>{P.addEventListener("change",async()=>{if(!P.files||P.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(P.files[0]);q(this,x,ve).call(this,a)}i()}),P.addEventListener("cancel",()=>{this.remove(),i()})}).finally(()=>q(this,y,Ee).call(this))),P.click()},m=new WeakSet,bn=function(){const{div:P}=this;let{width:i,height:a}=t(this,D);const[s,c]=this.pageDimensions,d=.75;if(this.width)i=this.width*s,a=this.height*c;else if(i>d*s||a>d*c){const nt=Math.min(d*s/i,d*c/a);i*=nt,a*=nt}const[E,M]=this.parentDimensions;this.setDims(i*E/s,a*M/c),this._uiManager.enableWaiting(!1);const W=st(this,T,document.createElement("canvas"));P.append(W),P.hidden=!1,q(this,S,_n).call(this,i,a),q(this,H,Zn).call(this),t(this,_)||(this.parent.addUndoableEditor(this),st(this,_,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},R=new WeakSet,Jn=function(P,i){var d;const[a,s]=this.parentDimensions;this.width=P/a,this.height=i/s,this.setDims(P,i),(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,A)!==null&&clearTimeout(t(this,A)),st(this,A,setTimeout(()=>{st(this,A,null),q(this,S,_n).call(this,P,i)},200))},$=new WeakSet,Qn=function(P,i){const{width:a,height:s}=t(this,D);let c=a,d=s,E=t(this,D);for(;c>2*P||d>2*i;){const M=c,W=d;c>2*P&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2)),d>2*i&&(d=d>=16384?Math.floor(d/2)-1:Math.ceil(d/2));const nt=new OffscreenCanvas(c,d);nt.getContext("2d").drawImage(E,0,0,M,W,0,0,c,d),E=nt.transferToImageBitmap()}return E},S=new WeakSet,_n=function(P,i){P=Math.ceil(P),i=Math.ceil(i);const a=t(this,T);if(!a||a.width===P&&a.height===i)return;a.width=P,a.height=i;const s=t(this,u)?t(this,D):q(this,$,Qn).call(this,P,i),c=a.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(s,0,0,s.width,s.height,0,0,P,i)},it=new WeakSet,Oe=function(P){if(P){if(t(this,u)){const s=this._uiManager.imageManager.getSvgUrl(t(this,C));if(s)return s}const i=document.createElement("canvas");return{width:i.width,height:i.height}=t(this,D),i.getContext("2d").drawImage(t(this,D),0,0),i.toDataURL()}if(t(this,u)){const[i,a]=this.pageDimensions,s=Math.round(this.width*i*z.PixelsPerInch.PDF_TO_CSS_UNITS),c=Math.round(this.height*a*z.PixelsPerInch.PDF_TO_CSS_UNITS),d=new OffscreenCanvas(s,c);return d.getContext("2d").drawImage(t(this,D),0,0,t(this,D).width,t(this,D).height,0,0,s,c),d.transferToImageBitmap()}return structuredClone(t(this,D))},H=new WeakSet,Zn=function(){st(this,v,new ResizeObserver(P=>{const i=P[0].contentRect;i.width&&i.height&&q(this,R,Jn).call(this,i.width,i.height)})),t(this,v).observe(this.div)},ee(gt,"_type","stamp");let ct=gt;e.StampEditor=ct}],__webpack_module_cache__={};function __w_pdfjs_require__(k){var e=__webpack_module_cache__[k];if(e!==void 0)return e.exports;var I=__webpack_module_cache__[k]={exports:{}};return __webpack_modules__[k](I,I.exports,__w_pdfjs_require__),I.exports}var __webpack_exports__={};return(()=>{var k=__webpack_exports__;Object.defineProperty(k,"__esModule",{value:!0}),Object.defineProperty(k,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(k,"AnnotationEditorLayer",{enumerable:!0,get:function(){return z.AnnotationEditorLayer}}),Object.defineProperty(k,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(k,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(k,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return U.AnnotationEditorUIManager}}),Object.defineProperty(k,"AnnotationLayer",{enumerable:!0,get:function(){return ct.AnnotationLayer}}),Object.defineProperty(k,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(k,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(k,"DOMSVGFactory",{enumerable:!0,get:function(){return r.DOMSVGFactory}}),Object.defineProperty(k,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(k,"GlobalWorkerOptions",{enumerable:!0,get:function(){return D.GlobalWorkerOptions}}),Object.defineProperty(k,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(k,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(k,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(k,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(k,"PDFDataRangeTransport",{enumerable:!0,get:function(){return I.PDFDataRangeTransport}}),Object.defineProperty(k,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(k,"PDFWorker",{enumerable:!0,get:function(){return I.PDFWorker}}),Object.defineProperty(k,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(k,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(k,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(k,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(k,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(k,"SVGGraphics",{enumerable:!0,get:function(){return I.SVGGraphics}}),Object.defineProperty(k,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(k,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(k,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(k,"XfaLayer",{enumerable:!0,get:function(){return C.XfaLayer}}),Object.defineProperty(k,"build",{enumerable:!0,get:function(){return I.build}}),Object.defineProperty(k,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(k,"getDocument",{enumerable:!0,get:function(){return I.getDocument}}),Object.defineProperty(k,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(k,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(k,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(k,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(k,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(k,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(k,"noContextMenu",{enumerable:!0,get:function(){return r.noContextMenu}}),Object.defineProperty(k,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(k,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(k,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(k,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(k,"updateTextLayer",{enumerable:!0,get:function(){return f.updateTextLayer}}),Object.defineProperty(k,"version",{enumerable:!0,get:function(){return I.version}});var e=__w_pdfjs_require__(1),I=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),f=__w_pdfjs_require__(26),z=__w_pdfjs_require__(27),U=__w_pdfjs_require__(5),ct=__w_pdfjs_require__(29),D=__w_pdfjs_require__(14),C=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=globalThis&&globalThis.__spreadArray||function(k,e,I){if(I||arguments.length===2)for(var r=0,f=e.length,z;r<f;r++)(z||!(r in e))&&(z||(z=Array.prototype.slice.call(e,0,r)),z[r]=e[r]);return k.concat(z||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(k,e){var I={};return allEvents.forEach(function(r){var f=k[r];f&&(e?I[r]=function(z){return f(z,e(r))}:I[r]=f)}),I}function makeCancellablePromise(k){var e=!1,I=new Promise(function(r,f){k.then(function(z){return!e&&r(z)}).catch(function(z){return!e&&f(z)})});return{promise:I,cancel:function(){e=!0}}}var isProduction=!0,prefix="Invariant failed";function invariant(k,e){if(!k){if(isProduction)throw new Error(prefix);var I=typeof e=="function"?e():e,r=I?"".concat(prefix,": ").concat(I):prefix;throw new Error(r)}}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(k,e,I){for(I of k.keys())if(dequal(I,e))return I}function dequal(k,e){var I,r,f;if(k===e)return!0;if(k&&e&&(I=k.constructor)===e.constructor){if(I===Date)return k.getTime()===e.getTime();if(I===RegExp)return k.toString()===e.toString();if(I===Array){if((r=k.length)===e.length)for(;r--&&dequal(k[r],e[r]););return r===-1}if(I===Set){if(k.size!==e.size)return!1;for(r of k)if(f=r,f&&typeof f=="object"&&(f=find(e,f),!f)||!e.has(f))return!1;return!0}if(I===Map){if(k.size!==e.size)return!1;for(r of k)if(f=r[0],f&&typeof f=="object"&&(f=find(e,f),!f)||!dequal(r[1],e.get(f)))return!1;return!0}if(I===ArrayBuffer)k=new Uint8Array(k),e=new Uint8Array(e);else if(I===DataView){if((r=k.byteLength)===e.byteLength)for(;r--&&k.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(k)){if((r=k.byteLength)===e.byteLength)for(;r--&&k[r]===e[r];);return r===-1}if(!I||typeof k=="object"){r=0;for(I in k)if(has.call(k,I)&&++r&&!has.call(e,I)||!(I in e)||!dequal(k[I],e[I]))return!1;return Object.keys(e).length===r}}return k!==k&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:k,type:e}){return jsxRuntimeExports.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:k})}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(I=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(e,"Destination is not specified."),typeof e=="string"?this.pdfDocument.getDestination(e).then(I):Array.isArray(e)?I(e):e.then(I)}).then(I=>{invariant(Array.isArray(I),`"${I}" is not a valid destination array.`);const r=I[0];new Promise(f=>{invariant(this.pdfDocument,"PDF document not loaded."),r instanceof Object?this.pdfDocument.getPageIndex(r).then(z=>{f(z)}).catch(()=>{invariant(!1,`"${r}" is not a valid page reference.`)}):typeof r=="number"?f(r):invariant(!1,`"${r}" is not a valid destination reference.`)}).then(f=>{const z=f+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(z>=1&&z<=this.pagesCount,`"${z}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:I,pageIndex:f,pageNumber:z})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const I=e-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(e>=1&&e<=this.pagesCount,`"${e}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:I,pageNumber:e})}addLinkAttributes(e,I,r){e.href=I,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=r?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(k){return typeof k<"u"}function isProvided(k){return isDefined(k)&&k!==null}function isString(k){return typeof k=="string"}function isArrayBuffer(k){return k instanceof ArrayBuffer}function isBlob(k){return invariant(isBrowser,"isBlob can only be used in a browser environment"),k instanceof Blob}function isDataURI(k){return isString(k)&&/^data:/.test(k)}function dataURItoByteString(k){invariant(isDataURI(k),"Invalid data URI.");const[e="",I=""]=k.split(",");return e.split(";").indexOf("base64")!==-1?atob(I):unescape(I)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(k){k&&k.cancel&&k.cancel()}function makePageCallback(k,e){return Object.defineProperty(k,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(k,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(k,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(k,"originalHeight",{get(){return this.view[3]},configurable:!0}),k}function isCancelException(k){return k.name==="RenderingCancelledException"}function loadFromFile(k){return new Promise((e,I)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return I(new Error("Error while reading a file."));e(r.result)},r.onerror=f=>{if(!f.target)return I(new Error("Error while reading a file."));const{error:z}=f.target;if(!z)return I(new Error("Error while reading a file."));switch(z.code){case z.NOT_FOUND_ERR:return I(new Error("Error while reading a file: File not found."));case z.SECURITY_ERR:return I(new Error("Error while reading a file: Security error."));case z.ABORT_ERR:return I(new Error("Error while reading a file: Aborted."));default:return I(new Error("Error while reading a file."))}},r.readAsArrayBuffer(k)})}function reducer(k,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return k}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}var __awaiter=globalThis&&globalThis.__awaiter||function(k,e,I,r){function f(z){return z instanceof I?z:new I(function(U){U(z)})}return new(I||(I=Promise))(function(z,U){function ct(g){try{C(r.next(g))}catch(L){U(L)}}function D(g){try{C(r.throw(g))}catch(L){U(L)}}function C(g){g.done?z(g.value):f(g.value).then(ct,D)}C((r=r.apply(k,e||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(k,e){var I={};for(var r in k)Object.prototype.hasOwnProperty.call(k,r)&&e.indexOf(r)<0&&(I[r]=k[r]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,r=Object.getOwnPropertySymbols(k);f<r.length;f++)e.indexOf(r[f])<0&&Object.prototype.propertyIsEnumerable.call(k,r[f])&&(I[r[f]]=k[r[f]]);return I};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(k,e)=>{switch(e){case PasswordResponses$1.NEED_PASSWORD:{const I=prompt("Enter the password to open this PDF file.");k(I);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const I=prompt("Invalid password. Please try again.");k(I);break}}};function isParameterObject(k){return typeof k=="object"&&k!==null&&("data"in k||"range"in k||"url"in k)}const Document=reactExports.forwardRef(function k(e,I){var{children:r,className:f,error:z="Failed to load PDF file.",externalLinkRel:U,externalLinkTarget:ct,file:D,inputRef:C,imageResourcesPath:g,loading:L="Loading PDF…",noData:O="No PDF file specified.",onItemClick:T,onLoadError:v,onLoadProgress:A,onLoadSuccess:u,onPassword:_=defaultOnPassword,onSourceError:x,onSourceSuccess:w,options:y,renderMode:o,rotate:h}=e,F=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[m,l]=useResolver(),{value:R,error:p}=m,[$,G]=useResolver(),{value:S,error:X}=$,it=reactExports.useRef(new LinkService),rt=reactExports.useRef([]),H=reactExports.useRef(void 0),lt=reactExports.useRef(void 0);D&&D!==H.current&&isParameterObject(D)&&(warning$1(!dequal(D,H.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),H.current=D),y&&y!==lt.current&&(warning$1(!dequal(y,lt.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),lt.current=y);const gt=reactExports.useRef({scrollPageIntoView:pt=>{const{dest:dt,pageNumber:Tt,pageIndex:Lt=Tt-1}=pt;if(T){T({dest:dt,pageIndex:Lt,pageNumber:Tt});return}const vt=rt.current[Lt];if(vt){vt.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${Tt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(I,()=>({linkService:it,pages:rt,viewer:gt}),[]);function Et(){w&&w()}function xt(){p&&(warning$1(!1,p.toString()),x&&x(p))}function P(){l({type:"RESET"})}reactExports.useEffect(P,[D,l]);const i=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!D)return null;if(typeof D=="string")return isDataURI(D)?{data:dataURItoByteString(D)}:(displayCORSWarning(),{url:D});if(D instanceof PDFDataRangeTransport)return{range:D};if(isArrayBuffer(D))return{data:D};if(isBrowser&&isBlob(D))return{data:yield loadFromFile(D)};if(invariant(typeof D=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(isParameterObject(D),"Invalid parameter object: need either .data, .range or .url"),"url"in D&&typeof D.url=="string"){if(isDataURI(D.url)){const{url:pt}=D,dt=__rest$1(D,["url"]),Tt=dataURItoByteString(pt);return Object.assign({data:Tt},dt)}displayCORSWarning()}return D}),[D]);reactExports.useEffect(()=>{const pt=makeCancellablePromise(i());return pt.promise.then(dt=>{l({type:"RESOLVE",value:dt})}).catch(dt=>{l({type:"REJECT",error:dt})}),()=>{cancelRunningTask(pt)}},[i,l]),reactExports.useEffect(()=>{if(!(typeof R>"u")){if(R===!1){xt();return}Et()}},[R]);function a(){S&&(u&&u(S),rt.current=new Array(S.numPages),it.current.setDocument(S))}function s(){X&&(warning$1(!1,X.toString()),v&&v(X))}function c(){G({type:"RESET"})}reactExports.useEffect(c,[G,R]);function d(){if(!R)return;const pt=Object.assign(Object.assign({},y),{isEvalSupported:!1}),dt=Object.assign(Object.assign({},R),pt),Tt=pdfjs$1.getDocument(dt);A&&(Tt.onProgress=A),_&&(Tt.onPassword=_);const Lt=Tt;return Lt.promise.then(vt=>{G({type:"RESOLVE",value:vt})}).catch(vt=>{Lt.destroyed||G({type:"REJECT",error:vt})}),()=>{Lt.destroy()}}reactExports.useEffect(d,[y,G,R]),reactExports.useEffect(()=>{if(!(typeof S>"u")){if(S===!1){s();return}a()}},[S]);function E(){it.current.setViewer(gt.current),it.current.setExternalLinkRel(U),it.current.setExternalLinkTarget(ct)}reactExports.useEffect(E,[U,ct]);function M(pt,dt){rt.current[pt]=dt}function W(pt){delete rt.current[pt]}const nt=reactExports.useMemo(()=>({imageResourcesPath:g,linkService:it.current,onItemClick:T,pdf:S,registerPage:M,renderMode:o,rotate:h,unregisterPage:W}),[g,T,S,o,h]),J=reactExports.useMemo(()=>makeEventProps(F,()=>S),[F,S]);function at(){return jsxRuntimeExports.jsx(DocumentContext.Provider,{value:nt,children:r})}function ht(){return D?S==null?jsxRuntimeExports.jsx(Message,{type:"loading",children:typeof L=="function"?L():L}):S===!1?jsxRuntimeExports.jsx(Message,{type:"error",children:typeof z=="function"?z():z}):at():jsxRuntimeExports.jsx(Message,{type:"no-data",children:typeof O=="function"?O():O})}return jsxRuntimeExports.jsx("div",Object.assign({className:clsx("react-pdf__Document",f),ref:C,style:{"--scale-factor":"1"}},J,{children:ht()}))}),Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var k=[],e=0;e<arguments.length;e++)k[e]=arguments[e];var I=k.filter(Boolean);if(I.length<=1){var r=I[0];return r||null}return function(z){I.forEach(function(U){typeof U=="function"?U(z):U&&(U.current=z)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(k){return k in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(k){return"children"in k}function isStructTreeNodeWithOnlyContentChild(k){return isStructTreeNode(k)?k.children.length===1&&0 in k.children&&"id"in k.children[0]:!1}function getRoleAttributes(k){const e={};if(isStructTreeNode(k)){const{role:I}=k,r=I.match(HEADING_PATTERN);if(r)e.role="heading",e["aria-level"]=Number(r[1]);else if(isPdfRole(I)){const f=PDF_ROLE_TO_HTML_ROLE[I];f&&(e.role=f)}}return e}function getBaseAttributes(k){const e={};if(isStructTreeNode(k)){if(k.alt!==void 0&&(e["aria-label"]=k.alt),k.lang!==void 0&&(e.lang=k.lang),isStructTreeNodeWithOnlyContentChild(k)){const[I]=k.children;if(I){const r=getBaseAttributes(I);return Object.assign(Object.assign({},e),r)}}}else"id"in k&&(e["aria-owns"]=k.id);return e}function getAttributes(k){return k?Object.assign(Object.assign({},getRoleAttributes(k)),getBaseAttributes(k)):null}function StructTreeItem({className:k,node:e}){const I=reactExports.useMemo(()=>getAttributes(e),[e]),r=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((f,z)=>jsxRuntimeExports.jsx(StructTreeItem,{node:f},z)),[e]);return jsxRuntimeExports.jsx("span",Object.assign({className:k},I,{children:r}))}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const k=usePageContext();invariant(k,"Unable to find Page context.");const{onGetStructTreeError:e,onGetStructTreeSuccess:I}=k,[r,f]=useResolver(),{value:z,error:U}=r,{customTextRenderer:ct,page:D}=k;function C(){z&&I&&I(z)}function g(){U&&(warning$1(!1,U.toString()),e&&e(U))}function L(){f({type:"RESET"})}reactExports.useEffect(L,[f,D]);function O(){if(ct||!D)return;const T=makeCancellablePromise(D.getStructTree()),v=T;return T.promise.then(A=>{f({type:"RESOLVE",value:A})}).catch(A=>{f({type:"REJECT",error:A})}),()=>cancelRunningTask(v)}return reactExports.useEffect(O,[ct,D,f]),reactExports.useEffect(()=>{if(z!==void 0){if(z===!1){g();return}C()}},[z]),z?jsxRuntimeExports.jsx(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:z}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(k){const e=usePageContext();invariant(e,"Unable to find Page context.");const I=Object.assign(Object.assign({},e),k),{_className:r,canvasBackground:f,devicePixelRatio:z=getDevicePixelRatio(),onRenderError:U,onRenderSuccess:ct,page:D,renderForms:C,renderTextLayer:g,rotate:L,scale:O}=I,{canvasRef:T}=k;invariant(D,"Attempted to render page canvas, but no page was specified.");const v=reactExports.useRef(null);function A(){D&&ct&&ct(makePageCallback(D,O))}function u(o){isCancelException(o)||(warning$1(!1,o.toString()),U&&U(o))}const _=reactExports.useMemo(()=>D.getViewport({scale:O*z,rotation:L}),[z,D,L,O]),x=reactExports.useMemo(()=>D.getViewport({scale:O,rotation:L}),[D,L,O]);function w(){if(!D)return;D.cleanup();const{current:o}=v;if(!o)return;o.width=_.width,o.height=_.height,o.style.width=`${Math.floor(x.width)}px`,o.style.height=`${Math.floor(x.height)}px`,o.style.visibility="hidden";const h={annotationMode:C?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:o.getContext("2d",{alpha:!1}),viewport:_};f&&(h.background=f);const F=D.render(h),m=F;return F.promise.then(()=>{o.style.visibility="",A()}).catch(u),()=>cancelRunningTask(m)}reactExports.useEffect(w,[f,v,z,D,C,_,x]);const y=reactExports.useCallback(()=>{const{current:o}=v;o&&(o.width=0,o.height=0)},[v]);return reactExports.useEffect(()=>y,[y]),jsxRuntimeExports.jsx("canvas",{className:`${r}__canvas`,dir:"ltr",ref:mergeRefs(T,v),style:{display:"block",userSelect:"none"},children:g?jsxRuntimeExports.jsx(StructTree,{}):null})}function PageSVG(){const k=usePageContext();invariant(k,"Unable to find Page context.");const{_className:e,onRenderSuccess:I,onRenderError:r,page:f,rotate:z,scale:U}=k;invariant(f,"Attempted to render page SVG, but no page was specified.");const[ct,D]=useResolver(),{value:C,error:g}=ct;function L(){f&&I&&I(makePageCallback(f,U))}function O(){g&&(isCancelException(g)||(warning$1(!1,g.toString()),r&&r(g)))}const T=reactExports.useMemo(()=>f.getViewport({scale:U,rotation:z}),[f,z,U]);function v(){D({type:"RESET"})}reactExports.useEffect(v,[f,D,T]);function A(){if(!f)return;const w=makeCancellablePromise(f.getOperatorList());return w.promise.then(y=>{new pdfjs$1.SVGGraphics(f.commonObjs,f.objs).getSVG(y,T).then(h=>{if(!(h instanceof SVGElement))throw new Error("getSVG returned unexpected result.");D({type:"RESOLVE",value:h})}).catch(h=>{D({type:"REJECT",error:h})})}).catch(y=>{D({type:"REJECT",error:y})}),()=>cancelRunningTask(w)}reactExports.useEffect(A,[f,D,T]),reactExports.useEffect(()=>{if(C!==void 0){if(C===!1){O();return}L()}},[C]);function u(w){if(!w||!C)return;w.firstElementChild||w.appendChild(C);const{width:y,height:o}=T;C.setAttribute("width",`${y}`),C.setAttribute("height",`${o}`)}const{width:_,height:x}=T;return jsxRuntimeExports.jsx("div",{className:`${e}__svg`,ref:w=>u(w),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:_,height:x,userSelect:"none"}})}function isTextItem(k){return"str"in k}function TextLayer(){const k=usePageContext();invariant(k,"Unable to find Page context.");const{customTextRenderer:e,onGetTextError:I,onGetTextSuccess:r,onRenderTextLayerError:f,onRenderTextLayerSuccess:z,page:U,pageIndex:ct,pageNumber:D,rotate:C,scale:g}=k;invariant(U,"Attempted to load page text content, but no page was specified.");const[L,O]=useResolver(),{value:T,error:v}=L,A=reactExports.useRef(null),u=reactExports.useRef(void 0);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function _(){T&&r&&r(T)}function x(){v&&(warning$1(!1,v.toString()),I&&I(v))}function w(){O({type:"RESET"})}reactExports.useEffect(w,[U,O]);function y(){if(!U)return;const p=makeCancellablePromise(U.getTextContent()),$=p;return p.promise.then(G=>{O({type:"RESOLVE",value:G})}).catch(G=>{O({type:"REJECT",error:G})}),()=>cancelRunningTask($)}reactExports.useEffect(y,[U,O]),reactExports.useEffect(()=>{if(T!==void 0){if(T===!1){x();return}_()}},[T]);const o=reactExports.useCallback(()=>{z&&z()},[z]),h=reactExports.useCallback(p=>{warning$1(!1,p.toString()),f&&f(p)},[f]);function F(){const p=u.current;p&&p.classList.add("active")}function m(){const p=u.current;p&&p.classList.remove("active")}const l=reactExports.useMemo(()=>U.getViewport({scale:g,rotation:C}),[U,C,g]);function R(){if(!U||!T)return;const{current:p}=A;if(!p)return;p.innerHTML="";const $=U.streamTextContent({includeMarkedContent:!0}),G={container:p,textContentSource:$,viewport:l},S=pdfjs$1.renderTextLayer(G),X=S;return S.promise.then(()=>{const it=document.createElement("div");it.className="endOfContent",p.append(it),u.current=it;const rt=p.querySelectorAll('[role="presentation"]');if(e){let H=0;T.items.forEach((lt,gt)=>{if(!isTextItem(lt))return;const Et=rt[H];if(!Et)return;const xt=e(Object.assign({pageIndex:ct,pageNumber:D,itemIndex:gt},lt));Et.innerHTML=xt,H+=lt.str&&lt.hasEOL?2:1})}o()}).catch(h),()=>cancelRunningTask(X)}return reactExports.useLayoutEffect(R,[e,h,o,U,ct,D,T,l]),jsxRuntimeExports.jsx("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:m,onMouseDown:F,ref:A})}function AnnotationLayer(){const k=useDocumentContext(),e=usePageContext();invariant(e,"Unable to find Page context.");const I=Object.assign(Object.assign({},k),e),{imageResourcesPath:r,linkService:f,onGetAnnotationsError:z,onGetAnnotationsSuccess:U,onRenderAnnotationLayerError:ct,onRenderAnnotationLayerSuccess:D,page:C,pdf:g,renderForms:L,rotate:O,scale:T=1}=I;invariant(g,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),invariant(C,"Attempted to load page annotations, but no page was specified."),invariant(f,"Attempted to load page annotations, but no linkService was specified.");const[v,A]=useResolver(),{value:u,error:_}=v,x=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function w(){u&&U&&U(u)}function y(){_&&(warning$1(!1,_.toString()),z&&z(_))}function o(){A({type:"RESET"})}reactExports.useEffect(o,[A,C]);function h(){if(!C)return;const p=makeCancellablePromise(C.getAnnotations()),$=p;return p.promise.then(G=>{A({type:"RESOLVE",value:G})}).catch(G=>{A({type:"REJECT",error:G})}),()=>{cancelRunningTask($)}}reactExports.useEffect(h,[A,C,L]),reactExports.useEffect(()=>{if(u!==void 0){if(u===!1){y();return}w()}},[u]);function F(){D&&D()}function m(p){warning$1(!1,`${p}`),ct&&ct(p)}const l=reactExports.useMemo(()=>C.getViewport({scale:T,rotation:O}),[C,O,T]);function R(){if(!g||!C||!f||!u)return;const{current:p}=x;if(!p)return;const $=l.clone({dontFlip:!0}),G={accessibilityManager:null,annotationCanvasMap:null,div:p,l10n:null,page:C,viewport:$},S={annotations:u,annotationStorage:g.annotationStorage,div:p,downloadManager:null,imageResourcesPath:r,linkService:f,page:C,renderForms:L,viewport:$};p.innerHTML="";try{new pdfjs$1.AnnotationLayer(G).render(S),F()}catch(X){m(X)}return()=>{}}return reactExports.useEffect(R,[u,r,f,C,L,l]),jsxRuntimeExports.jsx("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:x})}var __rest=globalThis&&globalThis.__rest||function(k,e){var I={};for(var r in k)Object.prototype.hasOwnProperty.call(k,r)&&e.indexOf(r)<0&&(I[r]=k[r]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,r=Object.getOwnPropertySymbols(k);f<r.length;f++)e.indexOf(r[f])<0&&Object.prototype.propertyIsEnumerable.call(k,r[f])&&(I[r[f]]=k[r[f]]);return I};const defaultScale=1;function Page(k){const e=useDocumentContext(),I=Object.assign(Object.assign({},e),k),{_className:r="react-pdf__Page",_enableRegisterUnregisterPage:f=!0,canvasBackground:z,canvasRef:U,children:ct,className:D,customRenderer:C,customTextRenderer:g,devicePixelRatio:L,error:O="Failed to load the page.",height:T,inputRef:v,loading:A="Loading page…",noData:u="No page specified.",onGetAnnotationsError:_,onGetAnnotationsSuccess:x,onGetStructTreeError:w,onGetStructTreeSuccess:y,onGetTextError:o,onGetTextSuccess:h,onLoadError:F,onLoadSuccess:m,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:R,onRenderError:p,onRenderSuccess:$,onRenderTextLayerError:G,onRenderTextLayerSuccess:S,pageIndex:X,pageNumber:it,pdf:rt,registerPage:H,renderAnnotationLayer:lt=!0,renderForms:gt=!1,renderMode:Et="canvas",renderTextLayer:xt=!0,rotate:P,scale:i=defaultScale,unregisterPage:a,width:s}=I,c=__rest(I,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[d,E]=useResolver(),{value:M,error:W}=d,nt=reactExports.useRef(null);invariant(rt,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const J=isProvided(it)?it-1:X??null,at=it??(isProvided(X)?X+1:null),ht=P??(M?M.rotate:null),pt=reactExports.useMemo(()=>{if(!M)return null;let Ht=1;const zt=i??defaultScale;if(s||T){const jt=M.getViewport({scale:1,rotation:ht});s?Ht=s/jt.width:T&&(Ht=T/jt.height)}return zt*Ht},[T,M,ht,i,s]);function dt(){return()=>{isProvided(J)&&f&&a&&a(J)}}reactExports.useEffect(dt,[f,rt,J,a]);function Tt(){if(m){if(!M||!pt)return;m(makePageCallback(M,pt))}if(f&&H){if(!isProvided(J)||!nt.current)return;H(J,nt.current)}}function Lt(){W&&(warning$1(!1,W.toString()),F&&F(W))}function vt(){E({type:"RESET"})}reactExports.useEffect(vt,[E,rt,J]);function Dt(){if(!rt||!at)return;const Ht=makeCancellablePromise(rt.getPage(at)),zt=Ht;return Ht.promise.then(jt=>{E({type:"RESOLVE",value:jt})}).catch(jt=>{E({type:"REJECT",error:jt})}),()=>cancelRunningTask(zt)}reactExports.useEffect(Dt,[E,rt,J,at,H]),reactExports.useEffect(()=>{if(M!==void 0){if(M===!1){Lt();return}Tt()}},[M,pt]);const mt=reactExports.useMemo(()=>M&&isProvided(J)&&at&&isProvided(ht)&&isProvided(pt)?{_className:r,canvasBackground:z,customTextRenderer:g,devicePixelRatio:L,onGetAnnotationsError:_,onGetAnnotationsSuccess:x,onGetStructTreeError:w,onGetStructTreeSuccess:y,onGetTextError:o,onGetTextSuccess:h,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:R,onRenderError:p,onRenderSuccess:$,onRenderTextLayerError:G,onRenderTextLayerSuccess:S,page:M,pageIndex:J,pageNumber:at,renderForms:gt,renderTextLayer:xt,rotate:ht,scale:pt}:null,[r,z,g,L,_,x,w,y,o,h,l,R,p,$,G,S,M,J,at,gt,xt,ht,pt]),et=reactExports.useMemo(()=>makeEventProps(c,()=>M&&(pt?makePageCallback(M,pt):void 0)),[c,M,pt]),Z=`${J}@${pt}/${ht}`,ft=`${J}/${ht}`;function wt(){switch(Et){case"custom":return invariant(C,'renderMode was set to "custom", but no customRenderer was passed.'),jsxRuntimeExports.jsx(C,{},`${Z}_custom`);case"none":return null;case"svg":return jsxRuntimeExports.jsx(PageSVG,{},`${ft}_svg`);case"canvas":default:return jsxRuntimeExports.jsx(PageCanvas,{canvasRef:U},`${Z}_canvas`)}}function Ct(){return xt?jsxRuntimeExports.jsx(TextLayer,{},`${Z}_text`):null}function Ut(){return lt?jsxRuntimeExports.jsx(AnnotationLayer,{},`${Z}_annotations`):null}function Gt(){return jsxRuntimeExports.jsxs(PageContext.Provider,{value:mt,children:[wt(),Ct(),Ut(),ct]})}function Wt(){return at?rt===null||M===void 0||M===null?jsxRuntimeExports.jsx(Message,{type:"loading",children:typeof A=="function"?A():A}):rt===!1||M===!1?jsxRuntimeExports.jsx(Message,{type:"error",children:typeof O=="function"?O():O}):Gt():jsxRuntimeExports.jsx(Message,{type:"no-data",children:typeof u=="function"?u():u})}return jsxRuntimeExports.jsx("div",Object.assign({className:clsx(r,D),"data-page-number":at,ref:mergeRefs(v,nt),style:{"--scale-factor":`${pt}`,backgroundColor:z||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},et,{children:Wt()}))}displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";const MockTest_NTA="";export{ButtonGroup$1 as B,Document$1 as D,Page as P,pdfjs$1 as p};
