var Ht=Object.defineProperty;var zt=(P,n,y)=>n in P?Ht(P,n,{enumerable:!0,configurable:!0,writable:!0,value:y}):P[n]=y;var Me=(P,n,y)=>(zt(P,typeof n!="symbol"?n+"":n,y),y),st=(P,n,y)=>{if(!n.has(P))throw TypeError("Cannot "+y)};var O=(P,n,y)=>(st(P,n,"read from private field"),y?y.call(P):n.get(P)),ae=(P,n,y)=>{if(n.has(P))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(P):n.set(P,y)},me=(P,n,y,t)=>(st(P,n,"write to private field"),t?t.call(P,y):n.set(P,y),y);var at=(P,n,y,t)=>({set _(a){me(P,n,a,y)},get _(){return O(P,n,t)}}),he=(P,n,y)=>(st(P,n,"access private method"),y);import{az as getAugmentedNamespace,l as _objectWithoutPropertiesLoose,aA as _setPrototypeOf,aB as _assertThisInitialized,r as reactExports,ak as PropTypes,a2 as React,i as _extends,o as clsx}from"./index-64b38d72.js";function commonjsRequire(P){throw new Error('Could not dynamically require "'+P+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,y){module.exports=y()})(globalThis,()=>(()=>{var __webpack_modules__=[,(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.UNSUPPORTED_FEATURES=n.TextRenderingMode=n.StreamType=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.arrayByteLength=re,n.arraysToBytes=ue,n.assert=d,n.bytesToString=I,n.createPromiseCapability=pe,n.createValidAbsoluteUrl=R,n.escapeString=Ce,n.getModificationDate=se,n.getVerbosityLevel=ne,n.info=ce,n.isArrayBuffer=Oe,n.isArrayEqual=Ze,n.isAscii=Fe,n.objectFromMap=te,n.objectSize=oe,n.setVerbosityLevel=Y,n.shadow=j,n.string32=Z,n.stringToBytes=q,n.stringToPDFString=Ee,n.stringToUTF16BEString=ke,n.stringToUTF8String=ze,n.unreachable=W,n.utf8StringToString=Pe,n.warn=_e,y(2);const t=[1,0,0,1,0,0];n.IDENTITY_MATRIX=t;const a=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=a;const F=1.35;n.LINE_FACTOR=F;const D=.35;n.LINE_DESCENT_FACTOR=D;const T={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=T;const A={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=A;const f="pdfjs_internal_editor_";n.AnnotationEditorPrefix=f;const w={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};n.AnnotationEditorType=w;const L={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};n.AnnotationEditorParamsType=L;const C={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=C;const S={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=S;const h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=h;const e={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=e;const i={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=i;const l={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=l;const b={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=b;const v={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=v;const c={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=c;const r={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=r;const s={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=s;const g={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=g;const k={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=k;const E={O:"PageOpen",C:"PageClose"};n.PageActionEventType=E;const m={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=m;const M={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=M;const ee={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=ee;const ie={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=ie;const Q={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=Q;const K={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};n.UNSUPPORTED_FEATURES=K;const G={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=G;let $=ee.WARNINGS;function Y(J){Number.isInteger(J)&&($=J)}function ne(){return $}function ce(J){$>=ee.INFOS&&console.log(`Info: ${J}`)}function _e(J){$>=ee.WARNINGS&&console.log(`Warning: ${J}`)}function W(J){throw new Error(J)}function d(J,H){J||W(H)}function u(J){if(!J)return!1;switch(J.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function R(J,H=null,z=null){if(!J)return null;try{if(z&&typeof J=="string"){if(z.addDefaultProtocol&&J.startsWith("www.")){const ye=J.match(/\./g);ye&&ye.length>=2&&(J=`http://${J}`)}if(z.tryConvertEncoding)try{J=ze(J)}catch{}}const ge=H?new URL(J,H):new URL(J);if(u(ge))return ge}catch{}return null}function j(J,H,z){return Object.defineProperty(J,H,{value:z,enumerable:!0,configurable:!0,writable:!1}),z}const U=function(){function H(z,ge){this.constructor===H&&W("Cannot initialize BaseException."),this.message=z,this.name=ge}return H.prototype=new Error,H.constructor=H,H}();n.BaseException=U;class B extends U{constructor(H,z){super(H,"PasswordException"),this.code=z}}n.PasswordException=B;class V extends U{constructor(H,z){super(H,"UnknownErrorException"),this.details=z}}n.UnknownErrorException=V;class X extends U{constructor(H){super(H,"InvalidPDFException")}}n.InvalidPDFException=X;class o extends U{constructor(H){super(H,"MissingPDFException")}}n.MissingPDFException=o;class p extends U{constructor(H,z){super(H,"UnexpectedResponseException"),this.status=z}}n.UnexpectedResponseException=p;class _ extends U{constructor(H){super(H,"FormatError")}}n.FormatError=_;class x extends U{constructor(H){super(H,"AbortException")}}n.AbortException=x;function I(J){(typeof J!="object"||J===null||J.length===void 0)&&W("Invalid argument for bytesToString");const H=J.length,z=8192;if(H<z)return String.fromCharCode.apply(null,J);const ge=[];for(let ye=0;ye<H;ye+=z){const ve=Math.min(ye+z,H),Se=J.subarray(ye,ve);ge.push(String.fromCharCode.apply(null,Se))}return ge.join("")}function q(J){typeof J!="string"&&W("Invalid argument for stringToBytes");const H=J.length,z=new Uint8Array(H);for(let ge=0;ge<H;++ge)z[ge]=J.charCodeAt(ge)&255;return z}function re(J){if(J.length!==void 0)return J.length;if(J.byteLength!==void 0)return J.byteLength;W("Invalid argument for arrayByteLength")}function ue(J){const H=J.length;if(H===1&&J[0]instanceof Uint8Array)return J[0];let z=0;for(let ve=0;ve<H;ve++)z+=re(J[ve]);let ge=0;const ye=new Uint8Array(z);for(let ve=0;ve<H;ve++){let Se=J[ve];Se instanceof Uint8Array||(typeof Se=="string"?Se=q(Se):Se=new Uint8Array(Se));const xe=Se.byteLength;ye.set(Se,ge),ge+=xe}return ye}function Z(J){return String.fromCharCode(J>>24&255,J>>16&255,J>>8&255,J&255)}function oe(J){return Object.keys(J).length}function te(J){const H=Object.create(null);for(const[z,ge]of J)H[z]=ge;return H}function le(){const J=new Uint8Array(4);return J[0]=1,new Uint32Array(J.buffer,0,1)[0]===1}function fe(){try{return new Function(""),!0}catch{return!1}}class N{static get isLittleEndian(){return j(this,"isLittleEndian",le())}static get isEvalSupported(){return j(this,"isEvalSupported",fe())}static get isOffscreenCanvasSupported(){return j(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}n.FeatureTest=N;const de=[...Array(256).keys()].map(J=>J.toString(16).padStart(2,"0"));class be{static makeHexColor(H,z,ge){return`#${de[H]}${de[z]}${de[ge]}`}static scaleMinMax(H,z){let ge;H[0]?(H[0]<0&&(ge=z[0],z[0]=z[1],z[1]=ge),z[0]*=H[0],z[1]*=H[0],H[3]<0&&(ge=z[2],z[2]=z[3],z[3]=ge),z[2]*=H[3],z[3]*=H[3]):(ge=z[0],z[0]=z[2],z[2]=ge,ge=z[1],z[1]=z[3],z[3]=ge,H[1]<0&&(ge=z[2],z[2]=z[3],z[3]=ge),z[2]*=H[1],z[3]*=H[1],H[2]<0&&(ge=z[0],z[0]=z[1],z[1]=ge),z[0]*=H[2],z[1]*=H[2]),z[0]+=H[4],z[1]+=H[4],z[2]+=H[5],z[3]+=H[5]}static transform(H,z){return[H[0]*z[0]+H[2]*z[1],H[1]*z[0]+H[3]*z[1],H[0]*z[2]+H[2]*z[3],H[1]*z[2]+H[3]*z[3],H[0]*z[4]+H[2]*z[5]+H[4],H[1]*z[4]+H[3]*z[5]+H[5]]}static applyTransform(H,z){const ge=H[0]*z[0]+H[1]*z[2]+z[4],ye=H[0]*z[1]+H[1]*z[3]+z[5];return[ge,ye]}static applyInverseTransform(H,z){const ge=z[0]*z[3]-z[1]*z[2],ye=(H[0]*z[3]-H[1]*z[2]+z[2]*z[5]-z[4]*z[3])/ge,ve=(-H[0]*z[1]+H[1]*z[0]+z[4]*z[1]-z[5]*z[0])/ge;return[ye,ve]}static getAxialAlignedBoundingBox(H,z){const ge=be.applyTransform(H,z),ye=be.applyTransform(H.slice(2,4),z),ve=be.applyTransform([H[0],H[3]],z),Se=be.applyTransform([H[2],H[1]],z);return[Math.min(ge[0],ye[0],ve[0],Se[0]),Math.min(ge[1],ye[1],ve[1],Se[1]),Math.max(ge[0],ye[0],ve[0],Se[0]),Math.max(ge[1],ye[1],ve[1],Se[1])]}static inverseTransform(H){const z=H[0]*H[3]-H[1]*H[2];return[H[3]/z,-H[1]/z,-H[2]/z,H[0]/z,(H[2]*H[5]-H[4]*H[3])/z,(H[4]*H[1]-H[5]*H[0])/z]}static apply3dTransform(H,z){return[H[0]*z[0]+H[1]*z[1]+H[2]*z[2],H[3]*z[0]+H[4]*z[1]+H[5]*z[2],H[6]*z[0]+H[7]*z[1]+H[8]*z[2]]}static singularValueDecompose2dScale(H){const z=[H[0],H[2],H[1],H[3]],ge=H[0]*z[0]+H[1]*z[2],ye=H[0]*z[1]+H[1]*z[3],ve=H[2]*z[0]+H[3]*z[2],Se=H[2]*z[1]+H[3]*z[3],xe=(ge+Se)/2,De=Math.sqrt((ge+Se)**2-4*(ge*Se-ve*ye))/2,Re=xe+De||1,Te=xe-De||1;return[Math.sqrt(Re),Math.sqrt(Te)]}static normalizeRect(H){const z=H.slice(0);return H[0]>H[2]&&(z[0]=H[2],z[2]=H[0]),H[1]>H[3]&&(z[1]=H[3],z[3]=H[1]),z}static intersect(H,z){const ge=Math.max(Math.min(H[0],H[2]),Math.min(z[0],z[2])),ye=Math.min(Math.max(H[0],H[2]),Math.max(z[0],z[2]));if(ge>ye)return null;const ve=Math.max(Math.min(H[1],H[3]),Math.min(z[1],z[3])),Se=Math.min(Math.max(H[1],H[3]),Math.max(z[1],z[3]));return ve>Se?null:[ge,ve,ye,Se]}static bezierBoundingBox(H,z,ge,ye,ve,Se,xe,De){const Re=[],Te=[[],[]];let Le,Ie,Ue,we,Ne,We,$e,Ve;for(let Xe=0;Xe<2;++Xe){if(Xe===0?(Ie=6*H-12*ge+6*ve,Le=-3*H+9*ge-9*ve+3*xe,Ue=3*ge-3*H):(Ie=6*z-12*ye+6*Se,Le=-3*z+9*ye-9*Se+3*De,Ue=3*ye-3*z),Math.abs(Le)<1e-12){if(Math.abs(Ie)<1e-12)continue;we=-Ue/Ie,0<we&&we<1&&Re.push(we);continue}$e=Ie*Ie-4*Ue*Le,Ve=Math.sqrt($e),!($e<0)&&(Ne=(-Ie+Ve)/(2*Le),0<Ne&&Ne<1&&Re.push(Ne),We=(-Ie-Ve)/(2*Le),0<We&&We<1&&Re.push(We))}let Ge=Re.length,je;const qe=Ge;for(;Ge--;)we=Re[Ge],je=1-we,Te[0][Ge]=je*je*je*H+3*je*je*we*ge+3*je*we*we*ve+we*we*we*xe,Te[1][Ge]=je*je*je*z+3*je*je*we*ye+3*je*we*we*Se+we*we*we*De;return Te[0][qe]=H,Te[1][qe]=z,Te[0][qe+1]=xe,Te[1][qe+1]=De,Te[0].length=Te[1].length=qe+2,[Math.min(...Te[0]),Math.min(...Te[1]),Math.max(...Te[0]),Math.max(...Te[1])]}}n.Util=be;const Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ee(J){if(J[0]>="ï"){let z;if(J[0]==="þ"&&J[1]==="ÿ"?z="utf-16be":J[0]==="ÿ"&&J[1]==="þ"?z="utf-16le":J[0]==="ï"&&J[1]==="»"&&J[2]==="¿"&&(z="utf-8"),z)try{const ge=new TextDecoder(z,{fatal:!0}),ye=q(J);return ge.decode(ye)}catch(ge){_e(`stringToPDFString: "${ge}".`)}}const H=[];for(let z=0,ge=J.length;z<ge;z++){const ye=Ae[J.charCodeAt(z)];H.push(ye?String.fromCharCode(ye):J.charAt(z))}return H.join("")}function Ce(J){return J.replace(/([()\\\n\r])/g,H=>H===`
`?"\\n":H==="\r"?"\\r":`\\${H}`)}function Fe(J){return/^[\x00-\x7F]*$/.test(J)}function ke(J){const H=["þÿ"];for(let z=0,ge=J.length;z<ge;z++){const ye=J.charCodeAt(z);H.push(String.fromCharCode(ye>>8&255),String.fromCharCode(ye&255))}return H.join("")}function ze(J){return decodeURIComponent(escape(J))}function Pe(J){return unescape(encodeURIComponent(J))}function Oe(J){return typeof J=="object"&&J!==null&&J.byteLength!==void 0}function Ze(J,H){if(J.length!==H.length)return!1;for(let z=0,ge=J.length;z<ge;z++)if(J[z]!==H[z])return!1;return!0}function se(J=new Date){return[J.getUTCFullYear().toString(),(J.getUTCMonth()+1).toString().padStart(2,"0"),J.getUTCDate().toString().padStart(2,"0"),J.getUTCHours().toString().padStart(2,"0"),J.getUTCMinutes().toString().padStart(2,"0"),J.getUTCSeconds().toString().padStart(2,"0")].join("")}function pe(){const J=Object.create(null);let H=!1;return Object.defineProperty(J,"settled",{get(){return H}}),J.promise=new Promise(function(z,ge){J.resolve=function(ye){H=!0,z(ye)},J.reject=function(ye){H=!0,ge(ye)}}),J}},(P,n,y)=>{y(3)},(P,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const y=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=y},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var P,y,t,a,F,D,T,A,f,ot,L,C;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:h,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:i}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=h,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=i}let createPDFNetworkStream;function setPDFNetworkStreamFactory(h){createPDFNetworkStream=h}function getDocument(h){const e=new PDFDocumentLoadingTask;let i;if(typeof h=="string"||h instanceof URL)i={url:h};else if((0,_util.isArrayBuffer)(h))i={data:h};else if(h instanceof PDFDataRangeTransport)i={range:h};else{if(typeof h!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!h.url&&!h.data&&!h.range)throw new Error("Invalid parameter object: need either .data, .range or .url");i=h}const l=Object.create(null);let b=null,v=null;for(const r in i){const s=i[r];switch(r){case"url":if(typeof window<"u")try{l[r]=new URL(s,window.location).href;continue}catch(g){(0,_util.warn)(`Cannot create valid URL: "${g}".`)}else if(typeof s=="string"||s instanceof URL){l[r]=s.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":b=s;continue;case"worker":v=s;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&s instanceof Buffer)l[r]=new Uint8Array(s);else{if(s instanceof Uint8Array)break;if(typeof s=="string")l[r]=(0,_util.stringToBytes)(s);else if(typeof s=="object"&&s!==null&&!isNaN(s.length))l[r]=new Uint8Array(s);else if((0,_util.isArrayBuffer)(s))l[r]=new Uint8Array(s);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}l[r]=s}if(l.CMapReaderFactory=l.CMapReaderFactory||DefaultCMapReaderFactory,l.StandardFontDataFactory=l.StandardFontDataFactory||DefaultStandardFontDataFactory,l.ignoreErrors=l.stopAtErrors!==!0,l.fontExtraProperties=l.fontExtraProperties===!0,l.pdfBug=l.pdfBug===!0,l.enableXfa=l.enableXfa===!0,(!Number.isInteger(l.rangeChunkSize)||l.rangeChunkSize<1)&&(l.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof l.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(l.docBaseUrl))&&(l.docBaseUrl=null),(!Number.isInteger(l.maxImageSize)||l.maxImageSize<-1)&&(l.maxImageSize=-1),typeof l.cMapUrl!="string"&&(l.cMapUrl=null),typeof l.standardFontDataUrl!="string"&&(l.standardFontDataUrl=null),typeof l.useWorkerFetch!="boolean"&&(l.useWorkerFetch=l.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&l.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof l.isEvalSupported!="boolean"&&(l.isEvalSupported=!0),typeof l.disableFontFace!="boolean"&&(l.disableFontFace=_is_node.isNodeJS),typeof l.useSystemFonts!="boolean"&&(l.useSystemFonts=!_is_node.isNodeJS&&!l.disableFontFace),(typeof l.ownerDocument!="object"||l.ownerDocument===null)&&(l.ownerDocument=globalThis.document),typeof l.disableRange!="boolean"&&(l.disableRange=!1),typeof l.disableStream!="boolean"&&(l.disableStream=!1),typeof l.disableAutoFetch!="boolean"&&(l.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(l.verbosity),!v){const r={verbosity:l.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};v=r.port?PDFWorker.fromPort(r):new PDFWorker(r),e._worker=v}const c=e.docId;return v.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const r=_fetchDocument(v,l,b,c),s=new Promise(function(g){let k;b?k=new _transport_stream.PDFDataTransportStream({length:l.length,initialData:l.initialData,progressiveDone:l.progressiveDone,contentDispositionFilename:l.contentDispositionFilename,disableRange:l.disableRange,disableStream:l.disableStream},b):l.data||(k=createPDFNetworkStream({url:l.url,length:l.length,httpHeaders:l.httpHeaders,withCredentials:l.withCredentials,rangeChunkSize:l.rangeChunkSize,disableRange:l.disableRange,disableStream:l.disableStream})),g(k)});return Promise.all([r,s]).then(function([g,k]){if(e.destroyed)throw new Error("Loading aborted");const E=new _message_handler.MessageHandler(c,g,v.port),m=new WorkerTransport(E,e,k,l);e._transport=m,E.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(h,e,i,l){if(h.destroyed)throw new Error("Worker was destroyed");i&&(e.length=i.length,e.initialData=i.initialData,e.progressiveDone=i.progressiveDone,e.contentDispositionFilename=i.contentDispositionFilename);const b=await h.messageHandler.sendWithPromise("GetDocRequest",{docId:l,apiVersion:"2.16.105",source:{data:e.data,url:e.url,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length},maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,docBaseUrl:e.docBaseUrl,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,fontExtraProperties:e.fontExtraProperties,enableXfa:e.enableXfa,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null});if(e.data&&(e.data=null),h.destroyed)throw new Error("Worker was destroyed");return b}const n=class n{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${at(n,P)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0,await((e=this._transport)==null?void 0:e.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};P=new WeakMap,ae(n,P,0);let PDFDocumentLoadingTask=n;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,i,l=!1,b=null){this.length=e,this.initialData=i,this.progressiveDone=l,this.contentDispositionFilename=b,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,i){for(const l of this._rangeListeners)l(e,i)}onDataProgress(e,i){this._readyCapability.promise.then(()=>{for(const l of this._progressListeners)l(e,i)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const i of this._progressiveReadListeners)i(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,i){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,i){this._pdfInfo=e,this._transport=i,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,i,l,b,v=!1){this._pageIndex=e,this._pageInfo=i,this._ownerDocument=b,this._transport=l,this._stats=v?new _display_utils.StatTimer:null,this._pdfBug=v,this.commonObjs=l.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:i=this.rotate,offsetX:l=0,offsetY:b=0,dontFlip:v=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:i,offsetX:l,offsetY:b,dontFlip:v})}getAnnotations({intent:e="display"}={}){const i=this._transport.getRenderingIntent(e);let l=this._annotationPromises.get(i.cacheKey);return l||(l=this._transport.getAnnotations(this._pageIndex,i.renderingIntent),this._annotationPromises.set(i.cacheKey,l),l=l.then(b=>{for(const v of b)v.titleObj!==void 0&&Object.defineProperty(v,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),v.titleObj.str}}),v.contentsObj!==void 0&&Object.defineProperty(v,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),v.contentsObj.str}});return b})),l}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:i,intent:l="display",annotationMode:b=_util.AnnotationMode.ENABLE,transform:v=null,imageLayer:c=null,canvasFactory:r=null,background:s=null,optionalContentConfigPromise:g=null,annotationCanvasMap:k=null,pageColors:E=null,printAnnotationStorage:m=null}){var Y,ne;((Y=arguments[0])==null?void 0:Y.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&b===_util.AnnotationMode.ENABLE&&(b=_util.AnnotationMode.ENABLE_FORMS)),((ne=arguments[0])==null?void 0:ne.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&b===_util.AnnotationMode.ENABLE&&(b=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const M=this._transport.getRenderingIntent(l,b,m);this.pendingCleanup=!1,g||(g=this._transport.getOptionalContentConfig());let ee=this._intentStates.get(M.cacheKey);ee||(ee=Object.create(null),this._intentStates.set(M.cacheKey,ee)),ee.streamReaderCancelTimeout&&(clearTimeout(ee.streamReaderCancelTimeout),ee.streamReaderCancelTimeout=null);const ie=r||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Q=!!(M.renderingIntent&_util.RenderingIntentFlag.PRINT);ee.displayReadyCapability||(ee.displayReadyCapability=(0,_util.createPromiseCapability)(),ee.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(M));const K=ce=>{ee.renderTasks.delete(G),(this.cleanupAfterRender||Q)&&(this.pendingCleanup=!0),this._tryCleanup(),ce?(G.capability.reject(ce),this._abortOperatorList({intentState:ee,reason:ce instanceof Error?ce:new Error(ce)})):G.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},G=new InternalRenderTask({callback:K,params:{canvasContext:e,viewport:i,transform:v,imageLayer:c,background:s},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:k,operatorList:ee.operatorList,pageIndex:this._pageIndex,canvasFactory:ie,useRequestAnimationFrame:!Q,pdfBug:this._pdfBug,pageColors:E});(ee.renderTasks||(ee.renderTasks=new Set)).add(G);const $=G.task;return Promise.all([ee.displayReadyCapability.promise,g]).then(([ce,_e])=>{if(this.pendingCleanup){K();return}this._stats&&this._stats.time("Rendering"),G.initializeGraphics({transparency:ce,optionalContentConfig:_e}),G.operatorListChanged()}).catch(K),$}getOperatorList({intent:e="display",annotationMode:i=_util.AnnotationMode.ENABLE,printAnnotationStorage:l=null}={}){function b(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(r))}const v=this._transport.getRenderingIntent(e,i,l,!0);let c=this._intentStates.get(v.cacheKey);c||(c=Object.create(null),this._intentStates.set(v.cacheKey,c));let r;return c.opListReadCapability||(r=Object.create(null),r.operatorListChanged=b,c.opListReadCapability=(0,_util.createPromiseCapability)(),(c.renderTasks||(c.renderTasks=new Set)).add(r),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(v)),c.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:i===!0},{highWaterMark:100,size(b){return b.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(l=>_xfa_text.XfaText.textContent(l));const i=this.streamTextContent(e);return new Promise(function(l,b){function v(){c.read().then(function({value:s,done:g}){if(g){l(r);return}Object.assign(r.styles,s.styles),r.items.push(...s.items),v()},b)}const c=i.getReader(),r={items:[],styles:Object.create(null)};v()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const e=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const l of i.renderTasks)e.push(l.completed),l.cancel();this.objs.clear();for(const i of this._bitmaps)i.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:i,operatorList:l}of this._intentStates.values())if(i.size>0||!l.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const i of this._bitmaps)i.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,i){const l=this._intentStates.get(i);l&&(this._stats&&this._stats.timeEnd("Page Request"),l.displayReadyCapability&&l.displayReadyCapability.resolve(e))}_renderPageChunk(e,i){for(let l=0,b=e.length;l<b;l++)i.operatorList.fnArray.push(e.fnArray[l]),i.operatorList.argsArray.push(e.argsArray[l]);i.operatorList.lastChunk=e.lastChunk,i.operatorList.separateAnnots=e.separateAnnots;for(const l of i.renderTasks)l.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:i,annotationStorageMap:l}){const v=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:i,annotationStorage:l}).getReader(),c=this._intentStates.get(i);c.streamReader=v;const r=()=>{v.read().then(({value:s,done:g})=>{if(g){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(s,c),r())},s=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const g of c.renderTasks)g.operatorListChanged();this._tryCleanup()}if(c.displayReadyCapability)c.displayReadyCapability.reject(s);else if(c.opListReadCapability)c.opListReadCapability.reject(s);else throw s}})};r()}_abortOperatorList({intentState:e,reason:i,force:l=!1}){if(e.streamReader){if(!l){if(e.renderTasks.size>0)return;if(i instanceof _display_utils.RenderingCancelledException){e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:i,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(e.streamReader.cancel(new _util.AbortException(i.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[b,v]of this._intentStates)if(v===e){this._intentStates.delete(b);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(e,i){const l={data:structuredClone(e,i)};this._deferred.then(()=>{for(const b of this._listeners)b.call(this,l)})}addEventListener(e,i){this._listeners.push(i)}removeEventListener(e,i){const l=this._listeners.indexOf(i);this._listeners.splice(l,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const h=(y=document==null?void 0:document.currentScript)==null?void 0:y.src;h&&(PDFWorkerUtil.fallbackWorkerSrc=h.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(h,e){let i;try{if(i=new URL(h),!i.origin||i.origin==="null")return!1}catch{return!1}const l=new URL(e,i);return i.origin===l.origin},PDFWorkerUtil.createCDNWrapper=function(h){const e=`importScripts("${h}");`;return URL.createObjectURL(new Blob([e]))}}const _PDFWorker=class _PDFWorker{constructor({name:h=null,port:e=null,verbosity:i=(0,_util.getVerbosityLevel)()}={}){if(e&&O(_PDFWorker,t).has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=h,this.destroyed=!1,this.verbosity=i,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){O(_PDFWorker,t).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(h){this._port=h,this._messageHandler=new _message_handler.MessageHandler("main","worker",h),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:h}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,h)||(h=PDFWorkerUtil.createCDNWrapper(new URL(h,window.location).href));const e=new Worker(h),i=new _message_handler.MessageHandler("main","worker",e),l=()=>{e.removeEventListener("error",b),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},b=()=>{this._webWorker||l()};e.addEventListener("error",b),i.on("test",c=>{if(e.removeEventListener("error",b),this.destroyed){l();return}c?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())}),i.on("ready",c=>{if(e.removeEventListener("error",b),this.destroyed){l();return}try{v()}catch{this._setupFakeWorker()}});const v=()=>{const c=new Uint8Array;i.send("test",c,[c.buffer])};v();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(h=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const i=`fake${PDFWorkerUtil.fakeWorkerId++}`,l=new _message_handler.MessageHandler(i+"_worker",i,e);h.setup(l,e);const b=new _message_handler.MessageHandler(i,i+"_worker",e);this._messageHandler=b,this._readyCapability.resolve(),b.send("configure",{verbosity:this.verbosity})}).catch(h=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${h.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),O(_PDFWorker,t).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(h){if(!(h!=null&&h.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return O(this,t).has(h.port)?O(this,t).get(h.port):new _PDFWorker(h)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var h;try{return((h=globalThis.pdfjsWorker)==null?void 0:h.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};t=new WeakMap,ae(_PDFWorker,t,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(e,i,l,b){ae(this,a,null);ae(this,F,new Map);ae(this,D,new Map);ae(this,T,null);this.messageHandler=e,this.loadingTask=i,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:i.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:b.ownerDocument,styleElement:b.styleElement}),this._params=b,b.useWorkerFetch||(this.CMapReaderFactory=new b.CMapReaderFactory({baseUrl:b.cMapUrl,isCompressed:b.cMapPacked}),this.StandardFontDataFactory=new b.StandardFontDataFactory({baseUrl:b.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=l,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return O(this,a)}getRenderingIntent(e,i=_util.AnnotationMode.ENABLE,l=null,b=!1){let v=_util.RenderingIntentFlag.DISPLAY,c=null;switch(e){case"any":v=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":v=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(i){case _util.AnnotationMode.DISABLE:v+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:v+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:v+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,c=(v&_util.RenderingIntentFlag.PRINT&&l instanceof _annotation_storage.PrintAnnotationStorage?l:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${i}`)}return b&&(v+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:v,cacheKey:`${v}_${_annotation_storage.AnnotationStorage.getHash(c)}`,annotationStorageMap:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const l of O(this,F).values())e.push(l._destroy());O(this,F).clear(),O(this,D).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return e.push(i),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),me(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:i}=this;e.on("GetReader",(l,b)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=v=>{this._lastProgress={loaded:v.loaded,total:v.total}},b.onPull=()=>{this._fullReader.read().then(function({value:v,done:c}){if(c){b.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(v),"GetReader - expected an ArrayBuffer."),b.enqueue(new Uint8Array(v),1,[v])}).catch(v=>{b.error(v)})},b.onCancel=v=>{this._fullReader.cancel(v),b.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("ReaderHeadersReady",l=>{const b=(0,_util.createPromiseCapability)(),v=this._fullReader;return v.headersReady.then(()=>{var c;(!v.isStreamingSupported||!v.isRangeSupported)&&(this._lastProgress&&((c=i.onProgress)==null||c.call(i,this._lastProgress)),v.onProgress=r=>{var s;(s=i.onProgress)==null||s.call(i,{loaded:r.loaded,total:r.total})}),b.resolve({isStreamingSupported:v.isStreamingSupported,isRangeSupported:v.isRangeSupported,contentLength:v.contentLength})},b.reject),b.promise}),e.on("GetRangeReader",(l,b)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const v=this._networkStream.getRangeReader(l.begin,l.end);if(!v){b.close();return}b.onPull=()=>{v.read().then(function({value:c,done:r}){if(r){b.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(c),"GetRangeReader - expected an ArrayBuffer."),b.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{b.error(c)})},b.onCancel=c=>{v.cancel(c),b.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("GetDoc",({pdfInfo:l})=>{this._numPages=l.numPages,this._htmlForXfa=l.htmlForXfa,delete l.htmlForXfa,i._capability.resolve(new PDFDocumentProxy(l,this))}),e.on("DocException",function(l){let b;switch(l.name){case"PasswordException":b=new _util.PasswordException(l.message,l.code);break;case"InvalidPDFException":b=new _util.InvalidPDFException(l.message);break;case"MissingPDFException":b=new _util.MissingPDFException(l.message);break;case"UnexpectedResponseException":b=new _util.UnexpectedResponseException(l.message,l.status);break;case"UnknownErrorException":b=new _util.UnknownErrorException(l.message,l.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}i._capability.reject(b)}),e.on("PasswordRequest",l=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),i.onPassword){const b=v=>{v instanceof Error?this._passwordCapability.reject(v):this._passwordCapability.resolve({password:v})};try{i.onPassword(b,l.code)}catch(v){this._passwordCapability.reject(v)}}else this._passwordCapability.reject(new _util.PasswordException(l.message,l.code));return this._passwordCapability.promise}),e.on("DataLoaded",l=>{var b;(b=i.onProgress)==null||b.call(i,{loaded:l.length,total:l.length}),this.downloadInfoCapability.resolve(l)}),e.on("StartRenderPage",l=>{if(this.destroyed)return;O(this,F).get(l.pageIndex)._startRenderPage(l.transparency,l.cacheKey)}),e.on("commonobj",([l,b,v])=>{var c;if(!this.destroyed&&!this.commonObjs.has(l))switch(b){case"Font":const r=this._params;if("error"in v){const k=v.error;(0,_util.warn)(`Error during font loading: ${k}`),this.commonObjs.resolve(l,k);break}let s=null;r.pdfBug&&((c=globalThis.FontInspector)!=null&&c.enabled)&&(s={registerFont(k,E){globalThis.FontInspector.fontAdded(k,E)}});const g=new _font_loader.FontFaceObject(v,{isEvalSupported:r.isEvalSupported,disableFontFace:r.disableFontFace,ignoreErrors:r.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:s});this.fontLoader.bind(g).catch(k=>e.sendWithPromise("FontFallback",{id:l})).finally(()=>{!r.fontExtraProperties&&g.data&&(g.data=null),this.commonObjs.resolve(l,g)});break;case"FontPath":case"Image":this.commonObjs.resolve(l,v);break;default:throw new Error(`Got unknown common object type ${b}`)}}),e.on("obj",([l,b,v,c])=>{var s;if(this.destroyed)return;const r=O(this,F).get(b);if(!r.objs.has(l))switch(v){case"Image":r.objs.resolve(l,c);const g=8e6;if(c){let k;if(c.bitmap){const{bitmap:E,width:m,height:M}=c;k=m*M*4,r._bitmaps.add(E)}else k=((s=c.data)==null?void 0:s.length)||0;k>g&&(r.cleanupAfterRender=!0)}break;case"Pattern":r.objs.resolve(l,c);break;default:throw new Error(`Got unknown object type ${v}`)}}),e.on("DocProgress",l=>{var b;this.destroyed||(b=i.onProgress)==null||b.call(i,{loaded:l.loaded,total:l.total})}),e.on("DocStats",l=>{this.destroyed||me(this,a,Object.freeze({streamTypes:Object.freeze(l.streamTypes),fontTypes:Object.freeze(l.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",l=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(l):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",l=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(l):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){var i,l;this.destroyed||(l=(i=this.loadingTask).onUnsupportedFeature)==null||l.call(i,e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=e-1,l=O(this,D).get(i);if(l)return l;const b=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(v=>{if(this.destroyed)throw new Error("Transport destroyed");const c=new PDFPageProxy(i,v,this,this._params.ownerDocument,this._params.pdfBug);return O(this,F).set(i,c),c});return O(this,D).set(i,b),b}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:i})}saveDocument(){var e;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((e=this._fullReader)==null?void 0:e.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return O(this,T)||me(this,T,this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>{var i,l;return{info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const i of O(this,F).values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),me(this,T,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}a=new WeakMap,F=new WeakMap,D=new WeakMap,T=new WeakMap;class PDFObjects{constructor(){ae(this,f);ae(this,A,Object.create(null))}get(e,i=null){if(i){const b=he(this,f,ot).call(this,e);return b.capability.promise.then(()=>i(b.data)),null}const l=O(this,A)[e];if(!(l!=null&&l.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${e}.`);return l.data}has(e){const i=O(this,A)[e];return(i==null?void 0:i.capability.settled)||!1}resolve(e,i=null){const l=he(this,f,ot).call(this,e);l.data=i,l.capability.resolve()}clear(){me(this,A,Object.create(null))}}A=new WeakMap,f=new WeakSet,ot=function(e){const i=O(this,A)[e];return i||(O(this,A)[e]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(e){ae(this,L,null);me(this,L,e),this.onContinue=null}get promise(){return O(this,L).capability.promise}cancel(){O(this,L).cancel()}get separateAnnots(){const{separateAnnots:e}=O(this,L).operatorList;if(!e)return!1;const{annotationCanvasMap:i}=O(this,L);return e.form||e.canvas&&(i==null?void 0:i.size)>0}}L=new WeakMap,exports.RenderTask=RenderTask;const S=class S{constructor({callback:e,params:i,objs:l,commonObjs:b,annotationCanvasMap:v,operatorList:c,pageIndex:r,canvasFactory:s,useRequestAnimationFrame:g=!1,pdfBug:k=!1,pageColors:E=null}){this.callback=e,this.params=i,this.objs=l,this.commonObjs=b,this.annotationCanvasMap=v,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=r,this.canvasFactory=s,this._pdfBug=k,this.pageColors=E,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:i}){var s;if(this.cancelled)return;if(this._canvas){if(O(S,C).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");O(S,C).add(this._canvas)}this._pdfBug&&((s=globalThis.StepperManager)!=null&&s.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:l,viewport:b,transform:v,imageLayer:c,background:r}=this.params;this.gfx=new _canvas.CanvasGraphics(l,this.commonObjs,this.objs,this.canvasFactory,c,i,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:v,viewport:b,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(e=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&O(S,C).delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&O(S,C).delete(this._canvas),this.callback())))}};C=new WeakMap,ae(S,C,new WeakSet);let InternalRenderTask=S;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(P,n,y)=>{var A,Pt,w;Object.defineProperty(n,"__esModule",{value:!0}),n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var t=y(1),a=y(6),F=y(10);class D{constructor(){ae(this,A);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(C,S){const h=this._storage.get(C);return h===void 0?S:Object.assign(S,h)}getRawValue(C){return this._storage.get(C)}remove(C){if(this._storage.delete(C),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const S of this._storage.values())if(S instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(C,S){const h=this._storage.get(C);let e=!1;if(h!==void 0)for(const[i,l]of Object.entries(S))h[i]!==l&&(e=!0,h[i]=l);else e=!0,this._storage.set(C,S);e&&he(this,A,Pt).call(this),S instanceof a.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(S.constructor._type)}has(C){return this._storage.has(C)}getAll(){return this._storage.size>0?(0,t.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new T(this)}get serializable(){if(this._storage.size===0)return null;const C=new Map;for(const[S,h]of this._storage){const e=h instanceof a.AnnotationEditor?h.serialize():h;e&&C.set(S,e)}return C}static getHash(C){if(!C)return"";const S=new F.MurmurHash3_64;for(const[h,e]of C)S.update(`${h}:${JSON.stringify(e)}`);return S.hexdigest()}}A=new WeakSet,Pt=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},n.AnnotationStorage=D;class T extends D{constructor(S){super();ae(this,w,null);me(this,w,structuredClone(S.serializable))}get print(){(0,t.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return O(this,w)}}w=new WeakMap,n.PrintAnnotationStorage=T},(P,n,y)=>{var D,T,A,f,w,L;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var t=y(7),a=y(1);const C=class C{constructor(h){ae(this,D,this.focusin.bind(this));ae(this,T,this.focusout.bind(this));ae(this,A,!1);ae(this,f,!1);ae(this,w,!1);ae(this,L,C._zIndex++);this.constructor===C&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=h.parent,this.id=h.id,this.width=this.height=null,this.pageIndex=h.parent.pageIndex,this.name=h.name,this.div=null;const[e,i]=this.parent.viewportBaseDimensions;this.x=h.x/e,this.y=h.y/i,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=O(this,L)}focusin(h){O(this,A)?me(this,A,!1):this.parent.setSelected(this)}focusout(h){if(!this.isAttachedToDOM)return;const e=h.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(h.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(h){const e=this.parent.div.getBoundingClientRect();this.startX=h.clientX-e.x,this.startY=h.clientY-e.y,h.dataTransfer.setData("text/plain",this.id),h.dataTransfer.effectAllowed="move"}setAt(h,e,i,l){const[b,v]=this.parent.viewportBaseDimensions;[i,l]=this.screenToPageTranslation(i,l),this.x=(h+i)/b,this.y=(e+l)/v,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(h,e){const[i,l]=this.parent.viewportBaseDimensions;[h,e]=this.screenToPageTranslation(h,e),this.x+=h/i,this.y+=e/l,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(h,e){const{rotation:i}=this.parent.viewport;switch(i){case 90:return[e,-h];case 180:return[-h,-e];case 270:return[-e,h];default:return[h,e]}}setDims(h,e){const[i,l]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*h/i}%`,this.div.style.height=`${100*e/l}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",O(this,D)),this.div.addEventListener("focusout",O(this,T));const[h,e]=this.getInitialTranslation();return this.translate(h,e),(0,t.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(h){const e=t.KeyboardManager.platform.isMac;if(h.button!==0||h.ctrlKey&&e){h.preventDefault();return}h.ctrlKey&&!e||h.shiftKey||h.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this),me(this,A,!0)}getRect(h,e){const[i,l]=this.parent.viewportBaseDimensions,[b,v]=this.parent.pageDimensions,c=b*h/i,r=v*e/l,s=this.x*b,g=this.y*v,k=this.width*b,E=this.height*v;switch(this.rotation){case 0:return[s+c,v-g-r-E,s+c+k,v-g-r];case 90:return[s+r,v-g+c,s+r+E,v-g+c+k];case 180:return[s-c-k,v-g+r,s-c,v-g+r+E];case 270:return[s-r-E,v-g-c-k,s-r,v-g-c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(h,e){const[i,l,b,v]=h,c=b-i,r=v-l;switch(this.rotation){case 0:return[i,e-v,c,r];case 90:return[i,e-l,r,c];case 180:return[b,e-l,c,r];case 270:return[b,e-v,r,c];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){me(this,w,!0)}disableEditMode(){me(this,w,!1)}isInEditMode(){return O(this,w)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var h;(h=this.div)==null||h.addEventListener("focusin",O(this,D))}serialize(){(0,a.unreachable)("An editor must be serializable")}static deserialize(h,e){const i=new this.prototype.constructor({parent:e,id:e.getNextId()});i.rotation=h.rotation;const[l,b]=e.pageDimensions,[v,c,r,s]=i.getRectInCurrentCoords(h.rect,b);return i.x=v/l,i.y=c/b,i.width=r/l,i.height=s/b,i}remove(){this.div.removeEventListener("focusin",O(this,D)),this.div.removeEventListener("focusout",O(this,T)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var h;(h=this.div)==null||h.classList.add("selectedEditor")}unselect(){var h;(h=this.div)==null||h.classList.remove("selectedEditor")}updateParams(h,e){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return O(this,f)}set isEditing(h){me(this,f,h),h?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};D=new WeakMap,T=new WeakMap,A=new WeakMap,f=new WeakMap,w=new WeakMap,L=new WeakMap,Me(C,"_colorManager",new t.ColorManager),Me(C,"_zIndex",1);let F=C;n.AnnotationEditor=F},(P,n,y)=>{var S,h,e,i,l,b,Tt,r,g,k,E,m,M,ee,ie,Q,K,G,$,Y,ne,ce,_e,W,d,u,Ct,j,lt,B,Be,X,Je,p,xt,x,wt,q,ct,ue,Qe,oe,et;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=F,n.opacityToHex=D;var t=y(1),a=y(8);function F(fe,N,de){for(const be of de)N.addEventListener(be,fe[be].bind(fe))}function D(fe){return Math.round(Math.min(255,Math.max(1,255*fe))).toString(16).padStart(2,"0")}class T{constructor(){ae(this,S,0)}getId(){return`${t.AnnotationEditorPrefix}${at(this,S)._++}`}}S=new WeakMap;class A{constructor(N=128){ae(this,h,[]);ae(this,e,!1);ae(this,i,void 0);ae(this,l,-1);me(this,i,N)}add({cmd:N,undo:de,mustExec:be,type:Ae=NaN,overwriteIfSameType:Ee=!1,keepUndo:Ce=!1}){if(be&&N(),O(this,e))return;const Fe={cmd:N,undo:de,type:Ae};if(O(this,l)===-1){O(this,h).length>0&&(O(this,h).length=0),me(this,l,0),O(this,h).push(Fe);return}if(Ee&&O(this,h)[O(this,l)].type===Ae){Ce&&(Fe.undo=O(this,h)[O(this,l)].undo),O(this,h)[O(this,l)]=Fe;return}const ke=O(this,l)+1;ke===O(this,i)?O(this,h).splice(0,1):(me(this,l,ke),ke<O(this,h).length&&O(this,h).splice(ke)),O(this,h).push(Fe)}undo(){O(this,l)!==-1&&(me(this,e,!0),O(this,h)[O(this,l)].undo(),me(this,e,!1),me(this,l,O(this,l)-1))}redo(){O(this,l)<O(this,h).length-1&&(me(this,l,O(this,l)+1),me(this,e,!0),O(this,h)[O(this,l)].cmd(),me(this,e,!1))}hasSomethingToUndo(){return O(this,l)!==-1}hasSomethingToRedo(){return O(this,l)<O(this,h).length-1}destroy(){me(this,h,null)}}h=new WeakMap,e=new WeakMap,i=new WeakMap,l=new WeakMap,n.CommandManager=A;const c=class c{constructor(N){ae(this,b);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const de=c.platform.isMac;for(const[be,Ae]of N)for(const Ee of be){const Ce=Ee.startsWith("mac+");de&&Ce?(this.callbacks.set(Ee.slice(4),Ae),this.allKeys.add(Ee.split("+").at(-1))):!de&&!Ce&&(this.callbacks.set(Ee,Ae),this.allKeys.add(Ee.split("+").at(-1)))}}static get platform(){const N=typeof navigator<"u"?navigator.platform:"";return(0,t.shadow)(this,"platform",{isWin:N.includes("Win"),isMac:N.includes("Mac")})}exec(N,de){if(!this.allKeys.has(de.key))return;const be=this.callbacks.get(he(this,b,Tt).call(this,de));be&&(be.bind(N)(),de.stopPropagation(),de.preventDefault())}};b=new WeakSet,Tt=function(N){N.altKey&&this.buffer.push("alt"),N.ctrlKey&&this.buffer.push("ctrl"),N.metaKey&&this.buffer.push("meta"),N.shiftKey&&this.buffer.push("shift"),this.buffer.push(N.key);const de=this.buffer.join("+");return this.buffer.length=0,de};let f=c;n.KeyboardManager=f;class w{constructor(){ae(this,r,null)}copy(N){N&&(Array.isArray(N)?me(this,r,N.map(de=>de.serialize())):me(this,r,[N.serialize()]),me(this,r,O(this,r).filter(de=>!!de)),O(this,r).length===0&&me(this,r,null))}paste(){return O(this,r)}isEmpty(){return O(this,r)===null}destroy(){me(this,r,null)}}r=new WeakMap;const s=class s{get _colors(){const N=new Map([["CanvasText",null],["Canvas",null]]);return(0,a.getColorValues)(N),(0,t.shadow)(this,"_colors",N)}convert(N){const de=(0,a.getRGB)(N);if(!window.matchMedia("(forced-colors: active)").matches)return de;for(const[be,Ae]of this._colors)if(Ae.every((Ee,Ce)=>Ee===de[Ce]))return s._colorsMapping.get(be);return de}getHexCode(N){const de=this._colors.get(N);return de?t.Util.makeHexColor(...de):N}};Me(s,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let L=s;n.ColorManager=L;const le=class le{constructor(N,de){ae(this,u);ae(this,j);ae(this,B);ae(this,X);ae(this,p);ae(this,x);ae(this,q);ae(this,ue);ae(this,oe);ae(this,g,null);ae(this,k,new Map);ae(this,E,new Map);ae(this,m,new w);ae(this,M,new A);ae(this,ee,0);ae(this,ie,null);ae(this,Q,null);ae(this,K,new T);ae(this,G,!1);ae(this,$,t.AnnotationEditorType.NONE);ae(this,Y,new Set);ae(this,ne,this.keydown.bind(this));ae(this,ce,this.onEditingAction.bind(this));ae(this,_e,this.onPageChanging.bind(this));ae(this,W,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ae(this,d,null);me(this,d,N),me(this,Q,de),O(this,Q)._on("editingaction",O(this,ce)),O(this,Q)._on("pagechanging",O(this,_e))}destroy(){he(this,j,lt).call(this),O(this,Q)._off("editingaction",O(this,ce)),O(this,Q)._off("pagechanging",O(this,_e));for(const N of O(this,E).values())N.destroy();O(this,E).clear(),O(this,k).clear(),me(this,g,null),O(this,Y).clear(),O(this,m).destroy(),O(this,M).destroy()}onPageChanging({pageNumber:N}){me(this,ee,N-1)}focusMainContainer(){O(this,d).focus()}keydown(N){var de;(de=this.getActive())!=null&&de.shouldGetKeyboardEvents()||le._keyboardManager.exec(this,N)}onEditingAction(N){["undo","redo","cut","copy","paste","delete","selectAll"].includes(N.name)&&this[N.name]()}setEditingState(N){N?(he(this,u,Ct).call(this),he(this,B,Be).call(this,{isEditing:O(this,$)!==t.AnnotationEditorType.NONE,isEmpty:he(this,ue,Qe).call(this),hasSomethingToUndo:O(this,M).hasSomethingToUndo(),hasSomethingToRedo:O(this,M).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:O(this,m).isEmpty()})):(he(this,j,lt).call(this),he(this,B,Be).call(this,{isEditing:!1}))}registerEditorTypes(N){me(this,ie,N);for(const de of O(this,ie))he(this,X,Je).call(this,de.defaultPropertiesToUpdate)}getId(){return O(this,K).getId()}addLayer(N){O(this,E).set(N.pageIndex,N),O(this,G)?N.enable():N.disable()}removeLayer(N){O(this,E).delete(N.pageIndex)}updateMode(N){if(me(this,$,N),N===t.AnnotationEditorType.NONE)this.setEditingState(!1),he(this,x,wt).call(this);else{this.setEditingState(!0),he(this,p,xt).call(this);for(const de of O(this,E).values())de.updateMode(N)}}updateToolbar(N){N!==O(this,$)&&O(this,Q).dispatch("switchannotationeditormode",{source:this,mode:N})}updateParams(N,de){for(const be of O(this,Y))be.updateParams(N,de);for(const be of O(this,ie))be.updateDefaultParams(N,de)}getEditors(N){const de=[];for(const be of O(this,k).values())be.pageIndex===N&&de.push(be);return de}getEditor(N){return O(this,k).get(N)}addEditor(N){O(this,k).set(N.id,N)}removeEditor(N){O(this,k).delete(N.id),this.unselect(N)}setActiveEditor(N){O(this,g)!==N&&(me(this,g,N),N&&he(this,X,Je).call(this,N.propertiesToUpdate))}toggleSelected(N){if(O(this,Y).has(N)){O(this,Y).delete(N),N.unselect(),he(this,B,Be).call(this,{hasSelectedEditor:this.hasSelection});return}O(this,Y).add(N),N.select(),he(this,X,Je).call(this,N.propertiesToUpdate),he(this,B,Be).call(this,{hasSelectedEditor:!0})}setSelected(N){for(const de of O(this,Y))de!==N&&de.unselect();O(this,Y).clear(),O(this,Y).add(N),N.select(),he(this,X,Je).call(this,N.propertiesToUpdate),he(this,B,Be).call(this,{hasSelectedEditor:!0})}isSelected(N){return O(this,Y).has(N)}unselect(N){N.unselect(),O(this,Y).delete(N),he(this,B,Be).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return O(this,Y).size!==0}undo(){O(this,M).undo(),he(this,B,Be).call(this,{hasSomethingToUndo:O(this,M).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:he(this,ue,Qe).call(this)})}redo(){O(this,M).redo(),he(this,B,Be).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:O(this,M).hasSomethingToRedo(),isEmpty:he(this,ue,Qe).call(this)})}addCommands(N){O(this,M).add(N),he(this,B,Be).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:he(this,ue,Qe).call(this)})}delete(){if(O(this,g)&&O(this,g).commitOrRemove(),!this.hasSelection)return;const N=[...O(this,Y)],de=()=>{for(const Ae of N)Ae.remove()},be=()=>{for(const Ae of N)he(this,q,ct).call(this,Ae)};this.addCommands({cmd:de,undo:be,mustExec:!0})}copy(){if(O(this,g)&&O(this,g).commitOrRemove(),this.hasSelection){const N=[];for(const de of O(this,Y))de.isEmpty()||N.push(de);if(N.length===0)return;O(this,m).copy(N),he(this,B,Be).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(O(this,m).isEmpty())return;this.unselectAll();const N=O(this,E).get(O(this,ee)),de=O(this,m).paste().map(Ee=>N.deserialize(Ee)),be=()=>{for(const Ee of de)he(this,q,ct).call(this,Ee);he(this,oe,et).call(this,de)},Ae=()=>{for(const Ee of de)Ee.remove()};this.addCommands({cmd:be,undo:Ae,mustExec:!0})}selectAll(){for(const N of O(this,Y))N.commit();he(this,oe,et).call(this,O(this,k).values())}unselectAll(){if(O(this,g)){O(this,g).commitOrRemove();return}if(he(this,oe,et).size!==0){for(const N of O(this,Y))N.unselect();O(this,Y).clear(),he(this,B,Be).call(this,{hasSelectedEditor:!1})}}isActive(N){return O(this,g)===N}getActive(){return O(this,g)}getMode(){return O(this,$)}};g=new WeakMap,k=new WeakMap,E=new WeakMap,m=new WeakMap,M=new WeakMap,ee=new WeakMap,ie=new WeakMap,Q=new WeakMap,K=new WeakMap,G=new WeakMap,$=new WeakMap,Y=new WeakMap,ne=new WeakMap,ce=new WeakMap,_e=new WeakMap,W=new WeakMap,d=new WeakMap,u=new WeakSet,Ct=function(){O(this,d).addEventListener("keydown",O(this,ne))},j=new WeakSet,lt=function(){O(this,d).removeEventListener("keydown",O(this,ne))},B=new WeakSet,Be=function(N){Object.entries(N).some(([be,Ae])=>O(this,W)[be]!==Ae)&&O(this,Q).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(O(this,W),N)})},X=new WeakSet,Je=function(N){O(this,Q).dispatch("annotationeditorparamschanged",{source:this,details:N})},p=new WeakSet,xt=function(){if(!O(this,G)){me(this,G,!0);for(const N of O(this,E).values())N.enable()}},x=new WeakSet,wt=function(){if(this.unselectAll(),O(this,G)){me(this,G,!1);for(const N of O(this,E).values())N.disable()}},q=new WeakSet,ct=function(N){const de=O(this,E).get(N.pageIndex);de?de.addOrRebuild(N):this.addEditor(N)},ue=new WeakSet,Qe=function(){if(O(this,k).size===0)return!0;if(O(this,k).size===1)for(const N of O(this,k).values())return N.isEmpty();return!1},oe=new WeakSet,et=function(N){O(this,Y).clear();for(const de of N)de.isEmpty()||(O(this,Y).add(de),de.select());he(this,B,Be).call(this,{hasSelectedEditor:!0})},Me(le,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],le.prototype.selectAll],[["ctrl+c","mac+meta+c"],le.prototype.copy],[["ctrl+v","mac+meta+v"],le.prototype.paste],[["ctrl+x","mac+meta+x"],le.prototype.cut],[["ctrl+z","mac+meta+z"],le.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],le.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],le.prototype.delete],[["Escape","mac+Escape"],le.prototype.unselectAll]]));let C=le;n.AnnotationEditorUIManager=C},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=n.AnnotationPrefix=void 0,n.deprecated=s,n.getColorValues=M,n.getCurrentTransform=ee,n.getCurrentTransformInverse=ie,n.getFilenameFromUrl=l,n.getPdfFilenameFromUrl=b,n.getRGB=m,n.getXfaPageViewport=E,n.isDataScheme=e,n.isPdfFile=i,n.isValidFetchUrl=c,n.loadScript=r;var t=y(9),a=y(1);const F="http://www.w3.org/2000/svg",D="pdfjs_internal_id_";n.AnnotationPrefix=D;const Q=class Q{};Me(Q,"CSS",96),Me(Q,"PDF",72),Me(Q,"PDF_TO_CSS_UNITS",Q.CSS/Q.PDF);let T=Q;n.PixelsPerInch=T;class A extends t.BaseCanvasFactory{constructor({ownerDocument:G=globalThis.document}={}){super(),this._document=G}_createCanvas(G,$){const Y=this._document.createElement("canvas");return Y.width=G,Y.height=$,Y}}n.DOMCanvasFactory=A;async function f(K,G=!1){if(c(K,document.baseURI)){const $=await fetch(K);if(!$.ok)throw new Error($.statusText);return G?new Uint8Array(await $.arrayBuffer()):(0,a.stringToBytes)(await $.text())}return new Promise(($,Y)=>{const ne=new XMLHttpRequest;ne.open("GET",K,!0),G&&(ne.responseType="arraybuffer"),ne.onreadystatechange=()=>{if(ne.readyState===XMLHttpRequest.DONE){if(ne.status===200||ne.status===0){let ce;if(G&&ne.response?ce=new Uint8Array(ne.response):!G&&ne.responseText&&(ce=(0,a.stringToBytes)(ne.responseText)),ce){$(ce);return}}Y(new Error(ne.statusText))}},ne.send(null)})}class w extends t.BaseCMapReaderFactory{_fetchData(G,$){return f(G,this.isCompressed).then(Y=>({cMapData:Y,compressionType:$}))}}n.DOMCMapReaderFactory=w;class L extends t.BaseStandardFontDataFactory{_fetchData(G){return f(G,!0)}}n.DOMStandardFontDataFactory=L;class C extends t.BaseSVGFactory{_createSVG(G){return document.createElementNS(F,G)}}n.DOMSVGFactory=C;class S{constructor({viewBox:G,scale:$,rotation:Y,offsetX:ne=0,offsetY:ce=0,dontFlip:_e=!1}){this.viewBox=G,this.scale=$,this.rotation=Y,this.offsetX=ne,this.offsetY=ce;const W=(G[2]+G[0])/2,d=(G[3]+G[1])/2;let u,R,j,U;switch(Y%=360,Y<0&&(Y+=360),Y){case 180:u=-1,R=0,j=0,U=1;break;case 90:u=0,R=1,j=1,U=0;break;case 270:u=0,R=-1,j=-1,U=0;break;case 0:u=1,R=0,j=0,U=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}_e&&(j=-j,U=-U);let B,V,X,o;u===0?(B=Math.abs(d-G[1])*$+ne,V=Math.abs(W-G[0])*$+ce,X=Math.abs(G[3]-G[1])*$,o=Math.abs(G[2]-G[0])*$):(B=Math.abs(W-G[0])*$+ne,V=Math.abs(d-G[1])*$+ce,X=Math.abs(G[2]-G[0])*$,o=Math.abs(G[3]-G[1])*$),this.transform=[u*$,R*$,j*$,U*$,B-u*$*W-j*$*d,V-R*$*W-U*$*d],this.width=X,this.height=o}clone({scale:G=this.scale,rotation:$=this.rotation,offsetX:Y=this.offsetX,offsetY:ne=this.offsetY,dontFlip:ce=!1}={}){return new S({viewBox:this.viewBox.slice(),scale:G,rotation:$,offsetX:Y,offsetY:ne,dontFlip:ce})}convertToViewportPoint(G,$){return a.Util.applyTransform([G,$],this.transform)}convertToViewportRectangle(G){const $=a.Util.applyTransform([G[0],G[1]],this.transform),Y=a.Util.applyTransform([G[2],G[3]],this.transform);return[$[0],$[1],Y[0],Y[1]]}convertToPdfPoint(G,$){return a.Util.applyInverseTransform([G,$],this.transform)}}n.PageViewport=S;class h extends a.BaseException{constructor(G,$){super(G,"RenderingCancelledException"),this.type=$}}n.RenderingCancelledException=h;function e(K){const G=K.length;let $=0;for(;$<G&&K[$].trim()==="";)$++;return K.substring($,$+5).toLowerCase()==="data:"}function i(K){return typeof K=="string"&&/\.pdf$/i.test(K)}function l(K){const G=K.indexOf("#"),$=K.indexOf("?"),Y=Math.min(G>0?G:K.length,$>0?$:K.length);return K.substring(K.lastIndexOf("/",Y)+1,Y)}function b(K,G="document.pdf"){if(typeof K!="string")return G;if(e(K))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),G;const $=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Y=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ne=$.exec(K);let ce=Y.exec(ne[1])||Y.exec(ne[2])||Y.exec(ne[3]);if(ce&&(ce=ce[0],ce.includes("%")))try{ce=Y.exec(decodeURIComponent(ce))[0]}catch{}return ce||G}class v{constructor(){this.started=Object.create(null),this.times=[]}time(G){G in this.started&&(0,a.warn)(`Timer is already running for ${G}`),this.started[G]=Date.now()}timeEnd(G){G in this.started||(0,a.warn)(`Timer has not been started for ${G}`),this.times.push({name:G,start:this.started[G],end:Date.now()}),delete this.started[G]}toString(){const G=[];let $=0;for(const Y of this.times){const ne=Y.name;ne.length>$&&($=ne.length)}for(const Y of this.times){const ne=Y.end-Y.start;G.push(`${Y.name.padEnd($)} ${ne}ms
`)}return G.join("")}}n.StatTimer=v;function c(K,G){try{const{protocol:$}=G?new URL(K,G):new URL(K);return $==="http:"||$==="https:"}catch{return!1}}function r(K,G=!1){return new Promise(($,Y)=>{const ne=document.createElement("script");ne.src=K,ne.onload=function(ce){G&&ne.remove(),$(ce)},ne.onerror=function(){Y(new Error(`Cannot load script at: ${ne.src}`))},(document.head||document.documentElement).append(ne)})}function s(K){console.log("Deprecated API usage: "+K)}let g;class k{static toDateObject(G){if(!G||typeof G!="string")return null;g||(g=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const $=g.exec(G);if(!$)return null;const Y=parseInt($[1],10);let ne=parseInt($[2],10);ne=ne>=1&&ne<=12?ne-1:0;let ce=parseInt($[3],10);ce=ce>=1&&ce<=31?ce:1;let _e=parseInt($[4],10);_e=_e>=0&&_e<=23?_e:0;let W=parseInt($[5],10);W=W>=0&&W<=59?W:0;let d=parseInt($[6],10);d=d>=0&&d<=59?d:0;const u=$[7]||"Z";let R=parseInt($[8],10);R=R>=0&&R<=23?R:0;let j=parseInt($[9],10)||0;return j=j>=0&&j<=59?j:0,u==="-"?(_e+=R,W+=j):u==="+"&&(_e-=R,W-=j),new Date(Date.UTC(Y,ne,ce,_e,W,d))}}n.PDFDateString=k;function E(K,{scale:G=1,rotation:$=0}){const{width:Y,height:ne}=K.attributes.style,ce=[0,0,parseInt(Y),parseInt(ne)];return new S({viewBox:ce,scale:G,rotation:$})}function m(K){if(K.startsWith("#")){const G=parseInt(K.slice(1),16);return[(G&16711680)>>16,(G&65280)>>8,G&255]}return K.startsWith("rgb(")?K.slice(4,-1).split(",").map(G=>parseInt(G)):K.startsWith("rgba(")?K.slice(5,-1).split(",").map(G=>parseInt(G)).slice(0,3):((0,a.warn)(`Not a valid color format: "${K}"`),[0,0,0])}function M(K){const G=document.createElement("span");G.style.visibility="hidden",document.body.append(G);for(const $ of K.keys()){G.style.color=$;const Y=window.getComputedStyle(G).color;K.set($,m(Y))}G.remove()}function ee(K){const{a:G,b:$,c:Y,d:ne,e:ce,f:_e}=K.getTransform();return[G,$,Y,ne,ce,_e]}function ie(K){const{a:G,b:$,c:Y,d:ne,e:ce,f:_e}=K.getTransform().invertSelf();return[G,$,Y,ne,ce,_e]}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var t=y(1);class a{constructor(){this.constructor===a&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,w){if(f<=0||w<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(f,w);return{canvas:L,context:L.getContext("2d")}}reset(f,w,L){if(!f.canvas)throw new Error("Canvas is not specified");if(w<=0||L<=0)throw new Error("Invalid canvas size");f.canvas.width=w,f.canvas.height=L}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,w){(0,t.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=a;class F{constructor({baseUrl:f=null,isCompressed:w=!1}){this.constructor===F&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=w}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const w=this.baseUrl+f+(this.isCompressed?".bcmap":""),L=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(w,L).catch(C=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${w}`)})}_fetchData(f,w){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=F;class D{constructor({baseUrl:f=null}){this.constructor===D&&(0,t.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const w=`${this.baseUrl}${f}`;return this._fetchData(w).catch(L=>{throw new Error(`Unable to load font data at: ${w}`)})}_fetchData(f){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=D;class T{constructor(){this.constructor===T&&(0,t.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,w,L=!1){if(f<=0||w<=0)throw new Error("Invalid SVG dimensions");const C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),L||(C.setAttribute("width",`${f}px`),C.setAttribute("height",`${w}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${f} ${w}`),C}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,t.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=T},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var t=y(1);const a=3285377520,F=4294901760,D=65535;class T{constructor(f){this.h1=f?f&4294967295:a,this.h2=f?f&4294967295:a}update(f){let w,L;if(typeof f=="string"){w=new Uint8Array(f.length*2),L=0;for(let g=0,k=f.length;g<k;g++){const E=f.charCodeAt(g);E<=255?w[L++]=E:(w[L++]=E>>>8,w[L++]=E&255)}}else if((0,t.isArrayBuffer)(f))w=f.slice(),L=w.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const C=L>>2,S=L-C*4,h=new Uint32Array(w.buffer,0,C);let e=0,i=0,l=this.h1,b=this.h2;const v=3432918353,c=461845907,r=v&D,s=c&D;for(let g=0;g<C;g++)g&1?(e=h[g],e=e*v&F|e*r&D,e=e<<15|e>>>17,e=e*c&F|e*s&D,l^=e,l=l<<13|l>>>19,l=l*5+3864292196):(i=h[g],i=i*v&F|i*r&D,i=i<<15|i>>>17,i=i*c&F|i*s&D,b^=i,b=b<<13|b>>>19,b=b*5+3864292196);switch(e=0,S){case 3:e^=w[C*4+2]<<16;case 2:e^=w[C*4+1]<<8;case 1:e^=w[C*4],e=e*v&F|e*r&D,e=e<<15|e>>>17,e=e*c&F|e*s&D,C&1?l^=e:b^=e}this.h1=l,this.h2=b}hexdigest(){let f=this.h1,w=this.h2;f^=w>>>1,f=f*3981806797&F|f*36045&D,w=w*4283543511&F|((w<<16|f>>>16)*2950163797&F)>>>16,f^=w>>>1,f=f*444984403&F|f*60499&D,w=w*3301882366&F|((w<<16|f>>>16)*3120437893&F)>>>16,f^=w>>>1;const L=(f>>>0).toString(16),C=(w>>>0).toString(16);return L.padStart(8,"0")+C.padStart(8,"0")}}n.MurmurHash3_64=T},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var t=y(1);class a{constructor({docId:A,onUnsupportedFeature:f,ownerDocument:w=globalThis.document,styleElement:L=null}){this.constructor===a&&(0,t.unreachable)("Cannot initialize BaseFontLoader."),this.docId=A,this._onUnsupportedFeature=f,this._document=w,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(A){this.nativeFontFaces.push(A),this._document.fonts.add(A)}insertRule(A){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(f));const w=f.sheet;w.insertRule(A,w.cssRules.length)}clear(){for(const A of this.nativeFontFaces)this._document.fonts.delete(A);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(A){if(A.attached||A.missingFile)return;if(A.attached=!0,this.isFontLoadingAPISupported){const w=A.createNativeFontFace();if(w){this.addNativeFontFace(w);try{await w.loaded}catch(L){throw this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,t.warn)(`Failed to load font '${w.family}': '${L}'.`),A.disableFontFace=!0,L}}return}const f=A.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(w=>{const L=this._queueLoadingCallback(w);this._prepareFontLoadEvent([f],[A],L)})}}_queueLoadingCallback(A){(0,t.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const A=!!((f=this._document)!=null&&f.fonts);return(0,t.shadow)(this,"isFontLoadingAPISupported",A)}get isSyncFontLoadingSupported(){(0,t.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,t.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(A,f,w){(0,t.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let F;n.FontLoader=F,n.FontLoader=F=class extends a{constructor(A){super(A),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let A=!1;if(typeof navigator>"u")A=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(A=!0)}return(0,t.shadow)(this,"isSyncFontLoadingSupported",A)}_queueLoadingCallback(A){function f(){for((0,t.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;w.requests.length>0&&w.requests[0].done;){const C=w.requests.shift();setTimeout(C.callback,0)}}const w=this.loadingContext,L={id:`pdfjs-font-loading-${w.nextRequestId++}`,done:!1,complete:f,callback:A};return w.requests.push(L),L}get _loadTestFont(){const A=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,t.shadow)(this,"_loadTestFont",A())}_prepareFontLoadEvent(A,f,w){function L(ie,Q){return ie.charCodeAt(Q)<<24|ie.charCodeAt(Q+1)<<16|ie.charCodeAt(Q+2)<<8|ie.charCodeAt(Q+3)&255}function C(ie,Q,K,G){const $=ie.substring(0,Q),Y=ie.substring(Q+K);return $+G+Y}let S,h;const e=this._document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d");let l=0;function b(ie,Q){if(l++,l>30){(0,t.warn)("Load test font never loaded."),Q();return}if(i.font="30px "+ie,i.fillText(".",0,20),i.getImageData(0,0,1,1).data[3]>0){Q();return}setTimeout(b.bind(null,ie,Q))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let c=this._loadTestFont;c=C(c,976,v.length,v);const s=16,g=1482184792;let k=L(c,s);for(S=0,h=v.length-3;S<h;S+=4)k=k-g+L(v,S)|0;S<v.length&&(k=k-g+L(v+"XXX",S)|0),c=C(c,s,4,(0,t.string32)(k));const E=`url(data:font/opentype;base64,${btoa(c)});`,m=`@font-face {font-family:"${v}";src:${E}}`;this.insertRule(m);const M=[];for(const ie of f)M.push(ie.loadedName);M.push(v);const ee=this._document.createElement("div");ee.style.visibility="hidden",ee.style.width=ee.style.height="10px",ee.style.position="absolute",ee.style.top=ee.style.left="0px";for(const ie of M){const Q=this._document.createElement("span");Q.textContent="Hi",Q.style.fontFamily=ie,ee.append(Q)}this._document.body.append(ee),b(v,()=>{ee.remove(),w.complete()})}};class D{constructor(A,{isEvalSupported:f=!0,disableFontFace:w=!1,ignoreErrors:L=!1,onUnsupportedFeature:C,fontRegistry:S=null}){this.compiledGlyphs=Object.create(null);for(const h in A)this[h]=A[h];this.isEvalSupported=f!==!1,this.disableFontFace=w===!0,this.ignoreErrors=L===!0,this._onUnsupportedFeature=C,this.fontRegistry=S}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let A;if(!this.cssFontInfo)A=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),A=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),A}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const A=(0,t.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(A)});`;let w;if(!this.cssFontInfo)w=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let L=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(L+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),w=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${L}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),w}getPathGenerator(A,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let w;try{w=A.get(this.loadedName+"_path_"+f)}catch(L){if(!this.ignoreErrors)throw L;return this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,t.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[f]=function(C,S){}}if(this.isEvalSupported&&t.FeatureTest.isEvalSupported){const L=[];for(const C of w){const S=C.args!==void 0?C.args.join(","):"";L.push("c.",C.cmd,"(",S,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",L.join(""))}return this.compiledGlyphs[f]=function(L,C){for(const S of w)S.cmd==="scale"&&(S.args=[C,-C]),L[S.cmd].apply(L,S.args)}}}n.FontFaceObject=D},(P,n,y)=>{var ne,ht;Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var t=y(8),a=y(1),F=y(13),D=y(14),T=y(3);const A=16,f=100,w=4096,L=15,C=10,S=T.isNodeJS&&typeof Path2D>"u"?-1:1e3,h=16;function e(W,d){if(W._removeMirroring)throw new Error("Context is already forwarding operations.");W.__originalSave=W.save,W.__originalRestore=W.restore,W.__originalRotate=W.rotate,W.__originalScale=W.scale,W.__originalTranslate=W.translate,W.__originalTransform=W.transform,W.__originalSetTransform=W.setTransform,W.__originalResetTransform=W.resetTransform,W.__originalClip=W.clip,W.__originalMoveTo=W.moveTo,W.__originalLineTo=W.lineTo,W.__originalBezierCurveTo=W.bezierCurveTo,W.__originalRect=W.rect,W.__originalClosePath=W.closePath,W.__originalBeginPath=W.beginPath,W._removeMirroring=()=>{W.save=W.__originalSave,W.restore=W.__originalRestore,W.rotate=W.__originalRotate,W.scale=W.__originalScale,W.translate=W.__originalTranslate,W.transform=W.__originalTransform,W.setTransform=W.__originalSetTransform,W.resetTransform=W.__originalResetTransform,W.clip=W.__originalClip,W.moveTo=W.__originalMoveTo,W.lineTo=W.__originalLineTo,W.bezierCurveTo=W.__originalBezierCurveTo,W.rect=W.__originalRect,W.closePath=W.__originalClosePath,W.beginPath=W.__originalBeginPath,delete W._removeMirroring},W.save=function(){d.save(),this.__originalSave()},W.restore=function(){d.restore(),this.__originalRestore()},W.translate=function(R,j){d.translate(R,j),this.__originalTranslate(R,j)},W.scale=function(R,j){d.scale(R,j),this.__originalScale(R,j)},W.transform=function(R,j,U,B,V,X){d.transform(R,j,U,B,V,X),this.__originalTransform(R,j,U,B,V,X)},W.setTransform=function(R,j,U,B,V,X){d.setTransform(R,j,U,B,V,X),this.__originalSetTransform(R,j,U,B,V,X)},W.resetTransform=function(){d.resetTransform(),this.__originalResetTransform()},W.rotate=function(R){d.rotate(R),this.__originalRotate(R)},W.clip=function(R){d.clip(R),this.__originalClip(R)},W.moveTo=function(u,R){d.moveTo(u,R),this.__originalMoveTo(u,R)},W.lineTo=function(u,R){d.lineTo(u,R),this.__originalLineTo(u,R)},W.bezierCurveTo=function(u,R,j,U,B,V){d.bezierCurveTo(u,R,j,U,B,V),this.__originalBezierCurveTo(u,R,j,U,B,V)},W.rect=function(u,R,j,U){d.rect(u,R,j,U),this.__originalRect(u,R,j,U)},W.closePath=function(){d.closePath(),this.__originalClosePath()},W.beginPath=function(){d.beginPath(),this.__originalBeginPath()}}class i{constructor(d){this.canvasFactory=d,this.cache=Object.create(null)}getCanvas(d,u,R){let j;return this.cache[d]!==void 0?(j=this.cache[d],this.canvasFactory.reset(j,u,R)):(j=this.canvasFactory.create(u,R),this.cache[d]=j),j}delete(d){delete this.cache[d]}clear(){for(const d in this.cache){const u=this.cache[d];this.canvasFactory.destroy(u),delete this.cache[d]}}}function l(W,d,u,R,j,U,B,V,X,o){const[p,_,x,I,q,re]=(0,t.getCurrentTransform)(W);if(_===0&&x===0){const oe=B*p+q,te=Math.round(oe),le=V*I+re,fe=Math.round(le),N=(B+X)*p+q,de=Math.abs(Math.round(N)-te)||1,be=(V+o)*I+re,Ae=Math.abs(Math.round(be)-fe)||1;return W.setTransform(Math.sign(p),0,0,Math.sign(I),te,fe),W.drawImage(d,u,R,j,U,0,0,de,Ae),W.setTransform(p,_,x,I,q,re),[de,Ae]}if(p===0&&I===0){const oe=V*x+q,te=Math.round(oe),le=B*_+re,fe=Math.round(le),N=(V+o)*x+q,de=Math.abs(Math.round(N)-te)||1,be=(B+X)*_+re,Ae=Math.abs(Math.round(be)-fe)||1;return W.setTransform(0,Math.sign(_),Math.sign(x),0,te,fe),W.drawImage(d,u,R,j,U,0,0,Ae,de),W.setTransform(p,_,x,I,q,re),[Ae,de]}W.drawImage(d,u,R,j,U,B,V,X,o);const ue=Math.hypot(p,_),Z=Math.hypot(x,I);return[ue*X,Z*o]}function b(W){const{width:d,height:u}=W;if(d>S||u>S)return null;const R=1e3,j=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),U=d+1;let B=new Uint8Array(U*(u+1)),V,X,o;const p=d+7&-8;let _=new Uint8Array(p*u),x=0;for(const Z of W.data){let oe=128;for(;oe>0;)_[x++]=Z&oe?0:255,oe>>=1}let I=0;for(x=0,_[x]!==0&&(B[0]=1,++I),X=1;X<d;X++)_[x]!==_[x+1]&&(B[X]=_[x]?2:1,++I),x++;for(_[x]!==0&&(B[X]=2,++I),V=1;V<u;V++){x=V*p,o=V*U,_[x-p]!==_[x]&&(B[o]=_[x]?1:8,++I);let Z=(_[x]?4:0)+(_[x-p]?8:0);for(X=1;X<d;X++)Z=(Z>>2)+(_[x+1]?4:0)+(_[x-p+1]?8:0),j[Z]&&(B[o+X]=j[Z],++I),x++;if(_[x-p]!==_[x]&&(B[o+X]=_[x]?2:4,++I),I>R)return null}for(x=p*(u-1),o=V*U,_[x]!==0&&(B[o]=8,++I),X=1;X<d;X++)_[x]!==_[x+1]&&(B[o+X]=_[x]?4:8,++I),x++;if(_[x]!==0&&(B[o+X]=4,++I),I>R)return null;const q=new Int32Array([0,U,-1,0,-U,0,0,0,1]),re=new Path2D;for(V=0;I&&V<=u;V++){let Z=V*U;const oe=Z+d;for(;Z<oe&&!B[Z];)Z++;if(Z===oe)continue;re.moveTo(Z%U,V);const te=Z;let le=B[Z];do{const fe=q[le];do Z+=fe;while(!B[Z]);const N=B[Z];N!==5&&N!==10?(le=N,B[Z]=0):(le=N&51*le>>4,B[Z]&=le>>2|le<<2),re.lineTo(Z%U,Z/U|0),B[Z]||--I}while(te!==Z);--V}return _=null,B=null,function(Z){Z.save(),Z.scale(1/d,-1/u),Z.translate(0,-u),Z.fill(re),Z.beginPath(),Z.restore()}}class v{constructor(d,u){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,d,u])}clone(){const d=Object.create(this);return d.clipBox=this.clipBox.slice(),d}setCurrentPoint(d,u){this.x=d,this.y=u}updatePathMinMax(d,u,R){[u,R]=a.Util.applyTransform([u,R],d),this.minX=Math.min(this.minX,u),this.minY=Math.min(this.minY,R),this.maxX=Math.max(this.maxX,u),this.maxY=Math.max(this.maxY,R)}updateRectMinMax(d,u){const R=a.Util.applyTransform(u,d),j=a.Util.applyTransform(u.slice(2),d);this.minX=Math.min(this.minX,R[0],j[0]),this.minY=Math.min(this.minY,R[1],j[1]),this.maxX=Math.max(this.maxX,R[0],j[0]),this.maxY=Math.max(this.maxY,R[1],j[1])}updateScalingPathMinMax(d,u){a.Util.scaleMinMax(d,u),this.minX=Math.min(this.minX,u[0]),this.maxX=Math.max(this.maxX,u[1]),this.minY=Math.min(this.minY,u[2]),this.maxY=Math.max(this.maxY,u[3])}updateCurvePathMinMax(d,u,R,j,U,B,V,X,o,p){const _=a.Util.bezierBoundingBox(u,R,j,U,B,V,X,o);if(p){p[0]=Math.min(p[0],_[0],_[2]),p[1]=Math.max(p[1],_[0],_[2]),p[2]=Math.min(p[2],_[1],_[3]),p[3]=Math.max(p[3],_[1],_[3]);return}this.updateRectMinMax(d,_)}getPathBoundingBox(d=F.PathType.FILL,u=null){const R=[this.minX,this.minY,this.maxX,this.maxY];if(d===F.PathType.STROKE){u||(0,a.unreachable)("Stroke bounding box must include transform.");const j=a.Util.singularValueDecompose2dScale(u),U=j[0]*this.lineWidth/2,B=j[1]*this.lineWidth/2;R[0]-=U,R[1]-=B,R[2]+=U,R[3]+=B}return R}updateClipFromPath(){const d=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(d||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(d){this.clipBox=d,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(d=F.PathType.FILL,u=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(d,u))}}function c(W,d,u=null){if(typeof ImageData<"u"&&d instanceof ImageData){W.putImageData(d,0,0);return}const R=d.height,j=d.width,U=R%h,B=(R-U)/h,V=U===0?B:B+1,X=W.createImageData(j,h);let o=0,p;const _=d.data,x=X.data;let I,q,re,ue,Z,oe,te,le;if(u)switch(u.length){case 1:Z=u[0],oe=u[0],te=u[0],le=u[0];break;case 4:Z=u[0],oe=u[1],te=u[2],le=u[3];break}if(d.kind===a.ImageKind.GRAYSCALE_1BPP){const fe=_.byteLength,N=new Uint32Array(x.buffer,0,x.byteLength>>2),de=N.length,be=j+7>>3;let Ae=4294967295,Ee=a.FeatureTest.isLittleEndian?4278190080:255;for(le&&le[0]===255&&le[255]===0&&([Ae,Ee]=[Ee,Ae]),I=0;I<V;I++){for(re=I<B?h:U,p=0,q=0;q<re;q++){const Ce=fe-o;let Fe=0;const ke=Ce>be?j:Ce*8-7,ze=ke&-8;let Pe=0,Oe=0;for(;Fe<ze;Fe+=8)Oe=_[o++],N[p++]=Oe&128?Ae:Ee,N[p++]=Oe&64?Ae:Ee,N[p++]=Oe&32?Ae:Ee,N[p++]=Oe&16?Ae:Ee,N[p++]=Oe&8?Ae:Ee,N[p++]=Oe&4?Ae:Ee,N[p++]=Oe&2?Ae:Ee,N[p++]=Oe&1?Ae:Ee;for(;Fe<ke;Fe++)Pe===0&&(Oe=_[o++],Pe=128),N[p++]=Oe&Pe?Ae:Ee,Pe>>=1}for(;p<de;)N[p++]=0;W.putImageData(X,0,I*h)}}else if(d.kind===a.ImageKind.RGBA_32BPP){const fe=!!(Z||oe||te);for(q=0,ue=j*h*4,I=0;I<B;I++){if(x.set(_.subarray(o,o+ue)),o+=ue,fe)for(let N=0;N<ue;N+=4)Z&&(x[N+0]=Z[x[N+0]]),oe&&(x[N+1]=oe[x[N+1]]),te&&(x[N+2]=te[x[N+2]]);W.putImageData(X,0,q),q+=h}if(I<V){if(ue=j*U*4,x.set(_.subarray(o,o+ue)),fe)for(let N=0;N<ue;N+=4)Z&&(x[N+0]=Z[x[N+0]]),oe&&(x[N+1]=oe[x[N+1]]),te&&(x[N+2]=te[x[N+2]]);W.putImageData(X,0,q)}}else if(d.kind===a.ImageKind.RGB_24BPP){const fe=!!(Z||oe||te);for(re=h,ue=j*re,I=0;I<V;I++){for(I>=B&&(re=U,ue=j*re),p=0,q=ue;q--;)x[p++]=_[o++],x[p++]=_[o++],x[p++]=_[o++],x[p++]=255;if(fe)for(let N=0;N<p;N+=4)Z&&(x[N+0]=Z[x[N+0]]),oe&&(x[N+1]=oe[x[N+1]]),te&&(x[N+2]=te[x[N+2]]);W.putImageData(X,0,I*h)}}else throw new Error(`bad image kind: ${d.kind}`)}function r(W,d){if(d.bitmap){W.drawImage(d.bitmap,0,0);return}const u=d.height,R=d.width,j=u%h,U=(u-j)/h,B=j===0?U:U+1,V=W.createImageData(R,h);let X=0;const o=d.data,p=V.data;for(let _=0;_<B;_++){const x=_<U?h:j;({srcPos:X}=(0,D.applyMaskImageData)({src:o,srcPos:X,dest:p,width:R,height:x})),W.putImageData(V,0,_*h)}}function s(W,d){const u=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let R=0,j=u.length;R<j;R++){const U=u[R];W[U]!==void 0&&(d[U]=W[U])}W.setLineDash!==void 0&&(d.setLineDash(W.getLineDash()),d.lineDashOffset=W.lineDashOffset)}function g(W,d){W.strokeStyle=W.fillStyle=d||"#000000",W.fillRule="nonzero",W.globalAlpha=1,W.lineWidth=1,W.lineCap="butt",W.lineJoin="miter",W.miterLimit=10,W.globalCompositeOperation="source-over",W.font="10px sans-serif",W.setLineDash!==void 0&&(W.setLineDash([]),W.lineDashOffset=0)}function k(W,d,u,R){const j=W.length;for(let U=3;U<j;U+=4){const B=W[U];if(B===0)W[U-3]=d,W[U-2]=u,W[U-1]=R;else if(B<255){const V=255-B;W[U-3]=W[U-3]*B+d*V>>8,W[U-2]=W[U-2]*B+u*V>>8,W[U-1]=W[U-1]*B+R*V>>8}}}function E(W,d,u){const R=W.length,j=1/255;for(let U=3;U<R;U+=4){const B=u?u[W[U]]:W[U];d[U]=d[U]*B*j|0}}function m(W,d,u){const R=W.length;for(let j=3;j<R;j+=4){const U=W[j-3]*77+W[j-2]*152+W[j-1]*28;d[j]=u?d[j]*u[U>>8]>>8:d[j]*U>>16}}function M(W,d,u,R,j,U,B,V,X,o,p){const _=!!U,x=_?U[0]:0,I=_?U[1]:0,q=_?U[2]:0;let re;j==="Luminosity"?re=m:re=E;const Z=Math.min(R,Math.ceil(1048576/u));for(let oe=0;oe<R;oe+=Z){const te=Math.min(Z,R-oe),le=W.getImageData(V-o,oe+(X-p),u,te),fe=d.getImageData(V,oe+X,u,te);_&&k(le.data,x,I,q),re(le.data,fe.data,B),d.putImageData(fe,V,oe+X)}}function ee(W,d,u,R){const j=R[0],U=R[1],B=R[2]-j,V=R[3]-U;B===0||V===0||(M(d.context,u,B,V,d.subtype,d.backdrop,d.transferMap,j,U,d.offsetX,d.offsetY),W.save(),W.globalAlpha=1,W.globalCompositeOperation="source-over",W.setTransform(1,0,0,1,0,0),W.drawImage(u.canvas,0,0),W.restore())}function ie(W,d){const u=a.Util.singularValueDecompose2dScale(W);u[0]=Math.fround(u[0]),u[1]=Math.fround(u[1]);const R=Math.fround((globalThis.devicePixelRatio||1)*t.PixelsPerInch.PDF_TO_CSS_UNITS);return d!==void 0?d:u[0]<=R||u[1]<=R}const Q=["butt","round","square"],K=["miter","round","bevel"],G={},$={},_e=class _e{constructor(d,u,R,j,U,B,V,X){ae(this,ne);this.ctx=d,this.current=new v(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=u,this.objs=R,this.canvasFactory=j,this.imageLayer=U,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=B,this.cachedCanvases=new i(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=V,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(X==null?void 0:X.background)||null,this.foregroundColor=(X==null?void 0:X.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(d,u=null){return typeof d=="string"?d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d):u}beginDrawing({transform:d,viewport:u,transparency:R=!1,background:j=null}){const U=this.ctx.canvas.width,B=this.ctx.canvas.height,V=j||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const X=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const o=this.backgroundColor=this.ctx.fillStyle;let p=!0,_=V;if(this.ctx.fillStyle=V,_=this.ctx.fillStyle,p=typeof _=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_),X==="#000000"&&o==="#ffffff"||X===o||!p)this.foregroundColor=this.backgroundColor=null;else{const[x,I,q]=(0,t.getRGB)(_),re=Z=>(Z/=255,Z<=.03928?Z/12.92:((Z+.055)/1.055)**2.4),ue=Math.round(.2126*re(x)+.7152*re(I)+.0722*re(q));this.selectColor=(Z,oe,te)=>{const le=.2126*re(Z)+.7152*re(oe)+.0722*re(te);return Math.round(le)===ue?o:X}}}if(this.ctx.fillStyle=this.backgroundColor||V,this.ctx.fillRect(0,0,U,B),this.ctx.restore(),R){const X=this.cachedCanvases.getCanvas("transparent",U,B);this.compositeCtx=this.ctx,this.transparentCanvas=X.canvas,this.ctx=X.context,this.ctx.save(),this.ctx.transform(...(0,t.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),g(this.ctx,this.foregroundColor),d&&(this.ctx.transform(...d),this.outputScaleX=d[0],this.outputScaleY=d[0]),this.ctx.transform(...u.transform),this.viewportScale=u.scale,this.baseTransform=(0,t.getCurrentTransform)(this.ctx),this.imageLayer&&((0,t.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(d,u,R,j){const U=d.argsArray,B=d.fnArray;let V=u||0;const X=U.length;if(X===V)return V;const o=X-V>C&&typeof R=="function",p=o?Date.now()+L:0;let _=0;const x=this.commonObjs,I=this.objs;let q;for(;;){if(j!==void 0&&V===j.nextBreakPoint)return j.breakIt(V,R),V;if(q=B[V],q!==a.OPS.dependency)this[q].apply(this,U[V]);else for(const re of U[V]){const ue=re.startsWith("g_")?x:I;if(!ue.has(re))return ue.get(re,R),V}if(V++,V===X)return V;if(o&&++_>C){if(Date.now()>p)return R(),V;_=0}}}endDrawing(){he(this,ne,ht).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const u of d.values())typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement&&(u.width=u.height=0);d.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(d,u){const R=d.width,j=d.height;let U=Math.max(Math.hypot(u[0],u[1]),1),B=Math.max(Math.hypot(u[2],u[3]),1),V=R,X=j,o="prescale1",p,_;for(;U>2&&V>1||B>2&&X>1;){let x=V,I=X;U>2&&V>1&&(x=Math.ceil(V/2),U/=V/x),B>2&&X>1&&(I=Math.ceil(X/2),B/=X/I),p=this.cachedCanvases.getCanvas(o,x,I),_=p.context,_.clearRect(0,0,x,I),_.drawImage(d,0,0,V,X,0,0,x,I),d=p.canvas,V=x,X=I,o=o==="prescale1"?"prescale2":"prescale1"}return{img:d,paintWidth:V,paintHeight:X}}_createMaskCanvas(d){const u=this.ctx,{width:R,height:j}=d,U=this.current.fillColor,B=this.current.patternFill,V=(0,t.getCurrentTransform)(u);let X,o,p,_;if((d.bitmap||d.data)&&d.count>1){const de=d.bitmap||d.data.buffer,be=V.slice(0,4);o=JSON.stringify(B?be:[be,U]),X=this._cachedBitmapsMap.get(de),X||(X=new Map,this._cachedBitmapsMap.set(de,X));const Ae=X.get(o);if(Ae&&!B){const Ee=Math.round(Math.min(V[0],V[2])+V[4]),Ce=Math.round(Math.min(V[1],V[3])+V[5]);return{canvas:Ae,offsetX:Ee,offsetY:Ce}}p=Ae}p||(_=this.cachedCanvases.getCanvas("maskCanvas",R,j),r(_.context,d));let x=a.Util.transform(V,[1/R,0,0,-1/j,0,0]);x=a.Util.transform(x,[1,0,0,1,0,-j]);const I=a.Util.applyTransform([0,0],x),q=a.Util.applyTransform([R,j],x),re=a.Util.normalizeRect([I[0],I[1],q[0],q[1]]),ue=Math.round(re[2]-re[0])||1,Z=Math.round(re[3]-re[1])||1,oe=this.cachedCanvases.getCanvas("fillCanvas",ue,Z),te=oe.context,le=Math.min(I[0],q[0]),fe=Math.min(I[1],q[1]);te.translate(-le,-fe),te.transform(...x),p||(p=this._scaleImage(_.canvas,(0,t.getCurrentTransformInverse)(te)),p=p.img,X&&B&&X.set(o,p)),te.imageSmoothingEnabled=ie((0,t.getCurrentTransform)(te),d.interpolate),l(te,p,0,0,p.width,p.height,0,0,R,j),te.globalCompositeOperation="source-in";const N=a.Util.transform((0,t.getCurrentTransformInverse)(te),[1,0,0,1,-le,-fe]);return te.fillStyle=B?U.getPattern(u,this,N,F.PathType.FILL):U,te.fillRect(0,0,R,j),X&&!B&&(this.cachedCanvases.delete("fillCanvas"),X.set(o,oe.canvas)),{canvas:oe.canvas,offsetX:Math.round(le),offsetY:Math.round(fe)}}setLineWidth(d){d!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=d,this.ctx.lineWidth=d}setLineCap(d){this.ctx.lineCap=Q[d]}setLineJoin(d){this.ctx.lineJoin=K[d]}setMiterLimit(d){this.ctx.miterLimit=d}setDash(d,u){const R=this.ctx;R.setLineDash!==void 0&&(R.setLineDash(d),R.lineDashOffset=u)}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(let u=0,R=d.length;u<R;u++){const j=d[u],U=j[0],B=j[1];switch(U){case"LW":this.setLineWidth(B);break;case"LC":this.setLineCap(B);break;case"LJ":this.setLineJoin(B);break;case"ML":this.setMiterLimit(B);break;case"D":this.setDash(B[0],B[1]);break;case"RI":this.setRenderingIntent(B);break;case"FL":this.setFlatness(B);break;case"Font":this.setFont(B[0],B[1]);break;case"CA":this.current.strokeAlpha=j[1];break;case"ca":this.current.fillAlpha=j[1],this.ctx.globalAlpha=j[1];break;case"BM":this.ctx.globalCompositeOperation=B;break;case"SMask":this.current.activeSMask=B?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=B}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const d=this.inSMaskMode;this.current.activeSMask&&!d?this.beginSMaskMode():!this.current.activeSMask&&d&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const d=this.ctx.canvas.width,u=this.ctx.canvas.height,R="smaskGroupAt"+this.groupLevel,j=this.cachedCanvases.getCanvas(R,d,u);this.suspendedCtx=this.ctx,this.ctx=j.context;const U=this.ctx;U.setTransform(...(0,t.getCurrentTransform)(this.suspendedCtx)),s(this.suspendedCtx,U),e(U,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),s(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(d){if(!this.current.activeSMask)return;d?(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])):d=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const u=this.current.activeSMask,R=this.suspendedCtx;ee(R,u,this.ctx,d),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(s(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const d=this.current;this.stateStack.push(d),this.current=d.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),s(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(d,u,R,j,U,B){this.ctx.transform(d,u,R,j,U,B),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(d,u,R){const j=this.ctx,U=this.current;let B=U.x,V=U.y,X,o;const p=(0,t.getCurrentTransform)(j),_=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,x=_?R.slice(0):null;for(let I=0,q=0,re=d.length;I<re;I++)switch(d[I]|0){case a.OPS.rectangle:B=u[q++],V=u[q++];const ue=u[q++],Z=u[q++],oe=B+ue,te=V+Z;j.moveTo(B,V),ue===0||Z===0?j.lineTo(oe,te):(j.lineTo(oe,V),j.lineTo(oe,te),j.lineTo(B,te)),_||U.updateRectMinMax(p,[B,V,oe,te]),j.closePath();break;case a.OPS.moveTo:B=u[q++],V=u[q++],j.moveTo(B,V),_||U.updatePathMinMax(p,B,V);break;case a.OPS.lineTo:B=u[q++],V=u[q++],j.lineTo(B,V),_||U.updatePathMinMax(p,B,V);break;case a.OPS.curveTo:X=B,o=V,B=u[q+4],V=u[q+5],j.bezierCurveTo(u[q],u[q+1],u[q+2],u[q+3],B,V),U.updateCurvePathMinMax(p,X,o,u[q],u[q+1],u[q+2],u[q+3],B,V,x),q+=6;break;case a.OPS.curveTo2:X=B,o=V,j.bezierCurveTo(B,V,u[q],u[q+1],u[q+2],u[q+3]),U.updateCurvePathMinMax(p,X,o,B,V,u[q],u[q+1],u[q+2],u[q+3],x),B=u[q+2],V=u[q+3],q+=4;break;case a.OPS.curveTo3:X=B,o=V,B=u[q+2],V=u[q+3],j.bezierCurveTo(u[q],u[q+1],B,V,B,V),U.updateCurvePathMinMax(p,X,o,u[q],u[q+1],B,V,B,V,x),q+=4;break;case a.OPS.closePath:j.closePath();break}_&&U.updateScalingPathMinMax(p,x),U.setCurrentPoint(B,V)}closePath(){this.ctx.closePath()}stroke(d){d=typeof d<"u"?d:!0;const u=this.ctx,R=this.current.strokeColor;u.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof R=="object"&&(R!=null&&R.getPattern)?(u.save(),u.strokeStyle=R.getPattern(u,this,(0,t.getCurrentTransformInverse)(u),F.PathType.STROKE),this.rescaleAndStroke(!1),u.restore()):this.rescaleAndStroke(!0)),d&&this.consumePath(this.current.getClippedPathBoundingBox()),u.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(d){d=typeof d<"u"?d:!0;const u=this.ctx,R=this.current.fillColor,j=this.current.patternFill;let U=!1;j&&(u.save(),u.fillStyle=R.getPattern(u,this,(0,t.getCurrentTransformInverse)(u),F.PathType.FILL),U=!0);const B=this.current.getClippedPathBoundingBox();this.contentVisible&&B!==null&&(this.pendingEOFill?(u.fill("evenodd"),this.pendingEOFill=!1):u.fill()),U&&u.restore(),d&&this.consumePath(B)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=G}eoClip(){this.pendingClip=$}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const d=this.pendingTextPaths,u=this.ctx;if(d===void 0){u.beginPath();return}u.save(),u.beginPath();for(const R of d)u.setTransform(...R.transform),u.translate(R.x,R.y),R.addToPath(u,R.fontSize);u.restore(),u.clip(),u.beginPath(),delete this.pendingTextPaths}setCharSpacing(d){this.current.charSpacing=d}setWordSpacing(d){this.current.wordSpacing=d}setHScale(d){this.current.textHScale=d/100}setLeading(d){this.current.leading=-d}setFont(d,u){const R=this.commonObjs.get(d),j=this.current;if(!R)throw new Error(`Can't find font for ${d}`);if(j.fontMatrix=R.fontMatrix||a.FONT_IDENTITY_MATRIX,(j.fontMatrix[0]===0||j.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+d),u<0?(u=-u,j.fontDirection=-1):j.fontDirection=1,this.current.font=R,this.current.fontSize=u,R.isType3Font)return;const U=R.loadedName||"sans-serif";let B="normal";R.black?B="900":R.bold&&(B="bold");const V=R.italic?"italic":"normal",X=`"${U}", ${R.fallbackName}`;let o=u;u<A?o=A:u>f&&(o=f),this.current.fontSizeScale=u/o,this.ctx.font=`${V} ${B} ${o}px ${X}`}setTextRenderingMode(d){this.current.textRenderingMode=d}setTextRise(d){this.current.textRise=d}moveText(d,u){this.current.x=this.current.lineX+=d,this.current.y=this.current.lineY+=u}setLeadingMoveText(d,u){this.setLeading(-u),this.moveText(d,u)}setTextMatrix(d,u,R,j,U,B){this.current.textMatrix=[d,u,R,j,U,B],this.current.textMatrixScale=Math.hypot(d,u),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(d,u,R,j){const U=this.ctx,B=this.current,V=B.font,X=B.textRenderingMode,o=B.fontSize/B.fontSizeScale,p=X&a.TextRenderingMode.FILL_STROKE_MASK,_=!!(X&a.TextRenderingMode.ADD_TO_PATH_FLAG),x=B.patternFill&&!V.missingFile;let I;(V.disableFontFace||_||x)&&(I=V.getPathGenerator(this.commonObjs,d)),V.disableFontFace||x?(U.save(),U.translate(u,R),U.beginPath(),I(U,o),j&&U.setTransform(...j),(p===a.TextRenderingMode.FILL||p===a.TextRenderingMode.FILL_STROKE)&&U.fill(),(p===a.TextRenderingMode.STROKE||p===a.TextRenderingMode.FILL_STROKE)&&U.stroke(),U.restore()):((p===a.TextRenderingMode.FILL||p===a.TextRenderingMode.FILL_STROKE)&&U.fillText(d,u,R),(p===a.TextRenderingMode.STROKE||p===a.TextRenderingMode.FILL_STROKE)&&U.strokeText(d,u,R)),_&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,t.getCurrentTransform)(U),x:u,y:R,fontSize:o,addToPath:I})}get isFontSubpixelAAEnabled(){const{context:d}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);d.scale(1.5,1),d.fillText("I",0,10);const u=d.getImageData(0,0,10,10).data;let R=!1;for(let j=3;j<u.length;j+=4)if(u[j]>0&&u[j]<255){R=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",R)}showText(d){const u=this.current,R=u.font;if(R.isType3Font)return this.showType3Text(d);const j=u.fontSize;if(j===0)return;const U=this.ctx,B=u.fontSizeScale,V=u.charSpacing,X=u.wordSpacing,o=u.fontDirection,p=u.textHScale*o,_=d.length,x=R.vertical,I=x?1:-1,q=R.defaultVMetrics,re=j*u.fontMatrix[0],ue=u.textRenderingMode===a.TextRenderingMode.FILL&&!R.disableFontFace&&!u.patternFill;U.save(),U.transform(...u.textMatrix),U.translate(u.x,u.y+u.textRise),o>0?U.scale(p,-1):U.scale(p,1);let Z;if(u.patternFill){U.save();const N=u.fillColor.getPattern(U,this,(0,t.getCurrentTransformInverse)(U),F.PathType.FILL);Z=(0,t.getCurrentTransform)(U),U.restore(),U.fillStyle=N}let oe=u.lineWidth;const te=u.textMatrixScale;if(te===0||oe===0){const N=u.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(N===a.TextRenderingMode.STROKE||N===a.TextRenderingMode.FILL_STROKE)&&(oe=this.getSinglePixelWidth())}else oe/=te;B!==1&&(U.scale(B,B),oe/=B),U.lineWidth=oe;let le=0,fe;for(fe=0;fe<_;++fe){const N=d[fe];if(typeof N=="number"){le+=I*N*j/1e3;continue}let de=!1;const be=(N.isSpace?X:0)+V,Ae=N.fontChar,Ee=N.accent;let Ce,Fe,ke=N.width;if(x){const Pe=N.vmetric||q,Oe=-(N.vmetric?Pe[1]:ke*.5)*re,Ze=Pe[2]*re;ke=Pe?-Pe[0]:ke,Ce=Oe/B,Fe=(le+Ze)/B}else Ce=le/B,Fe=0;if(R.remeasure&&ke>0){const Pe=U.measureText(Ae).width*1e3/j*B;if(ke<Pe&&this.isFontSubpixelAAEnabled){const Oe=ke/Pe;de=!0,U.save(),U.scale(Oe,1),Ce/=Oe}else ke!==Pe&&(Ce+=(ke-Pe)/2e3*j/B)}if(this.contentVisible&&(N.isInFont||R.missingFile)){if(ue&&!Ee)U.fillText(Ae,Ce,Fe);else if(this.paintChar(Ae,Ce,Fe,Z),Ee){const Pe=Ce+j*Ee.offset.x/B,Oe=Fe-j*Ee.offset.y/B;this.paintChar(Ee.fontChar,Pe,Oe,Z)}}let ze;x?ze=ke*re-be*o:ze=ke*re+be*o,le+=ze,de&&U.restore()}x?u.y-=le:u.x+=le*p,U.restore(),this.compose()}showType3Text(d){const u=this.ctx,R=this.current,j=R.font,U=R.fontSize,B=R.fontDirection,V=j.vertical?1:-1,X=R.charSpacing,o=R.wordSpacing,p=R.textHScale*B,_=R.fontMatrix||a.FONT_IDENTITY_MATRIX,x=d.length,I=R.textRenderingMode===a.TextRenderingMode.INVISIBLE;let q,re,ue,Z;if(!(I||U===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,u.save(),u.transform(...R.textMatrix),u.translate(R.x,R.y),u.scale(p,B),q=0;q<x;++q){if(re=d[q],typeof re=="number"){Z=V*re*U/1e3,this.ctx.translate(Z,0),R.x+=Z*p;continue}const oe=(re.isSpace?o:0)+X,te=j.charProcOperatorList[re.operatorListId];if(!te){(0,a.warn)(`Type3 character "${re.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=re,this.save(),u.scale(U,U),u.transform(..._),this.executeOperatorList(te),this.restore()),ue=a.Util.applyTransform([re.width,0],_)[0]*U+oe,u.translate(ue,0),R.x+=ue*p}u.restore(),this.processingType3=null}}setCharWidth(d,u){}setCharWidthAndBounds(d,u,R,j,U,B){this.ctx.rect(R,j,U-R,B-j),this.ctx.clip(),this.endPath()}getColorN_Pattern(d){let u;if(d[0]==="TilingPattern"){const R=d[1],j=this.baseTransform||(0,t.getCurrentTransform)(this.ctx),U={createCanvasGraphics:B=>new _e(B,this.commonObjs,this.objs,this.canvasFactory)};u=new F.TilingPattern(d,R,this.ctx,U,j)}else u=this._getPattern(d[1],d[2]);return u}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(d,u,R){var U;const j=((U=this.selectColor)==null?void 0:U.call(this,d,u,R))||a.Util.makeHexColor(d,u,R);this.ctx.strokeStyle=j,this.current.strokeColor=j}setFillRGBColor(d,u,R){var U;const j=((U=this.selectColor)==null?void 0:U.call(this,d,u,R))||a.Util.makeHexColor(d,u,R);this.ctx.fillStyle=j,this.current.fillColor=j,this.current.patternFill=!1}_getPattern(d,u=null){let R;return this.cachedPatterns.has(d)?R=this.cachedPatterns.get(d):(R=(0,F.getShadingPattern)(this.objs.get(d)),this.cachedPatterns.set(d,R)),u&&(R.matrix=u),R}shadingFill(d){if(!this.contentVisible)return;const u=this.ctx;this.save();const R=this._getPattern(d);u.fillStyle=R.getPattern(u,this,(0,t.getCurrentTransformInverse)(u),F.PathType.SHADING);const j=(0,t.getCurrentTransformInverse)(u);if(j){const U=u.canvas,B=U.width,V=U.height,X=a.Util.applyTransform([0,0],j),o=a.Util.applyTransform([0,V],j),p=a.Util.applyTransform([B,0],j),_=a.Util.applyTransform([B,V],j),x=Math.min(X[0],o[0],p[0],_[0]),I=Math.min(X[1],o[1],p[1],_[1]),q=Math.max(X[0],o[0],p[0],_[0]),re=Math.max(X[1],o[1],p[1],_[1]);this.ctx.fillRect(x,I,q-x,re-I)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(d,u){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(d)&&d.length===6&&this.transform(...d),this.baseTransform=(0,t.getCurrentTransform)(this.ctx),u)){const R=u[2]-u[0],j=u[3]-u[1];this.ctx.rect(u[0],u[1],R,j),this.current.updateRectMinMax((0,t.getCurrentTransform)(this.ctx),u),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(d){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const u=this.ctx;d.isolated||(0,a.info)("TODO: Support non-isolated groups."),d.knockout&&(0,a.warn)("Knockout groups not supported.");const R=(0,t.getCurrentTransform)(u);if(d.matrix&&u.transform(...d.matrix),!d.bbox)throw new Error("Bounding box is required.");let j=a.Util.getAxialAlignedBoundingBox(d.bbox,(0,t.getCurrentTransform)(u));const U=[0,0,u.canvas.width,u.canvas.height];j=a.Util.intersect(j,U)||[0,0,0,0];const B=Math.floor(j[0]),V=Math.floor(j[1]);let X=Math.max(Math.ceil(j[2])-B,1),o=Math.max(Math.ceil(j[3])-V,1),p=1,_=1;X>w&&(p=X/w,X=w),o>w&&(_=o/w,o=w),this.current.startNewPathAndClipBox([0,0,X,o]);let x="groupAt"+this.groupLevel;d.smask&&(x+="_smask_"+this.smaskCounter++%2);const I=this.cachedCanvases.getCanvas(x,X,o),q=I.context;q.scale(1/p,1/_),q.translate(-B,-V),q.transform(...R),d.smask?this.smaskStack.push({canvas:I.canvas,context:q,offsetX:B,offsetY:V,scaleX:p,scaleY:_,subtype:d.smask.subtype,backdrop:d.smask.backdrop,transferMap:d.smask.transferMap||null,startTransformInverse:null}):(u.setTransform(1,0,0,1,0,0),u.translate(B,V),u.scale(p,_),u.save()),s(u,q),this.ctx=q,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(u),this.groupLevel++}endGroup(d){if(!this.contentVisible)return;this.groupLevel--;const u=this.ctx,R=this.groupStack.pop();if(this.ctx=R,this.ctx.imageSmoothingEnabled=!1,d.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const j=(0,t.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...j);const U=a.Util.getAxialAlignedBoundingBox([0,0,u.canvas.width,u.canvas.height],j);this.ctx.drawImage(u.canvas,0,0),this.ctx.restore(),this.compose(U)}}beginAnnotation(d,u,R,j,U){if(he(this,ne,ht).call(this),g(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(u)&&u.length===4){const B=u[2]-u[0],V=u[3]-u[1];if(U&&this.annotationCanvasMap){R=R.slice(),R[4]-=u[0],R[5]-=u[1],u=u.slice(),u[0]=u[1]=0,u[2]=B,u[3]=V;const[X,o]=a.Util.singularValueDecompose2dScale((0,t.getCurrentTransform)(this.ctx)),{viewportScale:p}=this,_=Math.ceil(B*this.outputScaleX*p),x=Math.ceil(V*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(_,x);const{canvas:I,context:q}=this.annotationCanvas;this.annotationCanvasMap.set(d,I),this.annotationCanvas.savedCtx=this.ctx,this.ctx=q,this.ctx.setTransform(X,0,0,-o,0,V*o),g(this.ctx,this.foregroundColor)}else g(this.ctx,this.foregroundColor),this.ctx.rect(u[0],u[1],B,V),this.ctx.clip(),this.endPath()}this.current=new v(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...R),this.transform(...j)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(d){if(!this.contentVisible)return;const u=d.count;d=this.getObject(d.data,d),d.count=u;const R=this.ctx,j=this.processingType3;if(j&&(j.compiled===void 0&&(j.compiled=b(d)),j.compiled)){j.compiled(R);return}const U=this._createMaskCanvas(d),B=U.canvas;R.save(),R.setTransform(1,0,0,1,0,0),R.drawImage(B,U.offsetX,U.offsetY),R.restore(),this.compose()}paintImageMaskXObjectRepeat(d,u,R=0,j=0,U,B){if(!this.contentVisible)return;d=this.getObject(d.data,d);const V=this.ctx;V.save();const X=(0,t.getCurrentTransform)(V);V.transform(u,R,j,U,0,0);const o=this._createMaskCanvas(d);V.setTransform(1,0,0,1,0,0);for(let p=0,_=B.length;p<_;p+=2){const x=a.Util.transform(X,[u,R,j,U,B[p],B[p+1]]),[I,q]=a.Util.applyTransform([0,0],x);V.drawImage(o.canvas,I,q)}V.restore(),this.compose()}paintImageMaskXObjectGroup(d){if(!this.contentVisible)return;const u=this.ctx,R=this.current.fillColor,j=this.current.patternFill;for(const U of d){const{data:B,width:V,height:X,transform:o}=U,p=this.cachedCanvases.getCanvas("maskCanvas",V,X),_=p.context;_.save();const x=this.getObject(B,U);r(_,x),_.globalCompositeOperation="source-in",_.fillStyle=j?R.getPattern(_,this,(0,t.getCurrentTransformInverse)(u),F.PathType.FILL):R,_.fillRect(0,0,V,X),_.restore(),u.save(),u.transform(...o),u.scale(1,-1),l(u,p.canvas,0,0,V,X,0,-1,1,1),u.restore()}this.compose()}paintImageXObject(d){if(!this.contentVisible)return;const u=this.getObject(d);if(!u){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(u)}paintImageXObjectRepeat(d,u,R,j){if(!this.contentVisible)return;const U=this.getObject(d);if(!U){(0,a.warn)("Dependent image isn't ready yet");return}const B=U.width,V=U.height,X=[];for(let o=0,p=j.length;o<p;o+=2)X.push({transform:[u,0,0,R,j[o],j[o+1]],x:0,y:0,w:B,h:V});this.paintInlineImageXObjectGroup(U,X)}paintInlineImageXObject(d){if(!this.contentVisible)return;const u=d.width,R=d.height,j=this.ctx;this.save(),j.scale(1/u,-1/R);let U;if(typeof HTMLElement=="function"&&d instanceof HTMLElement||!d.data)U=d;else{const o=this.cachedCanvases.getCanvas("inlineImage",u,R),p=o.context;c(p,d,this.current.transferMaps),U=o.canvas}const B=this._scaleImage(U,(0,t.getCurrentTransformInverse)(j));j.imageSmoothingEnabled=ie((0,t.getCurrentTransform)(j),d.interpolate);const[V,X]=l(j,B.img,0,0,B.paintWidth,B.paintHeight,0,-R,u,R);if(this.imageLayer){const[o,p]=a.Util.applyTransform([0,-R],(0,t.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:d,left:o,top:p,width:V,height:X})}this.compose(),this.restore()}paintInlineImageXObjectGroup(d,u){if(!this.contentVisible)return;const R=this.ctx,j=d.width,U=d.height,B=this.cachedCanvases.getCanvas("inlineImage",j,U),V=B.context;c(V,d,this.current.transferMaps);for(const X of u){if(R.save(),R.transform(...X.transform),R.scale(1,-1),l(R,B.canvas,X.x,X.y,X.w,X.h,0,-1,1,1),this.imageLayer){const[o,p]=a.Util.applyTransform([X.x,X.y],(0,t.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:d,left:o,top:p,width:j,height:U})}R.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(d){}markPointProps(d,u){}beginMarkedContent(d){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(d,u){d==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(u)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(d){const u=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(d);const R=this.ctx;this.pendingClip&&(u||(this.pendingClip===$?R.clip("evenodd"):R.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),R.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const d=(0,t.getCurrentTransform)(this.ctx);if(d[1]===0&&d[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(d[0]),Math.abs(d[3]));else{const u=Math.abs(d[0]*d[3]-d[2]*d[1]),R=Math.hypot(d[0],d[2]),j=Math.hypot(d[1],d[3]);this._cachedGetSinglePixelWidth=Math.max(R,j)/u}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:d}=this.current,u=(0,t.getCurrentTransform)(this.ctx);let R,j;if(u[1]===0&&u[2]===0){const U=Math.abs(u[0]),B=Math.abs(u[3]);if(d===0)R=1/U,j=1/B;else{const V=U*d,X=B*d;R=V<1?1/V:1,j=X<1?1/X:1}}else{const U=Math.abs(u[0]*u[3]-u[2]*u[1]),B=Math.hypot(u[0],u[1]),V=Math.hypot(u[2],u[3]);if(d===0)R=V/U,j=B/U;else{const X=d*U;R=V>X?V/X:1,j=B>X?B/X:1}}this._cachedScaleForStroking=[R,j]}return this._cachedScaleForStroking}rescaleAndStroke(d){const{ctx:u}=this,{lineWidth:R}=this.current,[j,U]=this.getScaleForStroking();if(u.lineWidth=R||1,j===1&&U===1){u.stroke();return}let B,V,X;d&&(B=(0,t.getCurrentTransform)(u),V=u.getLineDash().slice(),X=u.lineDashOffset),u.scale(j,U);const o=Math.max(j,U);u.setLineDash(u.getLineDash().map(p=>p/o)),u.lineDashOffset/=o,u.stroke(),d&&(u.setTransform(...B),u.setLineDash(V),u.lineDashOffset=X)}isContentVisible(){for(let d=this.markedContentStack.length-1;d>=0;d--)if(!this.markedContentStack[d].visible)return!1;return!0}};ne=new WeakSet,ht=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let Y=_e;n.CanvasGraphics=Y;for(const W in a.OPS)Y.prototype[W]!==void 0&&(Y.prototype[a.OPS[W]]=Y.prototype[W])},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=h;var t=y(1),a=y(8),F=y(3);const D={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=D;function T(l,b){if(!b||F.isNodeJS)return;const v=b[2]-b[0],c=b[3]-b[1],r=new Path2D;r.rect(b[0],b[1],v,c),l.clip(r)}class A{constructor(){this.constructor===A&&(0,t.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,t.unreachable)("Abstract method `getPattern` called.")}}class f extends A{constructor(b){super(),this._type=b[1],this._bbox=b[2],this._colorStops=b[3],this._p0=b[4],this._p1=b[5],this._r0=b[6],this._r1=b[7],this.matrix=null}_createGradient(b){let v;this._type==="axial"?v=b.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(v=b.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const c of this._colorStops)v.addColorStop(c[0],c[1]);return v}getPattern(b,v,c,r){let s;if(r===D.STROKE||r===D.FILL){const g=v.current.getClippedPathBoundingBox(r,(0,a.getCurrentTransform)(b))||[0,0,0,0],k=Math.ceil(g[2]-g[0])||1,E=Math.ceil(g[3]-g[1])||1,m=v.cachedCanvases.getCanvas("pattern",k,E,!0),M=m.context;M.clearRect(0,0,M.canvas.width,M.canvas.height),M.beginPath(),M.rect(0,0,M.canvas.width,M.canvas.height),M.translate(-g[0],-g[1]),c=t.Util.transform(c,[1,0,0,1,g[0],g[1]]),M.transform(...v.baseTransform),this.matrix&&M.transform(...this.matrix),T(M,this._bbox),M.fillStyle=this._createGradient(M),M.fill(),s=b.createPattern(m.canvas,"no-repeat");const ee=new DOMMatrix(c);try{s.setTransform(ee)}catch(ie){(0,t.warn)(`RadialAxialShadingPattern.getPattern: "${ie==null?void 0:ie.message}".`)}}else T(b,this._bbox),s=this._createGradient(b);return s}}function w(l,b,v,c,r,s,g,k){const E=b.coords,m=b.colors,M=l.data,ee=l.width*4;let ie;E[v+1]>E[c+1]&&(ie=v,v=c,c=ie,ie=s,s=g,g=ie),E[c+1]>E[r+1]&&(ie=c,c=r,r=ie,ie=g,g=k,k=ie),E[v+1]>E[c+1]&&(ie=v,v=c,c=ie,ie=s,s=g,g=ie);const Q=(E[v]+b.offsetX)*b.scaleX,K=(E[v+1]+b.offsetY)*b.scaleY,G=(E[c]+b.offsetX)*b.scaleX,$=(E[c+1]+b.offsetY)*b.scaleY,Y=(E[r]+b.offsetX)*b.scaleX,ne=(E[r+1]+b.offsetY)*b.scaleY;if(K>=ne)return;const ce=m[s],_e=m[s+1],W=m[s+2],d=m[g],u=m[g+1],R=m[g+2],j=m[k],U=m[k+1],B=m[k+2],V=Math.round(K),X=Math.round(ne);let o,p,_,x,I,q,re,ue;for(let Z=V;Z<=X;Z++){if(Z<$){let N;Z<K?N=0:N=(K-Z)/(K-$),o=Q-(Q-G)*N,p=ce-(ce-d)*N,_=_e-(_e-u)*N,x=W-(W-R)*N}else{let N;Z>ne?N=1:$===ne?N=0:N=($-Z)/($-ne),o=G-(G-Y)*N,p=d-(d-j)*N,_=u-(u-U)*N,x=R-(R-B)*N}let oe;Z<K?oe=0:Z>ne?oe=1:oe=(K-Z)/(K-ne),I=Q-(Q-Y)*oe,q=ce-(ce-j)*oe,re=_e-(_e-U)*oe,ue=W-(W-B)*oe;const te=Math.round(Math.min(o,I)),le=Math.round(Math.max(o,I));let fe=ee*Z+te*4;for(let N=te;N<=le;N++)oe=(o-N)/(o-I),oe<0?oe=0:oe>1&&(oe=1),M[fe++]=p-(p-q)*oe|0,M[fe++]=_-(_-re)*oe|0,M[fe++]=x-(x-ue)*oe|0,M[fe++]=255}}function L(l,b,v){const c=b.coords,r=b.colors;let s,g;switch(b.type){case"lattice":const k=b.verticesPerRow,E=Math.floor(c.length/k)-1,m=k-1;for(s=0;s<E;s++){let M=s*k;for(let ee=0;ee<m;ee++,M++)w(l,v,c[M],c[M+1],c[M+k],r[M],r[M+1],r[M+k]),w(l,v,c[M+k+1],c[M+1],c[M+k],r[M+k+1],r[M+1],r[M+k])}break;case"triangles":for(s=0,g=c.length;s<g;s+=3)w(l,v,c[s],c[s+1],c[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class C extends A{constructor(b){super(),this._coords=b[2],this._colors=b[3],this._figures=b[4],this._bounds=b[5],this._bbox=b[7],this._background=b[8],this.matrix=null}_createMeshCanvas(b,v,c){const k=Math.floor(this._bounds[0]),E=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-k,M=Math.ceil(this._bounds[3])-E,ee=Math.min(Math.ceil(Math.abs(m*b[0]*1.1)),3e3),ie=Math.min(Math.ceil(Math.abs(M*b[1]*1.1)),3e3),Q=m/ee,K=M/ie,G={coords:this._coords,colors:this._colors,offsetX:-k,offsetY:-E,scaleX:1/Q,scaleY:1/K},$=ee+2*2,Y=ie+2*2,ne=c.getCanvas("mesh",$,Y,!1),ce=ne.context,_e=ce.createImageData(ee,ie);if(v){const d=_e.data;for(let u=0,R=d.length;u<R;u+=4)d[u]=v[0],d[u+1]=v[1],d[u+2]=v[2],d[u+3]=255}for(const d of this._figures)L(_e,d,G);return ce.putImageData(_e,2,2),{canvas:ne.canvas,offsetX:k-2*Q,offsetY:E-2*K,scaleX:Q,scaleY:K}}getPattern(b,v,c,r){T(b,this._bbox);let s;if(r===D.SHADING)s=t.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(b));else if(s=t.Util.singularValueDecompose2dScale(v.baseTransform),this.matrix){const k=t.Util.singularValueDecompose2dScale(this.matrix);s=[s[0]*k[0],s[1]*k[1]]}const g=this._createMeshCanvas(s,r===D.SHADING?null:this._background,v.cachedCanvases);return r!==D.SHADING&&(b.setTransform(...v.baseTransform),this.matrix&&b.transform(...this.matrix)),b.translate(g.offsetX,g.offsetY),b.scale(g.scaleX,g.scaleY),b.createPattern(g.canvas,"no-repeat")}}class S extends A{getPattern(){return"hotpink"}}function h(l){switch(l[0]){case"RadialAxial":return new f(l);case"Mesh":return new C(l);case"Dummy":return new S}throw new Error(`Unknown IR type: ${l[0]}`)}const e={COLORED:1,UNCOLORED:2};class i{static get MAX_PATTERN_SIZE(){return(0,t.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(b,v,c,r,s){this.operatorList=b[2],this.matrix=b[3]||[1,0,0,1,0,0],this.bbox=b[4],this.xstep=b[5],this.ystep=b[6],this.paintType=b[7],this.tilingType=b[8],this.color=v,this.ctx=c,this.canvasGraphicsFactory=r,this.baseTransform=s}createPatternCanvas(b){const v=this.operatorList,c=this.bbox,r=this.xstep,s=this.ystep,g=this.paintType,k=this.tilingType,E=this.color,m=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+k);const M=c[0],ee=c[1],ie=c[2],Q=c[3],K=t.Util.singularValueDecompose2dScale(this.matrix),G=t.Util.singularValueDecompose2dScale(this.baseTransform),$=[K[0]*G[0],K[1]*G[1]],Y=this.getSizeAndScale(r,this.ctx.canvas.width,$[0]),ne=this.getSizeAndScale(s,this.ctx.canvas.height,$[1]),ce=b.cachedCanvases.getCanvas("pattern",Y.size,ne.size,!0),_e=ce.context,W=m.createCanvasGraphics(_e);W.groupLevel=b.groupLevel,this.setFillAndStrokeStyleToContext(W,g,E);let d=M,u=ee,R=ie,j=Q;return M<0&&(d=0,R+=Math.abs(M)),ee<0&&(u=0,j+=Math.abs(ee)),_e.translate(-(Y.scale*d),-(ne.scale*u)),W.transform(Y.scale,0,0,ne.scale,0,0),_e.save(),this.clipBbox(W,d,u,R,j),W.baseTransform=(0,a.getCurrentTransform)(W.ctx),W.executeOperatorList(v),W.endDrawing(),{canvas:ce.canvas,scaleX:Y.scale,scaleY:ne.scale,offsetX:d,offsetY:u}}getSizeAndScale(b,v,c){b=Math.abs(b);const r=Math.max(i.MAX_PATTERN_SIZE,v);let s=Math.ceil(b*c);return s>=r?s=r:c=s/b,{scale:c,size:s}}clipBbox(b,v,c,r,s){const g=r-v,k=s-c;b.ctx.rect(v,c,g,k),b.current.updateRectMinMax((0,a.getCurrentTransform)(b.ctx),[v,c,r,s]),b.clip(),b.endPath()}setFillAndStrokeStyleToContext(b,v,c){const r=b.ctx,s=b.current;switch(v){case e.COLORED:const g=this.ctx;r.fillStyle=g.fillStyle,r.strokeStyle=g.strokeStyle,s.fillColor=g.fillStyle,s.strokeColor=g.strokeStyle;break;case e.UNCOLORED:const k=t.Util.makeHexColor(c[0],c[1],c[2]);r.fillStyle=k,r.strokeStyle=k,s.fillColor=k,s.strokeColor=k;break;default:throw new t.FormatError(`Unsupported paint type: ${v}`)}}getPattern(b,v,c,r){let s=c;r!==D.SHADING&&(s=t.Util.transform(s,v.baseTransform),this.matrix&&(s=t.Util.transform(s,this.matrix)));const g=this.createPatternCanvas(v);let k=new DOMMatrix(s);k=k.translate(g.offsetX,g.offsetY),k=k.scale(1/g.scaleX,1/g.scaleY);const E=b.createPattern(g.canvas,"repeat");try{E.setTransform(k)}catch(m){(0,t.warn)(`TilingPattern.getPattern: "${m==null?void 0:m.message}".`)}return E}}n.TilingPattern=i},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.applyMaskImageData=a;var t=y(1);function a({src:F,srcPos:D=0,dest:T,destPos:A=0,width:f,height:w,inverseDecode:L=!1}){const C=t.FeatureTest.isLittleEndian?4278190080:255,[S,h]=L?[0,C]:[C,0],e=f>>3,i=f&7,l=F.length;T=new Uint32Array(T.buffer);for(let b=0;b<w;b++){for(const c=D+e;D<c;D++){const r=D<l?F[D]:255;T[A++]=r&128?h:S,T[A++]=r&64?h:S,T[A++]=r&32?h:S,T[A++]=r&16?h:S,T[A++]=r&8?h:S,T[A++]=r&4?h:S,T[A++]=r&2?h:S,T[A++]=r&1?h:S}if(i===0)continue;const v=D<l?F[D++]:255;for(let c=0;c<i;c++)T[A++]=v&1<<7-c?h:S}return{srcPos:D,destPos:A}}},(P,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const y=Object.create(null);n.GlobalWorkerOptions=y,y.workerPort=y.workerPort===void 0?null:y.workerPort,y.workerSrc=y.workerSrc===void 0?"":y.workerSrc},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var t=y(1);const a={UNKNOWN:0,DATA:1,ERROR:2},F={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function D(A){switch(A instanceof Error||typeof A=="object"&&A!==null||(0,t.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),A.name){case"AbortException":return new t.AbortException(A.message);case"MissingPDFException":return new t.MissingPDFException(A.message);case"PasswordException":return new t.PasswordException(A.message,A.code);case"UnexpectedResponseException":return new t.UnexpectedResponseException(A.message,A.status);case"UnknownErrorException":return new t.UnknownErrorException(A.message,A.details);default:return new t.UnknownErrorException(A.message,A.toString())}}class T{constructor(f,w,L){this.sourceName=f,this.targetName=w,this.comObj=L,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=C=>{const S=C.data;if(S.targetName!==this.sourceName)return;if(S.stream){this._processStreamMessage(S);return}if(S.callback){const e=S.callbackId,i=this.callbackCapabilities[e];if(!i)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],S.callback===a.DATA)i.resolve(S.data);else if(S.callback===a.ERROR)i.reject(D(S.reason));else throw new Error("Unexpected callback case");return}const h=this.actionHandler[S.action];if(!h)throw new Error(`Unknown action from worker: ${S.action}`);if(S.callbackId){const e=this.sourceName,i=S.sourceName;new Promise(function(l){l(h(S.data))}).then(function(l){L.postMessage({sourceName:e,targetName:i,callback:a.DATA,callbackId:S.callbackId,data:l})},function(l){L.postMessage({sourceName:e,targetName:i,callback:a.ERROR,callbackId:S.callbackId,reason:D(l)})});return}if(S.streamId){this._createStreamSink(S);return}h(S.data)},L.addEventListener("message",this._onComObjOnMessage)}on(f,w){const L=this.actionHandler;if(L[f])throw new Error(`There is already an actionName called "${f}"`);L[f]=w}send(f,w,L){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:w},L)}sendWithPromise(f,w,L){const C=this.callbackId++,S=(0,t.createPromiseCapability)();this.callbackCapabilities[C]=S;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:C,data:w},L)}catch(h){S.reject(h)}return S.promise}sendWithStream(f,w,L,C){const S=this.streamId++,h=this.sourceName,e=this.targetName,i=this.comObj;return new ReadableStream({start:l=>{const b=(0,t.createPromiseCapability)();return this.streamControllers[S]={controller:l,startCall:b,pullCall:null,cancelCall:null,isClosed:!1},i.postMessage({sourceName:h,targetName:e,action:f,streamId:S,data:w,desiredSize:l.desiredSize},C),b.promise},pull:l=>{const b=(0,t.createPromiseCapability)();return this.streamControllers[S].pullCall=b,i.postMessage({sourceName:h,targetName:e,stream:F.PULL,streamId:S,desiredSize:l.desiredSize}),b.promise},cancel:l=>{(0,t.assert)(l instanceof Error,"cancel must have a valid reason");const b=(0,t.createPromiseCapability)();return this.streamControllers[S].cancelCall=b,this.streamControllers[S].isClosed=!0,i.postMessage({sourceName:h,targetName:e,stream:F.CANCEL,streamId:S,reason:D(l)}),b.promise}},L)}_createStreamSink(f){const w=f.streamId,L=this.sourceName,C=f.sourceName,S=this.comObj,h=this,e=this.actionHandler[f.action],i={enqueue(l,b=1,v){if(this.isCancelled)return;const c=this.desiredSize;this.desiredSize-=b,c>0&&this.desiredSize<=0&&(this.sinkCapability=(0,t.createPromiseCapability)(),this.ready=this.sinkCapability.promise),S.postMessage({sourceName:L,targetName:C,stream:F.ENQUEUE,streamId:w,chunk:l},v)},close(){this.isCancelled||(this.isCancelled=!0,S.postMessage({sourceName:L,targetName:C,stream:F.CLOSE,streamId:w}),delete h.streamSinks[w])},error(l){(0,t.assert)(l instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,S.postMessage({sourceName:L,targetName:C,stream:F.ERROR,streamId:w,reason:D(l)}))},sinkCapability:(0,t.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};i.sinkCapability.resolve(),i.ready=i.sinkCapability.promise,this.streamSinks[w]=i,new Promise(function(l){l(e(f.data,i))}).then(function(){S.postMessage({sourceName:L,targetName:C,stream:F.START_COMPLETE,streamId:w,success:!0})},function(l){S.postMessage({sourceName:L,targetName:C,stream:F.START_COMPLETE,streamId:w,reason:D(l)})})}_processStreamMessage(f){const w=f.streamId,L=this.sourceName,C=f.sourceName,S=this.comObj,h=this.streamControllers[w],e=this.streamSinks[w];switch(f.stream){case F.START_COMPLETE:f.success?h.startCall.resolve():h.startCall.reject(D(f.reason));break;case F.PULL_COMPLETE:f.success?h.pullCall.resolve():h.pullCall.reject(D(f.reason));break;case F.PULL:if(!e){S.postMessage({sourceName:L,targetName:C,stream:F.PULL_COMPLETE,streamId:w,success:!0});break}e.desiredSize<=0&&f.desiredSize>0&&e.sinkCapability.resolve(),e.desiredSize=f.desiredSize,new Promise(function(i){i(e.onPull&&e.onPull())}).then(function(){S.postMessage({sourceName:L,targetName:C,stream:F.PULL_COMPLETE,streamId:w,success:!0})},function(i){S.postMessage({sourceName:L,targetName:C,stream:F.PULL_COMPLETE,streamId:w,reason:D(i)})});break;case F.ENQUEUE:if((0,t.assert)(h,"enqueue should have stream controller"),h.isClosed)break;h.controller.enqueue(f.chunk);break;case F.CLOSE:if((0,t.assert)(h,"close should have stream controller"),h.isClosed)break;h.isClosed=!0,h.controller.close(),this._deleteStreamController(h,w);break;case F.ERROR:(0,t.assert)(h,"error should have stream controller"),h.controller.error(D(f.reason)),this._deleteStreamController(h,w);break;case F.CANCEL_COMPLETE:f.success?h.cancelCall.resolve():h.cancelCall.reject(D(f.reason)),this._deleteStreamController(h,w);break;case F.CANCEL:if(!e)break;new Promise(function(i){i(e.onCancel&&e.onCancel(D(f.reason)))}).then(function(){S.postMessage({sourceName:L,targetName:C,stream:F.CANCEL_COMPLETE,streamId:w,success:!0})},function(i){S.postMessage({sourceName:L,targetName:C,stream:F.CANCEL_COMPLETE,streamId:w,reason:D(i)})}),e.sinkCapability.reject(D(f.reason)),e.isCancelled=!0,delete this.streamSinks[w];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,w){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[w]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=T},(P,n,y)=>{var F,D;Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var t=y(1);class a{constructor({parsedData:A,rawData:f}){ae(this,F,void 0);ae(this,D,void 0);me(this,F,A),me(this,D,f)}getRaw(){return O(this,D)}get(A){return O(this,F).get(A)??null}getAll(){return(0,t.objectFromMap)(O(this,F))}has(A){return O(this,F).has(A)}}F=new WeakMap,D=new WeakMap,n.Metadata=a},(P,n,y)=>{var T,A,f,w,L,C,ut;Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var t=y(1);const a=Symbol("INTERNAL");class F{constructor(e,i){ae(this,T,!0);this.name=e,this.intent=i}get visible(){return O(this,T)}_setVisible(e,i){e!==a&&(0,t.unreachable)("Internal method `_setVisible` called."),me(this,T,i)}}T=new WeakMap;class D{constructor(e){ae(this,C);ae(this,A,!0);ae(this,f,new Map);ae(this,w,null);ae(this,L,null);if(this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,me(this,L,e.order);for(const i of e.groups)O(this,f).set(i.id,new F(i.name,i.intent));if(e.baseState==="OFF")for(const i of O(this,f).values())i._setVisible(a,!1);for(const i of e.on)O(this,f).get(i)._setVisible(a,!0);for(const i of e.off)O(this,f).get(i)._setVisible(a,!1);me(this,w,new Map);for(const[i,l]of O(this,f))O(this,w).set(i,l.visible)}}isVisible(e){if(O(this,f).size===0)return!0;if(!e)return(0,t.warn)("Optional content group not defined."),!0;if(e.type==="OCG")return O(this,f).has(e.id)?O(this,f).get(e.id).visible:((0,t.warn)(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return he(this,C,ut).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const i of e.ids){if(!O(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(O(this,f).get(i).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const i of e.ids){if(!O(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(!O(this,f).get(i).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const i of e.ids){if(!O(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(!O(this,f).get(i).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const i of e.ids){if(!O(this,f).has(i))return(0,t.warn)(`Optional content group not found: ${i}`),!0;if(O(this,f).get(i).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,t.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e,i=!0){if(!O(this,f).has(e)){(0,t.warn)(`Optional content group not found: ${e}`);return}O(this,f).get(e)._setVisible(a,!!i),me(this,A,null)}get hasInitialVisibility(){if(O(this,A)!==null)return O(this,A);for(const[e,i]of O(this,f)){const l=O(this,w).get(e);if(i.visible!==l)return me(this,A,!1)}return me(this,A,!0)}getOrder(){return O(this,f).size?O(this,L)?O(this,L).slice():[...O(this,f).keys()]:null}getGroups(){return O(this,f).size>0?(0,t.objectFromMap)(O(this,f)):null}getGroup(e){return O(this,f).get(e)||null}}A=new WeakMap,f=new WeakMap,w=new WeakMap,L=new WeakMap,C=new WeakSet,ut=function(e){const i=e.length;if(i<2)return!0;const l=e[0];for(let b=1;b<i;b++){const v=e[b];let c;if(Array.isArray(v))c=he(this,C,ut).call(this,v);else if(O(this,f).has(v))c=O(this,f).get(v).visible;else return(0,t.warn)(`Optional content group not found: ${v}`),!0;switch(l){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return l==="And"},n.OptionalContentConfig=D},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var t=y(1),a=y(8);class F{constructor(f,w){(0,t.assert)(w,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const L=f.initialData;if((L==null?void 0:L.length)>0){const C=new Uint8Array(L).buffer;this._queuedChunks.push(C)}this._pdfDataRangeTransport=w,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((C,S)=>{this._onReceiveData({begin:C,chunk:S})}),this._pdfDataRangeTransport.addProgressListener((C,S)=>{this._onProgress({loaded:C,total:S})}),this._pdfDataRangeTransport.addProgressiveReadListener(C=>{this._onReceiveData({chunk:C})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const w=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(w):this._queuedChunks.push(w);else{const L=this._rangeReaders.some(function(C){return C._begin!==f.begin?!1:(C._enqueue(w),!0)});(0,t.assert)(L,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){if(f.total===void 0){const w=this._rangeReaders[0];w!=null&&w.onProgress&&w.onProgress({loaded:f.loaded})}else{const w=this._fullRequestReader;w!=null&&w.onProgress&&w.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const w=this._rangeReaders.indexOf(f);w>=0&&this._rangeReaders.splice(w,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new D(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,w){if(w<=this._progressiveDataLength)return null;const L=new T(this,f,w);return this._pdfDataRangeTransport.requestDataRange(f,w),this._rangeReaders.push(L),L}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const w of this._rangeReaders.slice(0))w.cancel(f);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=F;class D{constructor(f,w,L=!1,C=null){this._stream=f,this._done=L||!1,this._filename=(0,a.isPdfFile)(C)?C:null,this._queuedChunks=w||[],this._loaded=0;for(const S of this._queuedChunks)this._loaded+=S.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class T{constructor(f,w,L){this._stream=f,this._begin=w,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const w=this._queuedChunk;return this._queuedChunk=null,{value:w,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(P,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class y{static textContent(a){const F=[],D={items:F,styles:Object.create(null)};function T(A){var L;if(!A)return;let f=null;const w=A.name;if(w==="#text")f=A.value;else if(y.shouldBuildText(w))(L=A==null?void 0:A.attributes)!=null&&L.textContent?f=A.attributes.textContent:A.value&&(f=A.value);else return;if(f!==null&&F.push({str:f}),!!A.children)for(const C of A.children)T(C)}return T(a),D}static shouldBuildText(a){return!(a==="textarea"||a==="input"||a==="option"||a==="select")}}n.XfaText=y},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var t=y(9);const a=function(A){return new Promise((f,w)=>{require$$5.readFile(A,(C,S)=>{if(C||!S){w(new Error(C));return}f(new Uint8Array(S))})})};class F extends t.BaseCanvasFactory{_createCanvas(f,w){return require$$5.createCanvas(f,w)}}n.NodeCanvasFactory=F;class D extends t.BaseCMapReaderFactory{_fetchData(f,w){return a(f).then(L=>({cMapData:L,compressionType:w}))}}n.NodeCMapReaderFactory=D;class T extends t.BaseStandardFontDataFactory{_fetchData(f){return a(f)}}n.NodeStandardFontDataFactory=T},(P,n,y)=>{var A,f,w,L,C,S,h,e,i,dt,b,Rt,c,ft,s,kt;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var t=y(7),a=y(1),F=y(23),D=y(24);const k=class k{constructor(m){ae(this,i);ae(this,b);ae(this,c);ae(this,s);ae(this,A,void 0);ae(this,f,!1);ae(this,w,this.pointerup.bind(this));ae(this,L,this.pointerdown.bind(this));ae(this,C,new Map);ae(this,S,!1);ae(this,h,!1);ae(this,e,void 0);k._initialized||(k._initialized=!0,F.FreeTextEditor.initialize(m.l10n),D.InkEditor.initialize(m.l10n),m.uiManager.registerEditorTypes([F.FreeTextEditor,D.InkEditor])),me(this,e,m.uiManager),this.annotationStorage=m.annotationStorage,this.pageIndex=m.pageIndex,this.div=m.div,me(this,A,m.accessibilityManager),O(this,e).addLayer(this)}updateToolbar(m){O(this,e).updateToolbar(m)}updateMode(m=O(this,e).getMode()){he(this,s,kt).call(this),m===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),O(this,e).unselectAll()}addInkEditorIfNeeded(m){if(!m&&O(this,e).getMode()!==a.AnnotationEditorType.INK)return;if(!m){for(const ee of O(this,C).values())if(ee.isEmpty()){ee.setInBackground();return}}he(this,c,ft).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(m){O(this,e).setEditingState(m)}addCommands(m){O(this,e).addCommands(m)}enable(){this.div.style.pointerEvents="auto";for(const m of O(this,C).values())m.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const m of O(this,C).values())m.disableEditing()}setActiveEditor(m){O(this,e).getActive()!==m&&O(this,e).setActiveEditor(m)}enableClick(){this.div.addEventListener("pointerdown",O(this,L)),this.div.addEventListener("pointerup",O(this,w))}disableClick(){this.div.removeEventListener("pointerdown",O(this,L)),this.div.removeEventListener("pointerup",O(this,w))}attach(m){O(this,C).set(m.id,m)}detach(m){var M;O(this,C).delete(m.id),(M=O(this,A))==null||M.removePointerInTextLayer(m.contentDiv)}remove(m){O(this,e).removeEditor(m),this.detach(m),this.annotationStorage.remove(m.id),m.div.style.display="none",setTimeout(()=>{m.div.style.display="",m.div.remove(),m.isAttachedToDOM=!1,document.activeElement===document.body&&O(this,e).focusMainContainer()},0),O(this,h)||this.addInkEditorIfNeeded(!1)}add(m){if(he(this,i,dt).call(this,m),O(this,e).addEditor(m),this.attach(m),!m.isAttachedToDOM){const M=m.render();this.div.append(M),m.isAttachedToDOM=!0}this.moveEditorInDOM(m),m.onceAdded(),this.addToAnnotationStorage(m)}moveEditorInDOM(m){var M;(M=O(this,A))==null||M.moveElementInDOM(this.div,m.div,m.contentDiv,!0)}addToAnnotationStorage(m){!m.isEmpty()&&!this.annotationStorage.has(m.id)&&this.annotationStorage.setValue(m.id,m)}addOrRebuild(m){m.needsToBeRebuilt()?m.rebuild():this.add(m)}addANewEditor(m){const M=()=>{this.addOrRebuild(m)},ee=()=>{m.remove()};this.addCommands({cmd:M,undo:ee,mustExec:!0})}addUndoableEditor(m){const M=()=>{this.addOrRebuild(m)},ee=()=>{m.remove()};this.addCommands({cmd:M,undo:ee,mustExec:!1})}getNextId(){return O(this,e).getId()}deserialize(m){switch(m.annotationType){case a.AnnotationEditorType.FREETEXT:return F.FreeTextEditor.deserialize(m,this);case a.AnnotationEditorType.INK:return D.InkEditor.deserialize(m,this)}return null}setSelected(m){O(this,e).setSelected(m)}toggleSelected(m){O(this,e).toggleSelected(m)}isSelected(m){return O(this,e).isSelected(m)}unselect(m){O(this,e).unselect(m)}pointerup(m){const M=t.KeyboardManager.platform.isMac;if(!(m.button!==0||m.ctrlKey&&M)&&m.target===this.div&&O(this,S)){if(me(this,S,!1),!O(this,f)){me(this,f,!0);return}he(this,c,ft).call(this,m)}}pointerdown(m){const M=t.KeyboardManager.platform.isMac;if(m.button!==0||m.ctrlKey&&M||m.target!==this.div)return;me(this,S,!0);const ee=O(this,e).getActive();me(this,f,!ee||ee.isEmpty())}drop(m){const M=m.dataTransfer.getData("text/plain"),ee=O(this,e).getEditor(M);if(!ee)return;m.preventDefault(),m.dataTransfer.dropEffect="move",he(this,i,dt).call(this,ee);const ie=this.div.getBoundingClientRect(),Q=m.clientX-ie.x,K=m.clientY-ie.y;ee.translate(Q-ee.startX,K-ee.startY),this.moveEditorInDOM(ee),ee.div.focus()}dragover(m){m.preventDefault()}destroy(){var m,M;((m=O(this,e).getActive())==null?void 0:m.parent)===this&&O(this,e).setActiveEditor(null);for(const ee of O(this,C).values())(M=O(this,A))==null||M.removePointerInTextLayer(ee.contentDiv),ee.isAttachedToDOM=!1,ee.div.remove(),ee.parent=null;this.div=null,O(this,C).clear(),O(this,e).removeLayer(this)}render(m){this.viewport=m.viewport,(0,t.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const M of O(this,e).getEditors(this.pageIndex))this.add(M);this.updateMode()}update(m){this.viewport=m.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[m,M,ee,ie]=this.viewport.viewBox,Q=ee-m,K=ie-M;return[Q,K]}get viewportBaseDimensions(){const{width:m,height:M,rotation:ee}=this.viewport;return ee%180===0?[m,M]:[M,m]}setDimensions(){const{width:m,height:M,rotation:ee}=this.viewport,ie=ee%180!==0,Q=Math.floor(m)+"px",K=Math.floor(M)+"px";this.div.style.width=ie?K:Q,this.div.style.height=ie?Q:K,this.div.setAttribute("data-main-rotation",ee)}};A=new WeakMap,f=new WeakMap,w=new WeakMap,L=new WeakMap,C=new WeakMap,S=new WeakMap,h=new WeakMap,e=new WeakMap,i=new WeakSet,dt=function(m){var M;m.parent!==this&&(this.attach(m),m.pageIndex=this.pageIndex,(M=m.parent)==null||M.detach(m),m.parent=this,m.div&&m.isAttachedToDOM&&(m.div.remove(),this.div.append(m.div)))},b=new WeakSet,Rt=function(m){switch(O(this,e).getMode()){case a.AnnotationEditorType.FREETEXT:return new F.FreeTextEditor(m);case a.AnnotationEditorType.INK:return new D.InkEditor(m)}return null},c=new WeakSet,ft=function(m){const M=this.getNextId(),ee=he(this,b,Rt).call(this,{parent:this,id:M,x:m.offsetX,y:m.offsetY});return ee&&this.add(ee),ee},s=new WeakSet,kt=function(){me(this,h,!0);for(const m of O(this,C).values())m.isEmpty()&&m.remove();me(this,h,!1)},Me(k,"_initialized",!1);let T=k;n.AnnotationEditorLayer=T},(P,n,y)=>{var T,A,f,w,L,C,S,h,Ft,i,Mt,b,Ot,c,pt;Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var t=y(1),a=y(7),F=y(6);const s=class s extends F.AnnotationEditor{constructor(E){super({...E,name:"freeTextEditor"});ae(this,h);ae(this,i);ae(this,b);ae(this,c);ae(this,T,this.editorDivBlur.bind(this));ae(this,A,this.editorDivFocus.bind(this));ae(this,f,this.editorDivKeydown.bind(this));ae(this,w,void 0);ae(this,L,"");ae(this,C,!1);ae(this,S,void 0);me(this,w,E.color||s._defaultColor||F.AnnotationEditor._defaultLineColor),me(this,S,E.fontSize||s._defaultFontSize)}static initialize(E){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(M=>[M,E.get(M)]));const m=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(m.getPropertyValue("--freetext-padding"))}static updateDefaultParams(E,m){switch(E){case t.AnnotationEditorParamsType.FREETEXT_SIZE:s._defaultFontSize=m;break;case t.AnnotationEditorParamsType.FREETEXT_COLOR:s._defaultColor=m;break}}updateParams(E,m){switch(E){case t.AnnotationEditorParamsType.FREETEXT_SIZE:he(this,h,Ft).call(this,m);break;case t.AnnotationEditorParamsType.FREETEXT_COLOR:he(this,i,Mt).call(this,m);break}}static get defaultPropertiesToUpdate(){return[[t.AnnotationEditorParamsType.FREETEXT_SIZE,s._defaultFontSize],[t.AnnotationEditorParamsType.FREETEXT_COLOR,s._defaultColor||F.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[t.AnnotationEditorParamsType.FREETEXT_SIZE,O(this,S)],[t.AnnotationEditorParamsType.FREETEXT_COLOR,O(this,w)]]}getInitialTranslation(){return[-s._internalPadding*this.parent.scaleFactor,-(s._internalPadding+O(this,S))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(t.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",O(this,f)),this.editorDiv.addEventListener("focus",O(this,A)),this.editorDiv.addEventListener("blur",O(this,T)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",O(this,f)),this.editorDiv.removeEventListener("focus",O(this,A)),this.editorDiv.removeEventListener("blur",O(this,T)),this.div.focus(),this.isEditing=!1)}focusin(E){super.focusin(E),E.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),O(this,C)||(me(this,C,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),me(this,L,he(this,b,Ot).call(this).trimEnd()),he(this,c,pt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(E){this.enableEditMode(),this.editorDiv.focus()}keydown(E){E.target===this.div&&E.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(E){s._keyboardManager.exec(this,E)}editorDivFocus(E){this.isEditing=!0}editorDivBlur(E){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let E,m;this.width&&(E=this.x,m=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),s._l10nPromise.get("editor_free_text_aria_label").then(ee=>{var ie;return(ie=this.editorDiv)==null?void 0:ie.setAttribute("aria-label",ee)}),s._l10nPromise.get("free_text_default_content").then(ee=>{var ie;return(ie=this.editorDiv)==null?void 0:ie.setAttribute("default-content",ee)}),this.editorDiv.contentEditable=!0;const{style:M}=this.editorDiv;if(M.fontSize=`calc(${O(this,S)}px * var(--scale-factor))`,M.color=O(this,w),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,a.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[ee,ie]=this.parent.viewportBaseDimensions;this.setAt(E*ee,m*ie,this.width*ee,this.height*ie);for(const Q of O(this,L).split(`
`)){const K=document.createElement("div");K.append(Q?document.createTextNode(Q):document.createElement("br")),this.editorDiv.append(K)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(E,m){const M=super.deserialize(E,m);return me(M,S,E.fontSize),me(M,w,t.Util.makeHexColor(...E.color)),me(M,L,E.value),M}serialize(){if(this.isEmpty())return null;const E=s._internalPadding*this.parent.scaleFactor,m=this.getRect(E,E),M=F.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:t.AnnotationEditorType.FREETEXT,color:M,fontSize:O(this,S),value:O(this,L),pageIndex:this.parent.pageIndex,rect:m,rotation:this.rotation}}};T=new WeakMap,A=new WeakMap,f=new WeakMap,w=new WeakMap,L=new WeakMap,C=new WeakMap,S=new WeakMap,h=new WeakSet,Ft=function(E){const m=ee=>{this.editorDiv.style.fontSize=`calc(${ee}px * var(--scale-factor))`,this.translate(0,-(ee-O(this,S))*this.parent.scaleFactor),me(this,S,ee),he(this,c,pt).call(this)},M=O(this,S);this.parent.addCommands({cmd:()=>{m(E)},undo:()=>{m(M)},mustExec:!0,type:t.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},i=new WeakSet,Mt=function(E){const m=O(this,w);this.parent.addCommands({cmd:()=>{me(this,w,E),this.editorDiv.style.color=E},undo:()=>{me(this,w,m),this.editorDiv.style.color=m},mustExec:!0,type:t.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},b=new WeakSet,Ot=function(){const E=this.editorDiv.getElementsByTagName("div");if(E.length===0)return this.editorDiv.innerText;const m=[];for(let M=0,ee=E.length;M<ee;M++){const Q=E[M].firstChild;(Q==null?void 0:Q.nodeName)==="#text"?m.push(Q.data):m.push("")}return m.join(`
`)},c=new WeakSet,pt=function(){const[E,m]=this.parent.viewportBaseDimensions,M=this.div.getBoundingClientRect();this.width=M.width/E,this.height=M.height/m},Me(s,"_freeTextDefaultContent",""),Me(s,"_l10nPromise"),Me(s,"_internalPadding",0),Me(s,"_defaultColor",null),Me(s,"_defaultFontSize",10),Me(s,"_keyboardManager",new a.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.prototype.commitOrRemove]])),Me(s,"_type","freetext");let D=s;n.FreeTextEditor=D},(P,n,y)=>{var f,w,L,C,S,h,e,i,l,b,v,c,r,s,g,Dt,E,It,M,Lt,ie,Nt,K,gt,$,jt,ne,Ut,_e,Bt,d,He,R,mt,U,tt,V,nt,o,Ye,_,yt,I,rt,re,_t,Z,Wt,te,qt,fe,Gt,de,bt,Ae,it,Ce,Ke,ke,vt;Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0,Object.defineProperty(n,"fitCurve",{enumerable:!0,get:function(){return F.fitCurve}});var t=y(1),a=y(6),F=y(25),D=y(7);const T=16,Pe=class Pe extends a.AnnotationEditor{constructor(se){super({...se,name:"inkEditor"});ae(this,g);ae(this,E);ae(this,M);ae(this,ie);ae(this,K);ae(this,$);ae(this,ne);ae(this,_e);ae(this,d);ae(this,R);ae(this,U);ae(this,V);ae(this,o);ae(this,_);ae(this,I);ae(this,Z);ae(this,te);ae(this,fe);ae(this,de);ae(this,Ae);ae(this,Ce);ae(this,ke);ae(this,f,0);ae(this,w,0);ae(this,L,0);ae(this,C,this.canvasPointermove.bind(this));ae(this,S,this.canvasPointerleave.bind(this));ae(this,h,this.canvasPointerup.bind(this));ae(this,e,this.canvasPointerdown.bind(this));ae(this,i,!1);ae(this,l,!1);ae(this,b,null);ae(this,v,null);ae(this,c,0);ae(this,r,0);ae(this,s,null);this.color=se.color||null,this.thickness=se.thickness||null,this.opacity=se.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(se){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(pe=>[pe,se.get(pe)]))}static updateDefaultParams(se,pe){switch(se){case t.AnnotationEditorParamsType.INK_THICKNESS:Pe._defaultThickness=pe;break;case t.AnnotationEditorParamsType.INK_COLOR:Pe._defaultColor=pe;break;case t.AnnotationEditorParamsType.INK_OPACITY:Pe._defaultOpacity=pe/100;break}}updateParams(se,pe){switch(se){case t.AnnotationEditorParamsType.INK_THICKNESS:he(this,g,Dt).call(this,pe);break;case t.AnnotationEditorParamsType.INK_COLOR:he(this,E,It).call(this,pe);break;case t.AnnotationEditorParamsType.INK_OPACITY:he(this,M,Lt).call(this,pe);break}}static get defaultPropertiesToUpdate(){return[[t.AnnotationEditorParamsType.INK_THICKNESS,Pe._defaultThickness],[t.AnnotationEditorParamsType.INK_COLOR,Pe._defaultColor||a.AnnotationEditor._defaultLineColor],[t.AnnotationEditorParamsType.INK_OPACITY,Math.round(Pe._defaultOpacity*100)]]}get propertiesToUpdate(){return[[t.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Pe._defaultThickness],[t.AnnotationEditorParamsType.INK_COLOR,this.color||Pe._defaultColor||a.AnnotationEditor._defaultLineColor],[t.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Pe._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(he(this,U,tt).call(this),he(this,V,nt).call(this)),this.isAttachedToDOM||(this.parent.add(this),he(this,o,Ye).call(this)),he(this,Ce,Ke).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,O(this,v).disconnect(),me(this,v,null),super.remove())}enableEditMode(){O(this,i)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",O(this,e)),this.canvas.addEventListener("pointerup",O(this,h)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",O(this,e)),this.canvas.removeEventListener("pointerup",O(this,h)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){O(this,i)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),me(this,i,!0),this.div.classList.add("disabled"),he(this,Ce,Ke).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(se){super.focusin(se),this.enableEditMode()}canvasPointerdown(se){se.button!==0||!this.isInEditMode()||O(this,i)||(this.setInForeground(),se.type!=="mouse"&&this.div.focus(),se.stopPropagation(),this.canvas.addEventListener("pointerleave",O(this,S)),this.canvas.addEventListener("pointermove",O(this,C)),he(this,$,jt).call(this,se.offsetX,se.offsetY))}canvasPointermove(se){se.stopPropagation(),he(this,ne,Ut).call(this,se.offsetX,se.offsetY)}canvasPointerup(se){se.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(se.stopPropagation(),he(this,R,mt).call(this,se),this.setInBackground())}canvasPointerleave(se){he(this,R,mt).call(this,se),this.setInBackground()}render(){if(this.div)return this.div;let se,pe;this.width&&(se=this.x,pe=this.y),super.render(),Pe._l10nPromise.get("editor_ink_aria_label").then(ye=>{var ve;return(ve=this.div)==null?void 0:ve.setAttribute("aria-label",ye)});const[J,H,z,ge]=he(this,ie,Nt).call(this);if(this.setAt(J,H,0,0),this.setDims(z,ge),he(this,U,tt).call(this),this.width){const[ye,ve]=this.parent.viewportBaseDimensions;this.setAt(se*ye,pe*ve,this.width*ye,this.height*ve),me(this,l,!0),he(this,o,Ye).call(this),this.setDims(this.width*ye,this.height*ve),he(this,d,He).call(this),he(this,ke,vt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return he(this,V,nt).call(this),this.div}setDimensions(se,pe){const J=Math.round(se),H=Math.round(pe);if(O(this,c)===J&&O(this,r)===H)return;me(this,c,J),me(this,r,H),this.canvas.style.visibility="hidden",O(this,f)&&Math.abs(O(this,f)-se/pe)>.01&&(pe=Math.ceil(se/O(this,f)),this.setDims(se,pe));const[z,ge]=this.parent.viewportBaseDimensions;this.width=se/z,this.height=pe/ge,O(this,i)&&he(this,_,yt).call(this,se,pe),he(this,o,Ye).call(this),he(this,d,He).call(this),this.canvas.style.visibility="visible"}static deserialize(se,pe){var De,Re;const J=super.deserialize(se,pe);J.thickness=se.thickness,J.color=t.Util.makeHexColor(...se.color),J.opacity=se.opacity;const[H,z]=pe.pageDimensions,ge=J.width*H,ye=J.height*z,ve=pe.scaleFactor,Se=se.thickness/2;me(J,f,ge/ye),me(J,i,!0),me(J,c,Math.round(ge)),me(J,r,Math.round(ye));for(const{bezier:Te}of se.paths){const Le=[];J.paths.push(Le);let Ie=ve*(Te[0]-Se),Ue=ve*(ye-Te[1]-Se);for(let Ne=2,We=Te.length;Ne<We;Ne+=6){const $e=ve*(Te[Ne]-Se),Ve=ve*(ye-Te[Ne+1]-Se),Ge=ve*(Te[Ne+2]-Se),je=ve*(ye-Te[Ne+3]-Se),qe=ve*(Te[Ne+4]-Se),Xe=ve*(ye-Te[Ne+5]-Se);Le.push([[Ie,Ue],[$e,Ve],[Ge,je],[qe,Xe]]),Ie=qe,Ue=Xe}const we=he(this,re,_t).call(this,Le);J.bezierPath2D.push(we)}const xe=he(De=J,de,bt).call(De);return me(J,L,Math.max(T,xe[2]-xe[0])),me(J,w,Math.max(T,xe[3]-xe[1])),he(Re=J,_,yt).call(Re,ge,ye),J}serialize(){if(this.isEmpty())return null;const se=this.getRect(0,0),pe=this.rotation%180===0?se[3]-se[1]:se[2]-se[0],J=a.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:t.AnnotationEditorType.INK,color:J,thickness:this.thickness,opacity:this.opacity,paths:he(this,Z,Wt).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,pe),pageIndex:this.parent.pageIndex,rect:se,rotation:this.rotation}}};f=new WeakMap,w=new WeakMap,L=new WeakMap,C=new WeakMap,S=new WeakMap,h=new WeakMap,e=new WeakMap,i=new WeakMap,l=new WeakMap,b=new WeakMap,v=new WeakMap,c=new WeakMap,r=new WeakMap,s=new WeakMap,g=new WeakSet,Dt=function(se){const pe=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=se,he(this,Ce,Ke).call(this)},undo:()=>{this.thickness=pe,he(this,Ce,Ke).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},E=new WeakSet,It=function(se){const pe=this.color;this.parent.addCommands({cmd:()=>{this.color=se,he(this,d,He).call(this)},undo:()=>{this.color=pe,he(this,d,He).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},M=new WeakSet,Lt=function(se){se/=100;const pe=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=se,he(this,d,He).call(this)},undo:()=>{this.opacity=pe,he(this,d,He).call(this)},mustExec:!0,type:t.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},ie=new WeakSet,Nt=function(){const{width:se,height:pe,rotation:J}=this.parent.viewport;switch(J){case 90:return[0,se,se,pe];case 180:return[se,pe,se,pe];case 270:return[pe,0,se,pe];default:return[0,0,se,pe]}},K=new WeakSet,gt=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,D.opacityToHex)(this.opacity)}`},$=new WeakSet,jt=function(se,pe){this.isEditing=!0,O(this,l)||(me(this,l,!0),he(this,o,Ye).call(this),this.thickness||(this.thickness=Pe._defaultThickness),this.color||(this.color=Pe._defaultColor||a.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Pe._defaultOpacity)),this.currentPath.push([se,pe]),me(this,b,null),he(this,K,gt).call(this),this.ctx.beginPath(),this.ctx.moveTo(se,pe),me(this,s,()=>{O(this,s)&&(O(this,b)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):he(this,d,He).call(this),this.ctx.lineTo(...O(this,b)),me(this,b,null),this.ctx.stroke()),window.requestAnimationFrame(O(this,s)))}),window.requestAnimationFrame(O(this,s))},ne=new WeakSet,Ut=function(se,pe){const[J,H]=this.currentPath.at(-1);se===J&&pe===H||(this.currentPath.push([se,pe]),me(this,b,[se,pe]))},_e=new WeakSet,Bt=function(se,pe){var Se;this.ctx.closePath(),me(this,s,null),se=Math.min(Math.max(se,0),this.canvas.width),pe=Math.min(Math.max(pe,0),this.canvas.height);const[J,H]=this.currentPath.at(-1);(se!==J||pe!==H)&&this.currentPath.push([se,pe]);let z;if(this.currentPath.length!==1)z=(0,F.fitCurve)(this.currentPath,30,null);else{const xe=[se,pe];z=[[xe,xe.slice(),xe.slice(),xe]]}const ge=he(Se=Pe,re,_t).call(Se,z);this.currentPath.length=0;const ye=()=>{this.paths.push(z),this.bezierPath2D.push(ge),this.rebuild()},ve=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(he(this,U,tt).call(this),he(this,V,nt).call(this)),he(this,Ce,Ke).call(this))};this.parent.addCommands({cmd:ye,undo:ve,mustExec:!0})},d=new WeakSet,He=function(){if(this.isEmpty()){he(this,I,rt).call(this);return}he(this,K,gt).call(this);const{canvas:se,ctx:pe}=this;pe.setTransform(1,0,0,1,0,0),pe.clearRect(0,0,se.width,se.height),he(this,I,rt).call(this);for(const J of this.bezierPath2D)pe.stroke(J)},R=new WeakSet,mt=function(se){he(this,_e,Bt).call(this,se.offsetX,se.offsetY),this.canvas.removeEventListener("pointerleave",O(this,S)),this.canvas.removeEventListener("pointermove",O(this,C)),this.parent.addToAnnotationStorage(this)},U=new WeakSet,tt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Pe._l10nPromise.get("editor_ink_canvas_aria_label").then(se=>{var pe;return(pe=this.canvas)==null?void 0:pe.setAttribute("aria-label",se)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},V=new WeakSet,nt=function(){me(this,v,new ResizeObserver(se=>{const pe=se[0].contentRect;pe.width&&pe.height&&this.setDimensions(pe.width,pe.height)})),O(this,v).observe(this.div)},o=new WeakSet,Ye=function(){if(!O(this,l))return;const[se,pe]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*se),this.canvas.height=Math.ceil(this.height*pe),he(this,I,rt).call(this)},_=new WeakSet,yt=function(se,pe){const J=he(this,Ae,it).call(this),H=(se-J)/O(this,L),z=(pe-J)/O(this,w);this.scaleFactor=Math.min(H,z)},I=new WeakSet,rt=function(){const se=he(this,Ae,it).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+se,this.translationY*this.scaleFactor+se)},re=new WeakSet,_t=function(se){const pe=new Path2D;for(let J=0,H=se.length;J<H;J++){const[z,ge,ye,ve]=se[J];J===0&&pe.moveTo(...z),pe.bezierCurveTo(ge[0],ge[1],ye[0],ye[1],ve[0],ve[1])}return pe},Z=new WeakSet,Wt=function(se,pe,J,H){const ge=[],ye=this.thickness/2;let ve,Se;for(const xe of this.paths){ve=[],Se=[];for(let De=0,Re=xe.length;De<Re;De++){const[Te,Le,Ie,Ue]=xe[De],we=se*(Te[0]+pe)+ye,Ne=H-se*(Te[1]+J)-ye,We=se*(Le[0]+pe)+ye,$e=H-se*(Le[1]+J)-ye,Ve=se*(Ie[0]+pe)+ye,Ge=H-se*(Ie[1]+J)-ye,je=se*(Ue[0]+pe)+ye,qe=H-se*(Ue[1]+J)-ye;De===0&&(ve.push(we,Ne),Se.push(we,Ne)),ve.push(We,$e,Ve,Ge,je,qe),he(this,te,qt).call(this,we,Ne,We,$e,Ve,Ge,je,qe,4,Se)}ge.push({bezier:ve,points:Se})}return ge},te=new WeakSet,qt=function(se,pe,J,H,z,ge,ye,ve,Se,xe){if(he(this,fe,Gt).call(this,se,pe,J,H,z,ge,ye,ve)){xe.push(ye,ve);return}for(let De=1;De<Se-1;De++){const Re=De/Se,Te=1-Re;let Le=Re*se+Te*J,Ie=Re*pe+Te*H,Ue=Re*J+Te*z,we=Re*H+Te*ge;const Ne=Re*z+Te*ye,We=Re*ge+Te*ve;Le=Re*Le+Te*Ue,Ie=Re*Ie+Te*we,Ue=Re*Ue+Te*Ne,we=Re*we+Te*We,Le=Re*Le+Te*Ue,Ie=Re*Ie+Te*we,xe.push(Le,Ie)}xe.push(ye,ve)},fe=new WeakSet,Gt=function(se,pe,J,H,z,ge,ye,ve){const xe=(3*J-2*se-ye)**2,De=(3*H-2*pe-ve)**2,Re=(3*z-se-2*ye)**2,Te=(3*ge-pe-2*ve)**2;return Math.max(xe,Re)+Math.max(De,Te)<=10},de=new WeakSet,bt=function(){let se=1/0,pe=-1/0,J=1/0,H=-1/0;for(const z of this.paths)for(const[ge,ye,ve,Se]of z){const xe=t.Util.bezierBoundingBox(...ge,...ye,...ve,...Se);se=Math.min(se,xe[0]),J=Math.min(J,xe[1]),pe=Math.max(pe,xe[2]),H=Math.max(H,xe[3])}return[se,J,pe,H]},Ae=new WeakSet,it=function(){return O(this,i)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Ce=new WeakSet,Ke=function(se=!1){if(this.isEmpty())return;if(!O(this,i)){he(this,d,He).call(this);return}const pe=he(this,de,bt).call(this),J=he(this,Ae,it).call(this);me(this,L,Math.max(T,pe[2]-pe[0])),me(this,w,Math.max(T,pe[3]-pe[1]));const H=Math.ceil(J+O(this,L)*this.scaleFactor),z=Math.ceil(J+O(this,w)*this.scaleFactor),[ge,ye]=this.parent.viewportBaseDimensions;this.width=H/ge,this.height=z/ye,me(this,f,H/z),he(this,ke,vt).call(this);const ve=this.translationX,Se=this.translationY;this.translationX=-pe[0],this.translationY=-pe[1],he(this,o,Ye).call(this),he(this,d,He).call(this),me(this,c,H),me(this,r,z),this.setDims(H,z);const xe=se?J/this.scaleFactor/2:0;this.translate(ve-this.translationX-xe,Se-this.translationY-xe)},ke=new WeakSet,vt=function(){const{style:se}=this.div;O(this,f)>=1?(se.minHeight=`${T}px`,se.minWidth=`${Math.round(O(this,f)*T)}px`):(se.minWidth=`${T}px`,se.minHeight=`${Math.round(T/O(this,f))}px`)},ae(Pe,re),Me(Pe,"_defaultColor",null),Me(Pe,"_defaultOpacity",1),Me(Pe,"_defaultThickness",1),Me(Pe,"_l10nPromise"),Me(Pe,"_type","ink");let A=Pe;n.InkEditor=A},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.fitCurve=void 0;const t=y(26);n.fitCurve=t},P=>{function n(h,e,i){if(!Array.isArray(h))throw new TypeError("First argument should be an array");if(h.forEach(c=>{if(!Array.isArray(c)||c.some(r=>typeof r!="number")||c.length!==h[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),h=h.filter((c,r)=>r===0||!c.every((s,g)=>s===h[r-1][g])),h.length<2)return[];const l=h.length,b=L(h[1],h[0]),v=L(h[l-2],h[l-1]);return y(h,b,v,e,i)}function y(h,e,i,l,b){var c,r,s,g,k,E,m,M,ee,ie,Q,K,G;if(h.length===2)return K=C.vectorLen(C.subtract(h[0],h[1]))/3,c=[h[0],C.addArrays(h[0],C.mulItems(e,K)),C.addArrays(h[1],C.mulItems(i,K)),h[1]],[c];if(r=T(h),[c,g,E]=t(h,r,r,e,i,b),g===0||g<l)return[c];if(g<l*l)for(s=r,k=g,m=E,G=0;G<20;G++){if(s=F(c,h,s),[c,g,E]=t(h,r,s,e,i,b),g<l)return[c];if(E===m){let $=g/k;if($>.9999&&$<1.0001)break}k=g,m=E}return Q=[],M=C.subtract(h[E-1],h[E+1]),M.every($=>$===0)&&(M=C.subtract(h[E-1],h[E]),[M[0],M[1]]=[-M[1],M[0]]),ee=C.normalize(M),ie=C.mulItems(ee,-1),Q=Q.concat(y(h.slice(0,E+1),e,ee,l,b)),Q=Q.concat(y(h.slice(E),ie,i,l,b)),Q}function t(h,e,i,l,b,v){var c,r,s;return c=a(h,i,l,b),[r,s]=A(h,c,e),v&&v({bez:c,points:h,params:e,maxErr:r,maxPoint:s}),[c,r,s]}function a(h,e,i,l){var b,v,c,r,s,g,k,E,m,M,ee,ie,Q,K,G,$,Y,ne=h[0],ce=h[h.length-1];for(b=[ne,null,null,ce],v=C.zeros_Xx2x2(e.length),Q=0,K=e.length;Q<K;Q++)$=e[Q],Y=1-$,c=v[Q],c[0]=C.mulItems(i,3*$*(Y*Y)),c[1]=C.mulItems(l,3*Y*($*$));for(r=[[0,0],[0,0]],s=[0,0],Q=0,K=h.length;Q<K;Q++)$=e[Q],c=v[Q],r[0][0]+=C.dot(c[0],c[0]),r[0][1]+=C.dot(c[0],c[1]),r[1][0]+=C.dot(c[0],c[1]),r[1][1]+=C.dot(c[1],c[1]),G=C.subtract(h[Q],S.q([ne,ne,ce,ce],$)),s[0]+=C.dot(c[0],G),s[1]+=C.dot(c[1],G);return g=r[0][0]*r[1][1]-r[1][0]*r[0][1],k=r[0][0]*s[1]-r[1][0]*s[0],E=s[0]*r[1][1]-s[1]*r[0][1],m=g===0?0:E/g,M=g===0?0:k/g,ie=C.vectorLen(C.subtract(ne,ce)),ee=1e-6*ie,m<ee||M<ee?(b[1]=C.addArrays(ne,C.mulItems(i,ie/3)),b[2]=C.addArrays(ce,C.mulItems(l,ie/3))):(b[1]=C.addArrays(ne,C.mulItems(i,m)),b[2]=C.addArrays(ce,C.mulItems(l,M))),b}function F(h,e,i){return i.map((l,b)=>D(h,e[b],l))}function D(h,e,i){var l=C.subtract(S.q(h,i),e),b=S.qprime(h,i),v=C.mulMatrix(l,b),c=C.sum(C.squareItems(b))+2*C.mulMatrix(l,S.qprimeprime(h,i));return c===0?i:i-v/c}function T(h){var e=[],i,l,b;return h.forEach((v,c)=>{i=c?l+C.vectorLen(C.subtract(v,b)):0,e.push(i),l=i,b=v}),e=e.map(v=>v/l),e}function A(h,e,i){var l,b,v,c,r,s,g,k;b=0,v=Math.floor(h.length/2);const E=f(e,10);for(r=0,s=h.length;r<s;r++)g=h[r],k=w(e,i[r],E,10),c=C.subtract(S.q(e,k),g),l=c[0]*c[0]+c[1]*c[1],l>b&&(b=l,v=r);return[b,v]}var f=function(h,e){for(var i,l=[0],b=h[0],v=0,c=1;c<=e;c++)i=S.q(h,c/e),v+=C.vectorLen(C.subtract(i,b)),l.push(v),b=i;return l=l.map(r=>r/v),l};function w(h,e,i,l){if(e<0)return 0;if(e>1)return 1;for(var b,v,c,r,s,g=1;g<=l;g++)if(e<=i[g]){r=(g-1)/l,c=g/l,v=i[g-1],b=i[g],s=(e-v)/(b-v)*(c-r)+r;break}return s}function L(h,e){return C.normalize(C.subtract(h,e))}class C{static zeros_Xx2x2(e){for(var i=[];e--;)i.push([0,0]);return i}static mulItems(e,i){return e.map(l=>l*i)}static mulMatrix(e,i){return e.reduce((l,b,v)=>l+b*i[v],0)}static subtract(e,i){return e.map((l,b)=>l-i[b])}static addArrays(e,i){return e.map((l,b)=>l+i[b])}static addItems(e,i){return e.map(l=>l+i)}static sum(e){return e.reduce((i,l)=>i+l)}static dot(e,i){return C.mulMatrix(e,i)}static vectorLen(e){return Math.hypot(...e)}static divItems(e,i){return e.map(l=>l/i)}static squareItems(e){return e.map(i=>i*i)}static normalize(e){return this.divItems(e,this.vectorLen(e))}}class S{static q(e,i){var l=1-i,b=C.mulItems(e[0],l*l*l),v=C.mulItems(e[1],3*l*l*i),c=C.mulItems(e[2],3*l*i*i),r=C.mulItems(e[3],i*i*i);return C.addArrays(C.addArrays(b,v),C.addArrays(c,r))}static qprime(e,i){var l=1-i,b=C.mulItems(C.subtract(e[1],e[0]),3*l*l),v=C.mulItems(C.subtract(e[2],e[1]),6*l*i),c=C.mulItems(C.subtract(e[3],e[2]),3*i*i);return C.addArrays(C.addArrays(b,v),c)}static qprimeprime(e,i){return C.addArrays(C.mulItems(C.addArrays(C.subtract(e[2],C.mulItems(e[1],2)),e[0]),6*(1-i)),C.mulItems(C.addArrays(C.subtract(e[3],C.mulItems(e[2],2)),e[1]),6*i))}}P.exports=n,P.exports.fitCubic=y,P.exports.createTangent=L},(P,n,y)=>{var d,At,R,St,U,Et;Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var t=y(1),a=y(8),F=y(5),D=y(28),T=y(29);const A=1e3,f=9,w=new WeakSet;function L(X){return{width:X[2]-X[0],height:X[3]-X[1]}}class C{static create(o){switch(o.data.annotationType){case t.AnnotationType.LINK:return new h(o);case t.AnnotationType.TEXT:return new e(o);case t.AnnotationType.WIDGET:switch(o.data.fieldType){case"Tx":return new l(o);case"Btn":return o.data.radioButton?new v(o):o.data.checkBox?new b(o):new c(o);case"Ch":return new r(o)}return new i(o);case t.AnnotationType.POPUP:return new s(o);case t.AnnotationType.FREETEXT:return new k(o);case t.AnnotationType.LINE:return new E(o);case t.AnnotationType.SQUARE:return new m(o);case t.AnnotationType.CIRCLE:return new M(o);case t.AnnotationType.POLYLINE:return new ee(o);case t.AnnotationType.CARET:return new Q(o);case t.AnnotationType.INK:return new K(o);case t.AnnotationType.POLYGON:return new ie(o);case t.AnnotationType.HIGHLIGHT:return new G(o);case t.AnnotationType.UNDERLINE:return new $(o);case t.AnnotationType.SQUIGGLY:return new Y(o);case t.AnnotationType.STRIKEOUT:return new ne(o);case t.AnnotationType.STAMP:return new ce(o);case t.AnnotationType.FILEATTACHMENT:return new _e(o);default:return new S(o)}}}class S{constructor(o,{isRenderable:p=!1,ignoreBorder:_=!1,createQuadrilaterals:x=!1}={}){this.isRenderable=p,this.data=o.data,this.layer=o.layer,this.page=o.page,this.viewport=o.viewport,this.linkService=o.linkService,this.downloadManager=o.downloadManager,this.imageResourcesPath=o.imageResourcesPath,this.renderForms=o.renderForms,this.svgFactory=o.svgFactory,this.annotationStorage=o.annotationStorage,this.enableScripting=o.enableScripting,this.hasJSActions=o.hasJSActions,this._fieldObjects=o.fieldObjects,this._mouseState=o.mouseState,p&&(this.container=this._createContainer(_)),x&&(this.quadrilaterals=this._createQuadrilaterals(_))}_createContainer(o=!1){const p=this.data,_=this.page,x=this.viewport,I=document.createElement("section"),{width:q,height:re}=L(p.rect),[ue,Z,oe,te]=x.viewBox,le=oe-ue,fe=te-Z;I.setAttribute("data-annotation-id",p.id);const N=t.Util.normalizeRect([p.rect[0],_.view[3]-p.rect[1]+_.view[1],p.rect[2],_.view[3]-p.rect[3]+_.view[1]]);if(!o&&p.borderStyle.width>0){I.style.borderWidth=`${p.borderStyle.width}px`;const be=p.borderStyle.horizontalCornerRadius,Ae=p.borderStyle.verticalCornerRadius;if(be>0||Ae>0){const Ce=`calc(${be}px * var(--scale-factor)) / calc(${Ae}px * var(--scale-factor))`;I.style.borderRadius=Ce}else if(this instanceof v){const Ce=`calc(${q}px * var(--scale-factor)) / calc(${re}px * var(--scale-factor))`;I.style.borderRadius=Ce}switch(p.borderStyle.style){case t.AnnotationBorderStyleType.SOLID:I.style.borderStyle="solid";break;case t.AnnotationBorderStyleType.DASHED:I.style.borderStyle="dashed";break;case t.AnnotationBorderStyleType.BEVELED:(0,t.warn)("Unimplemented border style: beveled");break;case t.AnnotationBorderStyleType.INSET:(0,t.warn)("Unimplemented border style: inset");break;case t.AnnotationBorderStyleType.UNDERLINE:I.style.borderBottomStyle="solid";break}const Ee=p.borderColor||null;Ee?I.style.borderColor=t.Util.makeHexColor(Ee[0]|0,Ee[1]|0,Ee[2]|0):I.style.borderWidth=0}I.style.left=`${100*(N[0]-ue)/le}%`,I.style.top=`${100*(N[1]-Z)/fe}%`;const{rotation:de}=p;return p.hasOwnCanvas||de===0?(I.style.width=`${100*q/le}%`,I.style.height=`${100*re/fe}%`):this.setRotation(de,I),I}setRotation(o,p=this.container){const[_,x,I,q]=this.viewport.viewBox,re=I-_,ue=q-x,{width:Z,height:oe}=L(this.data.rect);let te,le;o%180===0?(te=100*Z/re,le=100*oe/ue):(te=100*oe/re,le=100*Z/ue),p.style.width=`${te}%`,p.style.height=`${le}%`,p.setAttribute("data-main-rotation",(360-o)%360)}get _commonActions(){const o=(p,_,x)=>{const I=x.detail[p];x.target.style[_]=D.ColorConverters[`${I[0]}_HTML`](I.slice(1))};return(0,t.shadow)(this,"_commonActions",{display:p=>{const _=p.detail.display%2===1;this.container.style.visibility=_?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:_,print:p.detail.display===0||p.detail.display===3})},print:p=>{this.annotationStorage.setValue(this.data.id,{print:p.detail.print})},hidden:p=>{this.container.style.visibility=p.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:p.detail.hidden})},focus:p=>{setTimeout(()=>p.target.focus({preventScroll:!1}),0)},userName:p=>{p.target.title=p.detail.userName},readonly:p=>{p.detail.readonly?p.target.setAttribute("readonly",""):p.target.removeAttribute("readonly")},required:p=>{this._setRequired(p.target,p.detail.required)},bgColor:p=>{o("bgColor","backgroundColor",p)},fillColor:p=>{o("fillColor","backgroundColor",p)},fgColor:p=>{o("fgColor","color",p)},textColor:p=>{o("textColor","color",p)},borderColor:p=>{o("borderColor","borderColor",p)},strokeColor:p=>{o("strokeColor","borderColor",p)},rotation:p=>{const _=p.detail.rotation;this.setRotation(_),this.annotationStorage.setValue(this.data.id,{rotation:_})}})}_dispatchEventFromSandbox(o,p){const _=this._commonActions;for(const x of Object.keys(p.detail)){const I=o[x]||_[x];I&&I(p)}}_setDefaultPropertiesFromJS(o){if(!this.enableScripting)return;const p=this.annotationStorage.getRawValue(this.data.id);if(!p)return;const _=this._commonActions;for(const[x,I]of Object.entries(p)){const q=_[x];if(q){const re={detail:{[x]:I},target:o};q(re),delete p[x]}}}_createQuadrilaterals(o=!1){if(!this.data.quadPoints)return null;const p=[],_=this.data.rect;for(const x of this.data.quadPoints)this.data.rect=[x[2].x,x[2].y,x[1].x,x[1].y],p.push(this._createContainer(o));return this.data.rect=_,p}_createPopup(o,p){let _=this.container;this.quadrilaterals&&(o=o||this.quadrilaterals,_=this.quadrilaterals[0]),o||(o=document.createElement("div"),o.className="popupTriggerArea",_.append(o));const I=new g({container:_,trigger:o,color:p.color,titleObj:p.titleObj,modificationDate:p.modificationDate,contentsObj:p.contentsObj,richText:p.richText,hideWrapper:!0}).render();I.style.left="100%",_.append(I)}_renderQuadrilaterals(o){for(const p of this.quadrilaterals)p.className=o;return this.quadrilaterals}render(){(0,t.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(o,p=null){const _=[];if(this._fieldObjects){const x=this._fieldObjects[o];if(x)for(const{page:I,id:q,exportValues:re}of x){if(I===-1||q===p)continue;const ue=typeof re=="string"?re:null,Z=document.querySelector(`[data-element-id="${q}"]`);if(Z&&!w.has(Z)){(0,t.warn)(`_getElementsByName - element not allowed: ${q}`);continue}_.push({id:q,exportValue:ue,domElement:Z})}return _}for(const x of document.getElementsByName(o)){const{id:I,exportValue:q}=x;I!==p&&w.has(x)&&_.push({id:I,exportValue:q,domElement:x})}return _}static get platform(){const o=typeof navigator<"u"?navigator.platform:"";return(0,t.shadow)(this,"platform",{isWin:o.includes("Win"),isMac:o.includes("Mac")})}}class h extends S{constructor(o,p=null){super(o,{isRenderable:!0,ignoreBorder:!!(p!=null&&p.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=o.data.isTooltipOnly}render(){const{data:o,linkService:p}=this,_=document.createElement("a");_.setAttribute("data-element-id",o.id);let x=!1;return o.url?(p.addLinkAttributes(_,o.url,o.newWindow),x=!0):o.action?(this._bindNamedAction(_,o.action),x=!0):o.dest?(this._bindLink(_,o.dest),x=!0):(o.actions&&(o.actions.Action||o.actions["Mouse Up"]||o.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(_,o),x=!0),o.resetForm?(this._bindResetFormAction(_,o.resetForm),x=!0):this.isTooltipOnly&&!x&&(this._bindLink(_,""),x=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((I,q)=>{const re=q===0?_:_.cloneNode();return I.append(re),I}):(this.container.className="linkAnnotation",x&&this.container.append(_),this.container)}_bindLink(o,p){o.href=this.linkService.getDestinationHash(p),o.onclick=()=>(p&&this.linkService.goToDestination(p),!1),(p||p==="")&&(o.className="internalLink")}_bindNamedAction(o,p){o.href=this.linkService.getAnchorUrl(""),o.onclick=()=>(this.linkService.executeNamedAction(p),!1),o.className="internalLink"}_bindJSAction(o,p){o.href=this.linkService.getAnchorUrl("");const _=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const x of Object.keys(p.actions)){const I=_.get(x);I&&(o[I]=()=>{var q;return(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p.id,name:x}}),!1})}o.onclick||(o.onclick=()=>!1),o.className="internalLink"}_bindResetFormAction(o,p){const _=o.onclick;if(_||(o.href=this.linkService.getAnchorUrl("")),o.className="internalLink",!this._fieldObjects){(0,t.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),_||(o.onclick=()=>!1);return}o.onclick=()=>{var oe;_&&_();const{fields:x,refs:I,include:q}=p,re=[];if(x.length!==0||I.length!==0){const te=new Set(I);for(const le of x){const fe=this._fieldObjects[le]||[];for(const{id:N}of fe)te.add(N)}for(const le of Object.values(this._fieldObjects))for(const fe of le)te.has(fe.id)===q&&re.push(fe)}else for(const te of Object.values(this._fieldObjects))re.push(...te);const ue=this.annotationStorage,Z=[];for(const te of re){const{id:le}=te;switch(Z.push(le),te.type){case"text":{const N=te.defaultValue||"";ue.setValue(le,{value:N});break}case"checkbox":case"radiobutton":{const N=te.defaultValue===te.exportValues;ue.setValue(le,{value:N});break}case"combobox":case"listbox":{const N=te.defaultValue||"";ue.setValue(le,{value:N});break}default:continue}const fe=document.querySelector(`[data-element-id="${le}"]`);if(fe){if(!w.has(fe)){(0,t.warn)(`_bindResetFormAction - element not allowed: ${le}`);continue}}else continue;fe.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Z,name:"ResetForm"}})),!1}}}class e extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p})}render(){this.container.className="textAnnotation";const o=document.createElement("img");return o.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",o.alt="[{{type}} Annotation]",o.dataset.l10nId="text_annotation_type",o.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(o,this.data),this.container.append(o),this.container}}class i extends S{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(o){const{isWin:p,isMac:_}=S.platform;return p&&o.ctrlKey||_&&o.metaKey}_setEventListener(o,p,_,x){p.includes("mouse")?o.addEventListener(p,I=>{var q;(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:x(I),shift:I.shiftKey,modifier:this._getKeyModifier(I)}})}):o.addEventListener(p,I=>{var q;(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:x(I)}})})}_setEventListeners(o,p,_){var x;for(const[I,q]of p)(q==="Action"||(x=this.data.actions)!=null&&x[q])&&this._setEventListener(o,I,q,_)}_setBackgroundColor(o){const p=this.data.backgroundColor||null;o.style.backgroundColor=p===null?"transparent":t.Util.makeHexColor(p[0],p[1],p[2])}_setTextStyle(o){const p=["left","center","right"],{fontColor:_}=this.data.defaultAppearanceData,x=this.data.defaultAppearanceData.fontSize||f,I=o.style;let q;if(this.data.multiLine){const re=Math.abs(this.data.rect[3]-this.data.rect[1]),ue=Math.round(re/(t.LINE_FACTOR*x))||1,Z=re/ue;q=Math.min(x,Math.round(Z/t.LINE_FACTOR))}else{const re=Math.abs(this.data.rect[3]-this.data.rect[1]);q=Math.min(x,Math.round(re/t.LINE_FACTOR))}I.fontSize=`calc(${q}px * var(--scale-factor))`,I.color=t.Util.makeHexColor(_[0],_[1],_[2]),this.data.textAlignment!==null&&(I.textAlign=p[this.data.textAlignment])}_setRequired(o,p){p?o.setAttribute("required",!0):o.removeAttribute("required"),o.setAttribute("aria-required",p)}}class l extends i{constructor(o){const p=o.renderForms||!o.data.hasAppearance&&!!o.data.fieldValue;super(o,{isRenderable:p})}setPropertyOnSiblings(o,p,_,x){const I=this.annotationStorage;for(const q of this._getElementsByName(o.name,o.id))q.domElement&&(q.domElement[p]=_),I.setValue(q.id,{[x]:_})}render(){var x;const o=this.annotationStorage,p=this.data.id;this.container.className="textWidgetAnnotation";let _=null;if(this.renderForms){const I=o.getValue(p,{value:this.data.fieldValue});let q=I.formattedValue||I.value||"";const re=o.getValue(p,{charLimit:this.data.maxLen}).charLimit;re&&q.length>re&&(q=q.slice(0,re));const ue={userValue:q,formattedValue:null,valueOnFocus:""};this.data.multiLine?(_=document.createElement("textarea"),_.textContent=q,this.data.doNotScroll&&(_.style.overflowY="hidden")):(_=document.createElement("input"),_.type="text",_.setAttribute("value",q),this.data.doNotScroll&&(_.style.overflowX="hidden")),w.add(_),_.setAttribute("data-element-id",p),_.disabled=this.data.readOnly,_.name=this.data.fieldName,_.tabIndex=A,this._setRequired(_,this.data.required),re&&(_.maxLength=re),_.addEventListener("input",oe=>{o.setValue(p,{value:oe.target.value}),this.setPropertyOnSiblings(_,"value",oe.target.value,"value")}),_.addEventListener("resetform",oe=>{const te=this.data.defaultFieldValue??"";_.value=ue.userValue=te,ue.formattedValue=null});let Z=oe=>{const{formattedValue:te}=ue;te!=null&&(oe.target.value=te),oe.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){_.addEventListener("focus",te=>{ue.userValue&&(te.target.value=ue.userValue),ue.valueOnFocus=te.target.value}),_.addEventListener("updatefromsandbox",te=>{const le={value(fe){ue.userValue=fe.detail.value??"",o.setValue(p,{value:ue.userValue.toString()}),fe.target.value=ue.userValue},formattedValue(fe){const{formattedValue:N}=fe.detail;ue.formattedValue=N,N!=null&&fe.target!==document.activeElement&&(fe.target.value=N),o.setValue(p,{formattedValue:N})},selRange(fe){fe.target.setSelectionRange(...fe.detail.selRange)},charLimit:fe=>{var Ae;const{charLimit:N}=fe.detail,{target:de}=fe;if(N===0){de.removeAttribute("maxLength");return}de.setAttribute("maxLength",N);let be=ue.userValue;!be||be.length<=N||(be=be.slice(0,N),de.value=ue.userValue=be,o.setValue(p,{value:be}),(Ae=this.linkService.eventBus)==null||Ae.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:be,willCommit:!0,commitKey:1,selStart:de.selectionStart,selEnd:de.selectionEnd}}))}};this._dispatchEventFromSandbox(le,te)}),_.addEventListener("keydown",te=>{var N;let le=-1;if(te.key==="Escape"?le=0:te.key==="Enter"?le=2:te.key==="Tab"&&(le=3),le===-1)return;const{value:fe}=te.target;ue.valueOnFocus!==fe&&(ue.userValue=fe,(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:fe,willCommit:!0,commitKey:le,selStart:te.target.selectionStart,selEnd:te.target.selectionEnd}}))});const oe=Z;Z=null,_.addEventListener("blur",te=>{var fe;const{value:le}=te.target;ue.userValue=le,this._mouseState.isDown&&ue.valueOnFocus!==le&&((fe=this.linkService.eventBus)==null||fe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:le,willCommit:!0,commitKey:1,selStart:te.target.selectionStart,selEnd:te.target.selectionEnd}})),oe(te)}),(x=this.data.actions)!=null&&x.Keystroke&&_.addEventListener("beforeinput",te=>{var Ce;const{data:le,target:fe}=te,{value:N,selectionStart:de,selectionEnd:be}=fe;let Ae=de,Ee=be;switch(te.inputType){case"deleteWordBackward":{const Fe=N.substring(0,de).match(/\w*[^\w]*$/);Fe&&(Ae-=Fe[0].length);break}case"deleteWordForward":{const Fe=N.substring(de).match(/^[^\w]*\w*/);Fe&&(Ee+=Fe[0].length);break}case"deleteContentBackward":de===be&&(Ae-=1);break;case"deleteContentForward":de===be&&(Ee+=1);break}te.preventDefault(),(Ce=this.linkService.eventBus)==null||Ce.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:N,change:le||"",willCommit:!1,selStart:Ae,selEnd:Ee}})}),this._setEventListeners(_,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],te=>te.target.value)}if(Z&&_.addEventListener("blur",Z),this.data.comb){const te=(this.data.rect[2]-this.data.rect[0])/re;_.classList.add("comb"),_.style.letterSpacing=`calc(${te}px * var(--scale-factor) - 1ch)`}}else _=document.createElement("div"),_.textContent=this.data.fieldValue,_.style.verticalAlign="middle",_.style.display="table-cell";return this._setTextStyle(_),this._setBackgroundColor(_),this._setDefaultPropertiesFromJS(_),this.container.append(_),this.container}}class b extends i{constructor(o){super(o,{isRenderable:o.renderForms})}render(){const o=this.annotationStorage,p=this.data,_=p.id;let x=o.getValue(_,{value:p.exportValue===p.fieldValue}).value;typeof x=="string"&&(x=x!=="Off",o.setValue(_,{value:x})),this.container.className="buttonWidgetAnnotation checkBox";const I=document.createElement("input");return w.add(I),I.setAttribute("data-element-id",_),I.disabled=p.readOnly,this._setRequired(I,this.data.required),I.type="checkbox",I.name=p.fieldName,x&&I.setAttribute("checked",!0),I.setAttribute("exportValue",p.exportValue),I.tabIndex=A,I.addEventListener("change",q=>{const{name:re,checked:ue}=q.target;for(const Z of this._getElementsByName(re,_)){const oe=ue&&Z.exportValue===p.exportValue;Z.domElement&&(Z.domElement.checked=oe),o.setValue(Z.id,{value:oe})}o.setValue(_,{value:ue})}),I.addEventListener("resetform",q=>{const re=p.defaultFieldValue||"Off";q.target.checked=re===p.exportValue}),this.enableScripting&&this.hasJSActions&&(I.addEventListener("updatefromsandbox",q=>{const re={value(ue){ue.target.checked=ue.detail.value!=="Off",o.setValue(_,{value:ue.target.checked})}};this._dispatchEventFromSandbox(re,q)}),this._setEventListeners(I,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],q=>q.target.checked)),this._setBackgroundColor(I),this._setDefaultPropertiesFromJS(I),this.container.append(I),this.container}}class v extends i{constructor(o){super(o,{isRenderable:o.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const o=this.annotationStorage,p=this.data,_=p.id;let x=o.getValue(_,{value:p.fieldValue===p.buttonValue}).value;typeof x=="string"&&(x=x!==p.buttonValue,o.setValue(_,{value:x}));const I=document.createElement("input");if(w.add(I),I.setAttribute("data-element-id",_),I.disabled=p.readOnly,this._setRequired(I,this.data.required),I.type="radio",I.name=p.fieldName,x&&I.setAttribute("checked",!0),I.tabIndex=A,I.addEventListener("change",q=>{const{name:re,checked:ue}=q.target;for(const Z of this._getElementsByName(re,_))o.setValue(Z.id,{value:!1});o.setValue(_,{value:ue})}),I.addEventListener("resetform",q=>{const re=p.defaultFieldValue;q.target.checked=re!=null&&re===p.buttonValue}),this.enableScripting&&this.hasJSActions){const q=p.buttonValue;I.addEventListener("updatefromsandbox",re=>{const ue={value:Z=>{const oe=q===Z.detail.value;for(const te of this._getElementsByName(Z.target.name)){const le=oe&&te.id===_;te.domElement&&(te.domElement.checked=le),o.setValue(te.id,{value:le})}}};this._dispatchEventFromSandbox(ue,re)}),this._setEventListeners(I,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],re=>re.target.checked)}return this._setBackgroundColor(I),this._setDefaultPropertiesFromJS(I),this.container.append(I),this.container}}class c extends h{constructor(o){super(o,{ignoreBorder:o.data.hasAppearance})}render(){const o=super.render();o.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(o.title=this.data.alternativeText);const p=o.lastChild;return this.enableScripting&&this.hasJSActions&&p&&(this._setDefaultPropertiesFromJS(p),p.addEventListener("updatefromsandbox",_=>{this._dispatchEventFromSandbox({},_)})),o}}class r extends i{constructor(o){super(o,{isRenderable:o.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const o=this.annotationStorage,p=this.data.id,_=o.getValue(p,{value:this.data.fieldValue}),x=document.createElement("select");w.add(x),x.setAttribute("data-element-id",p),x.disabled=this.data.readOnly,this._setRequired(x,this.data.required),x.name=this.data.fieldName,x.tabIndex=A;let I=this.data.combo&&this.data.options.length>0;this.data.combo||(x.size=this.data.options.length,this.data.multiSelect&&(x.multiple=!0)),x.addEventListener("resetform",Z=>{const oe=this.data.defaultFieldValue;for(const te of x.options)te.selected=te.value===oe});for(const Z of this.data.options){const oe=document.createElement("option");oe.textContent=Z.displayValue,oe.value=Z.exportValue,_.value.includes(Z.exportValue)&&(oe.setAttribute("selected",!0),I=!1),x.append(oe)}let q=null;if(I){const Z=document.createElement("option");Z.value=" ",Z.setAttribute("hidden",!0),Z.setAttribute("selected",!0),x.prepend(Z),q=()=>{Z.remove(),x.removeEventListener("input",q),q=null},x.addEventListener("input",q)}const re=(Z,oe)=>{const te=oe?"value":"textContent",le=Z.target.options;return Z.target.multiple?Array.prototype.filter.call(le,fe=>fe.selected).map(fe=>fe[te]):le.selectedIndex===-1?null:le[le.selectedIndex][te]},ue=Z=>{const oe=Z.target.options;return Array.prototype.map.call(oe,te=>({displayValue:te.textContent,exportValue:te.value}))};return this.enableScripting&&this.hasJSActions?(x.addEventListener("updatefromsandbox",Z=>{const oe={value(te){q==null||q();const le=te.detail.value,fe=new Set(Array.isArray(le)?le:[le]);for(const N of x.options)N.selected=fe.has(N.value);o.setValue(p,{value:re(te,!0)})},multipleSelection(te){x.multiple=!0},remove(te){const le=x.options,fe=te.detail.remove;le[fe].selected=!1,x.remove(fe),le.length>0&&Array.prototype.findIndex.call(le,de=>de.selected)===-1&&(le[0].selected=!0),o.setValue(p,{value:re(te,!0),items:ue(te)})},clear(te){for(;x.length!==0;)x.remove(0);o.setValue(p,{value:null,items:[]})},insert(te){const{index:le,displayValue:fe,exportValue:N}=te.detail.insert,de=x.children[le],be=document.createElement("option");be.textContent=fe,be.value=N,de?de.before(be):x.append(be),o.setValue(p,{value:re(te,!0),items:ue(te)})},items(te){const{items:le}=te.detail;for(;x.length!==0;)x.remove(0);for(const fe of le){const{displayValue:N,exportValue:de}=fe,be=document.createElement("option");be.textContent=N,be.value=de,x.append(be)}x.options.length>0&&(x.options[0].selected=!0),o.setValue(p,{value:re(te,!0),items:ue(te)})},indices(te){const le=new Set(te.detail.indices);for(const fe of te.target.options)fe.selected=le.has(fe.index);o.setValue(p,{value:re(te,!0)})},editable(te){te.target.disabled=!te.detail.editable}};this._dispatchEventFromSandbox(oe,Z)}),x.addEventListener("input",Z=>{var le;const oe=re(Z,!0),te=re(Z,!1);o.setValue(p,{value:oe}),(le=this.linkService.eventBus)==null||le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:p,name:"Keystroke",value:te,changeEx:oe,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(x,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],Z=>Z.target.checked)):x.addEventListener("input",function(Z){o.setValue(p,{value:re(Z,!0)})}),this.data.combo&&this._setTextStyle(x),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class s extends S{constructor(o){var _,x,I;const p=!!((_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p})}render(){const o=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",o.includes(this.data.parentType))return this.container;const p=`[data-annotation-id="${this.data.parentId}"]`,_=this.layer.querySelectorAll(p);if(_.length===0)return this.container;const x=new g({container:this.container,trigger:Array.from(_),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),I=this.page,q=t.Util.normalizeRect([this.data.parentRect[0],I.view[3]-this.data.parentRect[1]+I.view[1],this.data.parentRect[2],I.view[3]-this.data.parentRect[3]+I.view[1]]),re=q[0]+this.data.parentRect[2]-this.data.parentRect[0],ue=q[1],[Z,oe,te,le]=this.viewport.viewBox,fe=te-Z,N=le-oe;return this.container.style.left=`${100*(re-Z)/fe}%`,this.container.style.top=`${100*(ue-oe)/N}%`,this.container.append(x.render()),this.container}}class g{constructor(o){this.container=o.container,this.trigger=o.trigger,this.color=o.color,this.titleObj=o.titleObj,this.modificationDate=o.modificationDate,this.contentsObj=o.contentsObj,this.richText=o.richText,this.hideWrapper=o.hideWrapper||!1,this.pinned=!1}render(){var re,ue;const p=document.createElement("div");p.className="popupWrapper",this.hideElement=this.hideWrapper?p:this.container,this.hideElement.hidden=!0;const _=document.createElement("div");_.className="popup";const x=this.color;if(x){const Z=.7*(255-x[0])+x[0],oe=.7*(255-x[1])+x[1],te=.7*(255-x[2])+x[2];_.style.backgroundColor=t.Util.makeHexColor(Z|0,oe|0,te|0)}const I=document.createElement("h1");I.dir=this.titleObj.dir,I.textContent=this.titleObj.str,_.append(I);const q=a.PDFDateString.toDateObject(this.modificationDate);if(q){const Z=document.createElement("span");Z.className="popupDate",Z.textContent="{{date}}, {{time}}",Z.dataset.l10nId="annotation_date_string",Z.dataset.l10nArgs=JSON.stringify({date:q.toLocaleDateString(),time:q.toLocaleTimeString()}),_.append(Z)}if((re=this.richText)!=null&&re.str&&(!((ue=this.contentsObj)!=null&&ue.str)||this.contentsObj.str===this.richText.str))T.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:_}),_.lastChild.className="richText popupContent";else{const Z=this._formatContents(this.contentsObj);_.append(Z)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Z of this.trigger)Z.addEventListener("click",this._toggle.bind(this)),Z.addEventListener("mouseover",this._show.bind(this,!1)),Z.addEventListener("mouseout",this._hide.bind(this,!1));return _.addEventListener("click",this._hide.bind(this,!0)),p.append(_),p}_formatContents({str:o,dir:p}){const _=document.createElement("p");_.className="popupContent",_.dir=p;const x=o.split(/(?:\r\n?|\n)/);for(let I=0,q=x.length;I<q;++I){const re=x[I];_.append(document.createTextNode(re)),I<q-1&&_.append(document.createElement("br"))}return _}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(o=!1){o&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(o=!0){o&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class k extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0}),this.textContent=o.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const o=document.createElement("div");o.className="annotationTextContent",o.setAttribute("role","comment");for(const p of this.textContent){const _=document.createElement("span");_.textContent=p,o.append(_)}this.container.append(o)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class E extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const o=this.data,{width:p,height:_}=L(o.rect),x=this.svgFactory.create(p,_,!0),I=this.svgFactory.createElement("svg:line");return I.setAttribute("x1",o.rect[2]-o.lineCoordinates[0]),I.setAttribute("y1",o.rect[3]-o.lineCoordinates[1]),I.setAttribute("x2",o.rect[2]-o.lineCoordinates[2]),I.setAttribute("y2",o.rect[3]-o.lineCoordinates[3]),I.setAttribute("stroke-width",o.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),x.append(I),this.container.append(x),this._createPopup(I,o),this.container}}class m extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const o=this.data,{width:p,height:_}=L(o.rect),x=this.svgFactory.create(p,_,!0),I=o.borderStyle.width,q=this.svgFactory.createElement("svg:rect");return q.setAttribute("x",I/2),q.setAttribute("y",I/2),q.setAttribute("width",p-I),q.setAttribute("height",_-I),q.setAttribute("stroke-width",I||1),q.setAttribute("stroke","transparent"),q.setAttribute("fill","transparent"),x.append(q),this.container.append(x),this._createPopup(q,o),this.container}}class M extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const o=this.data,{width:p,height:_}=L(o.rect),x=this.svgFactory.create(p,_,!0),I=o.borderStyle.width,q=this.svgFactory.createElement("svg:ellipse");return q.setAttribute("cx",p/2),q.setAttribute("cy",_/2),q.setAttribute("rx",p/2-I/2),q.setAttribute("ry",_/2-I/2),q.setAttribute("stroke-width",I||1),q.setAttribute("stroke","transparent"),q.setAttribute("fill","transparent"),x.append(q),this.container.append(x),this._createPopup(q,o),this.container}}class ee extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const o=this.data,{width:p,height:_}=L(o.rect),x=this.svgFactory.create(p,_,!0);let I=[];for(const re of o.vertices){const ue=re.x-o.rect[0],Z=o.rect[3]-re.y;I.push(ue+","+Z)}I=I.join(" ");const q=this.svgFactory.createElement(this.svgElementName);return q.setAttribute("points",I),q.setAttribute("stroke-width",o.borderStyle.width||1),q.setAttribute("stroke","transparent"),q.setAttribute("fill","transparent"),x.append(q),this.container.append(x),this._createPopup(q,o),this.container}}class ie extends ee{constructor(o){super(o),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class K extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const o=this.data,{width:p,height:_}=L(o.rect),x=this.svgFactory.create(p,_,!0);for(const I of o.inkLists){let q=[];for(const ue of I){const Z=ue.x-o.rect[0],oe=o.rect[3]-ue.y;q.push(`${Z},${oe}`)}q=q.join(" ");const re=this.svgFactory.createElement(this.svgElementName);re.setAttribute("points",q),re.setAttribute("stroke-width",o.borderStyle.width||1),re.setAttribute("stroke","transparent"),re.setAttribute("fill","transparent"),this._createPopup(re,o),x.append(re)}return this.container.append(x),this.container}}class G extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class $ extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Y extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class ne extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ce extends S{constructor(o){var _,x,I;const p=!!(o.data.hasPopup||(_=o.data.titleObj)!=null&&_.str||(x=o.data.contentsObj)!=null&&x.str||(I=o.data.richText)!=null&&I.str);super(o,{isRenderable:p,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class _e extends S{constructor(o){var x;super(o,{isRenderable:!0});const{filename:p,content:_}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(p),this.content=_,(x=this.linkService.eventBus)==null||x.dispatch("fileattachmentannotation",{source:this,filename:p,content:_})}render(){var p,_;this.container.className="fileAttachmentAnnotation";const o=document.createElement("div");return o.className="popupTriggerArea",o.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((p=this.data.titleObj)!=null&&p.str||(_=this.data.contentsObj)!=null&&_.str||this.data.richText)&&this._createPopup(o,this.data),this.container.append(o),this.container}_download(){var o;(o=this.downloadManager)==null||o.openOrDownloadData(this.container,this.content,this.filename)}}const V=class V{static render(o){var re,ue;const{annotations:p,div:_,viewport:x,accessibilityManager:I}=o;he(this,R,St).call(this,_,x);let q=0;for(const Z of p){if(Z.annotationType!==t.AnnotationType.POPUP){const{width:te,height:le}=L(Z.rect);if(te<=0||le<=0)continue}const oe=C.create({data:Z,layer:_,page:o.page,viewport:x,linkService:o.linkService,downloadManager:o.downloadManager,imageResourcesPath:o.imageResourcesPath||"",renderForms:o.renderForms!==!1,svgFactory:new a.DOMSVGFactory,annotationStorage:o.annotationStorage||new F.AnnotationStorage,enableScripting:o.enableScripting,hasJSActions:o.hasJSActions,fieldObjects:o.fieldObjects,mouseState:o.mouseState||{isDown:!1}});if(oe.isRenderable){const te=oe.render();if(Z.hidden&&(te.style.visibility="hidden"),Array.isArray(te))for(const le of te)le.style.zIndex=q++,he(re=V,d,At).call(re,le,Z.id,_,I);else te.style.zIndex=q++,oe instanceof s?_.prepend(te):he(ue=V,d,At).call(ue,te,Z.id,_,I)}}he(this,U,Et).call(this,_,o.annotationCanvasMap)}static update(o){const{annotationCanvasMap:p,div:_,viewport:x}=o;he(this,R,St).call(this,_,x),he(this,U,Et).call(this,_,p),_.hidden=!1}};d=new WeakSet,At=function(o,p,_,x){const I=o.firstChild||o;I.id=`${a.AnnotationPrefix}${p}`,_.append(o),x==null||x.moveElementInDOM(_,o,I,!1)},R=new WeakSet,St=function(o,{width:p,height:_,rotation:x}){const{style:I}=o,q=x%180!==0,re=Math.floor(p)+"px",ue=Math.floor(_)+"px";I.width=q?ue:re,I.height=q?re:ue,o.setAttribute("data-main-rotation",x)},U=new WeakSet,Et=function(o,p){if(p){for(const[_,x]of p){const I=o.querySelector(`[data-annotation-id="${_}"]`);if(!I)continue;const{firstChild:q}=I;q?q.nodeName==="CANVAS"?q.replaceWith(x):q.before(x):I.append(x)}p.clear()}},ae(V,d),ae(V,R),ae(V,U);let W=V;n.AnnotationLayer=W},(P,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function y(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}class t{static CMYK_G([F,D,T,A]){return["G",1-Math.min(1,.3*F+.59*T+.11*D+A)]}static G_CMYK([F]){return["CMYK",0,0,0,1-F]}static G_RGB([F]){return["RGB",F,F,F]}static G_HTML([F]){const D=y(F);return`#${D}${D}${D}`}static RGB_G([F,D,T]){return["G",.3*F+.59*D+.11*T]}static RGB_HTML([F,D,T]){const A=y(F),f=y(D),w=y(T);return`#${A}${f}${w}`}static T_HTML(){return"#00000000"}static CMYK_RGB([F,D,T,A]){return["RGB",1-Math.min(1,F+A),1-Math.min(1,T+A),1-Math.min(1,D+A)]}static CMYK_HTML(F){const D=this.CMYK_RGB(F).slice(1);return this.RGB_HTML(D)}static RGB_CMYK([F,D,T]){const A=1-F,f=1-D,w=1-T,L=Math.min(A,f,w);return["CMYK",A,f,w,L]}}n.ColorConverters=t},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var t=y(20);class a{static setupStorage(D,T,A,f,w){const L=f.getValue(T,{value:null});switch(A.name){case"textarea":if(L.value!==null&&(D.textContent=L.value),w==="print")break;D.addEventListener("input",C=>{f.setValue(T,{value:C.target.value})});break;case"input":if(A.attributes.type==="radio"||A.attributes.type==="checkbox"){if(L.value===A.attributes.xfaOn?D.setAttribute("checked",!0):L.value===A.attributes.xfaOff&&D.removeAttribute("checked"),w==="print")break;D.addEventListener("change",C=>{f.setValue(T,{value:C.target.checked?C.target.getAttribute("xfaOn"):C.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&D.setAttribute("value",L.value),w==="print")break;D.addEventListener("input",C=>{f.setValue(T,{value:C.target.value})})}break;case"select":if(L.value!==null)for(const C of A.children)C.attributes.value===L.value&&(C.attributes.selected=!0);D.addEventListener("input",C=>{const S=C.target.options,h=S.selectedIndex===-1?"":S[S.selectedIndex].value;f.setValue(T,{value:h})});break}}static setAttributes({html:D,element:T,storage:A=null,intent:f,linkService:w}){const{attributes:L}=T,C=D instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${f}`);for(const[S,h]of Object.entries(L))if(h!=null)switch(S){case"class":h.length&&D.setAttribute(S,h.join(" "));break;case"dataId":break;case"id":D.setAttribute("data-element-id",h);break;case"style":Object.assign(D.style,h);break;case"textContent":D.textContent=h;break;default:(!C||S!=="href"&&S!=="newWindow")&&D.setAttribute(S,h)}C&&w.addLinkAttributes(D,L.href,L.newWindow),A&&L.dataId&&this.setupStorage(D,L.dataId,T,A)}static render(D){var e;const T=D.annotationStorage,A=D.linkService,f=D.xfaHtml,w=D.intent||"display",L=document.createElement(f.name);f.attributes&&this.setAttributes({html:L,element:f,intent:w,linkService:A});const C=[[f,-1,L]],S=D.div;if(S.append(L),D.viewport){const i=`matrix(${D.viewport.transform.join(",")})`;S.style.transform=i}w!=="richText"&&S.setAttribute("class","xfaLayer xfaFont");const h=[];for(;C.length>0;){const[i,l,b]=C.at(-1);if(l+1===i.children.length){C.pop();continue}const v=i.children[++C.at(-1)[1]];if(v===null)continue;const{name:c}=v;if(c==="#text"){const s=document.createTextNode(v.value);h.push(s),b.append(s);continue}let r;if((e=v==null?void 0:v.attributes)!=null&&e.xmlns?r=document.createElementNS(v.attributes.xmlns,c):r=document.createElement(c),b.append(r),v.attributes&&this.setAttributes({html:r,element:v,storage:T,intent:w,linkService:A}),v.children&&v.children.length>0)C.push([v,-1,r]);else if(v.value){const s=document.createTextNode(v.value);t.XfaText.shouldBuildText(c)&&h.push(s),r.append(s)}}for(const i of S.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))i.setAttribute("readOnly",!0);return{textDivs:h}}static update(D){const T=`matrix(${D.viewport.transform.join(",")})`;D.div.style.transform=T,D.div.hidden=!1}}n.XfaLayer=a},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=b;var t=y(1),a=y(8);const F=1e5,D=30,T=.8,A=new Map,f=/^\s+$/g;function w(v,c){const r=A.get(v);if(r)return r;c.save(),c.font=`${D}px ${v}`;const s=c.measureText("");let g=s.fontBoundingBoxAscent,k=Math.abs(s.fontBoundingBoxDescent);if(g){c.restore();const m=g/(g+k);return A.set(v,m),m}c.strokeStyle="red",c.clearRect(0,0,D,D),c.strokeText("g",0,0);let E=c.getImageData(0,0,D,D).data;k=0;for(let m=E.length-1-3;m>=0;m-=4)if(E[m]>0){k=Math.ceil(m/4/D);break}c.clearRect(0,0,D,D),c.strokeText("A",0,D),E=c.getImageData(0,0,D,D).data,g=0;for(let m=0,M=E.length;m<M;m+=4)if(E[m]>0){g=D-Math.floor(m/4/D);break}if(c.restore(),g){const m=g/(g+k);return A.set(v,m),m}return A.set(v,T),T}function L(v,c,r,s){const g=document.createElement("span"),k=v._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:c.str!=="",hasEOL:c.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:c.str!=="",hasEOL:c.hasEOL,fontSize:0};v._textDivs.push(g);const E=t.Util.transform(v._viewport.transform,c.transform);let m=Math.atan2(E[1],E[0]);const M=r[c.fontName];M.vertical&&(m+=Math.PI/2);const ee=Math.hypot(E[2],E[3]),ie=ee*w(M.fontFamily,s);let Q,K;m===0?(Q=E[4],K=E[5]-ie):(Q=E[4]+ie*Math.sin(m),K=E[5]-ie*Math.cos(m)),g.style.left=`${Q}px`,g.style.top=`${K}px`,g.style.fontSize=`${ee}px`,g.style.fontFamily=M.fontFamily,k.fontSize=ee,g.setAttribute("role","presentation"),g.textContent=c.str,g.dir=c.dir,v._fontInspectorEnabled&&(g.dataset.fontName=c.fontName),m!==0&&(k.angle=m*(180/Math.PI));let G=!1;if(c.str.length>1||v._enhanceTextSelection&&f.test(c.str))G=!0;else if(c.str!==" "&&c.transform[0]!==c.transform[3]){const $=Math.abs(c.transform[0]),Y=Math.abs(c.transform[3]);$!==Y&&Math.max($,Y)/Math.min($,Y)>1.5&&(G=!0)}if(G&&(M.vertical?k.canvasWidth=c.height*v._viewport.scale:k.canvasWidth=c.width*v._viewport.scale),v._textDivProperties.set(g,k),v._textContentStream&&v._layoutText(g),v._enhanceTextSelection&&k.hasText){let $=1,Y=0;m!==0&&($=Math.cos(m),Y=Math.sin(m));const ne=(M.vertical?c.height:c.width)*v._viewport.scale,ce=ee;let _e,W;m!==0?(_e=[$,Y,-Y,$,Q,K],W=t.Util.getAxialAlignedBoundingBox([0,0,ne,ce],_e)):W=[Q,K,Q+ne,K+ce],v._bounds.push({left:W[0],top:W[1],right:W[2],bottom:W[3],div:g,size:[ne,ce],m:_e})}}function C(v){if(v._canceled)return;const c=v._textDivs,r=v._capability,s=c.length;if(s>F){v._renderingDone=!0,r.resolve();return}if(!v._textContentStream)for(let g=0;g<s;g++)v._layoutText(c[g]);v._renderingDone=!0,r.resolve()}function S(v,c,r){let s=0;for(let g=0;g<r;g++){const k=v[c++];k>0&&(s=s?Math.min(k,s):k)}return s}function h(v){const c=v._bounds,r=v._viewport,s=e(r.width,r.height,c);for(let g=0;g<s.length;g++){const k=c[g].div,E=v._textDivProperties.get(k);if(E.angle===0){E.paddingLeft=c[g].left-s[g].left,E.paddingTop=c[g].top-s[g].top,E.paddingRight=s[g].right-c[g].right,E.paddingBottom=s[g].bottom-c[g].bottom,v._textDivProperties.set(k,E);continue}const m=s[g],M=c[g],ee=M.m,ie=ee[0],Q=ee[1],K=[[0,0],[0,M.size[1]],[M.size[0],0],M.size],G=new Float64Array(64);for(let Y=0,ne=K.length;Y<ne;Y++){const ce=t.Util.applyTransform(K[Y],ee);G[Y+0]=ie&&(m.left-ce[0])/ie,G[Y+4]=Q&&(m.top-ce[1])/Q,G[Y+8]=ie&&(m.right-ce[0])/ie,G[Y+12]=Q&&(m.bottom-ce[1])/Q,G[Y+16]=Q&&(m.left-ce[0])/-Q,G[Y+20]=ie&&(m.top-ce[1])/ie,G[Y+24]=Q&&(m.right-ce[0])/-Q,G[Y+28]=ie&&(m.bottom-ce[1])/ie,G[Y+32]=ie&&(m.left-ce[0])/-ie,G[Y+36]=Q&&(m.top-ce[1])/-Q,G[Y+40]=ie&&(m.right-ce[0])/-ie,G[Y+44]=Q&&(m.bottom-ce[1])/-Q,G[Y+48]=Q&&(m.left-ce[0])/Q,G[Y+52]=ie&&(m.top-ce[1])/-ie,G[Y+56]=Q&&(m.right-ce[0])/Q,G[Y+60]=ie&&(m.bottom-ce[1])/-ie}const $=1+Math.min(Math.abs(ie),Math.abs(Q));E.paddingLeft=S(G,32,16)/$,E.paddingTop=S(G,48,16)/$,E.paddingRight=S(G,0,16)/$,E.paddingBottom=S(G,16,16)/$,v._textDivProperties.set(k,E)}}function e(v,c,r){const s=r.map(function(k,E){return{x1:k.left,y1:k.top,x2:k.right,y2:k.bottom,index:E,x1New:void 0,x2New:void 0}});i(v,s);const g=new Array(r.length);for(const k of s){const E=k.index;g[E]={left:k.x1New,top:0,right:k.x2New,bottom:0}}r.map(function(k,E){const m=g[E],M=s[E];M.x1=k.top,M.y1=v-m.right,M.x2=k.bottom,M.y2=v-m.left,M.index=E,M.x1New=void 0,M.x2New=void 0}),i(c,s);for(const k of s){const E=k.index;g[E].top=k.x1New,g[E].bottom=k.x2New}return g}function i(v,c){c.sort(function(g,k){return g.x1-k.x1||g.index-k.index});const s=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const g of c){let k=0;for(;k<s.length&&s[k].end<=g.y1;)k++;let E=s.length-1;for(;E>=0&&s[E].start>=g.y2;)E--;let m,M,ee,ie,Q=-1/0;for(ee=k;ee<=E;ee++){m=s[ee],M=m.boundary;let $;M.x2>g.x1?$=M.index>g.index?M.x1New:g.x1:M.x2New===void 0?$=(M.x2+g.x1)/2:$=M.x2New,$>Q&&(Q=$)}for(g.x1New=Q,ee=k;ee<=E;ee++)m=s[ee],M=m.boundary,M.x2New===void 0?M.x2>g.x1?M.index>g.index&&(M.x2New=M.x2):M.x2New=Q:M.x2New>Q&&(M.x2New=Math.max(Q,M.x2));const K=[];let G=null;for(ee=k;ee<=E;ee++){m=s[ee],M=m.boundary;const $=M.x2>g.x2?M:g;G===$?K.at(-1).end=m.end:(K.push({start:m.start,end:m.end,boundary:$}),G=$)}for(s[k].start<g.y1&&(K[0].start=g.y1,K.unshift({start:s[k].start,end:g.y1,boundary:s[k].boundary})),g.y2<s[E].end&&(K.at(-1).end=g.y2,K.push({start:g.y2,end:s[E].end,boundary:s[E].boundary})),ee=k;ee<=E;ee++){if(m=s[ee],M=m.boundary,M.x2New!==void 0)continue;let $=!1;for(ie=k-1;!$&&ie>=0&&s[ie].start>=M.y1;ie--)$=s[ie].boundary===M;for(ie=E+1;!$&&ie<s.length&&s[ie].end<=M.y2;ie++)$=s[ie].boundary===M;for(ie=0;!$&&ie<K.length;ie++)$=K[ie].boundary===M;$||(M.x2New=Q)}Array.prototype.splice.apply(s,[k,E-k+1,...K])}for(const g of s){const k=g.boundary;k.x2New===void 0&&(k.x2New=Math.max(v,k.x2))}}class l{constructor({textContent:c,textContentStream:r,container:s,viewport:g,textDivs:k,textContentItemsStr:E,enhanceTextSelection:m}){var M;m&&(0,a.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=c,this._textContentStream=r,this._container=s,this._document=s.ownerDocument,this._viewport=g,this._textDivs=k||[],this._textContentItemsStr=E||[],this._enhanceTextSelection=!!m,this._fontInspectorEnabled=!!((M=globalThis.FontInspector)!=null&&M.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,t.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(c,r){for(let s=0,g=c.length;s<g;s++){if(c[s].str===void 0){if(c[s].type==="beginMarkedContentProps"||c[s].type==="beginMarkedContent"){const k=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),c[s].id!==null&&this._container.setAttribute("id",`${c[s].id}`),k.append(this._container)}else c[s].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(c[s].str),L(this,c[s],r,this._layoutTextCtx)}}_layoutText(c){const r=this._textDivProperties.get(c);let s="";if(r.canvasWidth!==0&&r.hasText){const{fontFamily:g}=c.style,{fontSize:k}=r;(k!==this._layoutTextLastFontSize||g!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${k*this._devicePixelRatio}px ${g}`,this._layoutTextLastFontSize=k,this._layoutTextLastFontFamily=g);const{width:E}=this._layoutTextCtx.measureText(c.textContent);if(E>0){const m=this._devicePixelRatio*r.canvasWidth/E;this._enhanceTextSelection&&(r.scale=m),s=`scaleX(${m})`}}if(r.angle!==0&&(s=`rotate(${r.angle}deg) ${s}`),s.length>0&&(this._enhanceTextSelection&&(r.originalTransform=s),c.style.transform=s),r.hasText&&this._container.append(c),r.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this._container.append(g)}}_render(c=0){const r=(0,t.createPromiseCapability)();let s=Object.create(null);const g=this._document.createElement("canvas");if(g.height=g.width=D,this._layoutTextCtx=g.getContext("2d",{alpha:!1}),this._textContent){const k=this._textContent.items,E=this._textContent.styles;this._processItems(k,E),r.resolve()}else if(this._textContentStream){const k=()=>{this._reader.read().then(({value:E,done:m})=>{if(m){r.resolve();return}Object.assign(s,E.styles),this._processItems(E.items,s),k()},r.reject)};this._reader=this._textContentStream.getReader(),k()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');r.promise.then(()=>{s=null,c?this._renderTimer=setTimeout(()=>{C(this),this._renderTimer=null},c):C(this)},this._capability.reject)}expandTextDivs(c=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(h(this),this._bounds=null);const r=[],s=[];for(let g=0,k=this._textDivs.length;g<k;g++){const E=this._textDivs[g],m=this._textDivProperties.get(E);m.hasText&&(c?(r.length=0,s.length=0,m.originalTransform&&r.push(m.originalTransform),m.paddingTop>0?(s.push(`${m.paddingTop}px`),r.push(`translateY(${-m.paddingTop}px)`)):s.push(0),m.paddingRight>0?s.push(`${m.paddingRight/m.scale}px`):s.push(0),m.paddingBottom>0?s.push(`${m.paddingBottom}px`):s.push(0),m.paddingLeft>0?(s.push(`${m.paddingLeft/m.scale}px`),r.push(`translateX(${-m.paddingLeft/m.scale}px)`)):s.push(0),E.style.padding=s.join(" "),r.length&&(E.style.transform=r.join(" "))):(E.style.padding=null,E.style.transform=m.originalTransform))}}}n.TextLayerRenderTask=l;function b(v){const c=new l({textContent:v.textContent,textContentStream:v.textContentStream,container:v.container,viewport:v.viewport,textDivs:v.textDivs,textContentItemsStr:v.textContentItemsStr,enhanceTextSelection:v.enhanceTextSelection});return c._render(v.timeout),c}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var t=y(8),a=y(1),F=y(3);let D=class{constructor(){(0,a.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=D;{let e=function(r){let s=[];const g=[];for(const k of r){if(k.fn==="save"){s.push({fnId:92,fn:"group",items:[]}),g.push(s),s=s.at(-1).items;continue}k.fn==="restore"?s=g.pop():s.push(k)}return s},i=function(r){if(Number.isInteger(r))return r.toString();const s=r.toFixed(10);let g=s.length-1;if(s[g]!=="0")return s;do g--;while(s[g]==="0");return s.substring(0,s[g]==="."?g:g+1)},l=function(r){if(r[4]===0&&r[5]===0){if(r[1]===0&&r[2]===0)return r[0]===1&&r[3]===1?"":`scale(${i(r[0])} ${i(r[3])})`;if(r[0]===r[3]&&r[1]===-r[2]){const s=Math.acos(r[0])*180/Math.PI;return`rotate(${i(s)})`}}else if(r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1)return`translate(${i(r[4])} ${i(r[5])})`;return`matrix(${i(r[0])} ${i(r[1])} ${i(r[2])} ${i(r[3])} ${i(r[4])} ${i(r[5])})`};const T={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},A="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",w=["butt","round","square"],L=["miter","round","bevel"],C=function(r,s="",g=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!g)return URL.createObjectURL(new Blob([r],{type:s}));const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let E=`data:${s};base64,`;for(let m=0,M=r.length;m<M;m+=3){const ee=r[m]&255,ie=r[m+1]&255,Q=r[m+2]&255,K=ee>>2,G=(ee&3)<<4|ie>>4,$=m+1<M?(ie&15)<<2|Q>>6:64,Y=m+2<M?Q&63:64;E+=k[K]+k[G]+k[$]+k[Y]}return E},S=function(){const r=new Uint8Array([137,80,78,71,13,10,26,10]),s=12,g=new Int32Array(256);for(let Q=0;Q<256;Q++){let K=Q;for(let G=0;G<8;G++)K&1?K=3988292384^K>>1&2147483647:K=K>>1&2147483647;g[Q]=K}function k(Q,K,G){let $=-1;for(let Y=K;Y<G;Y++){const ne=($^Q[Y])&255,ce=g[ne];$=$>>>8^ce}return $^-1}function E(Q,K,G,$){let Y=$;const ne=K.length;G[Y]=ne>>24&255,G[Y+1]=ne>>16&255,G[Y+2]=ne>>8&255,G[Y+3]=ne&255,Y+=4,G[Y]=Q.charCodeAt(0)&255,G[Y+1]=Q.charCodeAt(1)&255,G[Y+2]=Q.charCodeAt(2)&255,G[Y+3]=Q.charCodeAt(3)&255,Y+=4,G.set(K,Y),Y+=K.length;const ce=k(G,$+4,Y);G[Y]=ce>>24&255,G[Y+1]=ce>>16&255,G[Y+2]=ce>>8&255,G[Y+3]=ce&255}function m(Q,K,G){let $=1,Y=0;for(let ne=K;ne<G;++ne)$=($+(Q[ne]&255))%65521,Y=(Y+$)%65521;return Y<<16|$}function M(Q){if(!F.isNodeJS)return ee(Q);try{let K;parseInt(process.versions.node)>=8?K=Q:K=Buffer.from(Q);const G=require$$5.deflateSync(K,{level:9});return G instanceof Uint8Array?G:new Uint8Array(G)}catch(K){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+K)}return ee(Q)}function ee(Q){let K=Q.length;const G=65535,$=Math.ceil(K/G),Y=new Uint8Array(2+K+$*5+4);let ne=0;Y[ne++]=120,Y[ne++]=156;let ce=0;for(;K>G;)Y[ne++]=0,Y[ne++]=255,Y[ne++]=255,Y[ne++]=0,Y[ne++]=0,Y.set(Q.subarray(ce,ce+G),ne),ne+=G,ce+=G,K-=G;Y[ne++]=1,Y[ne++]=K&255,Y[ne++]=K>>8&255,Y[ne++]=~K&65535&255,Y[ne++]=(~K&65535)>>8&255,Y.set(Q.subarray(ce),ne),ne+=Q.length-ce;const _e=m(Q,0,Q.length);return Y[ne++]=_e>>24&255,Y[ne++]=_e>>16&255,Y[ne++]=_e>>8&255,Y[ne++]=_e&255,Y}function ie(Q,K,G,$){const Y=Q.width,ne=Q.height;let ce,_e,W;const d=Q.data;switch(K){case a.ImageKind.GRAYSCALE_1BPP:_e=0,ce=1,W=Y+7>>3;break;case a.ImageKind.RGB_24BPP:_e=2,ce=8,W=Y*3;break;case a.ImageKind.RGBA_32BPP:_e=6,ce=8,W=Y*4;break;default:throw new Error("invalid format")}const u=new Uint8Array((1+W)*ne);let R=0,j=0;for(let p=0;p<ne;++p)u[R++]=0,u.set(d.subarray(j,j+W),R),j+=W,R+=W;if(K===a.ImageKind.GRAYSCALE_1BPP&&$){R=0;for(let p=0;p<ne;p++){R++;for(let _=0;_<W;_++)u[R++]^=255}}const U=new Uint8Array([Y>>24&255,Y>>16&255,Y>>8&255,Y&255,ne>>24&255,ne>>16&255,ne>>8&255,ne&255,ce,_e,0,0,0]),B=M(u),V=r.length+s*3+U.length+B.length,X=new Uint8Array(V);let o=0;return X.set(r,o),o+=r.length,E("IHDR",U,X,o),o+=s+U.length,E("IDATA",B,X,o),o+=s+B.length,E("IEND",new Uint8Array(0),X,o),C(X,"image/png",G)}return function(K,G,$){const Y=K.kind===void 0?a.ImageKind.GRAYSCALE_1BPP:K.kind;return ie(K,Y,G,$)}}();class h{constructor(){this.fontSizeScale=1,this.fontWeight=T.fontWeight,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=T.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(s,g){this.x=s,this.y=g}}let b=0,v=0,c=0;n.SVGGraphics=D=class{constructor(r,s,g=!1){(0,t.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new t.DOMSVGFactory,this.current=new h,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=r,this.objs=s,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!g,this._operatorIdMapping=[];for(const k in a.OPS)this._operatorIdMapping[a.OPS[k]]=k}save(){this.transformStack.push(this.transformMatrix);const r=this.current;this.extraStack.push(r),this.current=r.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(r){this.save(),this.executeOpTree(r),this.restore()}loadDependencies(r){const s=r.fnArray,g=r.argsArray;for(let k=0,E=s.length;k<E;k++)if(s[k]===a.OPS.dependency)for(const m of g[k]){const M=m.startsWith("g_")?this.commonObjs:this.objs,ee=new Promise(ie=>{M.get(m,ie)});this.current.dependencies.push(ee)}return Promise.all(this.current.dependencies)}transform(r,s,g,k,E,m){const M=[r,s,g,k,E,m];this.transformMatrix=a.Util.transform(this.transformMatrix,M),this.tgrp=null}getSVG(r,s){this.viewport=s;const g=this._initialize(s);return this.loadDependencies(r).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(r)),g))}convertOpList(r){const s=this._operatorIdMapping,g=r.argsArray,k=r.fnArray,E=[];for(let m=0,M=k.length;m<M;m++){const ee=k[m];E.push({fnId:ee,fn:s[ee],args:g[m]})}return e(E)}executeOpTree(r){for(const s of r){const g=s.fn,k=s.fnId,E=s.args;switch(k|0){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(E);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(E[0],E[1]);break;case a.OPS.setFont:this.setFont(E);break;case a.OPS.showText:this.showText(E[0]);break;case a.OPS.showSpacedText:this.showText(E[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(E[0],E[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(E[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(E[0]);break;case a.OPS.setHScale:this.setHScale(E[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(E[0],E[1],E[2],E[3],E[4],E[5]);break;case a.OPS.setTextRise:this.setTextRise(E[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(E[0]);break;case a.OPS.setLineWidth:this.setLineWidth(E[0]);break;case a.OPS.setLineJoin:this.setLineJoin(E[0]);break;case a.OPS.setLineCap:this.setLineCap(E[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(E[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(E[0],E[1],E[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(E[0],E[1],E[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(E);break;case a.OPS.setFillColorN:this.setFillColorN(E);break;case a.OPS.shadingFill:this.shadingFill(E[0]);break;case a.OPS.setDash:this.setDash(E[0],E[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(E[0]);break;case a.OPS.setFlatness:this.setFlatness(E[0]);break;case a.OPS.setGState:this.setGState(E[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(E[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(E[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(E[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(E[0],E[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(E[0],E[1],E[2],E[3],E[4],E[5]);break;case a.OPS.constructPath:this.constructPath(E[0],E[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(s.items);break;default:(0,a.warn)(`Unimplemented operator ${g}`);break}}}setWordSpacing(r){this.current.wordSpacing=r}setCharSpacing(r){this.current.charSpacing=r}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(r,s,g,k,E,m){const M=this.current;M.textMatrix=M.lineMatrix=[r,s,g,k,E,m],M.textMatrixScale=Math.hypot(r,s),M.x=M.lineX=0,M.y=M.lineY=0,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${i(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",i(-M.y)),M.txtElement=this.svgFactory.createElement("svg:text"),M.txtElement.append(M.tspan)}beginText(){const r=this.current;r.x=r.lineX=0,r.y=r.lineY=0,r.textMatrix=a.IDENTITY_MATRIX,r.lineMatrix=a.IDENTITY_MATRIX,r.textMatrixScale=1,r.tspan=this.svgFactory.createElement("svg:tspan"),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtgrp=this.svgFactory.createElement("svg:g"),r.xcoords=[],r.ycoords=[]}moveText(r,s){const g=this.current;g.x=g.lineX+=r,g.y=g.lineY+=s,g.xcoords=[],g.ycoords=[],g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${i(g.fontSize)}px`),g.tspan.setAttributeNS(null,"y",i(-g.y))}showText(r){const s=this.current,g=s.font,k=s.fontSize;if(k===0)return;const E=s.fontSizeScale,m=s.charSpacing,M=s.wordSpacing,ee=s.fontDirection,ie=s.textHScale*ee,Q=g.vertical,K=Q?1:-1,G=g.defaultVMetrics,$=k*s.fontMatrix[0];let Y=0;for(const _e of r){if(_e===null){Y+=ee*M;continue}else if(typeof _e=="number"){Y+=K*_e*k/1e3;continue}const W=(_e.isSpace?M:0)+m,d=_e.fontChar;let u,R,j=_e.width;if(Q){let B;const V=_e.vmetric||G;B=_e.vmetric?V[1]:j*.5,B=-B*$;const X=V[2]*$;j=V?-V[0]:j,u=B/E,R=(Y+X)/E}else u=Y/E,R=0;(_e.isInFont||g.missingFile)&&(s.xcoords.push(s.x+u),Q&&s.ycoords.push(-s.y+R),s.tspan.textContent+=d);let U;Q?U=j*$-W*ee:U=j*$+W*ee,Y+=U}s.tspan.setAttributeNS(null,"x",s.xcoords.map(i).join(" ")),Q?s.tspan.setAttributeNS(null,"y",s.ycoords.map(i).join(" ")):s.tspan.setAttributeNS(null,"y",i(-s.y)),Q?s.y-=Y:s.x+=Y*ie,s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${i(s.fontSize)}px`),s.fontStyle!==T.fontStyle&&s.tspan.setAttributeNS(null,"font-style",s.fontStyle),s.fontWeight!==T.fontWeight&&s.tspan.setAttributeNS(null,"font-weight",s.fontWeight);const ne=s.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(ne===a.TextRenderingMode.FILL||ne===a.TextRenderingMode.FILL_STROKE?(s.fillColor!==T.fillColor&&s.tspan.setAttributeNS(null,"fill",s.fillColor),s.fillAlpha<1&&s.tspan.setAttributeNS(null,"fill-opacity",s.fillAlpha)):s.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?s.tspan.setAttributeNS(null,"fill","transparent"):s.tspan.setAttributeNS(null,"fill","none"),ne===a.TextRenderingMode.STROKE||ne===a.TextRenderingMode.FILL_STROKE){const _e=1/(s.textMatrixScale||1);this._setStrokeAttributes(s.tspan,_e)}let ce=s.textMatrix;s.textRise!==0&&(ce=ce.slice(),ce[5]+=s.textRise),s.txtElement.setAttributeNS(null,"transform",`${l(ce)} scale(${i(ie)}, -1)`),s.txtElement.setAttributeNS(A,"xml:space","preserve"),s.txtElement.append(s.tspan),s.txtgrp.append(s.txtElement),this._ensureTransformGroup().append(s.txtElement)}setLeadingMoveText(r,s){this.setLeading(-s),this.moveText(r,s)}addFontStyle(r){if(!r.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const s=C(r.data,r.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${r.loadedName}"; src: url(${s}); }
`}setFont(r){const s=this.current,g=this.commonObjs.get(r[0]);let k=r[1];s.font=g,this.embedFonts&&!g.missingFile&&!this.embeddedFonts[g.loadedName]&&(this.addFontStyle(g),this.embeddedFonts[g.loadedName]=g),s.fontMatrix=g.fontMatrix||a.FONT_IDENTITY_MATRIX;let E="normal";g.black?E="900":g.bold&&(E="bold");const m=g.italic?"italic":"normal";k<0?(k=-k,s.fontDirection=-1):s.fontDirection=1,s.fontSize=k,s.fontFamily=g.loadedName,s.fontWeight=E,s.fontStyle=m,s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"y",i(-s.y)),s.xcoords=[],s.ycoords=[]}endText(){var s;const r=this.current;r.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&((s=r.txtElement)!=null&&s.hasChildNodes())&&(r.element=r.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(r){r>0&&(this.current.lineWidth=r)}setLineCap(r){this.current.lineCap=w[r]}setLineJoin(r){this.current.lineJoin=L[r]}setMiterLimit(r){this.current.miterLimit=r}setStrokeAlpha(r){this.current.strokeAlpha=r}setStrokeRGBColor(r,s,g){this.current.strokeColor=a.Util.makeHexColor(r,s,g)}setFillAlpha(r){this.current.fillAlpha=r}setFillRGBColor(r,s,g){this.current.fillColor=a.Util.makeHexColor(r,s,g),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(r){this.current.strokeColor=this._makeColorN_Pattern(r)}setFillColorN(r){this.current.fillColor=this._makeColorN_Pattern(r)}shadingFill(r){const s=this.viewport.width,g=this.viewport.height,k=a.Util.inverseTransform(this.transformMatrix),E=a.Util.applyTransform([0,0],k),m=a.Util.applyTransform([0,g],k),M=a.Util.applyTransform([s,0],k),ee=a.Util.applyTransform([s,g],k),ie=Math.min(E[0],m[0],M[0],ee[0]),Q=Math.min(E[1],m[1],M[1],ee[1]),K=Math.max(E[0],m[0],M[0],ee[0]),G=Math.max(E[1],m[1],M[1],ee[1]),$=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x",ie),$.setAttributeNS(null,"y",Q),$.setAttributeNS(null,"width",K-ie),$.setAttributeNS(null,"height",G-Q),$.setAttributeNS(null,"fill",this._makeShadingPattern(r)),this.current.fillAlpha<1&&$.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append($)}_makeColorN_Pattern(r){return r[0]==="TilingPattern"?this._makeTilingPattern(r):this._makeShadingPattern(r)}_makeTilingPattern(r){const s=r[1],g=r[2],k=r[3]||a.IDENTITY_MATRIX,[E,m,M,ee]=r[4],ie=r[5],Q=r[6],K=r[7],G=`shading${c++}`,[$,Y,ne,ce]=a.Util.normalizeRect([...a.Util.applyTransform([E,m],k),...a.Util.applyTransform([M,ee],k)]),[_e,W]=a.Util.singularValueDecompose2dScale(k),d=ie*_e,u=Q*W,R=this.svgFactory.createElement("svg:pattern");R.setAttributeNS(null,"id",G),R.setAttributeNS(null,"patternUnits","userSpaceOnUse"),R.setAttributeNS(null,"width",d),R.setAttributeNS(null,"height",u),R.setAttributeNS(null,"x",`${$}`),R.setAttributeNS(null,"y",`${Y}`);const j=this.svg,U=this.transformMatrix,B=this.current.fillColor,V=this.current.strokeColor,X=this.svgFactory.create(ne-$,ce-Y);if(this.svg=X,this.transformMatrix=k,K===2){const o=a.Util.makeHexColor(...s);this.current.fillColor=o,this.current.strokeColor=o}return this.executeOpTree(this.convertOpList(g)),this.svg=j,this.transformMatrix=U,this.current.fillColor=B,this.current.strokeColor=V,R.append(X.childNodes[0]),this.defs.append(R),`url(#${G})`}_makeShadingPattern(r){switch(typeof r=="string"&&(r=this.objs.get(r)),r[0]){case"RadialAxial":const s=`shading${c++}`,g=r[3];let k;switch(r[1]){case"axial":const E=r[4],m=r[5];k=this.svgFactory.createElement("svg:linearGradient"),k.setAttributeNS(null,"id",s),k.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),k.setAttributeNS(null,"x1",E[0]),k.setAttributeNS(null,"y1",E[1]),k.setAttributeNS(null,"x2",m[0]),k.setAttributeNS(null,"y2",m[1]);break;case"radial":const M=r[4],ee=r[5],ie=r[6],Q=r[7];k=this.svgFactory.createElement("svg:radialGradient"),k.setAttributeNS(null,"id",s),k.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),k.setAttributeNS(null,"cx",ee[0]),k.setAttributeNS(null,"cy",ee[1]),k.setAttributeNS(null,"r",Q),k.setAttributeNS(null,"fx",M[0]),k.setAttributeNS(null,"fy",M[1]),k.setAttributeNS(null,"fr",ie);break;default:throw new Error(`Unknown RadialAxial type: ${r[1]}`)}for(const E of g){const m=this.svgFactory.createElement("svg:stop");m.setAttributeNS(null,"offset",E[0]),m.setAttributeNS(null,"stop-color",E[1]),k.append(m)}return this.defs.append(k),`url(#${s})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${r[0]}`)}}setDash(r,s){this.current.dashArray=r,this.current.dashPhase=s}constructPath(r,s){const g=this.current;let k=g.x,E=g.y,m=[],M=0;for(const ee of r)switch(ee|0){case a.OPS.rectangle:k=s[M++],E=s[M++];const ie=s[M++],Q=s[M++],K=k+ie,G=E+Q;m.push("M",i(k),i(E),"L",i(K),i(E),"L",i(K),i(G),"L",i(k),i(G),"Z");break;case a.OPS.moveTo:k=s[M++],E=s[M++],m.push("M",i(k),i(E));break;case a.OPS.lineTo:k=s[M++],E=s[M++],m.push("L",i(k),i(E));break;case a.OPS.curveTo:k=s[M+4],E=s[M+5],m.push("C",i(s[M]),i(s[M+1]),i(s[M+2]),i(s[M+3]),i(k),i(E)),M+=6;break;case a.OPS.curveTo2:m.push("C",i(k),i(E),i(s[M]),i(s[M+1]),i(s[M+2]),i(s[M+3])),k=s[M+2],E=s[M+3],M+=4;break;case a.OPS.curveTo3:k=s[M+2],E=s[M+3],m.push("C",i(s[M]),i(s[M+1]),i(k),i(E),i(k),i(E)),M+=4;break;case a.OPS.closePath:m.push("Z");break}m=m.join(" "),g.path&&r.length>0&&r[0]!==a.OPS.rectangle&&r[0]!==a.OPS.moveTo?m=g.path.getAttributeNS(null,"d")+m:(g.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(g.path)),g.path.setAttributeNS(null,"d",m),g.path.setAttributeNS(null,"fill","none"),g.element=g.path,g.setCurrentPoint(k,E)}endPath(){const r=this.current;if(r.path=null,!this.pendingClip)return;if(!r.element){this.pendingClip=null;return}const s=`clippath${b++}`,g=this.svgFactory.createElement("svg:clipPath");g.setAttributeNS(null,"id",s),g.setAttributeNS(null,"transform",l(this.transformMatrix));const k=r.element.cloneNode(!0);if(this.pendingClip==="evenodd"?k.setAttributeNS(null,"clip-rule","evenodd"):k.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,g.append(k),this.defs.append(g),r.activeClipUrl){r.clipGroup=null;for(const E of this.extraStack)E.clipGroup=null;g.setAttributeNS(null,"clip-path",r.activeClipUrl)}r.activeClipUrl=`url(#${s})`,this.tgrp=null}clip(r){this.pendingClip=r}closePath(){const r=this.current;if(r.path){const s=`${r.path.getAttributeNS(null,"d")}Z`;r.path.setAttributeNS(null,"d",s)}}setLeading(r){this.current.leading=-r}setTextRise(r){this.current.textRise=r}setTextRenderingMode(r){this.current.textRenderingMode=r}setHScale(r){this.current.textHScale=r/100}setRenderingIntent(r){}setFlatness(r){}setGState(r){for(const[s,g]of r)switch(s){case"LW":this.setLineWidth(g);break;case"LC":this.setLineCap(g);break;case"LJ":this.setLineJoin(g);break;case"ML":this.setMiterLimit(g);break;case"D":this.setDash(g[0],g[1]);break;case"RI":this.setRenderingIntent(g);break;case"FL":this.setFlatness(g);break;case"Font":this.setFont(g);break;case"CA":this.setStrokeAlpha(g);break;case"ca":this.setFillAlpha(g);break;default:(0,a.warn)(`Unimplemented graphic state operator ${s}`);break}}fill(){const r=this.current;r.element&&(r.element.setAttributeNS(null,"fill",r.fillColor),r.element.setAttributeNS(null,"fill-opacity",r.fillAlpha),this.endPath())}stroke(){const r=this.current;r.element&&(this._setStrokeAttributes(r.element),r.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(r,s=1){const g=this.current;let k=g.dashArray;s!==1&&k.length>0&&(k=k.map(function(E){return s*E})),r.setAttributeNS(null,"stroke",g.strokeColor),r.setAttributeNS(null,"stroke-opacity",g.strokeAlpha),r.setAttributeNS(null,"stroke-miterlimit",i(g.miterLimit)),r.setAttributeNS(null,"stroke-linecap",g.lineCap),r.setAttributeNS(null,"stroke-linejoin",g.lineJoin),r.setAttributeNS(null,"stroke-width",i(s*g.lineWidth)+"px"),r.setAttributeNS(null,"stroke-dasharray",k.map(i).join(" ")),r.setAttributeNS(null,"stroke-dashoffset",i(s*g.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","1px"),r.setAttributeNS(null,"height","1px"),r.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(r)}paintImageXObject(r){const s=r.startsWith("g_")?this.commonObjs.get(r):this.objs.get(r);if(!s){(0,a.warn)(`Dependent image with object ID ${r} is not ready yet`);return}this.paintInlineImageXObject(s)}paintInlineImageXObject(r,s){const g=r.width,k=r.height,E=S(r,this.forceDataSchema,!!s),m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y","0"),m.setAttributeNS(null,"width",i(g)),m.setAttributeNS(null,"height",i(k)),this.current.element=m,this.clip("nonzero");const M=this.svgFactory.createElement("svg:image");M.setAttributeNS(f,"xlink:href",E),M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y",i(-k)),M.setAttributeNS(null,"width",i(g)+"px"),M.setAttributeNS(null,"height",i(k)+"px"),M.setAttributeNS(null,"transform",`scale(${i(1/g)} ${i(-1/k)})`),s?s.append(M):this._ensureTransformGroup().append(M)}paintImageMaskXObject(r){const s=this.current,g=r.width,k=r.height,E=s.fillColor;s.maskId=`mask${v++}`;const m=this.svgFactory.createElement("svg:mask");m.setAttributeNS(null,"id",s.maskId);const M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y","0"),M.setAttributeNS(null,"width",i(g)),M.setAttributeNS(null,"height",i(k)),M.setAttributeNS(null,"fill",E),M.setAttributeNS(null,"mask",`url(#${s.maskId})`),this.defs.append(m),this._ensureTransformGroup().append(M),this.paintInlineImageXObject(r,m)}paintFormXObjectBegin(r,s){if(Array.isArray(r)&&r.length===6&&this.transform(r[0],r[1],r[2],r[3],r[4],r[5]),s){const g=s[2]-s[0],k=s[3]-s[1],E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x",s[0]),E.setAttributeNS(null,"y",s[1]),E.setAttributeNS(null,"width",i(g)),E.setAttributeNS(null,"height",i(k)),this.current.element=E,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(r){const s=this.svgFactory.create(r.width,r.height),g=this.svgFactory.createElement("svg:defs");s.append(g),this.defs=g;const k=this.svgFactory.createElement("svg:g");return k.setAttributeNS(null,"transform",l(r.transform)),s.append(k),this.svg=k,s}_ensureClipGroup(){if(!this.current.clipGroup){const r=this.svgFactory.createElement("svg:g");r.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(r),this.current.clipGroup=r}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",l(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var t=y(1),a=y(33);const F=require$$5,D=require$$5,T=require$$5,A=require$$5,f=/^file:\/\/\/[a-zA-Z]:\//;function w(v){const c=A.parse(v);return c.protocol==="file:"||c.host?c:/^[a-z]:[/\\]/i.test(v)?A.parse(`file:///${v}`):(c.host||(c.protocol="file:"),c)}class L{constructor(c){this.source=c,this.url=w(c.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&c.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var c;return((c=this._fullRequestReader)==null?void 0:c._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new l(this):new e(this),this._fullRequestReader}getRangeReader(c,r){if(r<=this._progressiveDataLength)return null;const s=this.isFsUrl?new b(this,c,r):new i(this,c,r);return this._rangeRequestReaders.push(s),s}cancelAllRequests(c){this._fullRequestReader&&this._fullRequestReader.cancel(c);for(const r of this._rangeRequestReaders.slice(0))r.cancel(c)}}n.PDFNodeStream=L;class C{constructor(c){this._url=c.url,this._done=!1,this._storedError=null,this.onProgress=null;const r=c.source;this._contentLength=r.length,this._loaded=0,this._filename=null,this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)(),this._headersCapability=(0,t.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const c=this._readableStream.read();return c===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=c.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(c).buffer,done:!1})}cancel(c){if(!this._readableStream){this._error(c);return}this._readableStream.destroy(c)}_error(c){this._storedError=c,this._readCapability.resolve()}_setReadableStream(c){this._readableStream=c,c.on("readable",()=>{this._readCapability.resolve()}),c.on("end",()=>{c.destroy(),this._done=!0,this._readCapability.resolve()}),c.on("error",r=>{this._error(r)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class S{constructor(c){this._url=c.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)();const r=c.source;this._isStreamingSupported=!r.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const c=this._readableStream.read();return c===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=c.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(c).buffer,done:!1})}cancel(c){if(!this._readableStream){this._error(c);return}this._readableStream.destroy(c)}_error(c){this._storedError=c,this._readCapability.resolve()}_setReadableStream(c){this._readableStream=c,c.on("readable",()=>{this._readCapability.resolve()}),c.on("end",()=>{c.destroy(),this._done=!0,this._readCapability.resolve()}),c.on("error",r=>{this._error(r)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function h(v,c){return{protocol:v.protocol,auth:v.auth,host:v.hostname,port:v.port,path:v.path,method:"GET",headers:c}}class e extends C{constructor(c){super(c);const r=s=>{if(s.statusCode===404){const m=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=m,this._headersCapability.reject(m);return}this._headersCapability.resolve(),this._setReadableStream(s);const g=m=>this._readableStream.headers[m.toLowerCase()],{allowRangeRequests:k,suggestedLength:E}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:c.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=k,this._contentLength=E||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(g)};this._request=null,this._url.protocol==="http:"?this._request=D.request(h(this._url,c.httpHeaders),r):this._request=T.request(h(this._url,c.httpHeaders),r),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class i extends S{constructor(c,r,s){super(c),this._httpHeaders={};for(const k in c.httpHeaders){const E=c.httpHeaders[k];typeof E>"u"||(this._httpHeaders[k]=E)}this._httpHeaders.Range=`bytes=${r}-${s-1}`;const g=k=>{if(k.statusCode===404){const E=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=E;return}this._setReadableStream(k)};this._request=null,this._url.protocol==="http:"?this._request=D.request(h(this._url,this._httpHeaders),g):this._request=T.request(h(this._url,this._httpHeaders),g),this._request.on("error",k=>{this._storedError=k}),this._request.end()}}class l extends C{constructor(c){super(c);let r=decodeURIComponent(this._url.path);f.test(this._url.href)&&(r=r.replace(/^\//,"")),F.lstat(r,(s,g)=>{if(s){s.code==="ENOENT"&&(s=new t.MissingPDFException(`Missing PDF "${r}".`)),this._storedError=s,this._headersCapability.reject(s);return}this._contentLength=g.size,this._setReadableStream(F.createReadStream(r)),this._headersCapability.resolve()})}}class b extends S{constructor(c,r,s){super(c);let g=decodeURIComponent(this._url.path);f.test(this._url.href)&&(g=g.replace(/^\//,"")),this._setReadableStream(F.createReadStream(g,{start:r,end:s-1}))}}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=A,n.extractFilenameFromHeader=T,n.validateRangeRequestCapabilities=D,n.validateResponseStatus=f;var t=y(1),a=y(34),F=y(8);function D({getResponseHeader:w,isHttp:L,rangeChunkSize:C,disableRange:S}){const h={allowRangeRequests:!1,suggestedLength:void 0},e=parseInt(w("Content-Length"),10);return!Number.isInteger(e)||(h.suggestedLength=e,e<=2*C)||S||!L||w("Accept-Ranges")!=="bytes"||(w("Content-Encoding")||"identity")!=="identity"||(h.allowRangeRequests=!0),h}function T(w){const L=w("Content-Disposition");if(L){let C=(0,a.getFilenameFromContentDispositionHeader)(L);if(C.includes("%"))try{C=decodeURIComponent(C)}catch{}if((0,F.isPdfFile)(C))return C}return null}function A(w,L){return w===404||w===0&&L.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+L+'".'):new t.UnexpectedResponseException(`Unexpected server response (${w}) while retrieving PDF "${L}".`,w)}function f(w){return w===200||w===206}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=a;var t=y(1);function a(F){let D=!0,T=A("filename\\*","i").exec(F);if(T){T=T[1];let e=C(T);return e=unescape(e),e=S(e),e=h(e),w(e)}if(T=L(F),T){const e=h(T);return w(e)}if(T=A("filename","i").exec(F),T){T=T[1];let e=C(T);return e=h(e),w(e)}function A(e,i){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',i)}function f(e,i){if(e){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const l=new TextDecoder(e,{fatal:!0}),b=(0,t.stringToBytes)(i);i=l.decode(b),D=!1}catch{}}return i}function w(e){return D&&/[\x80-\xff]/.test(e)&&(e=f("utf-8",e),D&&(e=f("iso-8859-1",e))),e}function L(e){const i=[];let l;const b=A("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(l=b.exec(e))!==null;){let[,c,r,s]=l;if(c=parseInt(c,10),c in i){if(c===0)break;continue}i[c]=[r,s]}const v=[];for(let c=0;c<i.length&&c in i;++c){let[r,s]=i[c];s=C(s),r&&(s=unescape(s),c===0&&(s=S(s))),v.push(s)}return v.join("")}function C(e){if(e.startsWith('"')){const i=e.slice(1).split('\\"');for(let l=0;l<i.length;++l){const b=i[l].indexOf('"');b!==-1&&(i[l]=i[l].slice(0,b),i.length=l+1),i[l]=i[l].replace(/\\(.)/g,"$1")}e=i.join('"')}return e}function S(e){const i=e.indexOf("'");if(i===-1)return e;const l=e.slice(0,i),v=e.slice(i+1).replace(/^[^']*'/,"");return f(l,v)}function h(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(i,l,b,v){if(b==="q"||b==="Q")return v=v.replace(/_/g," "),v=v.replace(/=([0-9a-fA-F]{2})/g,function(c,r){return String.fromCharCode(parseInt(r,16))}),f(l,v);try{v=atob(v)}catch{}return f(l,v)})}return""}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var t=y(1),a=y(33);const F=200,D=206;function T(C){const S=C.response;return typeof S!="string"?S:(0,t.stringToBytes)(S).buffer}class A{constructor(S,h={}){this.url=S,this.isHttp=/^https?:/i.test(S),this.httpHeaders=this.isHttp&&h.httpHeaders||Object.create(null),this.withCredentials=h.withCredentials||!1,this.getXhr=h.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(S,h,e){const i={begin:S,end:h};for(const l in e)i[l]=e[l];return this.request(i)}requestFull(S){return this.request(S)}request(S){const h=this.getXhr(),e=this.currXhrId++,i=this.pendingRequests[e]={xhr:h};h.open("GET",this.url),h.withCredentials=this.withCredentials;for(const l in this.httpHeaders){const b=this.httpHeaders[l];typeof b>"u"||h.setRequestHeader(l,b)}return this.isHttp&&"begin"in S&&"end"in S?(h.setRequestHeader("Range",`bytes=${S.begin}-${S.end-1}`),i.expectedStatus=D):i.expectedStatus=F,h.responseType="arraybuffer",S.onError&&(h.onerror=function(l){S.onError(h.status)}),h.onreadystatechange=this.onStateChange.bind(this,e),h.onprogress=this.onProgress.bind(this,e),i.onHeadersReceived=S.onHeadersReceived,i.onDone=S.onDone,i.onError=S.onError,i.onProgress=S.onProgress,h.send(null),e}onProgress(S,h){var i;const e=this.pendingRequests[S];e&&((i=e.onProgress)==null||i.call(e,h))}onStateChange(S,h){var c,r,s;const e=this.pendingRequests[S];if(!e)return;const i=e.xhr;if(i.readyState>=2&&e.onHeadersReceived&&(e.onHeadersReceived(),delete e.onHeadersReceived),i.readyState!==4||!(S in this.pendingRequests))return;if(delete this.pendingRequests[S],i.status===0&&this.isHttp){(c=e.onError)==null||c.call(e,i.status);return}const l=i.status||F;if(!(l===F&&e.expectedStatus===D)&&l!==e.expectedStatus){(r=e.onError)==null||r.call(e,i.status);return}const v=T(i);if(l===D){const g=i.getResponseHeader("Content-Range"),k=/bytes (\d+)-(\d+)\/(\d+)/.exec(g);e.onDone({begin:parseInt(k[1],10),chunk:v})}else v?e.onDone({begin:0,chunk:v}):(s=e.onError)==null||s.call(e,i.status)}getRequestXhr(S){return this.pendingRequests[S].xhr}isPendingRequest(S){return S in this.pendingRequests}abortRequest(S){const h=this.pendingRequests[S].xhr;delete this.pendingRequests[S],h.abort()}}class f{constructor(S){this._source=S,this._manager=new A(S.url,{httpHeaders:S.httpHeaders,withCredentials:S.withCredentials}),this._rangeChunkSize=S.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(S){const h=this._rangeRequestReaders.indexOf(S);h>=0&&this._rangeRequestReaders.splice(h,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new w(this._manager,this._source),this._fullRequestReader}getRangeReader(S,h){const e=new L(this._manager,S,h);return e.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(e),e}cancelAllRequests(S){var h;(h=this._fullRequestReader)==null||h.cancel(S);for(const e of this._rangeRequestReaders.slice(0))e.cancel(S)}}n.PDFNetworkStream=f;class w{constructor(S,h){this._manager=S;const e={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._fullRequestId=S.requestFull(e),this._headersReceivedCapability=(0,t.createPromiseCapability)(),this._disableRange=h.disableRange||!1,this._contentLength=h.length,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const S=this._fullRequestId,h=this._manager.getRequestXhr(S),e=b=>h.getResponseHeader(b),{allowRangeRequests:i,suggestedLength:l}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(e),this._isRangeSupported&&this._manager.abortRequest(S),this._headersReceivedCapability.resolve()}_onDone(S){if(S&&(this._requests.length>0?this._requests.shift().resolve({value:S.chunk,done:!1}):this._cachedChunks.push(S.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(S){this._storedError=(0,a.createResponseStatusError)(S,this._url),this._headersReceivedCapability.reject(this._storedError);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(S){var h;(h=this.onProgress)==null||h.call(this,{loaded:S.loaded,total:S.lengthComputable?S.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const S=(0,t.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0,this._headersReceivedCapability.reject(S);for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(S,h,e){this._manager=S;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=S.url,this._requestId=S.requestRange(h,e,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var S;(S=this.onClosed)==null||S.call(this,this)}_onDone(S){const h=S.chunk;this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunk=h,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(S){this._storedError=(0,a.createResponseStatusError)(S,this._url);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(S){var h;this.isStreamingSupported||(h=this.onProgress)==null||h.call(this,{loaded:S.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const S=(0,t.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(P,n,y)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var t=y(1),a=y(33);function F(w,L,C){return{method:"GET",headers:w,signal:C.signal,mode:"cors",credentials:L?"include":"same-origin",redirect:"follow"}}function D(w){const L=new Headers;for(const C in w){const S=w[C];typeof S>"u"||L.append(C,S)}return L}class T{constructor(L){this.source=L,this.isHttp=/^https?:/i.test(L.url),this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new A(this),this._fullRequestReader}getRangeReader(L,C){if(C<=this._progressiveDataLength)return null;const S=new f(this,L,C);return this._rangeRequestReaders.push(S),S}cancelAllRequests(L){this._fullRequestReader&&this._fullRequestReader.cancel(L);for(const C of this._rangeRequestReaders.slice(0))C.cancel(L)}}n.PDFFetchStream=T;class A{constructor(L){this._stream=L,this._reader=null,this._loaded=0,this._filename=null;const C=L.source;this._withCredentials=C.withCredentials||!1,this._contentLength=C.length,this._headersCapability=(0,t.createPromiseCapability)(),this._disableRange=C.disableRange||!1,this._rangeChunkSize=C.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!C.disableStream,this._isRangeSupported=!C.disableRange,this._headers=D(this._stream.httpHeaders);const S=C.url;fetch(S,F(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,a.validateResponseStatus)(h.status))throw(0,a.createResponseStatusError)(h.status,S);this._reader=h.body.getReader(),this._headersCapability.resolve();const e=b=>h.headers.get(b),{allowRangeRequests:i,suggestedLength:l}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=l||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(e),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:L,done:C}=await this._reader.read();return C?{value:L,done:C}:(this._loaded+=L.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){this._reader&&this._reader.cancel(L),this._abortController.abort()}}class f{constructor(L,C,S){this._stream=L,this._reader=null,this._loaded=0;const h=L.source;this._withCredentials=h.withCredentials||!1,this._readCapability=(0,t.createPromiseCapability)(),this._isStreamingSupported=!h.disableStream,this._abortController=new AbortController,this._headers=D(this._stream.httpHeaders),this._headers.append("Range",`bytes=${C}-${S-1}`);const e=h.url;fetch(e,F(this._headers,this._withCredentials,this._abortController)).then(i=>{if(!(0,a.validateResponseStatus)(i.status))throw(0,a.createResponseStatusError)(i.status,e);this._readCapability.resolve(),this._reader=i.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:L,done:C}=await this._reader.read();return C?{value:L,done:C}:(this._loaded+=L.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(L).buffer,done:!1})}cancel(L){this._reader&&this._reader.cancel(L),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(P){var n=__webpack_module_cache__[P];if(n!==void 0)return n.exports;var y=__webpack_module_cache__[P]={exports:{}};return __webpack_modules__[P](y,y.exports,__w_pdfjs_require__),y.exports}var __webpack_exports__={};return(()=>{var P=__webpack_exports__;Object.defineProperty(P,"__esModule",{value:!0}),Object.defineProperty(P,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(P,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(P,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(P,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return F.AnnotationEditorUIManager}}),Object.defineProperty(P,"AnnotationLayer",{enumerable:!0,get:function(){return D.AnnotationLayer}}),Object.defineProperty(P,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(P,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(P,"GlobalWorkerOptions",{enumerable:!0,get:function(){return T.GlobalWorkerOptions}}),Object.defineProperty(P,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(P,"LoopbackPort",{enumerable:!0,get:function(){return y.LoopbackPort}}),Object.defineProperty(P,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(P,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(P,"PDFDataRangeTransport",{enumerable:!0,get:function(){return y.PDFDataRangeTransport}}),Object.defineProperty(P,"PDFDateString",{enumerable:!0,get:function(){return t.PDFDateString}}),Object.defineProperty(P,"PDFWorker",{enumerable:!0,get:function(){return y.PDFWorker}}),Object.defineProperty(P,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(P,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(P,"PixelsPerInch",{enumerable:!0,get:function(){return t.PixelsPerInch}}),Object.defineProperty(P,"RenderingCancelledException",{enumerable:!0,get:function(){return t.RenderingCancelledException}}),Object.defineProperty(P,"SVGGraphics",{enumerable:!0,get:function(){return w.SVGGraphics}}),Object.defineProperty(P,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return n.UNSUPPORTED_FEATURES}}),Object.defineProperty(P,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(P,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(P,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(P,"XfaLayer",{enumerable:!0,get:function(){return L.XfaLayer}}),Object.defineProperty(P,"build",{enumerable:!0,get:function(){return y.build}}),Object.defineProperty(P,"createPromiseCapability",{enumerable:!0,get:function(){return n.createPromiseCapability}}),Object.defineProperty(P,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(P,"getDocument",{enumerable:!0,get:function(){return y.getDocument}}),Object.defineProperty(P,"getFilenameFromUrl",{enumerable:!0,get:function(){return t.getFilenameFromUrl}}),Object.defineProperty(P,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return t.getPdfFilenameFromUrl}}),Object.defineProperty(P,"getXfaPageViewport",{enumerable:!0,get:function(){return t.getXfaPageViewport}}),Object.defineProperty(P,"isPdfFile",{enumerable:!0,get:function(){return t.isPdfFile}}),Object.defineProperty(P,"loadScript",{enumerable:!0,get:function(){return t.loadScript}}),Object.defineProperty(P,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(P,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(P,"version",{enumerable:!0,get:function(){return y.version}});var n=__w_pdfjs_require__(1),y=__w_pdfjs_require__(4),t=__w_pdfjs_require__(8),a=__w_pdfjs_require__(22),F=__w_pdfjs_require__(7),D=__w_pdfjs_require__(27),T=__w_pdfjs_require__(15),A=__w_pdfjs_require__(3),f=__w_pdfjs_require__(30),w=__w_pdfjs_require__(31),L=__w_pdfjs_require__(29);if(A.isNodeJS){const{PDFNodeStream:C}=__w_pdfjs_require__(32);(0,y.setPDFNetworkStreamFactory)(S=>new C(S))}else{const{PDFNetworkStream:C}=__w_pdfjs_require__(35),{PDFFetchStream:S}=__w_pdfjs_require__(36);(0,y.setPDFNetworkStreamFactory)(h=>(0,t.isValidFetchUrl)(h.url)?new S(h):new C(h))}})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;function _objectWithoutProperties(P,n){if(P==null)return{};var y=_objectWithoutPropertiesLoose(P,n),t,a;if(Object.getOwnPropertySymbols){var F=Object.getOwnPropertySymbols(P);for(a=0;a<F.length;a++)t=F[a],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(P,t)&&(y[t]=P[t])}return y}function _typeof(P){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(P)}function _classCallCheck(P,n){if(!(P instanceof n))throw new TypeError("Cannot call a class as a function")}function _toPrimitive(P,n){if(_typeof(P)!=="object"||P===null)return P;var y=P[Symbol.toPrimitive];if(y!==void 0){var t=y.call(P,n||"default");if(_typeof(t)!=="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(P)}function _toPropertyKey(P){var n=_toPrimitive(P,"string");return _typeof(n)==="symbol"?n:String(n)}function _defineProperties(P,n){for(var y=0;y<n.length;y++){var t=n[y];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(P,_toPropertyKey(t.key),t)}}function _createClass(P,n,y){return n&&_defineProperties(P.prototype,n),y&&_defineProperties(P,y),Object.defineProperty(P,"prototype",{writable:!1}),P}function _inherits(P,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(n&&n.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),Object.defineProperty(P,"prototype",{writable:!1}),n&&_setPrototypeOf(P,n)}function _possibleConstructorReturn(P,n){if(n&&(_typeof(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(P)}function _getPrototypeOf(P){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(y){return y.__proto__||Object.getPrototypeOf(y)},_getPrototypeOf(P)}function _defineProperty(P,n,y){return n=_toPropertyKey(n),n in P?Object.defineProperty(P,n,{value:y,enumerable:!0,configurable:!0,writable:!0}):P[n]=y,P}var __spreadArray=globalThis&&globalThis.__spreadArray||function(P,n,y){if(y||arguments.length===2)for(var t=0,a=n.length,F;t<a;t++)(F||!(t in n))&&(F||(F=Array.prototype.slice.call(n,0,t)),F[t]=n[t]);return P.concat(F||Array.prototype.slice.call(n))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],focusEvents=["onFocus","onBlur"],formEvents=["onChange","onInput","onInvalid","onReset","onSubmit"],genericEvents=["onError","onLoad"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],uiEvents=["onScroll"],wheelEvents=["onWheel"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],imageEvents=["onLoad","onError"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),keyboardEvents,!0),focusEvents,!0),formEvents,!0),genericEvents,!0),mouseEvents,!0),pointerEvents,!0),selectionEvents,!0),touchEvents,!0),uiEvents,!0),wheelEvents,!0),mediaEvents,!0),imageEvents,!0),animationEvents,!0),transitionEvents,!0),otherEvents,!0);function makeEventProps(P,n){var y={};return allEvents.forEach(function(t){var a=P[t];if(a){if(!n){y[t]=a;return}y[t]=function(F){return a(F,n(t))}}}),y}function makeCancellablePromise(P){var n=!1,y=new Promise(function(t,a){P.then(function(F){return!n&&t(F)}).catch(function(F){return!n&&a(F)})});return{promise:y,cancel:function(){n=!0}}}var isProduction$1=!0,prefix="Invariant failed";function invariant(P,n){if(!P){if(isProduction$1)throw new Error(prefix);var y=typeof n=="function"?n():n,t=y?"".concat(prefix,": ").concat(y):prefix;throw new Error(t)}}var isProduction=!0;function warning(P,n){if(!isProduction){if(P)return;var y="Warning: "+n;typeof console<"u"&&console.warn(y);try{throw Error(y)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message(P){var n=P.children,y=P.type;return React.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(y)},n)}Message.propTypes={children:PropTypes.node,type:PropTypes.oneOf(["error","loading","no-data"]).isRequired};var DEFAULT_LINK_REL="noopener noreferrer nofollow",LinkService=function(){function P(){_classCallCheck(this,P),this.externalLinkTarget=null,this.externalLinkRel=null}return _createClass(P,[{key:"setDocument",value:function(y){this.pdfDocument=y}},{key:"setViewer",value:function(y){this.pdfViewer=y}},{key:"setExternalLinkRel",value:function(y){this.externalLinkRel=y}},{key:"setExternalLinkTarget",value:function(y){this.externalLinkTarget=y}},{key:"setHistory",value:function(){}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(y){this.pdfViewer.currentPageNumber=y}},{key:"rotation",get:function(){return 0},set:function(y){}},{key:"goToDestination",value:function(y){var t=this;new Promise(function(a){typeof y=="string"?t.pdfDocument.getDestination(y).then(a):Array.isArray(y)?a(y):y.then(a)}).then(function(a){invariant(Array.isArray(a),'"'.concat(a,'" is not a valid destination array.'));var F=a[0];new Promise(function(D){F instanceof Object?t.pdfDocument.getPageIndex(F).then(function(T){D(T)}).catch(function(){invariant(!1,'"'.concat(F,'" is not a valid page reference.'))}):typeof F=="number"?D(F):invariant(!1,'"'.concat(F,'" is not a valid destination reference.'))}).then(function(D){var T=D+1;invariant(T>=1&&T<=t.pagesCount,'"'.concat(T,'" is not a valid page number.')),t.pdfViewer.scrollPageIntoView({dest:y,pageIndex:D,pageNumber:T})})})}},{key:"navigateTo",value:function(y){this.goToDestination(y)}},{key:"goToPage",value:function(){}},{key:"addLinkAttributes",value:function(y,t,a){y.href=t,y.rel=this.externalLinkRel||DEFAULT_LINK_REL,y.target=a?"_blank":this.externalLinkTarget||""}},{key:"getDestinationHash",value:function(){return"#"}},{key:"getAnchorUrl",value:function(){return"#"}},{key:"setHash",value:function(){}},{key:"executeNamedAction",value:function(){}},{key:"cachePageRef",value:function(){}},{key:"isPageVisible",value:function(){return!0}},{key:"isPageCached",value:function(){return!0}}]),P}(),PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function _arrayWithHoles(P){if(Array.isArray(P))return P}function _iterableToArrayLimit(P,n){var y=P==null?null:typeof Symbol<"u"&&P[Symbol.iterator]||P["@@iterator"];if(y!=null){var t,a,F,D,T=[],A=!0,f=!1;try{if(F=(y=y.call(P)).next,n===0){if(Object(y)!==y)return;A=!1}else for(;!(A=(t=F.call(y)).done)&&(T.push(t.value),T.length!==n);A=!0);}catch(w){f=!0,a=w}finally{try{if(!A&&y.return!=null&&(D=y.return(),Object(D)!==D))return}finally{if(f)throw a}}return T}}function _arrayLikeToArray(P,n){(n==null||n>P.length)&&(n=P.length);for(var y=0,t=new Array(n);y<n;y++)t[y]=P[y];return t}function _unsupportedIterableToArray(P,n){if(P){if(typeof P=="string")return _arrayLikeToArray(P,n);var y=Object.prototype.toString.call(P).slice(8,-1);if(y==="Object"&&P.constructor&&(y=P.constructor.name),y==="Map"||y==="Set")return Array.from(P);if(y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(y))return _arrayLikeToArray(P,n)}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(P,n){return _arrayWithHoles(P)||_iterableToArrayLimit(P,n)||_unsupportedIterableToArray(P,n)||_nonIterableRest()}var isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(P){return typeof P<"u"}function isProvided(P){return isDefined(P)&&P!==null}function isString(P){return typeof P=="string"}function isArrayBuffer(P){return P instanceof ArrayBuffer}function isBlob(P){return invariant(isBrowser,"isBlob can only be used in a browser environment"),P instanceof Blob}function isFile$1(P){return invariant(isBrowser,"isFile can only be used in a browser environment"),P instanceof File}function isDataURI(P){return isString(P)&&/^data:/.test(P)}function dataURItoByteString(P){invariant(isDataURI(P),"Invalid data URI.");var n=P.split(","),y=_slicedToArray(n,2),t=y[0],a=y[1],F=t.split(";");return F.indexOf("base64")!==-1?atob(a):unescape(a)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}var allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,"Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function displayWorkerWarning(){warning(!isLocalFileSystem,"Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ".concat(allowFileAccessFromFilesTip))}function cancelRunningTask(P){P&&P.cancel&&P.cancel()}function makePageCallback(P,n){return Object.defineProperty(P,"width",{get:function(){return this.view[2]*n},configurable:!0}),Object.defineProperty(P,"height",{get:function(){return this.view[3]*n},configurable:!0}),Object.defineProperty(P,"originalWidth",{get:function(){return this.view[2]},configurable:!0}),Object.defineProperty(P,"originalHeight",{get:function(){return this.view[3]},configurable:!0}),P}function isCancelException(P){return P.name==="RenderingCancelledException"}function loadFromFile(P){return new Promise(function(n,y){var t=new FileReader;return t.onload=function(){return n(new Uint8Array(t.result))},t.onerror=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:return y(new Error("Error while reading a file: File not found."));case a.target.error.NOT_READABLE_ERR:return y(new Error("Error while reading a file: File not readable."));case a.target.error.SECURITY_ERR:return y(new Error("Error while reading a file: Security error."));case a.target.error.ABORT_ERR:return y(new Error("Error while reading a file: Aborted."));default:return y(new Error("Error while reading a file."))}},t.readAsArrayBuffer(P),null})}function _arrayWithoutHoles(P){if(Array.isArray(P))return _arrayLikeToArray(P)}function _iterableToArray(P){if(typeof Symbol<"u"&&P[Symbol.iterator]!=null||P["@@iterator"]!=null)return Array.from(P)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray(P){return _arrayWithoutHoles(P)||_iterableToArray(P)||_unsupportedIterableToArray(P)||_nonIterableSpread()}var eventProps=function(){var P={};return[].concat(_toConsumableArray(mouseEvents),_toConsumableArray(touchEvents),_toConsumableArray(keyboardEvents)).forEach(function(n){P[n]=PropTypes.func}),P}(),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),httpHeaders:PropTypes.object,range:PropTypes.object,url:PropTypes.string,withCredentials:PropTypes.bool})];typeof File<"u"&&fileTypes.push(PropTypes.instanceOf(File));typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));var isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes),isLinkService=PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);var isPage=PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired}),isPageIndex=function P(n,y,t){var a=n[y],F=n.pageNumber,D=n.pdf;if(!isDefined(D))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(y,"` of type `").concat(_typeof(a),"` supplied to `").concat(t,"`, expected `number`."));if(a<0)return new Error("Expected `".concat(y,"` to be greater or equal to 0."));var T=D.numPages;if(a+1>T)return new Error("Expected `".concat(y,"` to be less or equal to ").concat(T-1,"."))}else if(!isDefined(F))return new Error("`".concat(y,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(t,"`."));return null},isPageNumber=function P(n,y,t){var a=n[y],F=n.pageIndex,D=n.pdf;if(!isDefined(D))return null;if(isDefined(a)){if(typeof a!="number")return new Error("`".concat(y,"` of type `").concat(_typeof(a),"` supplied to `").concat(t,"`, expected `number`."));if(a<1)return new Error("Expected `".concat(y,"` to be greater or equal to 1."));var T=D.numPages;if(a>T)return new Error("Expected `".concat(y,"` to be less or equal to ").concat(T,"."))}else if(!isDefined(F))return new Error("`".concat(y,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(t,"`."));return null},isPdf=PropTypes.oneOfType([PropTypes.shape({getDestination:PropTypes.func.isRequired,getOutline:PropTypes.func.isRequired,getPage:PropTypes.func.isRequired,numPages:PropTypes.number.isRequired}),PropTypes.bool]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.shape({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]),_excluded=["url"];function ownKeys$3(P,n){var y=Object.keys(P);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(P);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(P,a).enumerable})),y.push.apply(y,t)}return y}function _objectSpread$3(P){for(var n=1;n<arguments.length;n++){var y=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$3(Object(y),!0).forEach(function(t){_defineProperty(P,t,y[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(y)):ownKeys$3(Object(y)).forEach(function(t){Object.defineProperty(P,t,Object.getOwnPropertyDescriptor(y,t))})}return P}function _createSuper$5(P){var n=_isNativeReflectConstruct$5();return function(){var t=_getPrototypeOf(P),a;if(n){var F=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,F)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PDFDataRangeTransport=pdfExports.PDFDataRangeTransport,Document=function(P){_inherits(y,P);var n=_createSuper$5(y);function y(){var t;_classCallCheck(this,y);for(var a=arguments.length,F=new Array(a),D=0;D<a;D++)F[D]=arguments[D];return t=n.call.apply(n,[this].concat(F)),_defineProperty(_assertThisInitialized(t),"state",{pdf:null}),_defineProperty(_assertThisInitialized(t),"viewer",{scrollPageIntoView:function(A){var f=A.dest,w=A.pageIndex,L=A.pageNumber,C=t.props.onItemClick;if(C){C({dest:f,pageIndex:w,pageNumber:L});return}var S=t.pages[w];if(S){S.scrollIntoView();return}warning(!1,"An internal link leading to page ".concat(L," was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>."))}}),_defineProperty(_assertThisInitialized(t),"linkService",new LinkService),_defineProperty(_assertThisInitialized(t),"loadDocument",function(){cancelRunningTask(t.runningTask),t.loadingTask&&t.loadingTask.destroy();var T=makeCancellablePromise(t.findDocumentSource());t.runningTask=T,T.promise.then(function(A){if(t.onSourceSuccess(),!!A){t.setState(function(h){return h.pdf?{pdf:null}:null});var f=t.props,w=f.options,L=f.onLoadProgress,C=f.onPassword,S=pdfExports.getDocument(_objectSpread$3(_objectSpread$3({},A),w));S.onPassword=C,L&&(S.onProgress=L),t.loadingTask=S,S.promise.then(function(h){t.setState(function(e){return e.pdf&&e.pdf.fingerprint===h.fingerprint?null:{pdf:h}},t.onLoadSuccess)}).catch(function(h){t.onLoadError(h)})}}).catch(function(A){t.onSourceError(A)})}),_defineProperty(_assertThisInitialized(t),"setupLinkService",function(){var T=t.props,A=T.externalLinkRel,f=T.externalLinkTarget;t.linkService.setViewer(t.viewer),t.linkService.setExternalLinkRel(A),t.linkService.setExternalLinkTarget(f)}),_defineProperty(_assertThisInitialized(t),"onSourceSuccess",function(){var T=t.props.onSourceSuccess;T&&T()}),_defineProperty(_assertThisInitialized(t),"onSourceError",function(T){warning(T);var A=t.props.onSourceError;A&&A(T)}),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props.onLoadSuccess,A=t.state.pdf;T&&T(A),t.pages=new Array(A.numPages),t.linkService.setDocument(A)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({pdf:!1}),warning(T);var A=t.props.onLoadError;A&&A(T)}),_defineProperty(_assertThisInitialized(t),"findDocumentSource",function(){return new Promise(function(T){var A=t.props.file;if(A||T(null),typeof A=="string"){if(isDataURI(A)){var f=dataURItoByteString(A);T({data:f})}displayCORSWarning(),T({url:A})}if(A instanceof PDFDataRangeTransport&&T({range:A}),isArrayBuffer(A)&&T({data:A}),isBrowser&&(isBlob(A)||isFile$1(A))){loadFromFile(A).then(function(S){T({data:S})});return}if(invariant(_typeof(A)==="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(A.url||A.data||A.range,"Invalid parameter object: need either .data, .range or .url"),typeof A.url=="string"){if(isDataURI(A.url)){var w=A.url,L=_objectWithoutProperties(A,_excluded),C=dataURItoByteString(w);T(_objectSpread$3({data:C},L))}displayCORSWarning()}T(A)})}),_defineProperty(_assertThisInitialized(t),"registerPage",function(T,A){t.pages[T]=A}),_defineProperty(_assertThisInitialized(t),"unregisterPage",function(T){delete t.pages[T]}),t}return _createClass(y,[{key:"componentDidMount",value:function(){this.loadDocument(),this.setupLinkService()}},{key:"componentDidUpdate",value:function(a){var F=this.props.file;F!==a.file&&this.loadDocument()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask),this.loadingTask&&this.loadingTask.destroy()}},{key:"childContext",get:function(){var a=this.linkService,F=this.registerPage,D=this.unregisterPage,T=this.props,A=T.imageResourcesPath,f=T.renderMode,w=T.rotate,L=this.state.pdf;return{imageResourcesPath:A,linkService:a,pdf:L,registerPage:F,renderMode:f,rotate:w,unregisterPage:D}}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){return a.state.pdf})}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(DocumentContext.Provider,{value:this.childContext},a)}},{key:"renderContent",value:function(){var a=this.props.file,F=this.state.pdf;if(!a){var D=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof D=="function"?D():D)}if(F===null){var T=this.props.loading;return React.createElement(Message,{type:"loading"},typeof T=="function"?T():T)}if(F===!1){var A=this.props.error;return React.createElement(Message,{type:"error"},typeof A=="function"?A():A)}return this.renderChildren()}},{key:"render",value:function(){var a=this.props,F=a.className,D=a.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Document",F),ref:D},this.eventProps),this.renderContent())}}]),y}(reactExports.PureComponent);Document.defaultProps={error:"Failed to load PDF file.",loading:"Loading PDF…",noData:"No PDF file specified.",onPassword:function P(n,y){switch(y){case PasswordResponses.NEED_PASSWORD:{var t=prompt("Enter the password to open this PDF file.");n(t);break}case PasswordResponses.INCORRECT_PASSWORD:{var a=prompt("Invalid password. Please try again.");n(a);break}}}};var isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=_objectSpread$3(_objectSpread$3({},eventProps),{},{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.string,file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,rotate:PropTypes.number});var isDestination=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.any)]);PropTypes.shape({dest:isDestination,items:PropTypes.arrayOf(PropTypes.shape({dest:isDestination,title:PropTypes.string})),title:PropTypes.string}).isRequired,PropTypes.func,isPdf.isRequired;function ownKeys$2(P,n){var y=Object.keys(P);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(P);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(P,a).enumerable})),y.push.apply(y,t)}return y}function _objectSpread$2(P){for(var n=1;n<arguments.length;n++){var y=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$2(Object(y),!0).forEach(function(t){_defineProperty(P,t,y[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(y)):ownKeys$2(Object(y)).forEach(function(t){Object.defineProperty(P,t,Object.getOwnPropertyDescriptor(y,t))})}return P}_objectSpread$2({className:isClassName,inputRef:isRef,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,pdf:isPdf},eventProps);function mergeRefs(){for(var P=[],n=0;n<arguments.length;n++)P[n]=arguments[n];var y=P.filter(Boolean);if(y.length<=1){var t=y[0];return t||null}return function(F){y.forEach(function(D){typeof D=="function"?D(F):D&&(D.current=F)})}}const PageContext=reactExports.createContext(null);function _createSuper$4(P){var n=_isNativeReflectConstruct$4();return function(){var t=_getPrototypeOf(P),a;if(n){var F=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,F)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ANNOTATION_MODE=pdfExports.AnnotationMode,PageCanvasInternal=function(P){_inherits(y,P);var n=_createSuper$4(y);function y(){var t;_classCallCheck(this,y);for(var a=arguments.length,F=new Array(a),D=0;D<a;D++)F[D]=arguments[D];return t=n.call.apply(n,[this].concat(F)),_defineProperty(_assertThisInitialized(t),"canvasElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){t.renderer=null;var T=t.props,A=T.onRenderSuccess,f=T.page,w=T.scale;A&&A(makePageCallback(f,w))}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){if(!isCancelException(T)){warning(T);var A=t.props.onRenderError;A&&A(T)}}),_defineProperty(_assertThisInitialized(t),"drawPageOnCanvas",function(){var T=t.canvasElement.current;if(!T)return null;var A=_assertThisInitialized(t),f=A.renderViewport,w=A.viewport,L=t.props,C=L.canvasBackground,S=L.page,h=L.renderForms;T.width=f.width,T.height=f.height,T.style.width="".concat(Math.floor(w.width),"px"),T.style.height="".concat(Math.floor(w.height),"px");var e={annotationMode:h?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,get canvasContext(){return T.getContext("2d",{alpha:!1})},viewport:f};C&&(e.background=C),t.cancelRenderingTask();var i=S.render(e);return t.renderer=i,i.promise.then(t.onRenderSuccess).catch(t.onRenderError)}),t}return _createClass(y,[{key:"componentDidMount",value:function(){this.drawPageOnCanvas()}},{key:"componentDidUpdate",value:function(a){var F=this.props,D=F.canvasBackground,T=F.devicePixelRatio,A=F.page,f=F.renderForms;(D!==a.canvasBackground||T!==a.devicePixelRatio||f!==a.renderForms)&&(A.cleanup(),this.drawPageOnCanvas())}},{key:"componentWillUnmount",value:function(){this.cancelRenderingTask();var a=this.canvasElement.current;a&&(a.width=0,a.height=0)}},{key:"cancelRenderingTask",value:function(){this.renderer&&(this.renderer.cancel(),this.renderer=null)}},{key:"devicePixelRatio",get:function(){var a=this.props.devicePixelRatio;return a||getDevicePixelRatio()}},{key:"renderViewport",get:function(){var a=this.devicePixelRatio,F=this.props,D=F.page,T=F.rotate,A=F.scale;return D.getViewport({scale:A*a,rotation:T})}},{key:"viewport",get:function(){var a=this.props,F=a.page,D=a.rotate,T=a.scale;return F.getViewport({scale:T,rotation:D})}},{key:"render",value:function(){var a=this.props.canvasRef;return React.createElement("canvas",{className:"react-pdf__Page__canvas",dir:"ltr",ref:mergeRefs(a,this.canvasElement),style:{display:"block",userSelect:"none"}})}}]),y}(reactExports.PureComponent);PageCanvasInternal.propTypes={canvasBackground:PropTypes.string,canvasRef:isRef,devicePixelRatio:PropTypes.number,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number.isRequired};function PageCanvas(P){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(PageCanvasInternal,_extends({},n,P))})}function _createSuper$3(P){var n=_isNativeReflectConstruct$3();return function(){var t=_getPrototypeOf(P),a;if(n){var F=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,F)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PageSVGInternal=function(P){_inherits(y,P);var n=_createSuper$3(y);function y(){var t;_classCallCheck(this,y);for(var a=arguments.length,F=new Array(a),D=0;D<a;D++)F[D]=arguments[D];return t=n.call.apply(n,[this].concat(F)),_defineProperty(_assertThisInitialized(t),"state",{svg:null}),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){t.renderer=null;var T=t.props,A=T.onRenderSuccess,f=T.page,w=T.scale;A&&A(makePageCallback(f,w))}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){if(!isCancelException(T)){warning(T);var A=t.props.onRenderError;A&&A(T)}}),_defineProperty(_assertThisInitialized(t),"renderSVG",function(){var T=t.props.page;return t.renderer=T.getOperatorList(),t.renderer.then(function(A){var f=new pdfExports.SVGGraphics(T.commonObjs,T.objs);t.renderer=f.getSVG(A,t.viewport).then(function(w){t.setState({svg:w},t.onRenderSuccess)}).catch(t.onRenderError)}).catch(t.onRenderError)}),_defineProperty(_assertThisInitialized(t),"drawPageOnContainer",function(T){var A=t.state.svg;if(!(!T||!A)){T.firstElementChild||T.appendChild(A);var f=t.viewport,w=f.width,L=f.height;A.setAttribute("width",w),A.setAttribute("height",L)}}),t}return _createClass(y,[{key:"componentDidMount",value:function(){this.renderSVG()}},{key:"viewport",get:function(){var a=this.props,F=a.page,D=a.rotate,T=a.scale;return F.getViewport({scale:T,rotation:D})}},{key:"render",value:function(){var a=this,F=this.viewport,D=F.width,T=F.height;return React.createElement("div",{className:"react-pdf__Page__svg",ref:function(f){return a.drawPageOnContainer(f)},style:{display:"block",backgroundColor:"white",overflow:"hidden",width:D,height:T,userSelect:"none"}})}}]),y}(reactExports.PureComponent);PageSVGInternal.propTypes={onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,rotate:isRotate,scale:PropTypes.number.isRequired};function PageSVG(P){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(PageSVGInternal,_extends({},n,P))})}function ownKeys$1(P,n){var y=Object.keys(P);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(P);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(P,a).enumerable})),y.push.apply(y,t)}return y}function _objectSpread$1(P){for(var n=1;n<arguments.length;n++){var y=arguments[n]!=null?arguments[n]:{};n%2?ownKeys$1(Object(y),!0).forEach(function(t){_defineProperty(P,t,y[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(y)):ownKeys$1(Object(y)).forEach(function(t){Object.defineProperty(P,t,Object.getOwnPropertyDescriptor(y,t))})}return P}function _createSuper$2(P){var n=_isNativeReflectConstruct$2();return function(){var t=_getPrototypeOf(P),a;if(n){var F=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,F)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TextLayerInternal=function(P){_inherits(y,P);var n=_createSuper$2(y);function y(){var t;_classCallCheck(this,y);for(var a=arguments.length,F=new Array(a),D=0;D<a;D++)F[D]=arguments[D];return t=n.call.apply(n,[this].concat(F)),_defineProperty(_assertThisInitialized(t),"state",{textContent:null}),_defineProperty(_assertThisInitialized(t),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"endElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"loadTextContent",function(){var T=t.props.page,A=makeCancellablePromise(T.getTextContent());t.runningTask=A,A.promise.then(function(f){t.setState({textContent:f},t.onLoadSuccess)}).catch(function(f){t.onLoadError(f)})}),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props.onGetTextSuccess,A=t.state.textContent;T&&T(A)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({textItems:!1}),warning(T);var A=t.props.onGetTextError;A&&A(T)}),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){var T=t.props.onRenderTextLayerSuccess;T&&T()}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){warning(T);var A=t.props.onRenderTextLayerError;A&&A(T)}),_defineProperty(_assertThisInitialized(t),"onMouseDown",function(){var T=t.endElement.current;T&&T.classList.add("active")}),_defineProperty(_assertThisInitialized(t),"onMouseUp",function(){var T=t.endElement.current;T&&T.classList.remove("active")}),t}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a,"Attempted to load page text content, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer"),this.loadTextContent()}},{key:"componentDidUpdate",value:function(a){var F=this.props.page;a.page&&F!==a.page&&this.loadTextContent()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,F=a.page,D=a.rotate,T=a.scale;return F.getViewport({scale:T,rotation:D})}},{key:"unrotatedViewport",get:function(){var a=this.props,F=a.page,D=a.scale;return F.getViewport({scale:D})}},{key:"rotate",get:function(){var a=this.props,F=a.page,D=a.rotate;return D-F.rotate}},{key:"renderTextLayer",value:function(){var a=this,F=this.state.textContent;if(!F)return null;var D=this.layerElement.current,T=this.viewport,A=this.props,f=A.customTextRenderer,w=A.pageIndex,L=A.pageNumber;cancelRunningTask(this.runningTask),D.innerHTML="";var C={container:D,textContent:F,viewport:T},S=pdfExports.renderTextLayer(C);this.runningTask=S,S.promise.then(function(){var h=document.createElement("div");if(h.className="endOfContent",D.append(h),a.endElement.current=h,f){var e=0;F.items.forEach(function(i,l){var b=a.layerElement.current.children[e],v=f(_objectSpread$1({pageIndex:w,pageNumber:L,itemIndex:l},i));b.innerHTML=v,e+=i.str&&i.hasEOL?2:1})}a.onRenderSuccess()}).catch(function(h){a.onRenderError(h)})}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__textContent textLayer",onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,ref:this.layerElement},this.renderTextLayer())}}]),y}(reactExports.PureComponent);TextLayerInternal.propTypes={customTextRenderer:PropTypes.func,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,page:isPage.isRequired,pageIndex:PropTypes.number.isRequired,pageNumber:PropTypes.number.isRequired,rotate:isRotate,scale:PropTypes.number};function TextLayer(P){return React.createElement(PageContext.Consumer,null,function(n){return React.createElement(TextLayerInternal,_extends({},n,P))})}function _createSuper$1(P){var n=_isNativeReflectConstruct$1();return function(){var t=_getPrototypeOf(P),a;if(n){var F=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,F)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AnnotationLayerInternal=function(P){_inherits(y,P);var n=_createSuper$1(y);function y(){var t;_classCallCheck(this,y);for(var a=arguments.length,F=new Array(a),D=0;D<a;D++)F[D]=arguments[D];return t=n.call.apply(n,[this].concat(F)),_defineProperty(_assertThisInitialized(t),"state",{annotations:null}),_defineProperty(_assertThisInitialized(t),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"loadAnnotations",function(){var T=t.props.page,A=makeCancellablePromise(T.getAnnotations());t.runningTask=A,A.promise.then(function(f){t.setState({annotations:f},t.onLoadSuccess)}).catch(function(f){t.onLoadError(f)})}),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props.onGetAnnotationsSuccess,A=t.state.annotations;T&&T(A)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({annotations:!1}),warning(T);var A=t.props.onGetAnnotationsError;A&&A(T)}),_defineProperty(_assertThisInitialized(t),"onRenderSuccess",function(){var T=t.props.onRenderAnnotationLayerSuccess;T&&T()}),_defineProperty(_assertThisInitialized(t),"onRenderError",function(T){warning(T);var A=t.props.onRenderAnnotationLayerError;A&&A(T)}),t}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.page;invariant(a,"Attempted to load page annotations, but no page was specified."),warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations"),this.loadAnnotations()}},{key:"componentDidUpdate",value:function(a){var F=this.props,D=F.page,T=F.renderForms;(a.page&&D!==a.page||T!==a.renderForms)&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var a=this.props,F=a.page,D=a.rotate,T=a.scale;return F.getViewport({scale:T,rotation:D})}},{key:"renderAnnotationLayer",value:function(){var a=this.state.annotations;if(a){var F=this.props,D=F.imageResourcesPath,T=F.linkService,A=F.page,f=F.renderForms,w=this.viewport.clone({dontFlip:!0}),L={annotations:a,div:this.layerElement.current,imageResourcesPath:D,linkService:T,page:A,renderForms:f,viewport:w};this.layerElement.current.innerHTML="";try{pdfExports.AnnotationLayer.render(L),this.onRenderSuccess()}catch(C){this.onRenderError(C)}}}},{key:"render",value:function(){return React.createElement("div",{className:"react-pdf__Page__annotations annotationLayer",ref:this.layerElement},this.renderAnnotationLayer())}}]),y}(reactExports.PureComponent);AnnotationLayerInternal.propTypes={imageResourcesPath:PropTypes.string,linkService:isLinkService.isRequired,onGetAnnotationsError:PropTypes.func,onGetAnnotationsSuccess:PropTypes.func,onRenderAnnotationLayerError:PropTypes.func,onRenderAnnotationLayerSuccess:PropTypes.func,page:isPage,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number};var AnnotationLayer=function P(n){return React.createElement(DocumentContext.Consumer,null,function(y){return React.createElement(PageContext.Consumer,null,function(t){return React.createElement(AnnotationLayerInternal,_extends({},y,t,n))})})};function ownKeys(P,n){var y=Object.keys(P);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(P);n&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(P,a).enumerable})),y.push.apply(y,t)}return y}function _objectSpread(P){for(var n=1;n<arguments.length;n++){var y=arguments[n]!=null?arguments[n]:{};n%2?ownKeys(Object(y),!0).forEach(function(t){_defineProperty(P,t,y[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(y)):ownKeys(Object(y)).forEach(function(t){Object.defineProperty(P,t,Object.getOwnPropertyDescriptor(y,t))})}return P}function _createSuper(P){var n=_isNativeReflectConstruct();return function(){var t=_getPrototypeOf(P),a;if(n){var F=_getPrototypeOf(this).constructor;a=Reflect.construct(t,arguments,F)}else a=t.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var defaultScale=1,PageInternal=function(P){_inherits(y,P);var n=_createSuper(y);function y(){var t;_classCallCheck(this,y);for(var a=arguments.length,F=new Array(a),D=0;D<a;D++)F[D]=arguments[D];return t=n.call.apply(n,[this].concat(F)),_defineProperty(_assertThisInitialized(t),"state",{page:null}),_defineProperty(_assertThisInitialized(t),"pageElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(t),"onLoadSuccess",function(){var T=t.props,A=T.onLoadSuccess,f=T.registerPage,w=t.state.page;A&&A(makePageCallback(w,t.scale)),f&&f(t.pageIndex,t.pageElement.current)}),_defineProperty(_assertThisInitialized(t),"onLoadError",function(T){t.setState({page:!1}),warning(T);var A=t.props.onLoadError;A&&A(T)}),_defineProperty(_assertThisInitialized(t),"loadPage",function(){var T=t.props.pdf,A=t.getPageNumber();if(A){t.setState(function(w){return w.page?{page:null}:null});var f=makeCancellablePromise(T.getPage(A));t.runningTask=f,f.promise.then(function(w){t.setState({page:w},t.onLoadSuccess)}).catch(function(w){t.onLoadError(w)})}}),t}return _createClass(y,[{key:"componentDidMount",value:function(){var a=this.props.pdf;invariant(a,"Attempted to load a page, but no document was specified."),this.loadPage()}},{key:"componentDidUpdate",value:function(a){var F=this.props.pdf;if(a.pdf&&F!==a.pdf||this.getPageNumber()!==this.getPageNumber(a)){var D=this.props.unregisterPage;D&&D(this.getPageIndex(a)),this.loadPage()}}},{key:"componentWillUnmount",value:function(){var a=this.props.unregisterPage;a&&a(this.pageIndex),cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){var a=this.pageIndex,F=this.pageNumber,D=this.state.page;if(!D)return{};var T=this.props,A=T.canvasBackground,f=T.customTextRenderer,w=T.devicePixelRatio,L=T.onGetAnnotationsError,C=T.onGetAnnotationsSuccess,S=T.onGetTextError,h=T.onGetTextSuccess,e=T.onRenderAnnotationLayerError,i=T.onRenderAnnotationLayerSuccess,l=T.onRenderError,b=T.onRenderSuccess,v=T.onRenderTextLayerError,c=T.onRenderTextLayerSuccess,r=T.renderForms,s=T.renderInteractiveForms;return{canvasBackground:A,customTextRenderer:f,devicePixelRatio:w,onGetAnnotationsError:L,onGetAnnotationsSuccess:C,onGetTextError:S,onGetTextSuccess:h,onRenderAnnotationLayerError:e,onRenderAnnotationLayerSuccess:i,onRenderError:l,onRenderSuccess:b,onRenderTextLayerError:v,onRenderTextLayerSuccess:c,page:D,pageIndex:a,pageNumber:F,renderForms:r??s,rotate:this.rotate,scale:this.scale}}},{key:"getPageIndex",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber-1:isProvided(a.pageIndex)?a.pageIndex:null}},{key:"getPageNumber",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(a.pageNumber)?a.pageNumber:isProvided(a.pageIndex)?a.pageIndex+1:null}},{key:"pageIndex",get:function(){return this.getPageIndex()}},{key:"pageNumber",get:function(){return this.getPageNumber()}},{key:"rotate",get:function(){var a=this.props.rotate;if(isProvided(a))return a;var F=this.state.page;return F?F.rotate:null}},{key:"scale",get:function(){var a=this.state.page;if(!a)return null;var F=this.props,D=F.scale,T=F.width,A=F.height,f=this.rotate,w=1,L=D===null?defaultScale:D;if(T||A){var C=a.getViewport({scale:1,rotation:f});w=T?T/C.width:A/C.height}return L*w}},{key:"eventProps",get:function(){var a=this;return makeEventProps(this.props,function(){var F=a.state.page;return F&&makePageCallback(F,a.scale)})}},{key:"pageKey",get:function(){return"".concat(this.pageIndex,"@").concat(this.scale,"/").concat(this.rotate)}},{key:"pageKeyNoScale",get:function(){return"".concat(this.pageIndex,"/").concat(this.rotate)}},{key:"renderMainLayer",value:function(){var a=this.props,F=a.canvasRef,D=a.renderMode;switch(D){case"none":return null;case"svg":return React.createElement(PageSVG,{key:"".concat(this.pageKeyNoScale,"_svg")});case"canvas":default:return React.createElement(PageCanvas,{key:"".concat(this.pageKey,"_canvas"),canvasRef:F})}}},{key:"renderTextLayer",value:function(){var a=this.props.renderTextLayer;return a?React.createElement(TextLayer,{key:"".concat(this.pageKey,"_text")}):null}},{key:"renderAnnotationLayer",value:function(){var a=this.props.renderAnnotationLayer;return a?React.createElement(AnnotationLayer,{key:"".concat(this.pageKey,"_annotations")}):null}},{key:"renderChildren",value:function(){var a=this.props.children;return React.createElement(PageContext.Provider,{value:this.childContext},this.renderMainLayer(),this.renderTextLayer(),this.renderAnnotationLayer(),a)}},{key:"renderContent",value:function(){var a=this.pageNumber,F=this.props.pdf,D=this.state.page;if(!a){var T=this.props.noData;return React.createElement(Message,{type:"no-data"},typeof T=="function"?T():T)}if(F===null||D===null){var A=this.props.loading;return React.createElement(Message,{type:"loading"},typeof A=="function"?A():A)}if(F===!1||D===!1){var f=this.props.error;return React.createElement(Message,{type:"error"},typeof f=="function"?f():f)}return this.renderChildren()}},{key:"render",value:function(){var a=this.pageNumber,F=this.props,D=F.className,T=F.inputRef;return React.createElement("div",_extends({className:clsx("react-pdf__Page",D),"data-page-number":a,ref:mergeRefs(T,this.pageElement),style:{position:"relative",minWidth:"min-content",minHeight:"min-content"}},this.eventProps),this.renderContent())}}]),y}(reactExports.PureComponent);PageInternal.defaultProps={error:"Failed to load the page.",loading:"Loading page…",noData:"No page specified.",renderAnnotationLayer:!0,renderMode:"canvas",renderTextLayer:!0,scale:defaultScale};var isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);PageInternal.propTypes=_objectSpread(_objectSpread({},eventProps),{},{canvasBackground:PropTypes.string,children:PropTypes.node,className:isClassName,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,registerPage:PropTypes.func,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderInteractiveForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,unregisterPage:PropTypes.func,width:PropTypes.number});function Page(P,n){return React.createElement(DocumentContext.Consumer,null,function(y){return React.createElement(PageInternal,_extends({ref:n},y,P))})}const Page$1=React.forwardRef(Page);displayWorkerWarning();pdfExports.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker-6b078827.js",self.location);export{Document as D,Page$1 as P};
